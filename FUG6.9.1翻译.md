---
typora-root-url: ./FDS中钠燃烧模型添加.assets
---

[TOC]

# Introduction

本文件中介绍的软件 Fire Dynamics Simulator（FDS）是一种火灾驱动流体流动的计算流体动力学（CFD）模型。FDS 对纳维尔-斯托克斯方程的一种形式进行数值求解，该方程适用于低速（Ma[^1-1] < 0.3）热驱动流动，重点关注火灾产生的烟雾和热量传输。方程公式和数值算法载于《FDS 技术参考指南》[^29]。模型的验证和确认在 FDS 验证[^38]和确认[^23]指南中讨论。

Smokeview 是一个独立的可视化程序，用于显示 FDS 仿真结果。有关 Smokeview 的详细介绍，请参阅单独的用户指南[^17]。

## Features of FDS

FDS 的第一个版本于 2000 年 2 月公开发布。迄今为止，该模型约有一半应用于烟雾处理系统设计和自动喷水灭火系统/探测器启动研究。另一半用于住宅和工业火灾重建。在整个开发过程中，FDS 一直以解决消防工程中的实际火灾问题为目标，同时也为研究基本的火灾动力学和燃烧提供了工具。

**Hydrodynamic Model** FDS 对纳维尔-斯托克斯方程的一种形式进行数值求解，该方程适用于低速热驱动流动，重点是火灾产生的烟雾和热量传输。其核心算法是一种显式预测-校正方案，在空间和时间上均达到二阶精度。湍流是通过大涡流模拟（LES）处理的。如果基础数值网格足够精细，还可以执行直接数值模拟（DNS）。详见第 19.1 节。

**Combustion Model** 在大多数应用中，FDS 采用的是单步混合控制化学反应，其中使用了三个集合物种（一个物种代表一组物种）。这些集合物种包括空气、燃料和产物。默认情况下，最后两个集合物种是显式计算的。可选项包括多重反应和不一定是混合控制的反应。

**Radiation Transport** 辐射传热是通过求解灰色气体的辐射传输方程以及在某些有限的情况下使用宽带模型来实现的。该方程的求解方法类似于对流传输的有限体积法，因此被称为有限体积法（FVM）。使用约 100 个离散角度，有限体积求解器需要的时间约占计算 CPU 总时间的 20%，考虑到辐射传热的复杂性，这一成本并不高。气体-液滴混合物的吸收系数是通过 RadCal 窄带模型计算得出的[^27]。液滴可以吸收和散射热辐射。这在涉及雾状喷淋器的情况下非常重要，但在所有喷淋器情况下也会起作用。吸收和散射系数基于米氏理论。

**Geometry** FDS 可在直角网格上逼近控制方程。矩形障碍物被迫与底层网格保持一致。

**Multiple Meshes** 这是指在计算中使用一个以上的矩形网格。在计算域不易嵌入单一网格的情况下，可以指定多个矩形网格。

**Parallel Processing** FDS 采用 OpenMP [^36]，这是一种利用单台计算机上多个处理单元的编程接口。对于计算机集群，FDS 采用消息传递接口（MPI）[^37]。详情请参见第 3.1.2 节。

**Boundary Conditions** 所有固体表面都分配有热边界条件，以及有关材料燃烧行为的信息。虽然在进行直接数值模拟（DNS）时可以直接计算热量和质量的传递，但固体表面之间的热量和质量传递通常是通过经验相关性来处理的。

## What’s New in FDS 6?

FDS 6 中的许多变化是对各种子模式的改进，并不影响输入文件的基本结构或参数。除 FDS 5 中使用的参数外，下面列出的大多数更改都不需要额外的输入参数。

**Hydrodynamics and Turbulence**

- 采用保守的总变异递减（TVD）标量传输方式： Superbee（VLES 默认值）和 CHARM（LES 和 DNS 默认值）。这些方案可防止物种浓度和温度的过冲和欠冲。
- 实施了改进的湍流粘度模型： Deardorff（默认）、动态 Smagorinsky 和 Vreman。这些模型为粗分辨率下的流场提供了更大的动态范围，并在细分辨率下收敛到正确的解决方案。
- 显焓方程的保守形式在 FDS 6 配方中通过构造得到了满足，消除了数值混合导致的温度异常和能量守恒误差。
- 默认情况下包含巴氏力矩。
- 改进了动量和热通量的壁面函数。可选的壁面热通量模型适用于普朗特数可变的流体。
- Jarrin 的合成涡流法 (SEM) 被应用于通风口的湍流边界条件。

**Species and Combustion**

- 可使用输入组 SPEC 定义自定义物种混合物（“集合物种”）。
- 湍流燃烧采用新的部分搅拌间歇式反应器模型进行处理。在子网格层面，物种存在于两种状态之一：未混合或混合。在 FDS 时间步长内，混合程度通过与平均值（IEM）混合模型的交换相互作用而变化。化学动力学可以认为是无限快的，也可以遵从阿伦尼乌斯速率定律。
- 现在，运输、生产和消费二氧化碳和烟尘等产品种类已成为可能。化学机制必须由用户提供，可包括可逆反应。
- 现在，将气溶胶物质沉积到表面已经成为可能。
- 现在，包括液体特性在内的预定义种类越来越多。

**Lagrangian Particles**

- 拉格朗日粒子的功能已扩展到包括适用于实体壁的相同传热和热解模型。换句话说，您现在可以为平面、圆柱形或球形粒子分配一组表面属性，就像为固体表面分配属性一样。
- 液滴粒度分布有更多的选择和用户自定义选项。
- 您可以指定液滴的辐射特性。
- 薄多孔介质（即窗纱）的阻力效应可以用颗粒平面来模拟。

**Solid Phase Heat Transfer and Pyrolysis**

- 固体表面的基本一维传热和热解模型保持不变，但更改了几个输入参数，以扩展输入文件的功能和可读性。
- 根据指定的材料密度，热解模型允许表面收缩或膨胀。

**HVAC**

- 暖通空调系统增加了过滤器、百叶窗通风口和加热/冷却功能。
- 供暖、通风和空调系统现在可以使用 MPI。

**Radiation**

- RadCal 数据库已扩展到包括更多燃料种类。
- 在有热释放的单元中，排放项基于修正后的σ T4，这样当该排放项在火焰体积上积分时，指定的辐射分数（默认为 0.35）就会恢复。这与 FDS 5 及更早的版本不同，在 FDS 5 及更早的版本中，辐射分数乘以热释放率被局部用作排放项。

**Multi-Mesh Computations**

- 默认情况下，FDS 现在会在网格和实体边界迭代压力和速度。您可以通过 PRES 行上的参数控制误差容限和最大迭代次数。

**Control Functions**

- CTRL 功能已扩展至数学运算。
- 根据设备或控制功能的启动情况，可以停止对 RAMP 和 DEVC 的评估，并冻结其值。

**Devices and Output**

- 可为洒水器指定多个管网，以便根据操作喷头的数量降低流量。
- 控制功能的数值可通过 DEVC 输出。
- 可在一条 DEVC 线路上使用若干 POINTS 指定一行设备。
- 可提供有效值、协方差和相关系数的统计输出。

# Getting Started

FDS 是一个计算机程序，用于求解描述火灾演变的方程。它是一个 Fortran 程序，可从文本文件中读取输入参数，计算控制方程的数值解，并将用户指定的输出数据写入文件。Smokeview 是一个配套程序，可读取 FDS 输出文件并在计算机屏幕上生成动画。Smokeview 有一个简单的菜单驱动界面。FDS 则没有。不过，有各种第三方程序可以生成包含 FDS 所需的输入参数的文本文件。

本指南介绍如何获取 FDS 和 Smokeview 以及如何使用 FDS。另一份文件 [^17] 介绍了如何使用 Smokeview。

## How to Acquire FDS and Smokeview

项目主页提供了有关如何下载可执行文件、手册、源代码和相关实用程序的详细说明。

https://pages.nist.gov/fds-smv/

典型的 FDS/Smokeview 发行版包括一个安装包或压缩包，可用于 MS Windows、macOS 和 Linux。

可以通过直接将旧版本的安装程序复制到另一个位置来保留旧版本，这样在安装新版本时就不会被覆盖。

## Computer Hardware Requirements

运行编译版 FDS 和 Smokeview 的唯一硬性要求是 64 位 Windows、Linux 或 macOS 操作系统。单台计算机或计算集群应配备快速处理器（CPU）和每个内核至少 2 至 4 GB 内存。CPU 的速度将决定计算完成所需的时间，而 RAM 的大小将决定内存中可容纳的网格单元数量。由于单次计算的 FDS 输出可能会占用超过 10 GB 的存储空间，因此需要一个大硬盘来存储计算输出。

过去几年中购买的大多数计算机都足以运行 Smokeview，但需要注意的是，应购买额外的内存（RAM），使内存大小至少达到 2 GB。这样计算机才能在不 “交换 ”磁盘的情况下显示结果。对于 Smokeview 来说，为用于显示 FDS 计算结果的 PC 购买一块快速图形卡也很重要。

使用 MPI 运行 FDS 需要对每台运行案例的计算机进行共享磁盘访问。在 Windows 系统上，这需要一个能够共享文件夹的域网络。在 Linux 或 macOS 系统上，这需要 NFS 交叉挂载文件系统，并设置 ssh 密钥以实现无密码登录。对于多网格计算，FDS 可在标准的 100 Mb/s 网络上运行。千兆比特（1000 Mb/s）网络将进一步缩短网络通信时间，提高运行并行案例的 FDS 实例之间的数据传输速率。

## Computer Operating System (OS) and Software Requirements

公开 FDS 和 Smokeview 的目的是让工程师能够以合理的成本进行相当复杂的仿真。因此，FDS 和 Smokeview 适用于运行 Microsoft Windows、macOS 和 Linux 的计算机。

**MSWindows** 安装包适用于 64 位 Windows 操作系统。不建议在 Windows 7 之前的任何 MS Windows 版本下运行 FDS/Smokeview。

**macOS** 预编译的可执行文件通过安装脚本安装到用户选定的目录中。建议使用 macOS 10.4.x 或更高版本。您可以随时下载最新版本的 FDS 源代码，并为其他版本的 macOS 编译 FDS（详见第 26 章）。请注意，Rosetta 允许在苹果芯片系统（M1 和 M2 芯片）上运行在 x86-64 架构上编译的 FDS；因此，随 macOS 捆绑包分发的 FDS 可执行文件可在较新的 Mac 上运行。不过，如果使用 GNU 和 Open MPI 在苹果芯片上编译源代码，目前还无法使用 ULMAT 压力求解器（需要英特尔 MKL 库），因此也无法使用复杂几何功能（GEOM namelist）。

**Linux** 预编译的可执行文件通过安装脚本安装到用户选定的目录中。如果 预编译的 FDS 可执行文件无法运行（通常是由于库不兼容），可以下载并编译 FDS Fortran 源代码（详见第 26 章）。如果 Smokeview 无法在 Linux 工作站上运行，可以使用 Windows 版本查看 FDS 输出。

## Installation Testing

如果您根据要求进行安装测试的质量保证计划运行 FDS，《FDS 验证指南》附录 B [^38]中提供了测试程序。该指南可从 FDS-SMV 网站获取。

# Running FDS

每个 FDS 仿真都由一个文本输入文件控制，该文件通常有一个有助于识别特定案例的名称，文件扩展名为 .fds。输入文件可以直接用文本编辑器编写，也可以借助第三方图形用户界面（GUI）编写。模拟可直接通过命令提示符或图形用户界面启动。第二部分将详细介绍输入文件的创建。本章将介绍输入文件编写完成后如何运行仿真。

如果您是 FDS 和 Smokeview 的新手，强烈建议您从现有的输入文件开始，按原样运行，然后根据所需的场景对文件进行适当的更改。通过运行示例案例，您可以熟悉程序，学习如何使用 Smokeview，并在开始学习如何创建新输入文件之前确保您的计算机能够胜任任务。

样本输入文件是标准安装的一部分。对于初次使用的用户来说，位于 Examples 文件夹内名为 Fires 的子文件夹中的文件是一个很好的例子。找到名为 simple_test.fds 的文件，将其复制到计算机上不在安装文件夹内的文件夹中。这样做的原因是为了避免大量输出文件弄乱安装文件夹。按照第 3.1.2 节中的说明运行这个简单的单一网格案例。模拟只需几分钟。模拟完成后，使用 Smokeview 查看输出结果。通过这种方法，您可以快速掌握运行和分析模拟的基本方法。

## Computer Basics

### A Brief Primer on Computer Hardware

FDS 模拟可利用单台计算机上的多个处理单元或网络上的多台计算机。在运行 FDS 模拟之前，您应该熟悉自己的计算机硬件。

在使用运行 Microsoft Windows 的计算机时，打开任务管理器的 “性能 ”选项卡，查看插槽数、内核数和逻辑处理器数[^3-1]。插槽指的是主板上的物理连接器，它具有电源和连接随机存取内存（RAM）的功能。通常称为中央处理器或 CPU。有些主板有多个插座，可以支持多个 CPU，但对于典型的 Windows 台式机或笔记本电脑来说，只有一个插座/CPU。不过，每个 CPU 通常都有多个内核，每个内核本质上都是一个独立的处理单元，共享电源和内存。有时内核被称为物理内核，以区别于逻辑内核或逻辑处理器。逻辑处理器是一个内核可支持的多个线程之一。在 Windows 计算机上运行 FDS 时，逻辑处理器的数量是最重要的考虑因素。

如果您在各种 Linux 或 macOS 下运行 FDS，可以使用 Linux 的 “lscpu ”或 OS X 的 “sysctl hw ”命令来确定逻辑处理器的数量。这些操作系统使用的术语可能略有不同，但处理器与 Windows 计算机上的处理器相似，甚至相同。

### Two Ways to Use Multiple Processors

FDS 可在单台计算机上使用一个或多个内核运行，也可在多台计算机上运行。从 FDS 6.2.0 版开始，每个支持的操作系统（Windows、Linux、macOS）都有一个名为 fds 的单一[^3-2] 可执行文件（在 Windows 上扩展名为 .exe 文件）。

FDS 有两种并行运行方式，即利用单台计算机上的多个内核，或利用分布在网络或计算集群上多台计算机上的多个处理器/内核。第一种方法是 OpenMP（开放多处理）[^36]，它允许单台计算机在多个内核上运行单个或多个网格 FDS 仿真。**使用 OpenMP 并不要求将计算域分解为多个网格，它仍然可以处理定义了多个网格的情况。**并行运行 FDS 的第二种方法是使用 MPI（消息传递接口）。在这种情况下，**计算域必须划分为多个网格，通常每个网格都有自己的进程**。这些进程可以仅限于一台计算机，也可以分布在网络上。

**What is OpenMP?**

如果您的仿真只涉及一个网格，则只能在一台计算机上运行，但您可以使用 OpenMP 利用计算机的多个处理器或内核。安装 FDS 时，它会查询计算机以确定可用内核的数量。默认情况下，FDS 将使用单台计算机上大约一半的可用内核[^3-3]。这样做有两个原因：（1）防止在运行仿真时占用整个计算机；（2）使用所有内核进行单次仿真可能无法最大限度地缩短运行时间。OpenMP 在利用与单个（物理）处理器或 “插槽 ”相关联的多个（逻辑）内核时效果最佳。例如，如果您的计算机有两个处理器，每个处理器有 4 个内核，那么在 OpenMP 仿真中使用全部 8 个内核可能并不划算。您需要在自己的计算机上进行试验，以确定最适合您的策略。要更改特定 FDS 仿真的可用内核数量，可以设置一个名为 OMP_NUM_THREADS 的环境变量。具体方法取决于操作系统，下文将对此进行说明。

作业启动时，FDS 将打印该作业使用的内核数。请注意，此设置只适用于注销或重启机器之前。要设置启动时可用内核的默认值，也可在机器的启动配置脚本中设置 OMP_NUM_THREADS 环境变量。有关如何在启动时配置环境变量的详细信息，请参阅计算机操作系统的文档。

**What is MPI?**

MPI（消息传递接口）[^37] 使多台计算机或一台计算机上的多个内核能够运行多网格 FDS 作业。其主要思路是将 FDS 域分解成多个网格，然后以 MPI 进程的形式计算每个网格中的流场。该进程可视为 Windows 任务管理器中的 “任务”，或在 Linux/Unix 机器上执行 “top ”命令时看到的 “任务”。MPI 处理网格（即 MPI 进程）之间的信息传输。通常，在 MPI 计算中，每个网格都有自己的进程，但也可以将多个网格分配给一个 MPI 进程。这样，大型网格可以在专用内核上进行计算，而较小的网格则可以集中在运行于单个内核的单个进程中，无需 MPI 消息传递。

还要注意的是，FDS 用数字 1、2、3 等表示网格，而 MPI 则用数字 0、1、2 等表示进程。因此，网格 1 分配给进程 0；网格 2 分配给进程 1，依此类推。您自己不会对网格或进程进行明确编号，但 FDS 或 MPI 的错误语句可能会用编号来指代网格或进程。举例来说，如果一个 FDS 案例有 5 个网格，那么第一个打印输出（除非另有指示，通常会打印到屏幕上）是

```fortran
Mesh 1 is assigned to MPI Process 0
Mesh 2 is assigned to MPI Process 1
Mesh 3 is assigned to MPI Process 2
Mesh 4 is assigned to MPI Process 3
Mesh 5 is assigned to MPI Process 4
```

这意味着 5 个 MPI 进程（编号为 0 至 4）已经启动，每个网格都由各自的进程处理。这些进程可能在同一台计算机上，也可能在不同的计算机上。每台计算机都有自己的内存（RAM），但每个独立的 MPI 进程都有自己独立的内存，即使这些进程在同一台计算机上。

MPI 有不同的实现方式，就像有不同的 Fortran 和 C 编译器一样。每种实现方式本质上都是一个从 FDS 调用的子程序库，通过快速网络将数据从一个进程传输到另一个进程。子程序调用的格式已被社区广泛接受，允许不同的供应商和组织在开放的框架内自由开发更好的软件。对于 macOS，我们使用 Open MPI，这是一个由学术、研究和行业合作伙伴联合开发和维护的开源实现（www.open-mpi.org）。对于 Windows 和 Linux，我们使用英特尔 MPI。

MPI 和 OpenMP 可以同时使用。例如，可以将 4 个 MPI 进程分配给 4 台不同的计算机，假设每台计算机有 8 个内核，则每个 MPI 进程可以得到 8 个 OpenMP 线程的支持。大部分的速度提升都是由 MPI 实现的。对于一个速度相当快的网络，4 个 MPI 进程可将计算时间加快约 0.9 倍。无论使用的内核数超过 4 个，OpenMP 都能提供最高约 2 倍的额外加速。

## Launching an FDS Job

要启动 FDS 仿真，您可以使用第三方图形用户界面 (GUI)，也可以调用计算机的命令提示符并键入单行命令，具体操作如下。

### Single Computer Running MS Windows

打开特殊的 FDS 命令提示符 CMDfds，安装 FDS 时，该命令提示符应出现在桌面上。打开该特殊命令提示符后，将自动运行一个脚本，确保 FDS 命令和库保持一致。更改目录（“cd”）到案例输入文件所在的位置。决定模拟需要多少逻辑进程。假设您有 8 个可用的逻辑处理器（内核），并且 FDS 作业使用 4 个网格，请在命令提示符下键入以下内容：

`fds_local -p 4 -o 2 job_name.fds`

该任务将利用所有 4×2 = 8 个逻辑处理器，您可以打开任务管理器确认这一点。参数 -p 表示 MPI 进程数，参数 -o 表示 OpenMP 线程数。

模拟进度通过写入屏幕的诊断输出来显示。详细的诊断信息会自动写入文件 job_name.out。屏幕输出可通过替代命令重定向到文件：

`fds_local ... job_name.fds > job_name.err`

建议在与计算机实际连接的驱动器相关联的文件夹中运行模拟。如果在自动备份过程中出现网络问题或文件锁定，导致 Windows 无法将数据写入文件，则将文件保存到网络共享或云服务（如 OneDrive）控制的文件夹中可能会导致模拟失败。

### Multiple Computers Running MS Windows

以下步骤适用于 Windows 域网络，即用户账户由中央管理的网络，任何用户都可以使用相同的凭据登录任何机器。

1. 首次运行作业时，必须通过发出此命令提供域名和密码：
   1. `mpiexec -register`
2. 创建一个文本文件，如 hosts.txt，并在其中逐行列出计算机名称：
   1. - fred:3
        wilma:2
        dino:3
      - 其中，名称后面的数字是要在该计算机上调用的 MPI 进程数。所有数字之和应为作业的 MPI 进程数，通常等于网格数。
3. 运行以下测试程序来测试网络：
   1. `mpiexec -machine hosts.txt test_mpi`
   2. 如果您在 hosts.txt 文件中列出的每台电脑都返回了 “HelloWorld ”信息，请继续下一步。如果该命令失败，请使用每台计算机 “ping ”其他计算机，检查计算机之间的网络连接。此外，确保所有计算机上安装了相同版本的 FDS。
4. 在机器上共享一个工作目录（具有读写权限）。请勿将该目录放在 “程序文件 ”文件夹中，因为它受写保护。与所有人共享工作目录，以便所有其他计算机都能看到它。注意该目录在其他电脑上是如何定义的。有时它是\\\\<my_computer>\<my_shared_directory>\，有时它是通过数字 IP 地址定义的，如\\\129.6.129.87\my_shared_directory>\。定义取决于域名服务器（DNS）的工作方式。应避免目录名或文件名中出现空格，因为空格会导致问题，除非你是 DOS/Windows 专家。
5. 在命令提示符下，cd 到工作目录。在命令提示符下键入： mpiexec -wdir <working directory> -machinefile hosts.txt fds job_name.fds，其中 <working directory> 是调用命令的目录全路径名。如果想在每个 MPI 进程中使用一个以上的 OpenMP 线程，请添加参数 mpiexec ... -env OMP_NUM_THREADS <threads> fds_openmp job_name.fds 如果不小心设置了太多的 OpenMP 线程，可能会导致逻辑处理器超载，降低作业效率。
6. 如果成功，您应该会看到通常的 FDS 打印输出，显示哪些 MPI 进程分配给了哪台计算机。如果不成功，请向网络管理员咨询，或访问 FDS 帮助论坛寻求建议。

### Linux and macOS

由专用计算节点组成的计算集群通常运行 Linux 操作系统的多个变体之一。在这种环境下，建议或要求您使用 PBS/Torque 或 Slurm 等作业调度程序，通过编写简短的脚本（包括启动作业的命令、所需资源量等）来提交作业。有关在 Linux 或 macOS 下运行 FDS 的提示，请点击[此处](https://github.com/firemodels/fds/wiki/Installing-and-Running-FDS-on-a-Linux-Cluster)。

如果选择不使用作业调度程序运行作业，可以直接在命令提示符下达命令：

`export OMP_NUM_THREADS=M
mpiexec -n N -hostfile hosts.txt /home/username/.../fds job_name.fds >& job_name.err &`

hosts.txt 文件看起来像这样：

`comp1 slots=2
comp2 slots=1
comp3 slots=2`

其中，compX 是可用节点的名称，slot 表示每个节点上可用内核的数量。参数 slots 是可选项。在他人共享的集群上，如果没有作业调度程序，不应运行长时间作业。作业调度程序可避免在同一节点/内核上运行多个作业。如果使用的是单个 Linux 或 macOS 工作站，则无需定义主机文件。您只需调用前面描述的 mpiexec 行，并根据您的情况和计算机选择合适的处理器数量即可。

### Using MPI and OpenMP Together

在使用多网格时，MPI 是更好的选择，因为它比 OpenMP 能更有效地分配计算工作。不过，在同一模拟中结合使用 MPI 和 OpenMP 也是可行的。如果您拥有多台计算机，且每台计算机都有多个内核，您可以为每台计算机分配一个 MPI 进程，并使用 OpenMP 加快每台计算机上多个内核对给定网格的处理速度。通常情况下，无论为每个 MPI 进程分配多少个 OpenMP 线程，使用 OpenMP 最多可将计算速度提高 2 倍。通常，将计算域划分为更多网格并将 OpenMP 线程数设置为 1 会更好。你应该选择一个好的测试案例，尝试不同的网格划分和并行处理策略，看看哪种最适合你。

### Running Very Large Jobs

文献中报道的大多数 FDS 仿真都使用一到几十个网格，MPI 是并行处理这些作业的首选方法。通常，网格是以一对一的方式映射到 MPI 进程的，而且网格包含的网格单元数量相当。不过，也有可能运行涉及数千个网格的 FDS 作业。2016 年，NIST 的 FDS 开发人员获准访问田纳西州橡树岭国家实验室的橡树岭领先计算设施。该设施为用户提供了通过高速网络连接大量处理器的计算集群。FDS 模拟最多使用了约 10,000 个 MPI 进程。如果您可以使用类似的设施，这里有一些提示：

1. 只使用 MPI。OpenMP 可能不会明显加快运行速度，而且会消耗一些内核，而运行更多的 MPI 进程可以更好地利用这些内核。
2. 对于使用数千个网格/进程的作业，可在 MISC 行添加 SHARED_FILE_SYSTEM=F 参数。这将指示 FDS 根据 MPI 进程分割 Smokeview (.smv) 文件。由于 Smokeview 文件是串行写入的，而不是并行写入的，因此这将大大加快仿真初步阶段的速度。对于数量不多的网格，串行写入不成问题，但对于成千上万的网格，初始化例程可能需要数小时。工作完成后，您可以将编号文件 CHID_n.smv 附加到主 Smokeview 文件 CHID.smv，从而重建 Smokeview 文件。
3. 在 DUMP 行将 DT_CPU 设置为某个方便的时间间隔。该参数指示 FDS 定期写出一个文件（CHID_cpu.csv），记录每个 MPI 进程在主要子程序中消耗的挂钟时间。这可以帮助您确定是否有任何 MPI 进程花费了过多的空闲时间。请注意，CPU 文件会在仿真结束时自动写出。
4. 在短时间内运行作业，以估算完整作业所需的时间。大多数大型计算集群都会限制您的挂钟时间，超过挂钟时间就会停止作业。如果您必须使用 FDS 中的重启功能，请先进行短时作业练习，以确保作业可以正常继续。
5. 针对具体情况进行强扩展研究。也就是说，以机器内存所能容纳的最少网格数运行固定时间步数的作业。然后将网格按 2、4 或 8 的系数进行划分，直到网格/进程数量的增加无法显著提高速度为止。

## Efficiency of Multi-Process Simulations

计算结束后，FDS 会打印出一个名为 CHID_cpu.csv 的文件，其中记录了每个 MPI 进程在主要例程中花费的 CPU 时间。例如，列头 VELO 代表所有与计算流速相关的子程序；MASS 代表所有与计算物种质量分数和密度相关的子程序。列头 MAIN 代表所有未明确计算的 CPU 时间，即在主控制循环中花费的时间。理想情况下，这部分时间应占整个 CPU 使用时间的百分之几。

### MPI Efficiency

评估 MPI 的效率或可扩展性有两种基本方法。第一种方法被称为 “弱扩展”，即每个 MPI 进程所做的工作量保持不变，并添加额外的进程来解决更大的问题。例如，如果您正在模拟一片地形上的风，并不断增加相同物理和数值维度的网格，将每个新网格分配给自己的 MPI 进程，以模拟一片越来越大的地形，那么您会发现模拟的总体时间不会随着网格的增加而显著增加。这种计算的效率由以下表达式给出：
$$
E_\mathrm{w}=\frac{t_1}{t_N}
$$
其中，t1 是 1 个网格（MPI 进程）情况下的 CPU 时间，tN 是 N 个网格（MPI 进程）情况下的 CPU 时间。图 3.1 的左侧图显示了 FDS 弱扩展研究的结果。尺寸为 50 x 50 x 50 的网格并排排列，网格数量从 1 个到 432 个不等。理想情况下，所有情况下的 CPU 时间都应该差不多，因为每个 MPI 进程的工作量都是一样的。只有网格与网格之间的通信才会导致效率低下。但请注意，图中 1、2、4 和 8 个网格的效率要高于那些有更多 MPI 进程的网格。其原因在于，在大多数计算集群中，每个节点都有多个内核，当节点未完全满载时，作业运行速度通常更快。这些测试用例是在 NIST 上运行的，那里有一个每个节点 8 个内核的计算集群和一个每个节点 12 个内核的计算集群。

评估 MPI 效率的第二种方法称为 “强扩展”。在这种情况下，先在单个网格上模拟给定场景，然后分割网格，这样单元格大小和单元格总数就不会发生变化。理想情况下，如果将给定网格一分为二，并使用两个而非一个 MPI 进程运行，计算时间有望减少两倍。然而，更多的 MPI 进程需要在进程间进行更多通信。此外，尽管气相单元的总数保持不变，但网格数越多，需要计算的网格边界单元就越多。这组计算的效率由以下公式给出：E_\mathrm{s}=\frac{t_1}{N t_N}
$$
E_\mathrm{s}=\frac{t_1}{N t_N}
$$
在这里演示的强力研究中，尺寸为 180 x 160 x 120 的单一网格被划分为一系列更小的网格，最小的划分为尺寸为 20 x 20 x 20 的 432 个网格。图 3.1 右图显示了整个计算和主要子程序 CPU 时间的减少情况。理想情况下，CPU 时间应与网格数（MPI 进程）成反比；也就是说，CPU 相对时间应遵循黑色虚线。这一规则的一个明显例外是 “COMM ”或 COMMunications。这条曲线代表的是在网络中传输信息所花费的时间。

![QQ_1725368742618](/../FUG6.9.1翻译.assets/QQ_1725368742618.png)

### OpenMP Efficiency

为了证实 OpenMP 带来的加速效果，我们在两种网格大小（643 和 1283）下运行了一系列测试案例[^3-4]，并改变了 OpenMP 线程的数量。测试设置是一个简单的通道流，携带两个额外的物种，以模拟典型火灾问题中的标量传输。结果如图 3.2 所示。一般来说，使用 4 个内核（默认设置），用户可以预期速度提高 2 倍。

![QQ_1725368788747](/../FUG6.9.1翻译.assets/QQ_1725368788747.png)

## Monitoring Progress

特定计算的诊断结果会写入一个名为 CHID.out 的文件。当前的模拟时间和时间步长会被写入该文件，以便查看程序的进展情况。默认情况下，在前 100 个时间步之后，每 100 个时间步写出一次诊断结果。用户可以指定不同的时间间隔：

```fortran
&DUMP DIAGNOSTICS_INTERVAL=100 /
```

在计算过程中的任何时候，都可以运行 Smokeview 并直观地检查计算进度。

默认情况下，CHID.out 文件中的诊断信息是详细的。默认情况下，对于涉及 32 个网格或更少的作业，其值为 F；对于更大的网格，其值为 T。在运行大型 MPI 作业时，将仅由 MPI 进程 0 写入的输出静音可能会有好处。为此，添加

```fortran
&DUMP SUPPRESS_DIAGNOSTICS=T /
```

请注意，在这种情况下，输出文件不会监测网格边界速度错误；它将只显示模拟时间和时间步长。如有必要，仍可输出 QUANTITY='VELOCITY ERROR' 的 BNDF。

要在预定时间之前停止计算，请在输出文件的同一目录下创建一个名为 CHID.stop 的文件。该文件的存在将优雅地停止程序，使其转储出最新的流量变量，以便在 Smokeview 中查看。

由于计算时间可长达数小时或数天，因此 FDS 具有重新启动功能。关于如何使用该功能的详细信息，请参阅第 5.6 节。简而言之，在计算开始时指定保存 “重启 ”文件的频率。如果发生停电等中断计算的情况，可以从上次保存重启文件的时间重新开始计算。

还可以使用第 18.5 节所述的控制功能来控制停止时间和重新启动文件的转储时间。

****

[^3-1]:在使用英特尔处理器的计算机上，Windows 10 任务管理器会使用插槽、内核和逻辑处理器等术语。不同版本的 Windows 和不同处理器使用的这些术语可能有所不同。
[^3-2]:以前的 FDS 版本包含两个可执行文件，一个在单处理器上运行，另一个在多处理器上运行。从 FDS 6.2.0 开始，这两个可执行文件合并为一个，可以串行或并行模式运行。
[^3-3]:要确定 OpenMP 使用的内核数量，只需在命令提示符下键入 fds 即可。
[^3-4]:输入文件可从 [FDS GitHub repository](https://github.com/firemodels/fds/tree/master/Verification/Timing_Benchmarks)中获取。

# User Support

在项目过程中可能会出现各种问题，有些与 FDS 有关，有些与计算机有关。FDS 是一种 CPU 和内存密集型仿真软件，可以将计算机的处理器和内存推向极限。事实上，在 FDS 中没有任何硬连接的限制，可以防止您启动对硬件来说过大的计算。即使您的计算机有足够的内存（RAM），您仍然可以轻松设置需要数周或数月才能完成的计算。在模拟开始时预测需要多长时间和多少内存是很困难的。了解如何监控计算机的资源使用情况。从小规模计算开始，循序渐进。

尽管 FDS 的许多功能已经相当成熟，但还有许多功能尚未成熟。FDS 不仅用于实际工程应用，还用于火灾和燃烧方面的研究。随着您对该软件越来越熟悉，您将不可避免地遇到当前研究感兴趣的领域。事实上，燃烧一屋子的普通家具是该模型最具挑战性的应用之一。因此，请耐心等待，并学会将给定场景分解为各个构成部分。例如，除非您已经用相对较少的计算模拟了各种可燃物的燃烧，否则不要尝试模拟火灾在建筑物整层蔓延的情况。

除了《FDS 用户指南》，互联网上还有一些资源。这些资源包括用于报告错误和申请新功能的 “问题跟踪器”、用于澄清问题和讨论更广泛主题（而不仅仅是具体问题）的 “讨论组”，以及提供有关 FDS-SMV 开发、第三方工具和其他资源补充信息的 “维基页面”。在使用这些在线资源之前，重要的是首先尝试通过执行简单的测试计算或调试输入文件来解决自己的问题。接下来的几节将提供错误语句列表和解决问题的建议。

## The Version Number

在请求帮助解决 FDS 问题时，在提交问题描述的同时，必须提交 FDS 版本号。FDS 的每个版本都有一个版本号，例如 6.7.2，第一个版本号是主要版本号，第二个版本号是次要版本号，第三个版本号是维护版本号。主要版本每隔几年发布一次，顾名思义就是对模型的功能进行重大修改。次要版本每隔几个月发布一次，可能会导致功能上的细微变化。发布说明可以帮助您决定这些更改是否会影响您通常使用的应用程序类型。维护版本只是错误修复，不应影响代码功能。要获取版本号，只需在不带输入文件的命令提示符下输入可执行文件，就会出现相关信息，以及编译日期（对你有用）和所谓的 Git 散列标记（对我们有用）。Git 哈希标签指的是源代码的 GitHub 仓库编号。任何人都可以通过它获取用于构建该版本可执行文件的确切源代码文件。

养成检查可执行文件版本号的习惯，定期检查可能已经解决了你的问题的新版本，并在报告问题时告诉我们你正在使用的版本。

## Common Error Statements

FDS 计算可能在指定时限前结束。下面列出了常见错误语句及诊断方法：

**Input File Errors:** FDS 中最常见的错误是输入语句输入错误。这些错误会导致程序立即停止，并出现类似 "ERROR： HEAD 行有问题。对于这些错误，请检查错误语句中命名的输入文件行。确保参数名拼写正确。确保在每个命名列表条目的末尾都加上 /（正斜杠）。确保为每个输入参数提供了正确的输入数据类型，如一个实数、多个整数或其他类型。确保没有使用非 ASCII 字符，从其他应用程序或文字处理软件剪切和粘贴文本时有时会出现这种情况。确保数字 0 (0) 不打成大写字母 O，反之亦然。确保数字 1 (1) 不是感叹号 (!) 或小写字母 l。确保 Unix/Linux 机器上的文本文件不是在 Windows 机器上创建的，反之亦然。确保列出的所有参数仍在使用--新版本的 FDS 经常会删除或更改参数，迫使您重新检查旧的输入文件。

**Numerical Instability Errors:** 输入错误是仿真过程中出现的数值错误，可能会导致计算域中的速度过高，使时间步长减小到某个点[^4-1]，此时代码中的逻辑会认为结果不符合实际情况，并停止计算，同时在文件 CHID.out 中显示错误信息。在这种情况下，FDS 最后会输出一个 Plot3D 文件，提示计算域中的错误发生位置。通常情况下，数值不稳定性可以通过从计算域内的一个小区域虚构出大的速度矢量来识别。造成这种不稳定性的常见原因有：

- 纵横比大于 2 比 1 的网格单元格
- 网格界面上的网格分辨率变化超过 2 倍
- 网格界面上不匹配的障碍物或空心管道，网格分辨率发生变化
- 高速流经一个小开口，特别是用于模拟泄漏的开口。如第 10.3.2 节所述，有更好的方法来模拟泄漏。
- 热释放率的突然变化
- 使用 ADIABATIC 作为固相边界条件。该参数只能用于测试，因为没有一种固体材料的导热系数为零。使用该参数会导致固气界面出现非物理波动。
- 消除或制造障碍，如开门或关门
- 高（>100 $g/mol$）分子量的燃料分子，该分子不在 FDS 数据库（附录 A）中。在这种情况下，可降低分子量但保持原子比，或根据 SPEC 确定燃料比热。详见第 12.1.3 节。
- 密封的长隧道，其中的压力波动可能会导致虚假的数值伪影。详见第 21 节。
- 大量自动生成的压力区。当预处理程序将以面形式存储的 CAD 几何图形简单转换为薄障碍物时，就会出现这种情况。例如，在 10 厘米网格上，典型的室内石膏板墙在 FDS 输入文件中将显示为两个薄障碍物，代表石膏板包围一个网格单元宽的空气体积。FDS 会自动将这些区域识别为压力区，但有时会导致不稳定性的产生。可以通过查看 casename.out 文件来确定 FDS 识别的压力区。告诉 FDS 自动填充这些区域（见第 10.3.4 节）或手动修正几何形状以填充这些区域可以减少这些问题。

解决问题的方法有很多种，视情况而定。在报告问题之前，请尝试诊断并解决问题。迄今为止，输入文件的创建者是诊断问题的最佳人选。

**Inadequate Computer Resources:** 计算使用的内存可能超过了机器的容量（您会看到类似 "ERROR： 例程 INIT 中 ZZ 的内存分配失败"），或者输出文件用完了所有可用磁盘空间。在这些情况下，计算机可能会也可能不会产生可理解的错误信息。有时计算机只是没有反应。您有责任确保计算机有足够的资源进行计算。请记住，FDS 计算的大小和时间没有限制，这取决于计算机的资源。对于任何新的模拟，请尝试使用适中大小的网格运行案例，并逐渐进行细化，直到计算机无法处理为止。然后适当减小计算规模，使计算机可以舒适地运行该案例。尝试使用 90% 到 100% 的计算机资源运行是有风险的；最好使用 MPI 和多台计算机。如果您使用的是 Linux/Unix 机器，请确保堆栈大小不受限制，这将允许 FDS 访问尽可能多的 RAM。更改堆栈大小限制因 shell 类型而异，因此最好上网搜索如何确保堆栈大小不受限制。

**Run-Time Errors:** 计算机操作系统或 FDS 程序出现错误。计算机操作系统会将错误信息打印到屏幕上或诊断输出文件中。包括程序员在内的大多数人通常都无法理解这条信息，不过如果其中提到某个具体问题，如 “堆栈溢出”、“除以零 ”或 “文件写入错误，单位=...”，人们偶尔也会得到一点提示。有时，错误信息只是提到 “分割故障”。这些错误可能是由 FDS 中的错误引起的，例如，一个数字被除以零，或者一个数组在分配之前就被使用，或者其他一些问题。在向问题跟踪器报告错误之前，请尝试系统地简化输入文件，直到错误消失。这一过程通常会暴露出造成问题的计算的某些特征，有助于调试。

**MPI Timeout Errors:** 如果一个 MPI（消息传递接口）进程与另一个进程之间的通信出现错误或延迟，您可能会看到类似 "ERROR： MPI交换......MPI进程超时......” 这表明，无论出于何种原因，MPI 消息从未到达目的地，程序因此关闭。输入参数 MPI_TIMEOUT 在 MISC 行中指定，用于设置 FDS 等待通信完成的时间。默认情况下，等待 MPI 通信完成的时间为 600 秒，这是一个非常长的等待时间，通常意味着出了很大的问题。如果您认为出现延迟是有原因的，例如某个网格的尺寸比其他网格大得多，或者要做的工作比其他网格多得多，那么请将 MPI_TIMEOUT 设置为更大的值，并期待最好的结果。不过，超时可能表明计算设置方式出了问题，或者您的网络及其使用的特定通信结构出了问题。如果无法确定问题所在，请向[Issue Tracker](https://github.com/firemodels/fds/issues)提交失败案例的简单版本。

**Mesh Connection Error:** 如果网格排列复杂，FDS 可能无法分清哪个网格连接到哪个网格，通常会在仿真早期，即时间步进发生之前出现错误信息 “Mesh connection tested timed out for MPI process ...”。除了简化网格布置外，解决这一问题的一个可行方法是确保在输入文件中首先列出细网格或任何嵌入网格。这样，FDS 就能更好地记录网格之间的正确连接。

**File Writing Errors:** 有时，特别是在 Windows 机器上，FDS 会因为不允许写入文件而失败。典型的错误语句如下：

​	`forrtl: severe (47): write to READONLY file, unit 8598, file C:\Users\...\`

​	在本例中，单位 8598 只是 FDS 与其中一个输出文件相关联的一个数字。如果错误发生在计算开始之后，可以尝试在输入文件的 DUMP 行添加 FLUSH_FILE_BUFFERS=F （见第 22.1 节）。这将阻止 FDS 试图刷新内部缓冲区的内容，这样做是为了在 FDS 模拟期间能够在 Smokeview 中查看 FDS 输出。在某些 Windows 机器上，您可能会遇到阻止 FDS 等命令行程序写入包含程序文件的系统文件夹的安全设置。在这种情况下，请尝试在非系统文件夹（即您的主目录中的某个位置）中重新运行案例。

**Poisson Initialization:** 有时在计算开始时会出现错误，提示 “泊松初始化 ”出现问题。FDS 中的压力方程称为泊松方程。泊松求解器由大型线性方程组组成，必须在计算开始时进行初始化。大多数情况下，初始化步骤中的错误是由于网格 IJK 维度小于 4（二维计算除外）。也有可能是计算域的坐标出现了根本性错误。通过检查输入文件中的 MESH 行来诊断问题。

## Support Requests and Bug Tracking

由于 FDS 的开发是持续性的，各种例程和功能难免会出现问题。开发人员需要知道某项功能是否失效，因此我们鼓励报告问题。但是，必须明确指出问题所在。最好的办法是尽可能简化输入文件，以便诊断错误（即创建并提交一个最基本的工作示例）。此外，错误报告应仅限于那些明显不起作用的功能。火灾无法点燃、火焰无法蔓延等物理问题可能与网格分辨率或场景设置有关，您需要在报告之前先调查问题。如果错误信息来自操作系统而非 FDS，请首先调查一些更明显的可能性，如内存大小、磁盘空间等。

如果还不能解决问题，请报告问题，并提供尽可能多的错误信息和与问题相关的情况。输入文件应尽可能简化，以便在计算早期出现错误。如有必要，请按照网站提供的说明附上简化后的输入文件。这样，开发人员就可以快速运行有问题的输入文件，并有望诊断出问题所在。

注意：有关具体错误、问题、功能请求和增强功能的报告应发布到Issue Tracker，而不是Discussion Group。

****

[^4-1]:默认情况下，当时间步长低于初始时间步长的 0.0001 时，计算将停止。可以通过 TIME 行指定 LIMITING_DT_RATIO 来更改该系数。

# The Basic Structure of an Input File

## Naming the Input File

FDS 的运行基于单个 ASCII[^5-1] 文本文件，该文件包含按 namelist[^5-2] 分组的参数。输入文件为 FDS 提供了描述情景的所有必要信息。输入文件的保存名称为 job_name.fds，其中 job_name 是任何有助于识别模拟的字符串。如果在输入文件的 HEAD namelist 组中重复出现相同的字符串，那么与计算相关的所有输出文件都将使用这个共同的前缀名。

工作名称中不能有空格。请使用下划线字符代表空格。使用下划线字符代替空格也适用于系统命名目录的一般做法。

请注意，如果给定案例的指定名称相同，FDS 将直接重写该案例的输出文件。这在开发输入文件时很方便，因为可以节省磁盘空间。但要注意不要覆盖想要保留的计算。

## Namelist Formatting

在输入文件中使用 namelist 格式的记录指定参数。每条 namelist 记录都以“&”开头，紧接着是 namelist 组名，然后是以逗号分隔的输入参数列表，最后是斜线“/”。例如

````fortran
&DUMP NFRAMES=1800, DT_HRR=10., DT_DEVC=10., DT_PROF=30. /
````

设置 DUMP 命名列表组中包含的各种参数值。这些参数的含义将在后续章节中解释。namelist 记录可以在输入文件中跨越多行，但要确保以斜线结束记录，否则数据将无法理解。除了适合该组的参数和值外，不要在 namelist 行中添加任何其他内容。否则，FDS 将在执行时立即停止。

namelist 记录中的参数可以用逗号、空格或换行符分隔。建议使用逗号或换行符，切勿使用制表符，因为 namelist 数据结构中没有明确定义制表符。可以在文件中写入注释和备注，只要逗号之前除了空格外没有其他内容，逗号和斜线之间除了与特定 namelist 组对应的适当参数外没有其他内容。

输入文件中的参数可以是整数、实数、字符串或逻辑参数。逻辑参数（在 Fortran 之外称为布尔参数）可以是 T（表示 “真”）或 F（表示 “假”）。数字后面的句号（如 10.）是一种约定俗成的用法，表示实数而不是整数（10.相当于 10.0）。本《用户指南》中列出的字符串必须按原样复制，**代码区分大小写**，下划线也很重要。大多数字符输入参数的最大长度为 60。

大多数输入参数都是简单的实数或整数标量，如 DT=0.02，但有时输入参数是多维数组。例如，在描述一个特定的固体表面时，需要表达多层中多种材料的质量分数。输入数组 MATL_MASS_FRACTION(IL,IC)的目的是向 FDS 传递 IL 层中 IC 组份的质量分数。例如，如果第三层第二种材料的质量分数为 0.5，则写入

```fortran
MATL_MASS_FRACTION(3,2)=0.5
```

要输入多个质量分数，请使用此符号：

```fortran
MATL_MASS_FRACTION(1,1:3)=0.5,0.4,0.1
```

这意味着第 1 层的前三种材料的质量分数分别为 0.5、0.4 和 0.1。1:3 表示阵列元素 1 至 3（包括 3）。

请注意，字符串可以用单引号或双引号括起来。注意不要从简单的文本编辑器以外的地方粘贴文本来创建输入文件，否则标点符号可能无法正确转入文本文件。

某些文本文件编码可能无法在所有系统上运行。如果出现文件读取错误，但在输入文件中找不到排版错误，请尝试使用不同的编码保存输入文件。例如，文本文件编辑器记事本在 Windows PC 上运行正常，但用记事本编辑的文件在 Linux 或 macOS 上可能无法运行，因为 Windows 和 Unix/Linux 操作系统的行结束符不同。其他文本编辑器（如 Notepad++）通常效果更好，但请先尝试一个简单的案例。

## Input File Structure

一般来说，命名表记录可以按照任何顺序输入输入文件，但最好以某种系统的方式组织这些记录。通常情况下，一般信息列在输入文件顶部附近，而障碍物、设备等详细信息则列在下面。FDS 每次处理特定命名列表组时都会扫描整个输入文件。在使用某些文本编辑器时，FDS 经常无法读取文件的最后一行，原因是存在 “文件结束 ”字符。为确保 FDS 读取整个输入文件，可添加

```fortran
&TAIL /
```

作为输入文件末尾的最后一行。这样就完成了从 &HEAD 到 &TAIL 的文件。FDS 甚至不会查找最后一行。它只是强制将 “文件结束 ”字符从相关输入中删除。

编写输入文件时的另一个一般经验法则是，只添加与默认值不同的参数。这样，您就可以更容易地区分您想要的参数和 FDS 想要的参数。在文件中随意添加注释，只要这些注释不属于命名列表记录。

输入文件的一般结构如下所示，为清晰起见，删除了原始验证输入文件[^5-3]中的许多行。

```fortran
&HEAD CHID='WTC_05', TITLE='WTC Phase 1, Test 5' /
&MESH IJK=90,36,38, XB=-1.0,8.0,-1.8,1.8,0.0,3.82 /
&TIME T_END=5400. /
&MISC TMPA=20. /
&DUMP NFRAMES=1800, DT_HRR=10., DT_DEVC=10., DT_PROF=30. /
&REAC FUEL = 'N-HEPTANE'
FYI = 'Heptane, C_7 H_16'
C = 7.
H = 16.
CO_YIELD = 0.008
SOOT_YIELD = 0.015 /
&OBST XB= 3.5, 4.5,-1.0, 1.0, 0.0, 0.0, SURF_ID='STEEL FLANGE' / Fire Pan
...
&SURF ID = 'STEEL FLANGE'
COLOR = 'BLACK'
MATL_ID = 'STEEL'
BACKING = 'EXPOSED'
THICKNESS = 0.0063 /
...
&VENT MB='XMIN', SURF_ID='OPEN' /
...
&SLCF PBY=0.0, QUANTITY='TEMPERATURE', VECTOR=T /
...
&BNDF QUANTITY='GAUGE HEAT FLUX' /
...
&DEVC XYZ=6.04,0.28,3.65, QUANTITY='VOLUME FRACTION', SPEC_ID='OXYGEN', ID='EO2_FDS' /
...
&TAIL / End of file.
```

建议在研究新方案时，首先选择一个与案例相似的预写输入文件，进行必要的修改，然后以相当低的网格分辨率运行案例，以确定文件设置是否正确。最好从一个相对简单的文件开始，这样可以捕捉到问题的主要特征，而不会因为过多的细节而掩盖计算中的基本缺陷。最初的计算应该是粗网格计算，这样运行时间就不会超过一小时，而且可以很容易地进行修正，不会浪费太多时间。在学习如何编写输入文件的过程中，随着复杂程度的增加，您将不断运行和重新运行您的案例。

表 5.1 提供了所有 namelist 参数的快速参考，您可以在其中找到该参数在文档中的介绍，以及包含每组所有关键字的表格。

<center>Table 5.1: Namelist Group Reference Table</center>

![QQ_1725364980152](/../FUG6.9.1翻译.assets/QQ_1725364980152.png)

## Concatenating Input Files

**CATF 命名列表组允许将不同文件中的输入信息纳入模拟**。输入行

```fortran
&CATF OTHER_FILES='file_1.txt','file_2.txt' /
```

:question:（什么作用）将列出的两个文件的内容添加到当前输入文件中。一个 CATF 行最多可列出 20 个文件，输入文件中可包含多个 CATF 行。读取输入文件后，FDS 会创建一个新的输入文件 CHID_cat.fds，然后运行算例。

使用此功能时，请将原始输入文件和添加的输入文件中每行的字符数限制为 400。

## Protecting Old Cases

运行以前运行过的作业时，FDS 将自动用新输出覆盖旧输出。如果不希望发生这种情况，可在 MISC 行设置 OVERWRITE=F，在这种情况下，FDS 将检查是否存在以前创建的输出文件，如果存在，则停止执行。

## Stopping and Restarting Calculations (.restart)

**一个重要的 MISC 参数叫做 "重启"（RESTART）**。通常情况下，模拟由一系列从环境条件开始的事件组成。不过，**有时您可能需要停止计算，进行一些有限的调整，然后从该时间点重新开始计算**。为此，首先要在输出文件所在目录下创建一个名为 CHID.stop 的文件，使计算平稳停止。请记住，FDS 是区分大小写的。文件名必须与 CHID 完全相同，"stop "应为小写。FDS 会在每个时间步检查该文件是否存在，如果发现该文件，则会先创建一个名为 CHID.restart （或 CHID_nn.restart）的文件（如果是多网格作业，则创建多个文件），然后优雅地关闭计算。**要重新启动作业，工作目录中应存在 CHID.restart 文件，输入数据文件的 MISC 行需要添加 RESTART=T 短语**。例如，假设 CHID 为 "plume "的任务停止，方法是在创建所有输出文件的目录下创建一个名为 plume.stop 的虚拟文件。**要从中断处重新启动该作业，您需要删除 CHID.stop 文件，以便 FDS 不会立即停止计算**，并在输入文件 plume.fds 的 **MISC 行添加 RESTART=T**，或者您选择的输入文件名。如果存在与原始作业 CHID 相同的重启文件，FDS 就会继续将新数据保存在与旧数据相同的文件中[^5-4]。如果在 MISC 行也指定了 RESTART_CHID，则 FDS 将查找使用此字符串标记的旧输出文件，而不是使用 HEAD 行上指定的 CHID。在这种情况下，新的输出文件将使用 CHID 标记，而旧的输出文件不会被更改。运行重启的任务时，重启任务的诊断输出将附加到原始任务的输出文件中。

**有时您可能希望在运行过程中定期保存重启文件，以防断电或系统崩溃**。如果是这种情况，可在原始运行开始时在 **DUMP 行设置 DT_RESTART=50.**，例如每 50 秒保存一次重启文件。DT_RESTART 的默认值是 1000000，这意味着不会创建重启文件，除非通过创建名为 CHID.stop 的虚拟文件来优雅地停止作业。控制功能（见第 18.5 节）可用于在计算达到某些可测量条件（如首次启动喷洒器）时停止计算或转储重启文件。

:exclamation:在工作停止和重新启动之间，不能对计算进行重大更改，如添加或删除通风口和障碍物。更改仅限于那些不会立即改变现有流场的参数。例如，**更改发送到热释放率（*_hrr.csv）或设备（*_devc.csv）文件的数据输出频率，甚至切片文件输出。**新频率在 DUMP 行中设置（输出频率完整列表见表 23.8）。如果没有在新运行中设置频率，则会保留上一次运行的频率。但 DT_RESTART 并非如此；如果新运行中没有 DT_RESTART，则不会写入重启文件（这可防止覆盖旧的重启文件）。

由于开发人员很少使用重启功能，因此应将其视为一种脆弱的结构。检查输出结果，确保在停止和重启过程中不会发生突然或意外事件。

:exclamation:【繁琐】基本流程：运行->在某一时刻结束运行->工作目录下创建CHID.stop文件->输入卡中输入`&MISC RESTART=T`，并删除工作目录下的CHID.stop文件->重启计算。（一般的操作是，创建两个输入文件，其中一个规定DT_RESTART，另一个用来重启。）<font color=red>**pyrosim可以实现，在设计前后处理器时可以参考。**</font>

****

[^5-1]:ASCII - 美国信息交换标准码。标准 ASCII 文本由 128 个字符组成。
[^5-2]:一个namelist 是一个 Fortran 输入记录。
[^5-3]:实际输入文件 WTC_05.fds 是 FDS 验证套件的一部分
[^5-4]:默认情况下，重新启动作业时，电子表格输出文件将在作业重新启动时而不是作业停止时添加。:exclamation:如果希望在不剪切任何现有数据的情况下附加输出文件，即使会留下一些重复输出，那么请在 DUMP 行中将 CLIP_RESTART_FILES 设置为 F。

# Setting the Bounds of Time and Space

**本章介绍影响仿真总体范围的全局输入参数，如仿真时间、计算域的大小和范围等。**从根本上说，这些参数建立了模拟所有其他组件所使用的空间和时间坐标系，这就是为什么这些参数通常列在输入文件的最前面，也是为什么在这里首先介绍这些参数的原因。

## Naming the Job

设置输入文件的第一件事就是给作业命名。作业的名称非常重要，因为一个项目通常会涉及许多模拟，在这种情况下，各个模拟的名称应该是有意义的，有助于组织项目。在本例中，namelist 组 HEAD 包含两个参数：

```fortran
&HEAD CHID='WTC_05', TITLE='WTC Phase 1, Test 5' /
```

CHID 代表字符 ID，是一个 50 个字符或更少的字符串，用于标记输出文件。例如，如果 CHID='WTC_05'，则可方便地将输入数据文件命名为 WTC_05.fds，以便将输入文件与输出文件关联起来。CHID 中不允许使用句点或空格，因为输出文件会标记对某些计算机操作系统有意义的后缀。如果未指定 CHID，则会将其设置为输入文件名减去第一个句号之后的所有内容。

标题（TITLE）是描述模拟的字符串，长度不超过 256 个字符。它只是一个描述性文本，将传递给各种输出文件。

## Simulation Time

TIME 是一组参数的名称，用于定义模拟的持续时间和用于推进离散方程求解的初始时间步长。

### Basics

通常情况下，通过参数 T_END，这一行只需要模拟的持续时间。例如，下一行将指示 FDS 运行模拟 5400 秒。

```fortran
&TIME T_END=5400. /
```

如果将 T_END 设为零，则只执行设置工作，以便在 Smokeview 中快速检查几何体。

要以零以外的数字开始时间线，**可使用参数 T_BEGIN 指定写入文件的第一个时间步的时间**。这对于匹配实验数据或视频记录的时间线非常有用。

### Controlling the Time Step

**可以用 DT 指定初始时间步长**。该参数通常是通过网格单元的大小除以流动的特征速度自动设置的。在计算过程中，会对时间步长进行调整，以满足 CFL（Courant、Friedrichs、Lewy）条件。DT的默认值为$(\delta x\delta y\delta z)^{\frac13}/V_{\mathrm{char}}$ s。特征速度尺度估计为$V_{char}=0.2\sqrt{gH}\mathrm{~ m/s}$，$\delta x$、$\delta y$、$\delta z$是最小网格单元的尺寸，$H$是计算域的高度，$g$是重力加速度。从物理上讲，特征速度是浮力烟羽在计算域高度上的平均速度估计值，它为典型火灾模拟中的时间步长提供了合理的初始值。默认情况下，时间步长不允许超过其初始值。要允许这种情况发生，请设置 RESTRICT_TIME_STEP=F。

如果在模拟开始时会有突发事件发生，如喷水灭火器启动，那么设置初始时间步长以避免因时间步长过大而导致数值不稳定是有好处的。通过监控输出文件 job_name.out 中记录的初始时间步长，尝试使用不同的 DT 值。

**在显式预测-校正时间更新的第一部分结束时，将对时间步长进行检查，以确保其在适当的稳定范围内**。如果不在范围内，则将时间步长向上或向下调整 10%（或直到在范围内），并重新运行时间步长的预测部分。如果要防止 FDS 自动改变时间步长，**可在 TIME 行设置 LOCK_TIME_STEP 等于 T**，这样就不会调整指定的时间步长 DT。该参数仅用于诊断目的，例如为程序执行计时。如果初始时间步长设置过高，可能会导致数值不稳定。

名为 CHID.out 的诊断输出文件包含每个网格的时间步长和 CFL 编号信息。但是，对于涉及数十或数百个网格的仿真，评估全局时间步长信息可能比较困难。**对于时间步长的详细信息，有一个名为 CHID_cfl.csv 的可选输出文件**，其中包含每个时间步长的时间（秒）、时间步长大小（秒）、最大 CFL 数、出现最大 CFL 值的网格和网格索引、出现最大 CFL 数的网格单元六个面上的六个速度分量，以及出现最大 CFL 的发散（1/s）、粘度（kg/m/s）、HRRPUV（kW/m3）和燃烧混合时间（秒）。此外，还列出了最大 VN（冯-诺依曼）数以及出现该值的网格和单元指数。<font color=red>**要输出此文件，请在 DUMP 行将 CFL_FILE 设置为 T。通常设置为 F**</font>。

**The Final Time Step**

**在某些特殊情况下，可能需要控制计算的最后时间步长**。默认情况下，**FDS 将最后一个时间步长设置为 T_END - T**，其中 T 为当前时间。由于采用浮点运算，最后时间步长可能会非常小，从而导致意想不到的后果。您可以使用参数 DT_END_MINIMUM 或 DT_END_FILL（不必同时使用这两个参数）来控制最后的时间步长。使用 DT_END_MINIMUM 的效果是为最终时间步长设置一个最小值，因此 T_END 不会被严格遵守（因此我们默认的 DT_END_MINIMUM 值大致为机器ε）。最终的模拟时间将是 T + DT_END_MINIMUM。或者，也可以将 DT_END_FILL 设置为某个值（应小于最后一个时间步长）。如果 T+DT+DT_END_FILL > T_END，其中 DT 是计算出的稳定时间步长（或指定的时间步长），FDS 将重新计算时间步长为 DT = T_END - T。

### Steady-State Applications

在某些应用中，有时只需要稳态解（时间平均意义上的）。在 FDS 等随时间变化的代码中，达到稳态要求模拟运行足够长的时间，以形成稳态流场和气体温度场，并在固体表面形成稳态温度曲线。**由于必须对表面进行深度加热，因此形成稳态温度曲线可能需要很长时间**。这可能导致计算成本过高。**在稳态边界条件下，表面升温所需的时间与其比热成正比**。因此，在稳定条件下，可以通过降低比热来加快加热时间。因此保持架 MATL 中的 SPECIFIC_HEAT 不变，但仍能提供缩短表面加热时间的方法，**可以使用 TIME_SHRINK_FACTOR 的 MISC 输入**。<font color=red>MATL 上的 SPECIFIC_HEAT 输入值将根据该系数进行缩减</font>。当 TIME_SHRINK_FACTOR 为 10 时，各种材料的比热会降低 10 倍。这可将固体材料的加热速度大致提高 10 倍。在验证实验中，一个稳定的热源会将一个隔间加热到接近平衡状态，此时测量的是时间平均流量。

TIME_SHRINK_FACTOR 不会缩短流量和气体温度场的形成时间，但其形成速度往往比壁温曲线快得多。

请注意，当使用 TIME_SHRINK_FACTOR 时，QUANTITY='TIME'的设备或带有 DELAY 的设备或控制功能的值将根据 TIME_SHRINK_FACTOR 的值进行调整。例如，如果为 TIME_SHRINK_FACTOR 为 10 的 CTRL 输入指定了 10 秒的 DELAY，那么 FDS 将把 DELAY 调整为 1 秒。然而，使用基于时间的设备或控制功能会改变模拟结果，这意味着**非稳定的情况下可能不再适合使用 TIME_SHRINK_FACTOR**。

`WALL_INCREMENT`：改进时间解析度。将其设置为1，会迫使固相求解在每个时间步更新而不是每两个时间步。

## Computational Meshes

所有 FDS 计算都必须在一个由称为网格的直线体积组成的域内进行。每个网格都划分为矩形单元，单元数量取决于所需的流动动力学分辨率。MESH 是定义计算域的命名列表组。

### Basics

网格是一个单一的右平行四边形，即一个方框。网格内的坐标系符合右手定则。网格的原点由实数六元组 XB 的第一、第三和第五个值定义，对角由第二、第四和第六个值定义。例如

```fortran
&MESH IJK=10,20,30, XB=0.0,1.0,0.0,2.0,0.0,3.0 /
```

定义了一个网格，从原点开始横跨整个体积，在正 x 方向延伸 1 米，在正 y 方向延伸 2 米，在正 z 方向延伸 3 米。通过参数 IJK 将网格细分为均匀单元。在本例中，网格被划分为 10 厘米的立方体。网格单元最好与立方体相似，即单元的长、宽、高应大致相同。可以使用命名列表组 TRNX、TRNY 和/或 TRNZ（见第 6.3.5 节）指定特定方向上的非均匀网格单元。

任何超出网格边界的障碍物或通风口都会在边界处被切断。在网格外定义对象不会受到任何惩罚，这些对象也不会显示在 Smokeview 中。

FDS 中的压力求解器在 y 和 z 方向上采用快速傅立叶变换 (FFT)，如果这些方向上的单元数（IJK 中的 J 和 K）可以分解成低质数，如 2、3 和 5，则该算法的工作效率最高。**x 方向上的单元格数（IJK 中的 I）不受此限制的影响，因为压力求解器在 x 方向上不使用 FFT**。不过，由于压力求解器使用的时间不到 CPU 总时间的 10%，因此使用较小的素数所带来的收益通常可以忽略不计。请尝试使用不同的网格尺寸，以确保最终使用的网格尺寸不会过度降低计算速度。

### Two-Dimensional and Axially-Symmetric Calculations

在 FDS 中求解的控制方程是以三维笛卡尔坐标系为基础编写的。然而，通过将 IJK 三元组中的 J 设置为 MESH 线上的 1，可以进行二维笛卡尔或二维圆柱（轴对称）计算。对于轴对称，在 MESH 行添加 CYLINDRICAL=T，坐标 x 将被解释为径向坐标 r。如果使用多个网格，所有网格必须指定为二维或 CYLINDRICAL，不能混合使用二维、三维和圆柱几何图形。y = YMIN=XB(3) 或 y = YMAX=XB(4) 平面不应设置边界条件，轴对称计算中的 r = XMIN=XB(1) 平面也不应设置边界条件，如果 r = XB(1)=0 （注意 XB(1) 不一定为 0）。为了获得更好的可视化效果，XB(4) 和 XB(3) 之间的差值应该很小，这样 Smokeview 的渲染效果才会看起来像是二维的。**轴对称氦烟羽的示例见第 21.2 节**。

在处理 CYLINDRICAL 仿真结果时，请注意带有 SPATIAL_STATISTIC 属性的综合输出量仅适用于指定的 2-D 或圆柱坐标。因此，圆柱坐标定义了一个圆柱扇形，就像一块蛋糕，尽管 Smokeview 不会以这种方式渲染。将报告值乘以 $2\pi\delta\theta $，即可计算出完全积分量，其中 $\delta\theta $ 是 YMAX 和 YMIN 之间的差值，单位为弧度。只要 Smokeview 中的渲染效果符合您的要求，YMAX 和 YMIN 的取值并不重要。

### Multiple Meshes

术语 “多网格 ”是指计算域由多个计算网格组成，通常是连接在一起的，但并不是必须的。如果使用一个以上的网格，则每个网格都应有一个 MESH 行。这些行在输入文件中的输入顺序很重要。一般来说，网格应从最细到最粗依次输入。**如果两个网格重叠，FDS 假定在输入文件中列在第一位的网格优先于列在第二位的网格**。网格可以重叠、相邻或完全不接触。在最后一种情况下，基本上是执行两个独立的计算，它们之间没有任何联系。障碍物和通风口是根据整个坐标系输入的，不一定适用于任何一个特定的网格。每个网格都会检查所有几何实体的坐标，并决定是否将其包含在内。

![QQ_1725351612700](/../FUG6.9.1翻译.assets/QQ_1725351612700.png)

要使用 MPI（消息传递接口）并行运行 FDS，必须将计算域分解成多个网格，以便在进程之间分配工作量。一般来说，如果有可用资源，使用 MPI 运行多个网格情况会更好，但要注意，两个进程完成工作的时间不一定是一个进程的一半。要使 MPI 运行良好，必须为每个 MPI 进程分配相当数量的单元，否则大多数进程都会闲置，等待单元数最多的进程完成每个时间步的处理。您可以在单个处理器上使用多个网格而不使用 MPI，在这种情况下，一个 CPU 将逐个串行处理每个网格。

如果网格间距均匀，可以使用 MULT 功能（第 7.6 节）排列网格。例如，线条

```fortran
&MESH IJK=24,24,24, XB=-0.12,-0.06,-0.12,-0.06,-0.12,-0.06, MULT_ID='mesh' /
&MULT ID='mesh', DX=0.06, DY=0.06, DZ=0.06, I_UPPER=3, J_UPPER=3, K_UPPER=3 /
```

创建一个 4 x 4 x 4 的网格阵列，每个网格的边长为 0.06 米。

通常在 MPI 计算中，每个网格分配给自己的进程，每个进程分配给自己的处理器。不过，既可以将多个网格分配给一个进程，也可以将多个进程分配给一个处理器。假设有六个网格：

```fortran
&MESH ID='mesh1', IJK=..., XB=..., MPI_PROCESS=0 /
&MESH ID='mesh2', IJK=..., XB=..., MPI_PROCESS=1 /
&MESH ID='mesh3', IJK=..., XB=..., MPI_PROCESS=1 /
&MESH ID='mesh4', IJK=..., XB=..., MPI_PROCESS=2 /
&MESH ID='mesh5', IJK=..., XB=..., MPI_PROCESS=3 /
&MESH ID='mesh6', IJK=..., XB=..., MPI_PROCESS=3 /
```

参数 MPI_PROCESS 指示 FDS 将特定网格分配给给定的进程。在本例中，只需启动四个进程，编号从 0 到 3。请注意，这些进程需要从 0 开始按升序调用。 为什么要这样做呢？假设您只有四个处理器可用于这项工作。如果只启动四个进程而不是六个，就可以节省时间，因为 “mesh2 ”和 “mesh3 ”可以直接相互通信，而不必通过网络调用 MPI 来传输数据。mesh5 “和 ”mesh6 "也是如此。从本质上讲，这些网格对就像是邻居，无需通过邮政系统相互发送邮件。信件只需走到隔壁即可。

对于涉及许多网格的情况，您可能需要使用字符串 COLOR 或整数三元组 RGB 为它们分配颜色。还可以考虑使用乘法功能，轻松创建网格的三维数组。详见第 7.6 节。

有些并行计算环境没有集中文件系统，在这种情况下，FDS 必须将每个进程的输出文件写入单独的磁盘。如果您的计算集群没有共享文件系统（SHARED_FILE_SYSTEM），则应在 MISC 行将此参数设为 F。这个参数对于涉及成百上千进程的 MPI 作业也很有用，因为在这种情况下，写一个 Smokeview 文件非常耗时。当 SHARED_FILE_SYSTEM 设置为 F 时，Smokeview 读取的文件会被分割成若干块，每个 MPI 进程一块。这样做可以避免向 Smokeview 文件连续写入。对于大型 MPI 作业来说，还有一个有用的参数叫做 MISC 行上的 VERBOSE。这个逻辑参数会抑制与打印到诊断输出文件的 MPI 进程和 OpenMP 线程分配相关的信息。默认情况下，对于涉及 50 个或以下进程的 MPI 作业，其值为 T，而对于较大的作业，其值为 F。

### Mesh Alignment

无论是否使用 MPI 进行计算，多网格的规则都是相似的，但需要注意一些问题。网格对齐的最重要规则是相邻单元格应具有相同的横截面积或积分比，如图 6.2 所示。

![QQ_1725353335388](/../FUG6.9.1翻译.assets/QQ_1725353335388.png)

在设置多重网格计算时，还应遵循以下经验法则：

- 避免在预计会发生关键行动（尤其是火灾）的地方设置网状边界。有时无法避免火灾从网格蔓延到网格，但如果可能的话，应尽量使网格界面相对没有复杂现象，因为网格边界之间的信息交换还不如网格内单元与单元之间的信息交换准确。
- 一般来说，网格重叠的好处不大，因为信息只在外部边界交换。这意味着完全嵌入另一个网格的网格会在其外部边界接收信息，但较大的网格不会从嵌入其中的网格接收任何信息。从本质上讲，较大的网格（通常是较粗的网格）正在进行自己的场景模拟，不会受到嵌入其中的较小网格（通常是较细的网格）的影响。细网格中的细节，尤其是与火势增长和蔓延相关的细节，可能无法被粗网格捕捉到。在这种情况下，最好将详细的火灾行为隔离在一个网格内，并将较粗的网格置于细网格的外部边界。这样，细网格和粗网格就可以相互交换信息。
- 将域的整个面声明为 “打开的通风口 ”时，请注意使用快捷约定。每个网格都会具有此属性。详情请参阅第 7.4 节。
- 如果平面障碍物靠近两个网格的交汇处，应确保每个网格都能 “看到 ”障碍物。如果障碍物在其中一个网格外哪怕只有一毫米，该网格也不会考虑到它，在这种情况下，网格间的信息传递就会出现问题。

**如果您想在不运行案例的情况下检查网格对齐情况，请在任何网格线上将 CHECK_MESH_ALIGNMENT 设置为 T，并将 T_END 设置为零**。如果作业停止时没有错误，说明网格符合对齐规则。这种检查有时需要几十秒，但您可以在启动作业后打开 Smokeview，用肉眼检查对齐情况。

拒绝两个网格对齐的标准如下。假设相邻粗网格单元的大小为$\delta x_{\mathrm{c}}$，细网格单元的大小为 $\delta x_{\mathrm{f}}$。如果
$$
\left|\frac{\delta x_{\mathrm{c}}-n\delta x_{\mathrm{f}}}{\delta x_{\mathrm{f}}}\right|<0.001
$$
其中 n 是细单元与粗单元的比例。可以通过 MISC 行参数 ALIGNMENT_TOLERANCE 改变 0.001 的值。

**Accuracy of the Multiple Mesh Calculation**

使用相对较粗的网格单元对不同的网格配置进行试验，以确保信息在网格之间正常传输。有两个问题值得关注。首先，气流是否受到网格边界的严重影响？如果是，请尝试将网格边界从活动区域移开。其次，从一个网格到另一个网格，单元尺寸的跳跃是否太大？如果是，请考虑从细网格到粗网格的信息损失是否可以忍受。

### Mesh Stretching

默认情况下，填充计算域的网格单元大小一致。不过，也可以指定单元格在三个坐标方向中的一个或两个[^6-1] 是非均匀的。对于给定的 x、y 或 z 坐标方向，可以指定一个函数，将均匀分布的网格转换为非均匀分布的网格。网格变换时要小心！如果在一个区域缩小单元格，就必须在其他区域拉伸单元格。当一个或两个坐标方向发生变换时，三维网格中网格单元的纵横比将发生变化。为安全起见，应避免改变单元长宽比，使其超过 2 或 3。请记住，大涡度模拟技术基于这样一个假设，即数值网格应足够精细，以便形成造成混 合的涡流。一般来说，涡的形成受到网格单元最大维度的限制，因此，如果第三维度较大，在一 个或两个方向上缩小网格分辨率并不一定会带来更好的模拟效果。一般来说，变换会降低计算效率，两个坐标变换比一个坐标方向的变换对效率的影响更大。请尝试使用不同的网格划分策略，看看您需要付出多少代价。

下面举例说明如何进行网格变换。假设您的网格定义为

```fortran
&MESH IJK=15,10,20, XB=0.0,1.5,1.2,2.2,3.2,5.2 /
```

而您想改变 x 方向上的均匀间距。首先，请参考上图。您需要定义一个函数$x=f(\xi)$，将均匀间距计算坐标 (CC) $0\leq\xi\leq1.5$ 映射到物理坐标 (PC) $0\leq x\leq1.5$。该函数有三个强制约束条件：必须是单调的（始终递增）；必须将$\xi=0$ 映射到 $x = 0$；必须将$\xi=1.5$ 映射到 $x = 1.5$。对于均匀网格，默认变换函数为 $f(\boldsymbol{\xi})=\xi $，在这种情况下无需做任何操作。

![QQ_1725354488073](/../FUG6.9.1翻译.assets/QQ_1725354488073.png)

允许使用两种变换函数。第一种也是最简单的一种是片断线性变换函数。图 6.3 给出了一个片断线性变换的例子。图中显示了 15 个沿横轴均匀分布的网格单元如何转化为 15 个沿纵轴非均匀分布的网格单元。在这种情况下，函数是由连接点 (CC,PC) 的直线段组成的，这些直线段的顺序依次递增，输入文件中的下列行对此进行了指定：

```fortran
&MESH ..., TRNX_ID='my trnx' /
&TRNX ID='my trnx', CC=0.30, PC=0.50 /
&TRNX ID='my trnx', CC=1.20, PC=1.00 /
```

请注意，可将 ID 应用于一组 TRNX 行，并在所需的 MESH 行上使用 TRNX_ID 等进行调用。当 MULT_ID 应用于 MESH 时，这种策略也同样有效。或者，您也可以指出希望对其应用变换的整数 MESH_NUMBER（基于 MESH 行的顺序）（这种方法已被弃用，因为它要求每个网格都有一组变换行，这对于 MPI 计算来说是不切实际的）。如果要将变换应用于所有网格，请将 MESH_NUMBER 设为 0：

```fortran
&TRNX CC=0.30, PC=0.50, MESH_NUMBER=0 /
&TRNX CC=1.20, PC=1.00, MESH_NUMBER=0 /
```

参数 CC 指横轴上的计算坐标$\xi$；PC 指纵轴上的物理坐标 $x$。图中线段的斜率表示网格是被拉伸（斜率大于 1）还是被收缩（斜率小于 1）。这一过程的难点在于，通常情况下，您对纵轴上的物理坐标有一个理想的收缩/拉伸策略，因此必须逆向确定横轴上计算坐标的相应点。请注意，上述变换应用于多网格作业中的第二个网格。还应注意的是，在这种线性网格变换中，不应指定起点和终点。

第二种变换是多项式函数，其约束条件的形式为
$$
\frac{\mathrm{d}^nf(\mathrm{cc})}{\mathrm{d}\xi^n}=\mathrm{PC}
$$
图 6.4 举例说明了多项式变换的参数：

```fortran
&MESH ..., TRNX_ID='my trnx' /
&TRNX ID='my trnx', IDERIV=0, CC=0.75, PC=0.75 /
&TRNX ID='my trnx', IDERIV=1, CC=0.75, PC=0.50 /
```

对应于 $f(0.75)=0.75$ 和 $\frac{\mathrm{d}f}{\mathrm{d}\xi}(0.75)=0.5$ 这两个约束条件，换句话说，该函数将 0.75 映射为 0.75，且函数在$ \xi = 0.75 $处的斜率为 0.5。变换函数还必须经过点 (0,0) 和 (1.5,1.5)，这意味着 FDS 必须计算三次多项式$f(\boldsymbol{\xi})=c_{0}+c_{1} \boldsymbol{\xi}+c_{2} \boldsymbol{\xi}^{2}+c_{3} \boldsymbol{\xi}^{3}$ 的系数。函数的约束条件越多，多项式函数的阶数就越高，因此要小心过多的约束条件会导致函数的非单调性。程序会检查函数的单调性，如果不单调，则会产生错误信息。

请勿在与网格边界相对应的坐标值上指定线性变换点或 IDERIV=0 点。这将由 FDS 自动完成。

### Mesh Resolution

FDS 新用户常问的一个问题是："我的网格间距应该是多少？答案并不简单，因为这在很大程度上取决于您想要实现的目标。一般来说，您应该使用相对较粗的网格来建立 FDS 输入文件，然后逐渐细化网格，直到您在结果中看不到明显的差异。这就是所谓的网格灵敏度研究。

对于涉及浮力烟羽的模拟，衡量流场解析度的一个标准是非线性表达式 $D^*/\delta x$，其中 $D^*$是特征火直径。
$$
D^*=\left(\frac{\dot{Q}}{\rho_\infty c_pT_\infty\sqrt{g}}\right)^{\frac25}
$$
和 $\delta x$ 是网格单元的标称尺寸[^6-2]。$\dot Q$ 是火灾的总放热率。如果它随时间变化，则应考虑分辨率的相应变化。数量  $D^*/\delta x$ 可以看作是跨越火的特征直径（不一定是物理直径）的计算单元的数量。跨越火灾的单元越多，计算的分辨率就越高。最好根据这一非量纲参数来评估网格质量，而不是绝对的网格单元大小。例如，从某种意义上说，10 厘米的单元尺寸可能 “足以 ”评估烟雾和热量在建筑物中的扩散情况，但可能不适合研究非常小的燃烧源。

**FDS 验证指南[^23]中包含一个表格，其中列出了验证实验模拟中使用的  $D^*/\delta x$值**。该表位于介绍所有实验的章节末尾。这些值的范围超过两个数量级，是根据网格分辨率研究和特定火灾场景的特定属性选择的。将其中任何一个值作为 “可接受的 ”最小值都是不恰当的。

有一些特殊的输出量可以提供网格分辨率的本地测量值。详见第 22.10.28 节。

****

[^6-1]:如果要沿两个坐标方向拉伸网格，请将单元格数限制在 100 万左右。当使用非常大的网格时，用于双坐标拉伸的泊松求解器在初始化阶段会出现浮点溢出错误。如果需要超过 100 万个单元格，请考虑使用多个网格而不是一个大网格。
[^6-2]:特征火灾直径与特征火灾规模之间的关系是 $Q^*=(D^*/D)^{5/2}$，其中 $D$ 是火灾的物理直径。

# Model Geometry

设置计算的大量工作在于指定建模空间的几何形状，并对实体表面应用边界条件。几何形状可以用矩形障碍物和通风口来描述，前者可以加热、燃烧、传热等，后者可以将空气或燃料注入或吸出流动域。需要为每个障碍物和通风口指定一个边界条件，描述其热特性。火只是边界条件的一种。本章将介绍如何建立模型。

## Specifying Boundary Conditions

在说明如何建立几何体之前，首先需要说明如何描述几何体的边界表面。**SURF 命名列表组定义了流域内或流域边界的所有实体表面或开口的结构**。障碍物和通风口的边界条件是通过引用适当的 SURF 线来规定的，本节将介绍 SURF 线的参数。

**所有固体表面的默认边界条件都是表面温度固定为 TMPA 的光滑惰性壁，称为 “INERT”**。请勿将其与不发生热传递的表面混淆（这是一种绝热表面，其温度将发生变化以保持热传递为零，请参阅第 8.2.3 节）。为了在暴露于气体温度（可能高于或低于 TMPA）时将表面温度保持在 TMPA，FDS 会计算所需的传热系数，从而计算表面和气相之间的传热。您可以将 INERT 视为终极环境温度散热器，例如水冷面板。

如果只需要这一边界条件，则无需在输入文件中添加任何 SURF 行。如果需要其他边界条件，则应一次列出一个边界条件。每条 SURF 线都包含一个标识字符串 ID='...'，以便通过障碍物或通风口对其进行引用。因此，在下面要描述的每条 OBST 和 VENT 线路上，字符串 SURF_ID='...' 表示包含所需边界条件参数的 SURF 线路的 ID。**如果要将某一 SURF 行作为默认边界条件使用，请在 SURF 行上设置 DEFAULT=T**。

## Creating Rectilinear Obstructions

命名列表组 OBST 包含用于定义障碍物的参数。模型的整个几何结构完全由矩形实体构成，每个实体都在输入文件的一行中引入。

### Basics

每条 OBST 线都包含流域内一个矩形实体的坐标。该实体由两个点（x1,y1,z1）和（x2,y2,z2）定义，这两个点以实数六元组 XB 的形式输入到 OBST 线上。除坐标外，还可以使用参数 SURF_ID 指定障碍物的边界条件，即在障碍物表面应用哪条 SURF 线（第 7.1 节）。如果障碍物的顶部、侧面和底部具有不同的属性，请不要只指定一个 SURF_ID。请使用 SURF_IDS，这是一个由三个字符串组成的数组，**分别指定障碍物顶部、侧面和底部的边界条件 ID**。如果希望使用默认边界条件，则无需设置 SURF_ID 或 SURF_IDS。但是，如果障碍物的表面条件中至少有一个是默认的惰性表面条件，则可将其称为 “INERT”，但不必明确定义。例如

```fortran
&SURF ID='FIRE', HRRPUA=1000.0 /
&OBST XB=2.3,4.5,1.3,4.8,0.0,9.2, SURF_IDS='FIRE','INERT','INERT' /
```

在障碍物上面点火。这是一种简单的烧火方法。

除了 SURF_ID 和 SURF_ID，您还可以使用六元组 SURF_ID6，具体如下：

```fortran
&OBST XB=2.3,4.5,1.3,4.8,0.0,9.2,
SURF_ID6='FIRE','INERT','HOT','COLD','BLOW','INERT' /
```

其中六个曲面描述符分别指 x = 2.3、x = 4.5、y = 1.3、y = 4.8、z = 0.0 和 z = 9.2 平面。请注意，SURF_ID6 不应与 SURF_ID 或 SURF_IDS 在同一 OBST 行中使用。

**在模拟过程中可以设置或移除障碍物**。详见第 18.4.1 节。

### Thin Obstructions

**与气相数值网格间距相比相对较薄的障碍物近似为无限薄的薄片**。这些阻挡物（如窗玻璃）会形成流动和（部分）辐射屏障，但如果数值网格相对于其厚度较粗，则假定阻挡物只有一层网格单元的厚度，则阻挡物可能会不必要地增大。Smokeview 将这种障碍物渲染为薄片，但允许其具有热厚边界条件。

**这种障碍物的缺点是无法在其表面指定法向速度分量**。薄片障碍物的表面只能有一个速度矢量，因此无法从薄片障碍物中可靠地注入或抽出气体，因为从一侧推入的气体必然会从另一侧抽出。例如，如果您想创建一个简单的风扇，那么障碍物至少要有一个网格单元的厚度。**要防止 FDS 允许使用薄片障碍物，请在 MISC 行设置 THICKEN_OBSTRUCTIONS=T**，或在不允许使用薄片假设的各 OBST 行设置 THICKEN=T。

使用基于 FFT 的默认压力求解器时还会出现另一个缺点。薄障碍物更容易受到障碍物法向速度误差的影响。如果薄障碍物上存在较大的压力梯度或受到较高的法向速度影响，则可能需要对基于 FFT 的求解器采用更严格的公差或使用其他压力求解器。详见第 21.1 节的讨论。

薄障碍物可能会产生质量源，而不需要指定法向速度分量。障碍物旁边的气体单元被赋予一个体积源项，但表面的动量仍为零。

### Specified Versus Actual Areas

XB 在输入文件中指定的 OBST 尺寸可能不会（通常不会）与底层笛卡尔网格完全一致。然后，FDS 会 “捕捉 ”几何体，以填充（或取消）最近单元格的体积。相对于底层数值网格过小的遮挡物将被剔除。也就是说，**如果三个障碍物尺寸中至少有两个尺寸小于相应单元尺寸的一半，则该障碍物将被忽略**。 如上所述，如果您希望始终填充单元格，请在 OBST 行中指定 THICKEN=T。

当 OBST 与笛卡尔网格咬合时，单元面的面积会发生变化，因此 SURF 的总面积可能会略有变化。如果给出了指定的质量通量边界（包括 HRRPUA），那么 FDS 将自动调整该质量通量，以保持指定面积乘以指定质量通量的总和。

### Overlapping Obstructions

如果两个障碍物的面相互重叠，FDS 将选择输入文件中第二个指定的障碍物的表面属性。**如果不希望这样，请在第二个障碍物的 OBST 行添加 OVERLAY=F，在这种情况下，第一个障碍物的表面属性将被应用**。OVERLAY 的默认值为 T

当障碍物重叠时，Smokeview 会将两个障碍物独立渲染，这往往会导致重叠处的两个表面颜色出现难看的交叉阴影。解决这一问题的简单方法是，通过相应调整障碍物的坐标 (XB) 来 “缩小 ”不希望优先显示的障碍物。然后，在 Smokeview 中切换 “q ”键以显示您指定的障碍物，而不是 FDS 渲染的障碍物。

### Preventing Obstruction Removal

HOLE功能可以保护障碍物。**有时，使用HOLE创建门窗非常方便**。例如，假设在墙上打了一个HOLE来表示门或窗。只要在 OBST 行中包含 PERMIT_HOLE=F 短语，就可以定义一个障碍物来填充这个洞（大概是要移除或用不同的颜色或其他方式）。一般来说，任何障碍物都可以通过这个短语使 HOLE 无法穿透。默认情况下，PERMIT_HOLE=T 表示除非另有指示，否则障碍物被假定为可穿透的。请注意，如果可穿透的障碍物与不可穿透的障碍物重叠，应先列出 PERMIT_HOLE=F 的障碍物。

如果无论出于何种原因都不能移除或剔除障碍物，请设置 REMOVABLE=F。**有时需要这样做，以阻止 FDS 移除嵌入其他障碍物（如墙内的门）的障碍物**。

在极少数情况下，您可能不想让通风口连接到某个障碍物上，在这种情况下，设置 ALLOW_VENT=F

### Transparent or Outlined Obstructions

通过在 OBST 线路上指定 TRANSPARENCY（透明度），可以使障碍物半透明。这个实数参数的范围是 0 到 1，0 表示完全透明。该参数应始终与 “COLOR ”或 RGB 三元组一起设置。也可以在相应的 SURF 行中指定该参数以及颜色指示符。如果希望障碍物不可见，请设置 COLOR='INVISIBLE'。

在 Smokeview 中，障碍物通常绘制为实体。要绘制轮廓图，可将 OUTLINE 设置为 T

### Creating Holes in Obstructions

HOLE命名列表组定义了从现有障碍物或障碍物组中开洞的参数。为此，请添加以下格式的行

```fortran
&HOLE XB=2.0,4.5,1.9,4.8,0.0,9.2 /
```

删除体积 $2.0<x<4.5,1.9<y<4.8,0.0<z<9.2$ 内的任何实体网格单元。与体积相交的障碍物会被分割成更小的块。如果孔洞代表门或窗，一个好的经验法则是打出足够多的孔洞。**这样可以确保孔洞穿过整个障碍物**。例如，如果 OBST 线表示 0.1 米厚的墙壁：

```fortran
&OBST XB=1.0,1.1,0.0,5.0,0.0,3.0 /
```

如果您想创建一扇门，请添加以下内容：

```fortran
&HOLE XB=0.99,1.11,2.0,3.0,0.0,2.0 /
```

在孔的 x 坐标上增加的厘米数清楚地表明，孔要打穿整个障碍物。

当创建HOLE时，受影响的障碍物要么被剔除，要么在预定时间创建或移除。详见第 18.4.1 节。要使用 CTRL 或 DEVC 命名组控制孔，需要在 HOLE 行[^7-1]中分别添加 CTRL_ID 或 DEVC_ID 参数。当 HOLE 的状态评估值为 F 时，将在 HOLE 中放置一个障碍物。默认情况下，填充 HOLE 的障碍物的颜色与 HOLE 打穿的周围 OBST 的颜色相同。要使填充HOLE的障碍物与原始障碍物的颜色不同，请在HOLE行上设置 COLOR 或整数三元组 RGB（请参阅第 7.5 节）。如果希望填充 HOLE 的障碍物不可见，则设置 COLOR='INVISIBLE'。此外，还可以使用关键字 “透明”（TRANSPARENCY）（0 至 1 之间的实数）使填充HOLE的障碍物透明。示例请参见第 18.4.1 节。

如果障碍物不允许用HOLE穿刺，请在 OBST 行添加 PERMIT_HOLE=F。请注意，HOLE对VENT或网格边界没有影响。它只适用于 OBST 结构。

最好通过运行设置作业（TIME 行上的 T_END=0）或短时作业来检查几何图形，以测试设备和控制功能的运行情况。

## Creating Unstructured Geometry (Beta)

命名表 GEOM 描述了一个或多个非结构化封闭几何曲面，这些曲面包围了流体域的实体部分。这些曲面由一系列三角形面组成，其中每个面由三个顶点构成。用户可以为每个面指定特定的边界条件。

### My First Geometry

为了让您熟悉新的几何特征，我们允许将 OBST 命名列表的某些参数应用于 GEOM。因此，根据本节末尾列出的限制（请参阅第 7.3.11 节），您应该可以使用 OBST 建立的案例，只需将其替换为 GEOM 即可开始使用非结构化几何体。例如，如果您的燃烧器是这样创建的

```fortran
&OBST XB=-1,1,-1,1,0,0.5, SURF_IDS='FIRE','INERT','INERT' /
```

可以替换为

```fortran
&GEOM XB=-1,1,-1,1,0,0.5, SURF_IDS='FIRE','INERT','INERT' /
```

此外，如第 7.3.8 节所述，可以使用 MOVE 线对 GEOM 进行转换。

### Unstructured Geometry Basics

非结构实体的一个简单例子是

```fortran
&GEOM ID='My Solid'
SURF_ID='FIRE','INERT'
VERTS= -1.0, -1.0, 0.0,
1.0, -1.0, 0.0,
0.0, 1.0, 0.0,
0.0, 0.0, 1.0,
FACES= 1,3,2, 2,
1,4,3, 1,
3,4,2, 1,
2,4,1, 0 /
```

ID 指定名称 “My Solid”，VERTS 指定每个顶点的坐标（x1,y1,z1; x2,y2,z2, ...），FACES 定义每个三角形面--三个顶点和一个边界条件索引： (v1,v2,v3,b). 顶点索引的范围从 1 到 VERTS 中列出的顶点数量。三个顶点的顺序决定了三角形的哪一面朝外。从外部观察，每个三角形的顶点应按照右手定则惯例逆时针排序。

**边界条件索引 b 的范围从 0 到 SURF_ID 中的条目数。b = 0 应用默认边界条件**。在上面的示例中，第一个面的索引 b = 2 对应于 “INERT”，第二个和第三个面的索引 b = 1 对应于 “FIRE”，第四个面对应于默认值。

### Triangulated Surfaces Quality

为了使 FDS 能够从流体域的其他部分中正确地检测出体积的实体部分，在开始时需要对三角化曲面的质量进行一些测试。

FDS 对每个 GEOM namelist 的顶点和面集合执行以下条件：

1. 每个顶点必须是唯一的，由边共享，是唯一成型曲面的一部分，因此其相邻的面环理论上可以连续变形为圆盘：符合这些条件的顶点称为非退化顶点和流形顶点。好顶点和坏顶点的例子见图 7.3。:question:
2. 连接顶点的每条边的长度必须不为零，而且必须始终由恰好两个面共享。符合这些条件的边称为非退化边和流形边。请参见图 7.4 中好边和坏边的示例。
3. 每个面不能与其他面相交，且面积必须不为零；这样的面称为非相交面和非退化面。
4. 如图 7.1 所示，**面的顶点排序应使相邻面的法线向外一致**。
5. 每个 GEOM namelist 都可以定义一个或多个不同的体块（非连接体块），这些体块不应相互相交或自 相交。请参见图 7.7 中的不良相交几何体示例。

如果遵守了前面的条件，就可以得到一个成型的 GEOM 命名列表，它代表了一个或多个closed, manifold, orientable, non intersecting的三角形曲面，这些曲面包围着定义明确的体积。图 7.2 展示了一个成形良好的三角形曲面。

![QQ_1725330330472](/../FUG6.9.1翻译.assets/QQ_1725330330472.png)

![QQ_1725330354354](/../FUG6.9.1翻译.assets/QQ_1725330354354.png)

![QQ_1725330368943](/../FUG6.9.1翻译.assets/QQ_1725330368943.png)

![QQ_1725330382913](/../FUG6.9.1翻译.assets/QQ_1725330382913.png)

每当对这些条件的其中一项检查失败时，FDS 就会输出一条错误信息，说明问题及其在域中的位置。例如

```fortran
ERROR: GEOM ID='Cube': Non manifold geometry at edge: ...
```

### Intersections

GEOM 之间以及 GEOM 与其他 namelists 之间可能会发生几种类型的交叉：

- GEOM - GEOM 和 GEOM - OBST: 每当发生这些类型的相交时，FDS 都会尝试执行布尔运算，在尊重曲面边界条件的前提下将对象合并。当一个几何体与另一个几何体相交时，用户尚未输入定义该交点的顶点和边。在一般情况下，要辨别确切的交点可能非常复杂，因此我们采用了线性化方法，通过在单元的笛卡尔面上定义的边来生成单元内的近似边界面。两个相交球体的示例如下图 7.8 所示。如果几何形状过于复杂，这一操作可能会失败。在这种情况下，单元格将是空的。建议用户尽可能在自己选择的预处理器中应用几何联合。
- GEOM - HOLE: 目前没有相交。

![QQ_1725333047354](/../FUG6.9.1翻译.assets/QQ_1725333047354.png)

### Coloring and Texture Maps

GEOM 对象的着色和纹理贴图的指定方法与 OBST 相同（见第 7.5 节）。

### Self-Generated Geometries

GEOM 命名列表允许快速定义特定类型的几何对象，如使用 XB 的块体、使用 SPHERE_ORIGIN 和 SPHERE_RADIUS 的球体以及使用 ZVALS 的二维地形高程。FDS 会生成顶点和面，以表示这些对象，相当于使用 VERTS 和 FACES 所定义的对象。

**Blocks**

定义区块的 GEOM 命名列表由以下方式指定

```fortran
&GEOM ID='block'
SURF_ID='S1'
XB=0.0,1.0,0.0,1.0,0.0,1.0
/
```

其中，XB=xmin,xmax,ymin,ymax,zmin,zmax 定义了区块的最小和最大边界。XB 参数的使用方法与 OBST 或 VENT 行相同。通过指定 IJK 参数，可以将区块细化为多个部分。例如，IJK=8,6,4 将把图块沿 x 维分成 8 个部分，沿 y 维分成 6 个部分，沿 z 维分成 4 个部分。

SURF_ID 参数将指定的边界条件分配给所有生成的面。与 OBST 类似，您也可以使用 SURF_IDS 和 SURF_ID6 列表指定曲面条件（见第 7.2.1 节）。

**Spheres**

一个定义了以 (0,0,0) 为中心、半径为 1 的球体的 GEOM 命名列表是这样指定的

```fortran
&GEOM ID='sphere'
SURF_ID='S1'
SPHERE_ORIGIN=0.0,0.0,0.0, SPHERE_RADIUS=1.0
/
```

默认情况下，**球体被离散化，因此每个面的大小与网格分辨率一致**。我们可以指定一个 N_LEVEL 参数来定义球体被分割的次数。

**Cylinders**

GEOM 命名列表定义了一个圆柱体几何体，圆心位于 CYLINDER_ORIGIN=(0,0,0)，轴线 CYLINDER_AXIS = (1.,0,0)，长度 CYLINDER_LENGTH = 2.，半径 CYLINDER_RADIUS = 0.5。

```fortran
&GEOM ID='cylinder', SURF_ID='S1',
CYLINDER_LENGTH=2.,
CYLINDER_RADIUS=.5,
CYLINDER_ORIGIN=0.,0.,0.,
CYLINDER_AXIS=1.,0.,0.,
CYLINDER_NSEG_AXIS=6,
CYLINDER_NSEG_THETA=48 /
```

其中，圆柱体沿轴线分为 6 段，周长分为 48 段。关键字 SURF_ID 可用 SURF_IDS='S1'、'S2'、'S3'代替，其中字符串'S1'、'S2'、'S3'分别对应顶面、侧面和底面的表面 ID。

**2D Terrain Elevations**

定义二维地形高程的 GEOM 命名列表如下

```fortran
&GEOM ID='terrain'
SURF_ID='S1'
IJK=ivals,jvals, XB=xmin,xmax,ymin,ymax,
EXTEND_TERRAIN=etlog, ZVAL_HORIZON=zvhr,
ZVALS=...
/
```

其中 XB 定义了以（xmin,ymin）和（xmax,ymax）为边界的矩形区域，ZVALS 定义了该区域的高程数据。IJK 指定了该区域内每个维度的顶点数量。在本例中，ivals 值出现在 x 维度上，jval 值出现在 y 维度上。ZVALS 关键字用于指定每个 (x,y) 位置的标高。在 ZVALS 关键字后指定的高程数据按行主次顺序排列。第一行包含从 xmin 到 xmax 的 ymin 位置上的 ivals 高程值。同样，最后一行包含 ymax 位置从 xmin 到 xmax 的 ivals 高程值。海拔数据有 jvals 行和 ivals 列。可选字段 EXTEND_TERRAIN 和 ZVAL_HORIZON 的使用形式如下。如果计算域的设置大于 XB 定义的地形补丁，以至于完全包含地形，那么设置 EXTEND_TERRAIN=T 就可以将地形扩展到域边界。这对于减少计算中的边界效应很有帮助。此外，如果在 GEOM 行上设置了实数 ZVAL_HORIZON，那么在扩展域时，域边界将使用该标高。与块体和球体一样，FDS 使用这些关键字提供的信息来构造顶点和三角形面。几何体的底面标高（仅用于 Smokeview 可视化目的）可通过参数 ZMIN 设置。

此外，还可以指定地形几何图形，定义一个从顶部看具有凸形规则边界的三角剖面图。该三角剖面将代表所关注的地形，并定义地形 GEOM 的顶部边界。地形表面由 VERTS 和 FACES 指定，与基本几何体（第 7.3.2 节）一样，字段 IS_TERRAIN 需设置为 T，以便 FDS 知道这是一个地形非结构化表面。每个面的曲面类型的指定方式与基本几何体相同。此外，还可以使用 EXTEND_TERRAIN 逻辑。

**Geometries Extruded From Simple Planar Polygons**

在这种情况下，可以定义一个几何体，指定 VERTS、连接性 POLY 和挤出距离 EXTRUDE。例如

```fortran
&GEOM ID='ExtPoly', SURF_ID='Poly1',
VERTS =
-1.0, -1.0, 1.0,
0.5, -1.0, 1.75,
1.0, -1.0, 2.0,
0.0, 0.0, 1.5,
1.0, 1.0, 2.0,
-1.0, 1.0, 1.0,
POLY = 1, 2, 4, 3, 5, 6,
EXTRUDE=0.5 /
```

POLY 所定义的多边形必须简单、非退化（无线段交叉、无重复顶点），且所有线段必须位于三维空间的同一平面上。它最多可以有 1000 个顶点。EXTRUDE 的值可以是正或负的实数，但不能为零。可以通过 SURF_IDS 字段提供单一曲面 ID 或顶面、侧面和底面 ID，方法与第 7.3.6 节中的圆柱体相同。请注意，**SURF_IDS 中的底面总是指在 POLY 中定义的多边形，挤出操作就是从这里开始的**。:question:

### Generating Complex Geometries

生成格式良好的复杂几何图形是一个耗时且容易出错的过程。FDS-SMV 社区提供了多个第三方预处理工具，用于将 CAD 文件自动转换为 GEOM 命名列表。

这些工具应始终对三角化曲面进行质量检查，并生成格式良好的 GEOM 命名列表。这些工具的链接可在项目主页 https://pages.nist.gov/fds-smv/ 的 “Third-Party Tools and Training ”下找到。(现在好像几乎都用不了)

### Transforming Objects

几何体可以平移、旋转和缩放。例如，在下面的 GEOM 命名列表中

```fortran
&MOVE ID='ChairMove', AXIS=...,...,..., ROTATION_ANGLE=..., DX=, /
&GEOM ID='chair'
SURF_ID='woodSID','apholsterySID',
VERTS=X1,Y1,Z1,...,XM,YM,ZM,
FACES=F1_1,F1_2,F1_3,F1_SID,...,FN_1,FN_2,FN_3,FN_SID
MOVE_ID='ChairMove'
/
```

椅子对象的平移和旋转是通过引用 MOVE 命名列表进行的，其定义和解释见第 11.4 节。

### Reading Geometry Node Locations And Connectivity Data From Binary

如果几何图形有大量节点和曲面三角形，则可以通过从 FDS 生成的二进制文件中读取这些数据来提高设置效率。该二进制文件可在仅设置模式（T_END=0.0）下运行情况下获得。请看上一节中定义的椅子几何图形。当 FDS 读取几何体时，XYZ 和面连接数据 FACES 会自动写入运行目录下名称为 CHID_GEOM_ID.bingeom 的二进制文件（此处 GEOM_ID=“chair”）。如果没有提供 ID，二进制文件的名称将是 CHID_N_GEOM.beingom，其中 N_GEOM 是定义 FDS 输入文件中几何线出现顺序的数字。

然后，假设案例 ID 为 CHID=“DiningRoom”，下次运行案例时，几何体行可以修改为

```fortran
&GEOM ID='chair',
SURF_ID='woodSID','apholsterySID',
BINARY_FILE='DiningRoom_chair.bingeom',
MOVE_ID='ChairMove' /
```

其中的 BINARY_FILE 指示 FDS 从二进制几何体文件中读取节点和面。请注意，我们删除了输入行中的 VERTS 和 FACES 阵列。这种加载大型几何体的方式避免了测试和读取 FDS 输入文件中与这些数组相关的所有行。**这种方法在使用并行文件系统的大型并行计算中特别有效。**有关几何图形 I/O 二进制格式的更多信息，请参见第 27.19 节。如果使用与默认名称不同的名称，可以在 BINARY_FILE 字段中指定。也可以在 BINARY_FILE 字符串中添加位置目录。

地形也可以二进制格式读取和写入，在这种情况下，只记录其顶面三角测量。二进制文件包含其几何信息和地形类型，但如上图所示，必须在几何行中提供 SURF_ID 数组。如果需要扩展地形，EXTEND_TERRAIN 也需要同样的要求。二进制文件连接性中定义的曲面 ID 数量必须与 SURF_ID 中定义的曲面数量一致。

### Handling Split Cells and Thin Geometries

非结构化几何算法目前的一个限制是，笛卡尔单元不能被薄几何体或角分割，这样就有可能在一个笛卡尔单元内产生两个背景压力区。默认情况下，如果单元被薄几何体分割，FDS 将填充两个不相连的体积中较小的一个。但是，您可能希望让一侧完全平滑，而让另一侧吸收几何体的变化。例如，您希望隧道或天花板的内壁光滑，但对问题的外部部分并不太在意。在这种情况下，您可以通过在 GEOM 行上设置 CELL_BLOCK_IOR 或 CELL_BLOCK_ORIENTATION 来控制几何体的哪一边被填充。前者是一个表示笛卡尔轴的整数，后者允许指定任何方向的矢量。图 7.9 举例说明了这一功能的工作原理。**目前，这一功能仅限于 IOR 可以定义方向的几何图形**。例如，这对空心球体无效。对于地形几何体，默认值为 CELL_BLOCK_IOR=-3。

![QQ_1725334563611](/../FUG6.9.1翻译.assets/QQ_1725334563611.png)

### GEOM Limitations

- 目前，GEOM namelists 没有控制逻辑。也就是说，无法添加或删除 GEOM。
- MULT 结构目前无法应用于几何图形。
- 薄几何图形和边角不能分割单元，必须封住一边。参见第 7.3.10 节。
- 仅允许在单个网面上使用外部衬底。如果背面在另一个网格上，背衬将被设置为 VOID（静音）。
- **VENT 不能应用于 GEOM**。表面属性必须通过 SURF_ID 逐个面应用。
- 无VENT意味着HVAC不能应用于 GEOM 表面。这已列入我们的优先事项，并将在未来推出。
- 无法在几何图形中施加切向速度。NO_SLIP 条件假定切向速度为零。允许这一功能也是开发工作的重点。
- **GEOM 中没有三维传热和 BURN_AWAY**。
- HOLE 命名列表不适用于 GEOM。
- 不建议使用子网格几何图形（小于一个网格单元）。它们目前不包括在动量方程的处理中。同样，间隙也应定义为一个单元格大小的厚度。
- 不建议使用比笛卡尔网格单元小得多的三角形面。与笛卡尔网格单元相比，每个面的边界条件分配分辨率过低。
- 粒子会与几何体相互作用，但由于表面张力的作用，粒子不会在几何体下方流动。也就是说，如果粒子落在球体顶部，一旦到达赤道，就会直接落到地面上。它们将表现为颗粒，而不是液滴。
- 小心烟尘沉积。虽然几何图形具有沉积功能，但尚未经过全面测试。

### The Big Picture, Run Time, and Accuracy

**Big picture** FDS 中复杂几何图形的长期目标是实现与建筑信息管理 (BIM) 模型和复杂 CAD 几何图形相对无缝的工作流程。然而，过去几年中，我们一直在开发一种保守而稳定的公式。为此，我们不得不暂时放弃浸没边界法，转而采用需要非结构化压力求解器（ULMAT；见第 21.1 节）的切割单元方案。

**Run time** 在使用复杂几何体时，您可能会发现运行时间变慢，原因有两个。首先，设置时间会明显变慢，尤其是在未从二进制文件导入几何体的情况下（见第 7.3.9 节）。这是不可避免的，因为识别和处理切割单元非常耗时。其次，使用 ULMAT 虽然在实体边界处更为精确，但比 FFT 压力求解器（每次迭代）更慢。此外，随着网格大小的增加，ULMAT 的速度也会逐渐变慢。因此，在较大的情况下使用 ULMAT 时，必须将域分解为小于150,000 个单元（约 个）的网格。

**Accuracy** 使用曲线几何图形的理由应该是笛卡尔几何图形的精度不够。例如，您可能有一个倾斜的天花板或房间的某些细节需要更高的逼真度。如果需要更高的精度，通常也意味着需要更好的网格分辨率。几何图形和笛卡尔网格的保真度要保持一致。如果笛卡尔网格过粗，就不要指望高度精细的几何图形会带来更好的结果。

## Applying Surface Properties

OBST 组用于指定计算域内的障碍物，而 VENT 组（表 23.36）用于指定与障碍物或外墙相邻的平面。请注意，“ VENT ”是出于历史原因而使用的，这组参数已经远远超出了其最初的作用，即简单地将空气吹入或吸出计算域。有关使用 VENT参数的通风策略的讨论，请参见第 10.1 节。

### Basics

通风口的指定方式与障碍物类似，六元组 XB 表示与实体表面相接的平面。六个坐标中有两个必须相同，表示平面而不是实体。请注意，任何给定的实体表面只能指定一个 VENT。**如果 VENT 重叠，FDS 将输出警告信息并忽略多余的 VENT 行**。

VENT一词有些误导。从字面上理解，VENT可以用来模拟建筑物通风系统的组成部分，如扩散器或回风口。在这些情况下，VENT坐标在实体表面上形成一个平面，构成管道的边界。不需要在实体上开孔；**假定空气被推出墙外或吸入墙内的管道工程**。更实际的是，VENT只是一种将特定边界条件应用于固体表面矩形补丁的手段。例如，通常是先通过 OBST 线生成一个固体障碍物，然后在固体表面的某处指定一个VENT，该VENT的 SURF_ID 具有燃料的热特性和燃烧特性。例如

```fortran
&OBST XB=0.0,5.0,2.0,3.0,0.0,4.0, SURF_ID='big block' /
&VENT XB=1.0,2.0,2.0,2.0,1.0,3.0, SURF_ID='hot patch' /
```

指定一个大的障碍物（在文件的其他地方以 “big block ”为名给出了属性），并在其一个面上打上 “补丁”，以 “hot patch ”为名给出了其他属性。后一种表面属性实际上不一定是 “通风口”，比如供气或回气管道，而只是一个边界条件与障碍物不同的补丁。请注意，<font color=red>**VENT的表面属性优先于底层障碍物的表面属性**</font>。

**VENT必须始终与固体障碍物相连**。有时，VENT的一部分可能会超出实体，在这种情况下，通风孔要么会被忽略，要么会触发一条错误信息。只有与实体表面相邻的VENT部分才会被考虑。因此，**如果给VENT的 SURF_ID 指定了 HRRPUA（单位面积热释放率）值，则该释放率仅适用于通风口下方有固体的部分**。

此外，VENT的方向是由一侧的固体单元和另一侧的气体单元组成的。不要将VENT扩展到多个方向。

指定整面外墙的简单方法是将 XB 替换为 MB（网格边界），这是一个字符串，其值为以下值之一： XMAX“、”XMIN“、”YMAX“、”YMIN“、”ZMAX “或 ”ZMIN"，分别表示平面 x = XMAX、x = XMIN、y = YMAX、y = YMIN、z = ZMAX 或 z = ZMIN。与障碍物一样，通风口的边界条件索引也是用 SURF_ID 指定的，表示要应用所列 SURF 线中的哪一条。如果希望使用默认边界条件，则无需设置 SURF_ID。

**在进行多网格模拟（即使用多个矩形网格）时，使用 MB 快捷键时要小心**。由字符串 MB 指定的平面可能会被错误地应用到多个网格上，从而可能导致混淆平面是实体墙还是开放边界。检查 Smokeview 中的几何图形，确保正确指定VENT。尽可能使用颜色来仔细检查设置。有关颜色的更多详情，请参见第 7.5 节和表 7.1。此外，**VENT线条上的参数 OUTLINE=T 会使通风口在 Smokeview 中绘制成轮廓**。

**对于多网格计算，**一个更安全的选择可能是使用 DB（域边界），它采用与 MB 相同的选项，但将 SURF_ID 应用于域边界。

### Special Vents

有四个保留的SURF_ID可以应用于VENT - ' OPEN '， ' MIRROR '， ' PERIODIC '和HVAC。术语保留意味着这些surf_id不应该由您显式定义。**它们的属性是预定义的**。

**Open Vents**

第一个特殊的VENT由参数SURF_ID= ' OPEN '调用。**这仅在VENT应用于计算域的外部边界时使用，其中它表示对外部的被动开放**。默认情况下，FDS假定计算域的外部边界(MESH行上的XBs)是一个固体壁面。**要创建完全或部分开放的域，请在外部网格边界上使用open通风口**。通过简单地将其指定为OPEN，有时可以方便地指定向计算域外部打开的门或窗。但是，请记住，**这种开口上的压力边界条件是不完善的，建议如果通过门或窗户的流量很重要，您应该将域扩展几米，而不是使用OPEN边界**<font color=red>(在输入卡中如何设置？)</font>。您仍然需要使用OPEN边界来打开计算域的一个或多个侧面，但是这些开口将离建模的门或窗足够远，从而不会影响流型。

默认情况下，假定在' OPEN '出口之外存在环境条件。然而，在某些情况下，您可能想要改变这个假设，例如，温度。**如果您假设的温度不是环境温度**，则指定TMP_EXTERIOR和SURF_ID= ' OPEN '。您可以使用渐变函数TMP_EXTERIOR_RAMP修改该参数的时间历史。谨慎地使用这个选项——在很多情况下，如果你想描述建筑物的外部，最好在计算中明确地包括外部，因为进出门窗的流动将更自然地被捕捉到。有关更多细节，请参见第16.5.1节。如果要指定OPEN边界处的非环境压力，请参见第10.4节。

<font color=red>**OPEN 压力边界条件在气流主要为法向气流时最为稳定**</font>。即，大部分流入或大部分流出。这是因为，如果气流与通气孔平行，则开放边界处的规定压力条件不佳（输入的微小扰动可能导致输出的巨大变化）。例如，假设室外流在x方向上为10m /s，在z方向上为±0.001 m/s，顶部边界为OPEN。这个流动的动能大约是$k=50m^2/s^2$。当垂直速度为正时(+0.001 m/s)，则规定的滞止压力边界条件设为$H=k=50m^2/s^2$。但当垂直速度为负(-0.001 m/s)时，$H = 0$(见[1])。由于这个原因，**在室外应用中应该小心使用OPEN通风口**。**<font color=red>参见第16.2节了解另一种方法。</font>**

**在模拟过程中，可以打开或关闭通往计算域外部的通风口**(OPEN通风口)。最好是通过制造或移除覆盖在OPEN通风口上的薄障碍物来完成。有关详细信息，请参见第18.4.2节。

**Mirror Vents**

一个带有SURF_ID= ' MIRROR '的VENT表示一个对称平面。通常，MIRROR跨越计算域的整个面，实质上是将域的大小加倍，MIRROR充当对称平面。MIRROR另一侧的流动正好相反[^7-2]。从数值角度来看，MIRROR是一个无通量、自由滑移边界。**与OPEN一样，MIRROR只能在计算域的外部边界指定**。通常，OPEN或MIRROR通风口是沿着计算域的整个一侧指定的，在这种情况下，“MB”表示法很方便。

在传统的RANS (Reynolds - Average Navier-Stokes)模型中，对称边界通常被用作节省计算时间的一种方法。然而，由于FDS是一个LES(大涡模拟)模型，对称边界的使用应该仔细考虑。原因是LES模型不计算N-S方程的时间平均解。换句话说，对于RANS模型，火羽被表示为轴对称流场，因为如果你在足够长的时间内对实际流场进行时间平均，那就是你所期望的。因此，对于RANS模型，沿羽流中心线的对称边界是合适的。然而，在LES模型中，方程中没有时间平均，也没有时间平均的对称解。沿着火羽的中心线放置MIRROR边界将完全改变其动力学。它会产生一种非常类似于垂直墙壁附近的火灾流场的东西。因此，不建议在紊流火羽的中心线处采用镜像边界条件。:question:**如果火焰或燃烧器很小，并且流动是层流的，那么MIRROR边界条件是有意义的**。实际上，在二维计算中，MIRROR边界条件是在第三个坐标方向上使用的(这是自动完成的，不需要显式指定)。

**Periodic Vents**

带有SURF_ID= ' PERIODIC '的VENT可以与域的另一侧的另一个周期性VENT结合使用。如果域仅由单个网格组成，则可表示为：

```fortran
&VENT MB='XMIN', SURF_ID='PERIODIC' /
&VENT MB='XMAX', SURF_ID='PERIODIC' /
```

指定仿真在x方向上是周期性的。对于应用PERIODIC边界条件的**多网格域**，整个域必须是单个大块，并且必须使用PBX, PBY或PBZ指定VENT平面。例如，如果$x_{min}=0,x_{max}=1$，则可使用：

```fortran
&VENT PBX=0, SURF_ID='PERIODIC' /
&VENT PBX=1, SURF_ID='PERIODIC' /
```

默认情况下，为了处理具有多个网格的周期域的最一般情况(想象一个周期通道被分成几个网格)，FDS将压力边界条件视为我们所说的“插值边界”。这意味着压力泊松方程的矩阵是排列好的狄利克雷边界条件(解的值在边界处指定)。这可能导致解中的小误差，有时需要使用泊松方程的真周期矩阵。但是使用当前的求解器(Fishpak)，这只能用于单个网格。如果你想为单个网格情况实现真正的周期边界，在PRES线上设置适当的FISHPAK_BC值为零。例如，

```fortran
&PRES FISHPAK_BC(1:3)=0,0,0 /
```

周期性通风口不能用于连接偏移通风口或不同坐标方向的通风口。对于此类情况，您必须使用HVAC功能(见第10.2节)。

**HVAC Vents**

带有SURF_ID= ' HVAC '的通风口表示该通风口连接到HVAC系统。HVAC系统输入的描述见第10.2节。

**Circular Vents**

**圆形或半圆形通风口可以指定为坐标为XB的矩形与圆心为XYZ、半径为RADIUS的圆的交点。**被分配到相应 SURF_ID 的矩形表面单元将是那些中心点位于交叉点内的单元。在Fire/circular_burner.fds算例中，以下两行创建了一个直径为1m的圆形通风口，以$0.02 kg/m^2/s$的速度流动丙烷气体：

```fortran
&SURF ID='BURNER', MASS_FLUX(1)=0.02, SPEC_ID(1)='PROPANE', TAU_MF(1)=0.01 /
&VENT XB=-0.6,0.6,-0.6,0.6,0,0, XYZ=0,0,0, RADIUS=0.5, SURF_ID='BURNER',
    SPREAD_RATE=0.05 /
```

XB坐标指定了通风口的方向。在这种情况下，指定的区域的范围XB足够大，可以容纳整个圆。还请注意，在本例中，参数SPREAD_RATE使火焰以0.05 m/s的速率向外蔓延。通过排气口的丙烷的质量通量如图7.10所示。注意，质量通量随着“t平方”曲线而增加。这是一场以线性速度径向蔓延的火灾的预期结果。在这种情况下，火在10s达到圆的半径，和预期的一样。还要注意，参数TAU_MF表明，一旦火焰前缘到达给定的网格单元，燃料应该迅速上升。换句话说，TAU_MF 控制燃料的局部上升；SPREAD_RATE 控制全局上升。升压后，燃料的流速等于 乘以单位面积的燃料质量流量。即使在粗网格上粗略地分解了圆，也会调整燃料流量以产生由圆形通风口控制的所需值。

![image-20240617101428989](/../FUG6.9.1翻译.assets/image-20240617101428989.png)

### Controlling Vents

在某些情况下，可以通过 DEVC_ID 或 CTRL_ID 指定的 “设备 ”和 “控制 ”来控制通风口功能。详见第 18.4.2 节。

### Trouble-Shooting Vents

**与输入文件中的大多数条目不同，指定VENTs的顺序可能很重要**。可能在某些情况下，将一个通风口置于另一个通风口之上是很方便的。如前所述，这是因为VENT的属性是从几何体上覆盖几何体下的面。例如，假设您想要指定一个隔间的天花板具有一组特定的表面属性，并且您指定整个天花板具有适当的SURF_ID。然后，**<font color=red>您希望在天花板上指定一个较小的块，以具有另一组表面属性，例如空气供应</font>**。在这种情况下，<u>您必须先指定供应通风口，因为对于天花板的该区域，FDS 将忽略天花板属性并应用供应属性</u>。现在，通风孔的规则是 "先到先得"。但是请记住，第二个VENT并没有被完全拒绝——只在重叠的地方。FDS还将向屏幕(或标准错误)打印一个警告，说明哪个VENT具有优先级。**此外，如果任何VENTs都应用OPEN边界条件，请小心OPEN边界禁用压力ZONEs**，这将改变问题的解决方案。

Smokeview 可以帮助识别两个VENT重叠的位置，假定每个通风口都有独特的 COLOR。由于 Smokeview 绘制的VENT是相互重叠的，因此重叠的区域会有颗粒感，看起来很别扭，而且会随着场景的移动而改变图案。

如果出现错误消息，要求指定通风口的方向，请首先检查以**确保通风口是平面**。如果排气口是一个平面，那么可以通过指定`IOR`参数强制其方向。如果VENT的法线方向在x正方向，则设置`IOR=1`。如果**法线**方向在负x方向，则设置`IOR=-1`。**对于y和z方向，分别使用数字2和3**。`IOR`只能在某些情况解决这个问题。

## Coloring Obstructions, Geometry, Vents, Surfaces, and Meshes

在可视化模拟结果时，为对象分配有意义的颜色或图案非常有用。在FDS中有两种方法可以做到这一点。要么指定一个单一的颜色，要么指定一个纹理贴图，这本质上是你选择的图像。

### Colors

FDS中许多项目的颜色可以通过两种方式规定：整数颜色值(RGB)的三元组或字符串(COLOR)。三个RGB整数的范围是0到255，表示红色，绿色和蓝色的数量组成了这个颜色。如果按名称定义COLOR，那么键入的名称必须与颜色表中列出的名称完全一致，这一点很重要。可以在SURF线上指定颜色参数，在这种情况下，该类型的所有表面都将具有该颜色，或者可以将颜色参数直接应用于浸入几何形状的障碍物或通风口。例如：

```fortran
&SURF ID='UPHOLSTERY', ..., RGB=0,255,0 /
&OBST XB=..., COLOR='BLUE' /
&GEOM GEOM_ID=..., COLOR='BLUE' /
```

将所有UPHOLSTERY上色为绿色和这个特殊的障碍或几何形状上色为蓝色。

表 7.1 提供了各种颜色的 RGB 值和 COLOR 名称[^7-3]。通过 SURF 线为曲面指定唯一的颜色非常有用，可以确定整个几何体是否指定了所需的曲面属性。

障碍物，几何形状和通风口可以单独着色，覆盖SURF线指定的颜色。**特殊情况COLOR= ' INVISIBLE '导致通风口、几何形状或障碍物不被烟雾视图绘制**。另一种特殊情况**COLOR= ' RAINBOW '**导致通风口，障碍物或网格的颜色从RGB值的整个范围中随机选择，当使用MULT命名列表组并希望区分多重阻塞、通气或网格时，这可能很有用。

<center>Table 7.1: A sample of color definitions.</center>

![QQ_1725348980823](/../FUG6.9.1翻译.assets/QQ_1725348980823.png)

### Texture Maps

在计算域中，有多种方法可以规定各种物体的颜色，但也有一种方法可以将图像粘贴到障碍物上，从而使 Smokeview 图像更加逼真。这种技术被称为 “纹理映射”。例如，要将木镶板图像应用到墙壁上，可在定义木镶板物理特性的 SURF 线中添加一条线：

```fortran
&SURF ID='wood paneling',..., TEXTURE_MAP='paneling.jpg', TEXTURE_WIDTH=1.,
    TEXTURE_HEIGHT=2. /
```

假设在工作目录中存在一个名为paneling.jpg的JPEG文件，那么在使用paneling的任何地方，Smokeview都会加载并显示该图像。注意，当第一次调用烟雾视图时，图像不会出现。**这是一个由显示/隐藏菜单控制的选项**。参数TEXTURE_WIDTH和TEXTURE_HEIGHT是图像的物理尺寸。在上述案例下，JPEG图像是1米宽2米高的镶板。烟雾视图尽可能频繁地复制图像，使其看起来在需要的地方应用了面板。仔细考虑图像在场景中是如何重复的。如果图像有明显的方向，则应该将真正的三重体TEXTURE_ORIGIN添加到应该应用纹理映射的VENT或OBST线上。例如，

```fortran
&OBST XB=1.,2.,3.,4.,5.,7., SURF_ID='wood paneling', TEXTURE_ORIGIN=1.,3.,5. /
```

对尺寸为1米× 1米× 2米的障碍物应用镶板，使镶板的图像位于点(1,3,5)。TEXTURE_ORIGIN的默认值是(0,0,0)，全局默认值可以通过在MISC行中添加TEXTURE_ORIGIN语句来更改。

**对于球体的几何形状**，GEOM线上的参数TEXTURE_MAPPING= ' SPHERICAL '让烟雾视图知道将纹理包裹在球体周围，而不是从上方将其平放。以下来自测试用例geom_texture3a.fds的FDS输入行。FDS使用图像sphere_cover_03.png定义一个球体作为纹理贴图(该图像在烟雾视图安装目录中找到)。图7.11显示了使用这些输入线以及应用的矩形纹理映射的纹理映射球体。

```fortran
&SURF ID='surf1'
    TEXTURE_MAP='sphere_cover_03.png',COLOR='BLUE',
    TEXTURE_WIDTH=1.0,TEXTURE_HEIGHT=1.0,TEXTURE_ORIGIN=0.0,0.0,0.0,
    TEXTURE_MAPPING='SPHERICAL'/
&MOVE ID='SPHERE_ROT', AXIS=0.,0.,1., ROTATION_ANGLE=270. /
&GEOM ID='sphere1',SURF_ID='surf1',SPHERE_RADIUS=0.5,
    N_LAT=25,N_LONG=50,SPHERE_ORIGIN=0.0,0.0,0.0,MOVE_ID='SPHERE_ROT'
```

![image-20240617104746731](/../FUG6.9.1翻译.assets/image-20240617104746731.png)

## Repeated Objects: The MULT Namelist Group (Table 23.19)

有时，障碍物、孔洞和通风口会在输入文件中重复出现。这样的创建过程可能很繁琐，也会使输入文件难以阅读。不过，如果一组特定的对象有规律地重复出现，您可以使用一种称为乘法器的工具。例如，如果要重复一个障碍物，可以在输入文件中创建如下一行：

```fortran
&MULT ID='m1', DX=1.2, DY=2.4, I_LOWER=-2, I_UPPER=3, J_LOWER=0, J_UPPER=5 /
&OBST XB=x1,x2,y1,y2,z1,z2, MULT_ID='m1' /
```

这样做的效果是根据以下公式生成一个障碍物阵列：

```fortran
x1’ = x1+DX0+i DX ; I_LOWER ≤ i ≤ I_UPPER
x2’ = x2+DX0+i DX ; I_LOWER ≤ i ≤ I_UPPER
y1’ = y1+DY0+ j DY ; J_LOWER ≤ j ≤ J_UPPER
y2’ = y2+DY0+ j DY ; J_LOWER ≤ j ≤ J_UPPER
z1’ = z1+DZ0+k DZ ; K_LOWER ≤ k ≤ K_UPPER
z2’ = z2+DZ0+k DZ ; K_LOWER ≤ k ≤ K_UPPER
```

如果需要在乘法运算之前移动障碍物的位置，则使用参数 DX0、DY0 和 DZ0。

这个想法的一个变体是用一个名为 DXB 的六元组代替参数 DX、DY 和 DZ。DXB 中的六个条目分别递增 XB 给出的障碍物坐标值。例如，X 坐标变换如下：

```fortran
x1’ = x1+DX0+n DXB(1) ; N_LOWER ≤ n ≤ N_UPPER
x2’ = x2+DX0+n DXB(2) ; N_LOWER ≤ n ≤ N_UPPER
```

N_LOWER 和 N_UPPER 用于表示 N 的范围。这种更灵活的输入方案允许您创建一个斜屋顶，例如，在该斜屋顶中，各个屋顶片段在上升到顶部时会缩短。下面这个简短的输入文件演示了这一功能，它使用四个外围障碍物创建了一个中空的金字塔，构成了金字塔底座的轮廓：

```fortran
&HEAD CHID='pyramid', TITLE='Simple demo of multiplier function' /
&MESH IJK=100,100,100, XB=0.0,1.0,0.0,1.0,0.0,1.0 /
&TIME T_END=0. /
&MULT ID='south', DXB=0.01,-.01,0.01,0.01,0.01,0.01, N_LOWER=0, N_UPPER=39 /
&MULT ID='north', DXB=0.01,-.01,-.01,-.01,0.01,0.01, N_LOWER=0, N_UPPER=39 /
&MULT ID='east', DXB=-.01,-.01,0.01,-.01,0.01,0.01, N_LOWER=0, N_UPPER=39 /
&MULT ID='west', DXB=0.01,0.01,0.01,-.01,0.01,0.01, N_LOWER=0, N_UPPER=39 /
&OBST XB=0.10,0.90,0.10,0.11,0.10,0.11, MULT_ID='south', COLOR='RED' /
&OBST XB=0.10,0.90,0.89,0.90,0.10,0.11, MULT_ID='north', COLOR='BLUE' /
&OBST XB=0.10,0.11,0.11,0.89,0.10,0.11, MULT_ID='west', COLOR='GREEN' /
&OBST XB=0.89,0.90,0.11,0.89,0.10,0.11, MULT_ID='east', COLOR='CYAN' /
&MULT ID='holes', DX=0.15, DZ=0.1, I_UPPER=1, K_UPPER=1 /
&HOLE XB=0.40,0.45,0.00,1.00,0.15,0.20, MULT_ID='holes' /
&TAIL /
```

该输入文件的最终结果是在每个面的底部以阶梯模式重复长矩形障碍物，从而创建一个金字塔。注意本例中使用了 N_LOWER 和 N_UPPER，它们会自动使 FDS 按顺序而不是以数组的形式重复障碍物。

![QQ_1725349567034](/../FUG6.9.1翻译.assets/QQ_1725349567034.png)

请注意，MULTiplication功能适用于 MESH、OBST、HOLE、VENT 和 INIT 线路。**对于 MESH，它只适用于网格的边界 (XB)，而不适用于单元格数**。

另请注意，如果在包含 MULT_ID 的行中指定了 COLOR，该颜色将应用于对象的所有副本。不过，您可以设置 COLOR='RAINBOW'，这将指示 FDS 为每个复制对象随机选择一种颜色。

### Using MULT for Mesh Refinement

请注意，可以使用 I_LOWER_SKIP 和 I_UPPER_SKIP 等跳过 MULT 数组中的对象和网格。上式中的 i 会在此区间内跳过。下面以细化内部网格的多网格为例，说明这种方法的实用性。网格排列结果如图 7.13 所示。

```fortran
&MULT ID='interior fine mesh array',
DX=1.0,I_LOWER=1,I_UPPER=2,
DZ=1.0,K_LOWER=1,K_UPPER=2 /
&MULT ID='exterior coarse mesh array',
DX=1.0,I_LOWER=0,I_LOWER_SKIP=1,I_UPPER_SKIP=2,I_UPPER=3,
DZ=1.0,K_LOWER=0,K_LOWER_SKIP=1,K_UPPER_SKIP=2,K_UPPER=3 /
&MESH IJK=8,1,8, XB=0.0,1.0,-0.5,0.5,0.0,1.0, MULT_ID='interior fine mesh array' /
&MESH IJK=4,1,4, XB=0.0,1.0,-0.5,0.5,0.0,1.0, MULT_ID='exterior coarse mesh array' /
```

![QQ_1725349728256](/../FUG6.9.1翻译.assets/QQ_1725349728256.png)

### Using MULT to make shapes out of obstructions

使用 OBST 线制作的块状障碍物受限于 XB 所定义的方框内。不过，MULT 可用来创建障碍物阵列，每个障碍物阵列可以小到一个网格单元，并可将其调整为以下四种基本形状之一：球形、圆柱形、圆锥形或方框形。流动障碍物是通过使用 MULT_ID 创建的 OBST 数组与 OBST 行上定义的 SHAPE 的交叉点创建的。请注意，这种方法可能会占用大量内存，因为每个网格单元都可以是自己的 OBST，这与使用 BURN_AWAY 进行热解时分解 OBST 的方式类似。

雕刻形状的第一步是创建 MULT 行，定义 OBST 的复制。然后在 OBST 行上输入 SHAPE（形状），并输入所需的参数；参数列于表 7.2。

<center>Table 7.2: OBST SHAPE parameters.</center>

![QQ_1725349850670](/../FUG6.9.1翻译.assets/QQ_1725349850670.png)

下面给出了一个球体的示例。默认情况下，球心位于 (0,0,0)，因此只需要 RADIUS。如果 RADIUS 大于 OBST 数组的半宽，问题不大，但最终结果不会是球体。如果 RADIUS 小于半宽，这也是允许的，但效率不高。

```fortran
&MESH IJK=50,50,50, XB=-0.125,0.125,-0.125,0.125,-0.125,0.125/
&SURF ID='shape', COLOR='ORANGE'/
&MULT ID='cube array', DX=0.005,DY=0.005,DZ=0.005, I_UPPER=41,J_UPPER=41,K_UPPER=41/
&OBST XB=-0.105,-0.100,-0.105,-0.100,-0.105,-0.100
MULT_ID='cube array'
SURF_ID='shape'
SHAPE='SPHERE'
RADIUS=0.1/
```

![QQ_1725349924687](/../FUG6.9.1翻译.assets/QQ_1725349924687.png)

要创建一个圆柱体，除了半径之外，我们还需要高度和方向。圆柱体底面中心 XYZ 的位置默认为 (0,0,0)。垂直方向（默认）圆柱体的示例如下图 7.15 所示。请注意，方向矢量的大小并不重要；该矢量仅用于指定方向。

![QQ_1725350078992](/../FUG6.9.1翻译.assets/QQ_1725350078992.png)

关于精确面积调整的注意事项：改变 ORIENTATION（方向）（默认值：0,0,1）或使用多网格的 SHAPE（形状）会使面积调整算法失效。因此，FDS 无法按照 SURF 线和 OBST 线 SHAPE 几何参数给出的精确面积，精确计算出表面的质量通量。FDS 产生的质量通量将由 SURF 线和 OBST 所对应的网格单元的大小决定。如果需要调整方向或进行多网格计算，请首先运行一个示例案例，查看表面实现的总流速（通常可在 CHID_hrr.csv 文件中找到）。然后在相应的 SURF 行上手动调整质量通量（或 HRRPUA）。

```fortran
&SURF ID='shape', COLOR='DARK GRAY'/
&MULT ID='cube array', DX=0.005,DY=0.005,DZ=0.005, I_UPPER=41,J_UPPER=41,K_UPPER=41/
&OBST XB=-0.105,-0.100,-0.105,-0.100,-0.105,-0.100
MULT_ID='cube array'
SURF_ID='shape'
SHAPE='CYLINDER'
RADIUS=0.05
HEIGHT=0.2
XYZ=0,0,-0.1
ORIENTATION=0,0,1/
```

锥体所需的输入参数与圆柱体基本相同。底面中心的位置使用 XYZ 指定，底面的 RADIUS、HEIGHT 和 ORIENTATION 也必须指定。下图 7.16 是一个示例。

```fortran
&SURF ID='shape', COLOR='FOREST GREEN'/
&MULT ID='cube array', DX=0.005,DY=0.005,DZ=0.005, I_UPPER=41,J_UPPER=41,K_UPPER=41/
&OBST XB=-0.105,-0.100,-0.105,-0.100,-0.105,-0.100
MULT_ID='cube array'
SURF_ID='shape'
SHAPE='CONE'
RADIUS=0.05
HEIGHT=0.2
XYZ=0,0,-0.1
ORIENTATION=0,0,1/
```

![QQ_1725350086415](/../FUG6.9.1翻译.assets/QQ_1725350086415.png)

最后，方框形状可以定义旋转立方体。方框形状由其高度（HEIGHT）、宽度（WIDTH）和长度（LENGTH）局部定义。方块中心的位置以 XYZ 为单位。角度 THETA 的单位是度，它指定了方框相对于全局 Z 轴的旋转，遵循右手定则。随后，方向矢量可以改变相对于 THETA 旋转参考帧的方向。这个方向向量可以改变方框的方向，使局部高度方向与之相匹配。图 7.17 是一个简单的示例。

```fortran
&SURF ID='shape', COLOR='GRAY'/
&MULT ID='cube array', DX=0.005,DY=0.005,DZ=0.005, I_UPPER=41,J_UPPER=41,K_UPPER=41/
&OBST XB=-0.105,-0.100,-0.105,-0.100,-0.105,-0.100
MULT_ID='cube array'
SURF_ID='shape'
SHAPE='BOX'
LENGTH=0.075
WIDTH=0.025
HEIGHT=0.05
XYZ=0,0,0.01
ORIENTATION=0.5,0,1
THETA = 45. /
```

![QQ_1725350136405](/../FUG6.9.1翻译.assets/QQ_1725350136405.png)



****

[^7-1]:如果在 “HOLE ”行添加 CTRL_ID 或 DEVC_ID，请勿将此 “HOLE ”与另一个 “HOLE ”重叠。控制逻辑可能会失败。
[^7-2]:注意，Smokeview 中不显示场景的镜像。
[^7-3]:通过搜索 FDS 源代码文件 data.f90，可以找到所有 500 多种颜色的完整列表。

# Thermal Boundary Conditions

<font color=red>本章介绍如何指定实体物体的热属性。</font>

## Basics

默认情况下，计算域的外部边界假定为保持环境温度的固体边界。对于添加到场景中的任何障碍物也是如此。要指定实体的属性，请使用命名列表组 SURF（第 7.1 节）。**假设固体由不同材料的层组成**。通过 MATL 命名列表组（第 8.3 节）指定每种所需材料的属性。这些属性表示材料的加热速度和燃烧方式。输入文件中的每个 MATL 条目都必须有一个 ID 或名称，以便通过参数 MATL_ID 将其与特定的 SURF 关联起来。例如，输入文件条目：

```fortran
&MATL ID='BRICK', CONDUCTIVITY=0.69, SPECIFIC_HEAT=0.84, DENSITY=1600. /
&SURF ID='BRICK WALL', MATL_ID='BRICK', COLOR='RED', BACKING='EXPOSED',
THICKNESS=0.20 /
&OBST XB=0.1,5.0,1.0,1.2,0.0,1.0, SURF_ID='BRICK WALL' /
```

定义了一堵长 4.9 米、高 1 米、厚 20 厘米的砖墙。**请注意，OBST 线表示的墙壁厚度与 SURF 线指定的THICKNESS无关**。OBST 线定义了障碍物的几何形状（即求解器如何看到障碍物）。SURF 线定义了障碍物的传热特性（即一维固相求解器如何看到障碍物）。这样，障碍物就可以紧贴局部网格，但传热求解仍能反映实际厚度。

## Surface Temperature and Heat Flux

本节介绍如何指定简单的热边界条件。当有关固体材料属性的信息很少或没有时，通常会使用这些条件。如果已知材料的属性，最好是指定这些属性，然后让模型计算墙壁和其他固体表面的热通量和温度。

### Specified Solid Surface Temperature

通常情况下，FDS 使用 MATL 命名列表组指定的热属性来预测固体边界的表面温度，而 SURF 则通过字符串 MATL_ID 调用命名列表组。不过，**输入 TMP_FRONT（以℃为单位的表面温度）可用于指定固定的温度边界条件**：

```fortran
&SURF ID='HOT WALL', COLOR='RED', TMP_FRONT=200. /
```

请注意，无需指定 MATL_ID 或厚度。**由于墙壁将保持在给定温度下，因此无需说明其材料成分或厚度**。(:question:那如何计算墙体内部的温度？)

### Convective Heat Transfer Options

本节标为专题，因为通常情况下不需要修改 FDS 中的对流换热模型。不过，在一些特殊情况下，默认模型可能无法满足要求，本节将介绍一些选项。

**Default Convective Heat Transfer Model**

在 LES 计算中，对流传热系数 h 基于自由（自然）对流和强制对流的努塞尔特（Nu）数中的较大者：
$$
\dot{q}_\mathrm{c}^{\prime\prime}=h\left(T_\mathrm{g}-T_\mathrm{w}\right)\quad;\quad h=\frac kL\max\left(\mathrm{Nu}_\mathrm{free},\mathrm{Nu}_\mathrm{forced},\frac{2L}{\delta n}\right)
$$
其中，Tg 是邻近表面的气相单元中心温度，Tw 是表面（壁面）温度，L 是特征长度，k 是气体的热导率。对于平面，L 取为 1 米，对于球体和圆柱体，L 取为直径 D。**右侧的最后一个参数对应于 DNS 情况下的极限**。对于拉格朗日粒子，假设 D≪δn，因此 h 的方程变为：
$$
h=\frac kL\max{(\mathrm{Nu}_{\mathrm{free}},\mathrm{Nu}_{\mathrm{forced}})}
$$
对于自由(自然)对流，努塞尔数是瑞利数的函数：
$$
\mathrm{Ra}=\frac{2g\left|T_\mathrm{g}-T_\mathrm{w}\right|L^3}{\left(T_\mathrm{g}+T_\mathrm{w}\right)\nu\alpha}\quad;\quad\nu=\frac\mu\rho\quad;\quad\alpha=\frac k{\rho c_p}\quad;\quad\mathrm{Pr}=\frac\nu\alpha 
$$
以下表达式是参考文献[^20]在 Pr = 0.7 的假设条件下给出的简化表达式。
$$
\mathrm{Nu}_{{\mathrm{frec}}}=\left\{\begin{array}{ll}\left(0.825+0.324\mathrm{~Ra}^{1/6}\right)^{2}&\text{Vertical plate or cylinder}\\0.54\mathrm{~Ra}^{1/4}&\text{Horizontal hoo plate facing up or cold plate facing down, Ra}\leq10^{7}\\0.15\mathrm{~Ra}^{1/3}&\text{Horizontal hot plate facing up or old plate facing down, Ra}>10^{7}\\0.52\mathrm{~Ra}^{1/5}&\text{Horizontal hoolate facing down or cold plate facing up}\\\left(0.60+0.321\mathrm{~Ra}^{1/6}\right)^{2}&\text{Horizontal cylinder}\\2+0.454\mathrm{~Ra}^{1/4}&\text{Sphere}\end{array}\right.
$$
对于强迫对流，Nu由下式给出：
$$
\mathrm{Nu}_{\mathrm{forced}}=C_0+(C_1\operatorname{Re}^m-C_2)\operatorname{Pr}^{1/3}\quad;\quad\mathrm{Re}=\frac{\rho|\mathbf{u}|L}\mu
$$

<center>Table 8.1: Coefficients used for forced convection heat transfer correlations[^20]</center>

![image-20240715153121373](/image-20240715153121373.png)

系数值见表 8.1。此外，也可以通过在 SURF 行设置 NUSSELT_C0、NUSSELT_C1、NUSSELT_C2 和 NUSSELT_M 的值来指定自定义系数。**如果使用此功能，必须定义所有四个系数的值**。
长度尺度 L 由 SURF 行上的 CONVECTION_LENGTH_SCALE 指定。默认情况下，板的标度为 1 米，球体或圆柱体的标度为 1 米。

**Impinging Jet Heat Transfer Model**

强制对流传热相关性通常适用于平行于表面的流动。当流动为撞击射流（法向和朝向表面）时，速度的切向分量在撞击点不能很好地分辨，因此，如果不特别考虑表面，就会预测出一个虚假的低传热系数值。如果表面可能受到撞击射流或停滞点气流的影响（在火灾中，通常是指火源上方的天花板），可考虑使用撞击射流传热模型，使用 HEAT_TRANSFER_MODEL='IMPINGING JET'对 SURF 进行应用。该模型的默认形式与强制对流相关性类似，但雷诺数是通过 "冲击速度 "计算得出的，计算公式为$U_{\mathrm{imp}}=\sqrt{2H}$，其中 H 是单位质量的停滞能量（参见《FDS 技术指南》）。
$$
\mathrm{Nu}_{{\mathrm{imp}}}=C_{0}+\left(C_{1}\operatorname{Re}_{{\mathrm{imp}}}^{m}-C_{2}\right)\Pr^{1/3}\quad;\quad\mathrm{Re}_{{\mathrm{imp}}}=\frac{\rho U_{{\mathrm{imp}}}L}{\mu}
$$
默认系数为 $C_0=0,C_1=0.055,C_2=0,m=0.8$。但如上所述，可以在 SURF 行输入自定义值。同样，默认长度标度为 L = 1 米，但也可以更改。文献中通常将此值设定为喷射源的直径。通过 Nuimp 获得的传热系数将与强制对流和自由对流的传热系数进行比较，并为表面选择最大值。

**Output for Convective Heat Transfer Regime**

在计算传热系数时，可以直观地看到采用了哪种对流传热相关性。**这可以通过使用 BNDF 或 DEVC 上的固相输出量 "CONVECTIVE**
**HEAT TRANSFER REGIME’ "来实现**。对于壁面（颗粒不可用），该状态映射为一个整数值，1 = NATURAL, 2 = FORCED, 3 = IMPACT, 4 = RESOLVED，并用颜色标记，以便边界可视化。

**Specified Convective Heat Transfer Coefficient**

要指定对流传热系数，可使用 SURF 行上的 HEAT_TRANSFER_COEFFICIENT 将其设置为常数，单位为 W/(m2K)，并可选择使用 RAMP_HEAT_TRANSFER_COEFFICIENT 设置随时间变化的斜坡。如果固体障碍物的背面朝向计算域外部，且固体会传热，则可使用 HEAT_TRANSFER_COEFFICIENT_BACK 指定背面的传热系数，并可使用 RAMP_HEAT_TRANSFER_COEFFICIENT_BACK 指定随时间变化的斜坡。**这种背面条件适用于 BACKING='VOID' 或 BACKING='EXPOSED' 的 SURF 线路**。

**Specifying the Heat Flux at a Solid Surface**

与其改变对流传热系数，不如直接指定一个固定的热通量。有两种方法可以做到这一点。第一种是以 kW/m2 为单位指定 NET_HEAT_FLUX。指定后，**FDS 将计算所需的表面温度，以确保来自表面的辐射热通量和对流热通量之和等于 NET_HEAT_FLUX**。第二种方法是指定 CONVECTIVE_HEAT_FLUX，单位为 kW/m2。然后根据 SURF 线的EMISSIVITY和获得所需的 CONVECTIVE_HEAT_FLUX 所需的墙壁温度来确定辐射通量。**将 EMISSIVITY设为零将导致表面只有对流热通量**。如果 NET_HEAT_FLUX 或 CONVECTIVE_HEAT_FLUX 为正值，墙会加热周围的气体。如果 NET_HEAT_FLUX 或 CONVECTIVE_HEAT_FLUX 为负值，墙会冷却周围气体。不能用 NET_HEAT_FLUX 指定 TMP_FRONT，因为 NET_HEAT_FLUX 结合了辐射通量和对流通量，FDS 必须计算壁面温度才能得到所需的通量。指定 TMP_FRONT 和 CONVECTIVE_HEAT_FLUX 后，FDS 将使用壁室附近的气体温度来设置对流传热系数，以达到该壁室所需的 CONVECTIVE_HEAT_FLUX。如果液滴以指定的热通量着陆表面，则预测液滴和表面之间不会发生热传递。这是因为液滴的热传导率很高，在试图强制执行特定热通量时可能会导致不合理的壁面温度，进而可能导致运行错误或数值不稳定。

**Logarithmic Law of the Wall**

**近壁处理方法，例如壁面模型或壁面函数**，旨在利用代数公式模拟靠近壁面处从分子传输到湍流传输的突然变化，而无需解决近壁流场这一计算成本高昂的区域。主要理论遵循基于壁面剪切力恒定的量纲分析。因此，无量纲速度 $u^{+}$是通过壁面函数计算得出的。

以此类推，我们定义无量纲温度$T^+\equiv(T_\mathrm{g}-T_\mathrm{w})/T_\tau $ ，其中 $T_{\mathfrak{g}}$是第一个离壁网格单元的气体温度，$T_{\tau}$与壁面热通量 $\dot{q}_\mathrm{w}^{\prime\prime}$定义为$T_\tau=\dot{q}_\mathrm{w}^{\prime\prime}/\rho_\mathrm{w}u_\tau c_\mathrm{p}$。局部传热系数由以下公式求得：
$$
h=\frac{\dot{q}_{\mathrm{w}}^{\prime\prime}}{T_{\mathrm{g}}-T_{\mathrm{w}}}=\frac{\rho_{\mathrm{w}}c_{\mathrm{p}}u_{\tau}}{T^{+}}
$$
有关方程的更多详情，请参阅《FDS 技术指南》。要为特定表面指定该传热模型，请在 SURF 行设置 HEAT_TRANSFER_MODEL 等于 "LOGLAW"。请注意，**loglaw 模型并不适合浮力流**--它要求表面附近有解析度较高的 "风"，因此主要适用于网格解析度较高的强制对流类型的流动。

**Blowing Heat Transfer**

如果表面正在喷出（"吹"）或排出（"吸"）气体，则表面的法向流会破坏热边界层。**吹气会降低传热系数，而吸气会增加传热系数**。在 SURF 行中添加 BLOWING=T 将考虑这种影响，但不使用经验传热相关性的 DNS 模拟除外。当 BLOWING=T 时，传热系数调整如下[^21]：
$$
\Phi_h=\frac{\dot{m}^{\prime\prime}c_p}h\\h_{\mathrm{blowing}}=\frac{\Phi_h}{\mathrm{e}^{\Phi_h}-1}h
$$
其中，h 是未经调整的传热系数，$\dot{m}^{\prime\prime}$是单位面积的质量流量（正值表示吹气），cp 是气体的比热。

### Adiabatic Surfaces

诊断模拟的一个常见边界条件是强制所有表面完全隔热，**即气体与固体之间没有净热传导（辐射和对流）**。对于这些情况，请在 SURF 行指定 ADIABATIC=T。FDS 将计算壁面温度，使净对流和辐射热通量之和为零。指定一个表面为 ADIABATIC 等于 NET_HEAT_FLUX=0 和 EMISSIVITY=1。在这种情况下，通常也会初始化气体和表面温度，以便测量域内物体吸收或产生的热量等：

```fortran
&INIT XB=..., TEMPERATURE=2000. /
&SURF ID='...', ADIABATIC=T, TMP_FRONT_INITIAL=2000. /
```

请注意，**TMP_FRONT_INITIAL 设置的是表面的初始温度，除此以外几乎没有其他用途**。**如果表面不是 ADIABATIC 且具有材料属性，可使用 TMP_INNER 设置表面和内部温度**。

还需注意的是，没有任何固体表面是真正绝热的；因此，绝热边界条件只能用于诊断目的。如果使用 ADIABATIC 表面，实际火灾模拟可能会产生数值不稳定性，因为墙壁温度场和辐射场不会同时更新。如果液滴落在 ADIABATIC 表面上，预计液滴和表面之间不会发生热传递。这是因为当试图执行绝热条件时，与液滴相关的高传热速率会导致不合理的壁面温度，从而可能导致运行错误或数值不稳定。

## One-Dimensional Heat Conduction in Solids

**指定的温度或热通量边界条件很容易应用，但在实际火灾场景中作用有限**。<font color=red>在大多数情况下，墙壁、天花板和地板由多层衬里材料组成</font>。在大多数火灾情况下，使用一维求解器计算固体表面的法线热传导就足够了。在一些有限的情况下，可以进行三维热传导；见第 8.4 节。

MATL 命名列表组用于定义构成边界实体的材料属性。**实体边界可由不同材料的多个层组成，每个层可由多个材料成分组成**（最大层数和材料组分为20）。

### Structure of Solid Boundaries

通过名为 MATL_ID(IL,IC)的数组在 SURF 线上指定材料层和成分。**参数 IL 是一个整数，表示层索引，从 1 开始，即<font color=red>外部</font>边界的层**。参数 IC 是一个整数，表示材料成分索引。**例如，MATL_ID(2,3)='BRICK' 表示第二层的第三个材料成分是 BRICK**。在实际应用中，材料的列表通常如下例所示：

```fortran
&MATL ID = 'INSULATOR'
    CONDUCTIVITY = 0.041
    SPECIFIC_HEAT = 2.09
    DENSITY = 229. /
&SURF ID = 'BRICK WALL'
    MATL_ID = 'BRICK','INSULATOR'
    COLOR = 'RED'
    BACKING = 'EXPOSED'
    THICKNESS = 0.20,0.10 /
```

:exclamation:**在没有参数的情况下，参数 MATL_ID 被假定为多层材料的列表，每层只包含一个材料成分**。

**当一组 SURF 参数应用于 OBST 的面时，第一个 MATL_ID 定义了第一层实体材料。其他 MATL_ID 将依次应用**。如果 BACKING="EXPOSED"，则最后一个 MATL_ID 应用于实体的反面。如果在上面的示例中，使用 SURF_ID 将 BRICK WALL 应用于整个 OBST，那么在进行从 +x 面到 -x 面的传热计算时，FDS 将认为 OBST 是 BRICK，其次是 INSULATOR，从 -x 面到 +x 面的传热计算也是如此。为避免这种情况，请指定具有相反 MATL_ID 的第二个 SURF，并使用 SURF_ID6 将两个 SURF 定义应用于 OBST 的相对面。

:exclamation:**可使用 MATL_MASS_FRACTION 关键字定义同一层中的固体材料混合物**。该参数的两个索引与 MATL_ID 关键字相同。例如，如果砖层中含有一些额外的水，输入可以如下所示：

```fortran
&MATL ID = 'WATER'
    CONDUCTIVITY = 0.60
    SPECIFIC_HEAT = 4.19
    DENSITY = 1000. /
&SURF ID = 'BRICK WALL'
    MATL_ID(1,1:2) = 'BRICK','WATER'
    MATL_MASS_FRACTION(1,1:2) = 0.95,0.05
    MATL_ID(2,1) = 'INSULATOR'
    COLOR = 'RED'
    BACKING = 'EXPOSED'
    THICKNESS = 0.20,0.10 / <--- for layers 1 and 2
```

在这个例子中，第一层材料，即第 1 层，由砖和水的混合物组成。这由 MATL_ID 数组给出，该数组指定第 1 层的成分 1 为砖，第 1 层的成分 2 为水。每种成分的质量分数通过 MATL_MASS_FRACTION 指定。在本例中，砖的质量占第 1 层的 95%，水的质量占第 1 层的 5%。

重要的是，**固体混合物的成分被视为没有空隙的纯净物质**。混合物的密度为
$$
\rho=\left(\sum_i\frac{Y_i}{\rho_i}\right)^{-1}
$$
其中，$Y_{i}$是材料的质量分数，$\rho_{i}$ 是 MATL 线上定义的材料体积密度。在上面的例子中，墙壁的密度约为 1553 kg/m3。墙体密度小于纯砖密度这一事实可能令人困惑，但很容易解释。如果墙体中含有水，那么墙体的整个体积就不可能是纯砖。取而代之的是充满水的空隙（孔隙）。如果把水抽走，就只剩下大约 1476 kg/m3 的砖了。要使部分空隙墙的密度达到 1600 kg/m3，纯砖的密度应更高。

### Thermal Properties

对于任何固体材料，请指定其CONDUCTIVITY（W/(mK)）、DENSITY（kg/m3）、SPECIFIC_HEAT（kJ/(kgK)）和EMISSIVITY[^76-1]（默认为 0.9）。**CONDUCTIVITY 和 SPECIFIC_HEAT 都可以是温度的函数。而DENSITY和EMISSIVITY则不能。**温度依赖性使用 RAMP 约定来指定。举例来说，马氏体是一种适用于高温应用的壁材：

```fortran
&MATL ID = 'MARINITE'
    EMISSIVITY = 0.8
    DENSITY = 737.
    SPECIFIC_HEAT_RAMP = 'c_ramp'
    CONDUCTIVITY_RAMP = 'k_ramp' /
&RAMP ID='k_ramp', T= 24., F=0.13 /
&RAMP ID='k_ramp', T=149., F=0.12 /
&RAMP ID='k_ramp', T=538., F=0.12 /
&RAMP ID='c_ramp', T= 93., F=1.172 /
&RAMP ID='c_ramp', T=205., F=1.255 /
&RAMP ID='c_ramp', T=316., F=1.339 /
&RAMP ID='c_ramp', T=425., F=1.423 /
```

请注意，对于与温度相关的量，RAMP 参数 T 表示温度，F 表示比热或热导率。在这种情况下，MATL 行给出的不是 CONDUCTIVITY 或 SPECIFIC_HEAT，而是 RAMP 名称。

**固体材料的ABSORPTION_COEFFICIENT（1/m）允许辐射穿透并吸收到固体中**。相应地，材料的辐射是基于内部温度，而不仅仅是表面温度。**具有 ABSORPTION_COEFFICIENT 的材料只能用于平面，而不能用于圆柱体或球体**。

### Back Side Boundary Conditions

定义热厚障碍物背面边界条件有几种选择。默认情况下，SURF 行上的 BACKING='EXPOSED'（背面暴露）假定背面暴露在固体后面的热环境中[^8-3]。FDS 会计算热量通过实体传导到墙壁后面的空间，反之亦然。**实体中的热传导计算是基于 SURF 行中指定的材料层厚度**，而不是应用 SURF 的 OBST 或其他实体的尺寸。例如，在对厚度为 5 毫米的钢板建模时，如果因为 5 毫米小于网格尺寸 5 厘米的一半而将 OBST 近似为零单元格厚板，那么 FDS 仍将计算通过 5 毫米厚钢板的传热。如果在尺寸远大于指定THICKNESS的实体上应用 BACKING='EXPOSED' 的SURF，FDS 将忽略 BACKING='EXPOSED'，而应用 BACKING='VOID'。后一种边界条件如下所述。

另一种背面边界条件，BACKING='INSULATED'，假定固体背面是完全隔热的材料，在这种情况下，热量不会损失到背面。**使用该条件意味着无需指定内部隔热材料的属性，因为假定它是完全隔热的**。

**如果假定墙壁始终背向环境，则应设置属性 BACKING='VOID'**。您也可以使用 TMP_GAS_BACK，将背面暴露气体温度设置为环境温度以外的温度。可以使用 RAMP_TMP_GAS_BACK 指定 TMP_GAS_BACK 的 RAMP。背面传热系数通过自然对流相关性计算得出（参见《FDS 技术指南》）。同样，也可以使用 TMP_GAS_FRONT 和斜坡 RAMP_TMP_GAS_FRONT 设置正面气体温度。这主要适用于需要控制曝光温度的诊断情况。

可以通过在 SURF 行中指定 EMISSIVITY_BACK 来控制表面背面的发射率。如果不指定，背面发射率将在模拟过程中以 MATL 发射率的质量加权和来计算。

### Initial Solid Temperature

默认情况下，固体材料的初始温度设置为环境温度（MISC 行的 TMPA）。**使用 SURF 行的 TMP_INNER 可指定不同的固体初始温度。请注意，设置该温度会导致 TMP_FRONT 和/或 TMP_BACK 被覆盖。**还可以使用 RAMP_T_I 指定初始温度曲线，其中斜坡的 T 值为距离工作面的深度（米），F 值为该深度的温度。RAMP_T_I 曲线不能用于三维热传递。

### Walls with Different Materials Front and Back

如果障碍物不在计算域边缘，FDS 将计算通过指定固体THICKNESS的传热，并使用前后两侧的气相温度和热通量作为边界条件。在障碍物的另一侧进行冗余计算。列出的第一层适用于暴露的正面，最后一层适用于反面。例如，SURF 线应用于固体 OBST。在 OBST 的 -x 侧，第 1 层是材料 A，第 2 层是材料 B，第 3 层是材料 A。在 +x 侧，SURF 以同样的方式应用。

```fortran
&SURF ID = 'SYMMETRIC'
    BACKING = 'EXPOSED'
    MATL_ID(1:3,1) = 'MATERIAL A','MATERIAL B','MATERIAL A'
    THICKNESS(1:3) = 0.1,0.2,0.1 /
```

现在来看看下面的 SURF 定义。在 OBST 的 -x 侧，第 1 层为材料 A，第 2 层为材料 B，第 3 层为材料 C；在 +x 侧，SURF 以同样的方式应用，第 1 层为材料 A，第 2 层为材料 B，第 3 层为材料 C。

```fortran
&SURF ID = 'NON-SYMMETRIC'
    BACKING = 'EXPOSED'
    MATL_ID(1:3,1) = 'MATERIAL A','MATERIAL B','MATERIAL C'
    THICKNESS(1:3) = 0.1,0.2,0.1 /
```

指定多层时需要注意。如果分层是对称的，可以在两侧应用同一条 SURF 线。但是，如果分层不对称，则必须创建两条单独的 SURF 线，并分别应用于两侧。例如，一根由钢材制成的空心箱形柱子，外面覆盖了一层绝缘材料，绝缘材料上面又覆盖了一层塑料，那么就必须用以下两条 SURF 线来描述：

```fortran
&SURF ID = 'COLUMN EXTERIOR'
    BACKING = 'EXPOSED'
    MATL_ID(1:3,1) = 'PLASTIC','INSULATION','STEEL'
    THICKNESS(1:3) = 0.002,0.036,0.0063 /
&SURF ID = 'COLUMN INTERIOR'
    BACKING = 'EXPOSED'
    MATL_ID(1:3,1) = 'STEEL','INSULATION','PLASTIC'
    THICKNESS(1:3) = 0.0063,0.036,0.002 /
```

<font color=red>**此外，如果隔热材料和塑料都是可燃的，并且在相应的 MATL 行中指定了它们的燃烧特性，那么就需要说明柱子的哪一侧会产生燃料蒸汽**</font>。在这种情况下，钢是不透气的。如果在标有 "’COLUMN EXTERIOR"的 SURF 行中添加 LAYER_DIVIDE=2.0 参数，则前两层（"PLASTIC"和 "INSULATION"）加热后形成的燃料蒸汽将从该面排出。同样，对于标有 "COLUMN INTERIOR "的 SURF 行，指定 LAYER_DIVIDE=0.0 表示没有燃料蒸汽进入立柱内部。事实上，从 0.0 到 1.0 的值都同样有效，因为材料 "STEEL "不会产生任何燃料蒸汽。

默认情况下，LAYER_DIVIDE（层数分隔）是使用EXPOSED背板的表面的层数的 0.5 倍，与其他表面的层数相等。

****

[^76-1]:定义实体材料成分的各 MATL 行上指定的EMISSIVITY值用于计算前后表面的有效发射率。但是，如果在 SURF 行中指定了 EMISSIVITY 或 EMISSIVITY_BACK，则这些值将优先使用。
[^8-3]:在使用 FDS 之前，边界条件 BACKING='EXPOSED'仅限于零格或一格厚的固体。现在这一限制不再适用。

****

### Specified Internal Heat Source

**凝聚相热传导**方程中有一个源项，用于描述内部的能量源和能量汇。有三种类型的源会对该项产生影响：热解反应热（见第 9.2 节）、内部吸收和辐射发射（见第 9.2.6 节）以及用户指定的热源。**需要指定热源的一个例子是内部电流对电缆的加热**。

在 SURF 行中使用 INTERNAL_HEAT_SOURCE 指定各层的内源项。其单位为 kW/m3，默认值为 0。在下面的示例中，描述电缆的圆柱表面由外层塑料和内层金属芯组成。金属芯的加热功率为 300 kW/m3。

```fortran
&SURF ID = 'Cable'
    THICKNESS = 0.002,0.008
    MATL_ID(1,1) = 'PLASTIC'
    MATL_ID(2,1) = 'METAL'
    GEOMETRY = 'CYLINDRICAL'
    LENGTH = 0.1
    INTERNAL_HEAT_SOURCE = 0.,300. /
```

### Non-Planar Walls and Targets

FDS 中的所有障碍物都被假定为符合直线网格，所有边界面都被假定为平面。然而，许多物体（如电缆、管道和导管）并不是平面。尽管在 FDS 中必须将这些对象表示为 "方框"，但您**仍可以将其作为真正的圆柱形或球形对象进行内部传热计算**。例如，输入线：

```fortran
&OBST XB=0.0,5.0,1.1,1.2,3.4,3.5, SURF_ID='CABLE' /
&SURF ID='CABLE', MATL_ID='PVC', GEOMETRY='CYLINDRICAL', THICKNESS=0.01 /
```

可用于模拟一条长 5 米、横截面为圆柱形、直径为 2 厘米的电力电缆。传热计算仍然是一维的，即假定物体周围存在均匀的热通量。这可能有些令人困惑，因为电缆被表示为横截面为正方形的障碍物，每个面都要进行单独的传热计算，四个面之间没有任何联系。显然，这不是进行固相传热的理想方法，但它确实为气相计算提供了一个合理的边界表面温度。**要对电缆进行更详细的评估，需要进行二维或三维热传导计算，而 FDS 中并不包含这种计算**。

使用 GEOMETRY='SPHERICAL' 来描述球形物体。如果您指定的是圆柱形几何体，并希望确保传热系数适合水平圆柱体，则在 SURF 行添加 HORIZONTAL=T。

### Solid Phase Numerical Gridding Issues

**在固体内部，FDS 在表面法线方向上对一维传热方程进行数值求解**。一般来说，数值求解器的节点间距并不均匀。表面第一个单元的大小会自动选择为小于或等于 $\sqrt{\tau k/\rho c}$，其中$\tau$是时间常数，设置为 1 s，$k/\rho c$ 是热扩散率。默认情况下，节点间距在层中心的密度较小，而在边界的密度较大，以便更好地解析陡峭的温度梯度。

节点间距的默认参数适用于简单的传热计算，**但有时热解反应会引起温度和燃烧速率的虚假波动**。<font color=red>可以通过以下方法提高固相解决方案的数值精度和稳定性</font>：

**使节点间距更均匀**  在 SURF 行上设置 STRETCH_FACTOR(NL)=1，NL 表示特定的层。这将生成一个完全均匀的网格。1 和 2 之间的值会产生不同程度的拉伸。默认值 2 表示第二个单元格的厚度是第一个单元格的两倍，第三个单元格的厚度是第二个单元格的两倍，依此类推，直到达到层的中间深度，此时单元格会按照相同的模式收缩。

**使网格单元更小**  通过设置 CELL_SIZE_FACTOR(NL)小于 1，其中 NL 指定一个特定层。例如，数值为 0.5 时，该层的网格单元大小为原来的一半。

**指定所需的单元格大小**  直接指定 CELL_SIZE(NL)，其中 NL 表示特定层。该**参数优先于** STRETCH_FACTOR 和 CELL_SIZE_FACTOR。

**提高时间分辨率**  <font color=red>在时间行中设置 WALL_INCREMENT=1。这将迫使固相计算每时间步更新一次，而不是默认的每 2 个时间步更新一次</font>。如果这样还不够，可以指示 FDS 使用比气相求解器更小的时间步长更新固相热传导计算。可以使用参数 TIME_STEP_FACTOR（时间步长系数）对选定的表面（SURF）类型进行细分。默认值为 10，这意味着该 SURF 类型的固相时间步长最多可细分为 10 倍。决定细分时间步长的标准是，在该细分步长期间，固体内部温度的变化不应超过 DELTA_TMP_MAX ℃。DELTA_TMP_MAX 的默认值为 10 ℃，这也是一个 SURF 参数。您可以在 DEVC 或 BNDF 输出行中选择 QUANTITY='SUBSTEPS'，查看特定表面单元或整个域分别使用了多少个子步骤。

**限制任何层中的单元数量**  设置 N_LAYER_CELLS_MAX(NL)（默认值为 1000），其中 NL 指定一个特定层。**降低该值不一定能提高精度，但可以节省计算时间。不过，固相很少需要这么多单元格。**输出文件 CHID.out 包含固相节点的坐标。

**Change when a wall cell is renoded**  在 SURF 行设置 RENODE_DELTA_T。如果细胞在热解过程中收缩，FDS 会尝试对壁单元进行重编码，以减少壁节点的数量。如果第一个壁单元和第二个壁单元之间的温差足够大，那么重新编码可能会导致表面温度的大幅波动，从而在热解模型中产生虚假行为。RENODE_DELTA_T 定义了壁单元之间的温差限制，在该限制下 FDS 不会对壁单元进行重编码。默认值为 2 K。

如果所有材料成分都发生反应，并且没有固体残留，固体的厚度就会缩小。当收缩层的厚度小于规定的极限值时，每个收缩层都将从计算中消失。可以使用 MINIMUM_LAYER_THICKNESS(N)（N 为层索引）在 SURF 行上设置该值。如果没有指定层索引，则该值将应用于所有层。默认值为 0.0001 米或指定厚度的 0.1 倍，以较小者为准。当收缩表面的所有材料都已消耗但 BURN_AWAY 未规定时，表面温度将设为 TMP_GAS_BACK，对流热通量设为零，燃烧速率设为零。

**检查和提高固相计算精度的方法见第9.3节。**

### Specified Front and Back Surface Temperature

如果固体障碍物的热厚度较厚，通常不需要指定其表面温度，因为表面温度应根据固体的热通量和内部热渗透情况自行确定。不过，在某些情况下可能需要这样做。例如，在测试热传导算法时，就需要使用指定边界温度的典型分析方案。示例如下

```fortran
&SURF ID='...', MATL_ID='...', TMP_FRONT=500., TMP_BACK=20., THICKNESS=0.01 /
```

这条线将 1 厘米厚平板的正面温度固定为 500 ℃，背面温度固定为 20 ℃。您无需指定两个表面的温度。如果障碍物的背面暴露在外，则需要为背面指定另一个具有相反边界条件的 SURF。可以使用斜坡 RAMP_T 和 RAMP_TMP_BACK，分别改变正面和背面的温度。

## 3-D Heat Conduction (Beta)

**FDS 中使用的 1-D 热传导模型适用于大多数导热系数相对较低的建筑材料，即隔热材料**。然而，钢材等材料的导热系数相对较高，因此可能不适合使用 1-D 传导模型。FDS 具有有限的三维热传导能力，适用于横向热传递可能很重要的钢结构或其他固体物体。**FDS 中的三维传导算法使用了一维求解器。每隔三个固相时间步，三个坐标方向之一的温度都会及时更新，在每个时间步之间，更新后的温度场会转移到其他两个方向**。这样，三维温度场在三次调用固相求解器的过程中得到更新。

### Basics

在三维算法中，构成固体的每个障碍物（OBST）都假定由不同材料（MATL）的混合物组成。可以通过多个障碍物构建多层，但这些障碍物会被固定在气相网格上。因此，您无法像使用一维求解器那样指定任意厚度的层。

**要调用三维求解器，请在 SURF 行中指定 HT3D=T**，如本例所示：

```fortran
&SURF ID='STEEL SLAB', HT3D=T, COLOR='BLACK' /
&OBST XB= 0.08, 0.12,-0.12,-0.08,-0.07, 0.17, SURF_ID='STEEL SLAB', MATL_ID='STEEL' /
&MATL ID='STEEL', DENSITY=7500, SPECIFIC_HEAT=0.5, CONDUCTIVITY=50 /
```

**用于控制固相网格划分的参数通常在 OBST 行而不是 SURF 行给出**。在本例中，MATL_ID 指定在 OBST 行。您可以使用参数 CELL_SIZE (m) 指定间距均匀的网格，也可以使用参数 STRETCH_FACTOR 和 CELL_SIZE_FACTOR 拉伸网格。您还可以使用 N_LAYER_CELLS_MAX 来限制网格单元的数量。这些参数在第 8.3.8 节中有解释，但在 OBST 行中指定时，这些参数是标量，指的是由特定障碍物形成的单层。如果未在 OBST 行中指定这些参数，它们将取自 SURF 行中指定的第一个层；如果未在 SURF 行中指定这些参数，它们将取自第 8.3.8 节中列出的默认值。

您可以在 OBST 行中使用 INTERNAL_HEAT_SOURCE 指定固体障碍物的内部源。其单位为kW/m3，默认值为零。

### Limitations

1. HT3D 不能应用于外部边界；它必须应用于在每个坐标方向上至少有一个面暴露的 OBST。
2. **避免三维实体和一维实体接触**。如果三维实体的两侧接触到一维实体，在该特定方向上将不会计算横向热传导。
3. 如果您的三维障碍物超出了相邻网格的范围，FDS 会使用一种特殊算法来识别该障碍物所在的所有网格以及与之相连的障碍物。但是，如果该算法无法检测到所有网格，并出现错误提示，请在 "MISC"行添加参数 NEIGHBOR_SEPARATION_DISTANCE。在此距离内的任何网格都将共享几何信息，用于三维热传导计算。如果将此参数设置为大于计算域宽度的值，则所有网格都将建立用于交换边界信息的通信通道。
4. 默认情况下，内部节点集中在表面附近，并向实体深处延伸。如果希望保持均匀的间距，请在 SURF 或 OBST 行设置 CELL_SIZE，以指示所需的内部节点间距。CELL_SIZE 通常与气相单元相当。如果障碍物很薄，即厚度小于一个气相单元，则指定的 CELL_SIZE 仅适用于横向而非法向的热传导。法线方向的网格划分将由参数 STRETCH_FACTOR 和 CELL_SIZE_FACTOR 控制。如果指定的 CELL_SIZE 太粗，无法解决沿法线方向表面定义的变化，这将非常有用（示例见第 8.4.4 节）。

**示例:钢组件**

图 8.1 显示了一个简单的测试案例，其中钢组件被一个小的热物体加热。右图表明，表面的净热通量等于固体吸收的热量：
$$
\int_0^t\int_{\partial\Omega}\dot{q}_\mathrm{net}^{\prime\prime}\mathrm{~d}S\mathrm{~d}t^{\prime}=\int_\Omega\rho_\mathrm{s}c_\mathrm{s}\Delta T_\mathrm{s}\mathrm{~d}V
$$
上式左侧的积分在FDS中使用device线求值:

```fortran
&DEVC ID='...', XB=..., QUANTITY='NET HEAT FLUX', SURF_ID='STEEL SLAB'
    SPATIAL_STATISTIC='SURFACE INTEGRAL', TEMPORAL_STATISTIC='TIME INTEGRAL' /
```

XB 所包含的体积包括整个组件。右侧积分的计算公式为

```fortran
&DEVC ID='...', XB=..., QUANTITY='WALL ENTHALPY', IOR=3, SURF_ID='STEEL SLAB'
    SPATIAL_STATISTIC='SURFACE INTEGRAL', RELATIVE=T, CONVERSION_FACTOR=10000, /
```

**"壁面焓"量是壁面单元从正面到背面所形成的体积内的总能量**。这就是为什么要包含 IOR 的原因，因为只需对朝上的壁细胞进行积分。此外，:question:由于与该量相关的单位是 kJ 而不是 kJ/m2，因此需要 CONVERSION_FACTOR 来抵消求和后每个壁单元的面积（0.01 米乘 0.01 米）。**参数 RELATIVE=T 表示只需要焓的变化**。

![image-20240716101658649](/image-20240716101658649.png)

**示例:未保护的结构钢**

工字钢等钢结构构件很难建模，原因有二。首先，底层网格必须具有相当高的分辨率，以捕捉横截面形状；其次，横向热传递可能非常重要。在最佳情况下，工字钢通常被建模为代表腹板和翼缘板的薄型（即零单元厚度）障碍物的集合。

```fortran
&OBST XB=0.12,1.88,0.51,0.53,0.21,0.79, SURF_ID='STEEL SLAB' / Web
&OBST XB=0.12,1.88,0.41,0.63,0.76,0.79, SURF_ID='STEEL SLAB' / Upper Flange
&OBST XB=0.12,1.88,0.41,0.63,0.21,0.24, SURF_ID='STEEL SLAB' / Lower Flange
&SURF ID='STEEL SLAB', MATL_ID='STEEL', HT3D=T, COLOR='BLACK', CELL_SIZE=0.1 /
```

![image-20240716102701740](/image-20240716102701740.png)

### Surface Linings

在某些应用中，您可能希望在相邻的障碍物集合内执行三维热传导，每个障碍物都有一个 MATL_ID。这些障碍物可能有一些外层衬里，例如沙发垫上的布料，这种衬里比单个气相网格单元还要薄。换句话说，**这种内衬材料不能用 OBST 表示**。不过，您可以使用 MATL_ID、MATL_MASS_FRACTION 和 SURF 线的厚度来指定一层或多层多组分材料，这些材料也会分配给具有指定 MATL_ID 和 MATL_MASS_FRACTION 的 OBST。

处理衬垫的方式取决于障碍物的大小。如果障碍物是一个深度小于二分之一网格单元的平板，并且表示为零单元的厚板，那么任何层材料都会被假定为增加了底板的厚度。例如，如果一块钢板的厚度为 1 厘米，并假定其两侧涂有 2 厘米厚的隔热层，那么从气相计算的角度来看，该组件仍被视为薄板，但在传热计算中，其深度被视为 5 厘米。

另一方面，如果实体是由非薄板的障碍物组成，衬里材料会取代底部实体的体积。例如，以下输入行定义了一个由钢材制成的单个障碍物，该障碍物内衬两层由三种不同成分组成的隔热材料：

```fortran
&OBST XB=-0.20, 0.20,-0.20, 0.20,-0.05, 0.05, SURF_ID='SLAB', MATL_ID='STEEL' /
&SURF ID='SLAB', HT3D=T, COLOR='BEIGE', THICKNESS=0.003,0.002,
    MATL_ID(1,1:2)='STUFF A','STUFF B', MATL_MASS_FRACTION(1,1:2)=0.3,0.7,
    MATL_ID(2,1:2)='STUFF B','STUFF C', MATL_MASS_FRACTION(2,1:2)=0.2,0.8 /
&MATL ID='STUFF A', DENSITY= 50, SPECIFIC_HEAT=1.0, CONDUCTIVITY=0.1 /
&MATL ID='STUFF B', DENSITY= 80, SPECIFIC_HEAT=1.5, CONDUCTIVITY=0.2 /
&MATL ID='STUFF C', DENSITY= 30, SPECIFIC_HEAT=2.5, CONDUCTIVITY=0.3 /
&MATL ID='STEEL', DENSITY=7500, SPECIFIC_HEAT=0.5, CONDUCTIVITY=50. /
```

生成的实体与您指定的实体尺寸相同，但有 5 毫米的表面材料被指定的 "材料 "层取代。

**示例:绝缘结构钢**

隔热钢梁可以作为一维和三维物体的混合模型。通过隔热层传导的热量主要沿表面法线方向变化，而沿着钢梁传导的热量主要沿横向方向变化。下面的线条提供了一个钢板涂有隔热层的示例。钢板作为一个相对较薄的障碍物进入，隔热层通过一条 SURF 线涂在钢板的两侧。后一个参数可确保在计算实体重叠体积时包含薄钢板障碍物和隔热层障碍物。请注意，所有尺寸都必须精确，以确保正确计算重叠体积。

```fortran
&OBST XB=..., SURF_ID='INSULATION', MATL_ID='STEEL', CELL_SIZE=0.1 /
&SURF ID='INSULATION', MATL_ID='STUFF', COLOR='BEIGE', THICKNESS=0.01, HT3D=T /
```

请注意，**CELL_SIZE 指的是横向传热**。隔热层和薄钢板法线方向的传热将根据表面线 "INSULATION "上的参数进行网格划分。

### Working with Thin Plates

名为 Heat_Transfer/checkerboard.fds 的示例案例演示了如何使用薄钢板。请看以下输入行：

```fortran
&MATL ID='steel', SPECIFIC_HEAT=0.515, CONDUCTIVITY=16.2, DENSITY=7900 /
&SURF ID='paint', COLOR='BLACK', EMISSIVITY=0.95, HT3D=T /
&SURF ID='no paint', COLOR='SILVER', EMISSIVITY=0.33, HT3D=T /
&OBST XB=0.00,1.20,0.00,0.0031,0.00,1.20, MATL_ID='steel', SURF_ID='no paint' /
&VENT XB=0.00,0.05,0.0000,0.0000,0.00,0.05, SURF_ID='paint', MULT_ID='M', IOR=-2 /
&VENT XB=0.00,0.05,0.0031,0.0031,0.00,0.05, SURF_ID='paint', MULT_ID='M', IOR= 2 /
&VENT XB=0.05,0.10,0.0000,0.0000,0.05,0.10, SURF_ID='paint', MULT_ID='M', IOR=-2 /
&VENT XB=0.05,0.10,0.0031,0.0031,0.05,0.10, SURF_ID='paint', MULT_ID='M', IOR= 2 /
&MULT ID='M', DX=0.10, DZ=0.10, I_UPPER=11, K_UPPER=11 /
```

有一个薄薄的 OBSTstruction，厚 3.1 毫米，长 1.2 米，宽 1.2 米。气相网格尺寸为 25 毫米，远大于板的厚度。**从气相流体求解器的角度来看，这块板只是一个屏障，没有厚度。但是，三维热传导求解器考虑到了它 3.1 毫米的厚度**。钢板的 MATL_ID 为 "steel"，并使用 SURF_ID="no paint "设置了默认的表面属性。这个 SURF_ID 调用了三维求解器，并指定了一种颜色和 0.33 的EMISSIVITY。如果没有指定EMISSIVITY，则会采用 "steel"的EMISSIVITY，在这种情况下，默认值为 0.9。VENT将 "黑色 "或高发射率方格的棋盘图案应用到平板上。图 8.3 显示了模拟图像以及内焓和净热通量的对比图。

![image-20240716104445833](/image-20240716104445833.png)

### 1-D Heat Conduction in Solids of Varying Thickness

有些情况不需要三维热传导，但没有明确的厚度，而默认的一维热传导算法需要明确的THICKNESS。在这种情况下，实体可能有不同厚度的不同层。在这种情况下，无需在 SURF 行指定THICKNESS或 MATL_ID。相反，您可以在构成实体的障碍物 (OBST) 上指定 MATL_ID。多个障碍物可用于创建多个层，每个层可通过 MATL_ID(:) 和 MATL_MASS_FRACTION(:) 指定一个或多个材料成分。**与在 SURF 行中指定这些参数的方式不同，单一索引代表的是材料成分，而不是层**。例如，请看这些输入行：

```fortran
&SURF ID='SKIN', COLOR='BLACK', VARIABLE_THICKNESS=T /
&OBST XB=0.2,0.8,0.2,0.8,0.2,0.8, SURF_ID='SKIN',
    MATL_ID='Steel','Aluminum', MATL_MASS_FRACTION=0.8,0.2 /
&HOLE XB=0.3,0.7,0.3,0.7,0.3,0.7 /
&OBST XB=0.3,0.7,0.3,0.7,0.3,0.7, PERMIT_HOLE=F,
    MATL_ID='Aluminum', MATL_MASS_FRACTION=1. /
```

SURF 线仅用于将表面涂成黑色，并通过参数 VARIABLE_THICKNESS（可变厚度）表明，层厚度和材料成分将通过构成实体的 OBST 传达。在本例中，固体是一个 0.6 米的立方体，由钢和铝组成，:question:**空心部分由纯铝组成**。如上所述，材料属性通过 MATL 线进行传递。

# Fire and Pyrolysis

FDS 有几种描述固体和液体热解的方法。采用哪种方法主要取决于材料属性的可用性和底层热解模型的适当性。请注意，<font color=red>**FDS 中的所有热解模型都要求您明确定义气相反应。详见第 13 章。一个给定的面一次只能使用一个热解模型**</font>。

## Specified Heat Release Rate

**固体和液体燃料可通过 MATL namelist 组指定其相关属性来建模**。然而，简单地获得给定热释放率(HRR)的火灾不需要材料特性。指定的火灾被模拟为气体燃料从固体表面或通风口喷出。这本质上是一个燃烧器，具有指定的单位面积热释放率（HRRPUA），单位为 kW/m2。例如

```fortran
&SURF ID='FIRE', HRRPUA=500. /
```

将 500 kW/m2 应用于属性 SURF_ID='FIRE' 的任何表面。**请参阅第 11 章中有关随时间变化的量的讨论，了解如何提高或降低热释放率**。

MLRPUA 是 HRRPUA 的替代参数，其功能完全相同，但该参数指定**单位面积内燃料气体的质量损失率**，单位为 kg/（m2 s）。请勿在同一 SURF 行中同时指定 HRRPUA 和 MLRPUA。

如果指定了 HRRPUA 或 MLRPUA，但未给出 SPEC_ID，则 FDS 将使用第一个 REAC 输入的燃料。如果只给出一个 SPEC_ID，则 FDS 将使用该 SPEC_ID 作为燃料。只有当该物种只在一个 REAC 输入中用作燃料时，才可以这样做；否则将使用 SPEC_ID 和 MASS_FLUX。如果给出多个 SPEC_ID 和 MASS_FRACTION，则 FDS 将假定 HRRPUA 或 MLRPUA 仅指与 REAC 行中的 FUEL 输入相对应的物种。对于 MLRPUA，FDS 将用 MLRPUA 乘以燃料种类的 MASS_FRACTION，以获得燃料种类的质量通量。如果存在任何非燃料种类，则这些种类的质量通量将被设置为保留其指定的 MASS_FRACTION。**对于 HRRPUA，FDS 将计算所有燃料种类的平均燃烧热。**该平均燃烧热用于定义燃料种类的质量通量，即有效的 MLRPUA。非燃料种类的处理方法与 MLRPUA 相同。

在下面的示例中，使用 HRRPUA 的四个不同表面使用了六种燃料。**其中四种燃料的相关 REAC 输入中没有 HEAT_OF_COMBUSTION；它们的燃烧热可通过其形成热来确定**。一种燃料的 REAC 输入值上有 HEAT_OF_COMBUSTION。第六种燃料是用户自定义的，用于 REAC 时没有 HEAT_OF_COMBUSTION。其燃烧热可使用 EPUMO2 测定。表面 S1 有 HRRPUA，但没有 SPEC_ID；因此，它将使用第一个 REAC 输入（METHANE）的FUEL种类。S1 的燃料质量通量将由 HRRPUA 除以 METHANE 燃烧热得出。表面 S2 指定燃料种类为 MYFUEL。表面 S3 将使用 MASS_FLUX 计算总质量通量，即PROPANE和ETHANE燃烧热的加权平均值。表面 S4 将使用 MYFUEL2 燃料，其燃烧热将是使用 SPEC 输入的 MASS_FRACTION 计算的TOLUENE和HYDROGEN燃烧热的加权平均值。结果如图 9.1 所示。

```fortran
&SPEC ID='TOLUENE',LUMPED_COMPONENT_ONLY=T/
&SPEC ID='HYDROGEN',LUMPED_COMPONENT_ONLY=T/
&SPEC FUEL='MYFUEL',C=1,H=1,O=1/
&SPEC ID='MYFUEL2',SPEC_ID='TOLUENE','HYDROGEN',MASS_FRACTION=0.5,0.5/
&REAC FUEL='METHANE'/
&REAC FUEL='PROPANE'/
&REAC FUEL='ETHANE',HEAT_OF_COMBUSTION=40000/
&REAC FUEL='MYFUEL2'/
&SURF ID='S1',COLOR='RED',HRRPUA=1000/
&SURF ID='S2',COLOR='ORANGE',HRRPUA=1000,SPEC_ID='MYFUEL'/
&SURF ID='S3',COLOR='YELLOW',HRRPUA=1000,SPEC_ID='PROPANE','ETHANE',
    MASS_FRACTION=0.2,0.8/
&SURF ID='S4',COLOR='GREEN',HRRPUA=1000,SPEC_ID='MYFUEL2'/
```

如果第二个面指定为:

```fortran
&SURF ID='S2',COLOR='ORANGE',HRRPUA=1000,SPEC_ID='MYFUEL','NITROGEN',
    MASS_FRACTION=0.25,0.75/
```

那么燃料的质量通量将与之前相同，但现在它将被三倍的NITROGEN质量通量稀释。

![image-20240716113042791](/image-20240716113042791.png)

### A Radially-Spreading Fire

**有时需要模拟以某种特定速度径向蔓延的火灾**。与其试图获取材料特性来直接模拟火灾的点燃和蔓延，不如直接指定火灾蔓延速度。首先，添加一条具有指定热释放率 HRRPUA 的 SURF 线，并添加任何所需的可选时间历史参 数 RAMP_Q 或 TAU_Q（见第 11.1 节）。然后，在VENT或同一SURF线上指定 XYZ 和 SPREAD_RATE。火势将从 XYZ 点（如果未指定，默认为 VENT 的中心点）开始，以 SPREAD_RATE （米/秒）的速度径向蔓延。可选的 HRR 斜坡上升从火势到达指定点时开始。例如

```fortran
&SURF ID='FIRE', HRRPUA=500.0, RAMP_Q='fireramp' /
&RAMP ID='fireramp', T= 0.0, F=0.0 /
&RAMP ID='fireramp', T= 1.0, F=1.0 /
&RAMP ID='fireramp', T=30.0, F=1.0 /
&RAMP ID='fireramp', T=31.0, F=0.0 /
&VENT XB=0.0,5.0,1.5,9.5,0.0,0.0, SURF_ID='FIRE', XYZ=1.5,4.0,0.0, SPREAD_RATE=0.03 /
```

通过VENT线创建一个矩形区域，火从（1.5,4.0,0.0）点开始，以 0.03 米/秒的速度向外蔓延。当火势向外蔓延时，每个表面单元燃烧 30 秒，形成一个不断扩大的火环。请注意，RAMP_Q 用于打开和关闭燃烧，以模拟火势径向蔓延时的燃料消耗。不应该用它来模拟 t 平方的火势增长速度--本练习的目的就是以更自然的方式模拟这种曲线。最终，当火圈越过矩形边界时，火会熄灭。可能需要进行一些反复试验，才能找到可以获得所需热释放率时间历史的 SPREAD_RATE。

**如果火势蔓延的区域是一个矩形平面，可直接在 SURF 线上指定 XYZ 和 SPREAD_RATE**，然后将该 SURF 线应用于希望火势蔓延的障碍物或颗粒上。当材料的详细属性未知，或直接模拟固体燃料的热解所产生的不确定性过大时，这种方法可用于模拟火灾在杂乱空间中的蔓延。

如果模拟的起始时间 T_BEGIN 不为零，请注意径向蔓延火灾的默认起始时间是 T_BEGIN，而不是零。这也适用于 TAU_Q，但不适用于 RAMP_Q。由于这可能会引起混淆，如果您在非零时间开始计算，请进行快速测试，以确保斜坡或火势蔓延的行为符合预期。

### Compensating for the unresolved surface area

如果热解模型中的障碍物或通风口所代表的物体形状比矩形框更复杂，或者**网格解析度无法解析实际表面积**，则在 SURF 行上添加参数 AREA_MULTIPLIER，可以用一个恒定系数手动调整燃烧速率。默认值为 1.0。该系数还将影响物体与气相之间的热传递速率。

### Thermally-Thick Solids that Burn at a Specified Rate

**真实物体，如家具、办公设备等，通常很难通过 SURF 和 MATL 参数来描述**。有时，关于给定物体的唯一信息就是它的体热特性(bulk thermal properties)、"点火 "温度以及随后的燃烧速率与点火时间的函数关系。在这种情况下，请添加类似下面的行：

```fortran
&MATL ID = 'stuff'
    CONDUCTIVITY = 0.1
    SPECIFIC_HEAT = 1.0
    DENSITY = 900.0 /
&SURF ID = 'my surface'
    COLOR = 'GREEN'
    MATL_ID = 'stuff'
    HRRPUA = 1000.
    IGNITION_TEMPERATURE = 500.
    RAMP_Q = 'fire_ramp'
    THICKNESS = 0.01 /
&RAMP ID='fire_ramp', T= 0.0, F=0.0 /
&RAMP ID='fire_ramp', T= 10.0, F=1.0 /
&RAMP ID='fire_ramp', T=310.0, F=1.0 /
&RAMP ID='fire_ramp', T=320.0, F=0.0 /
```

一个表面属性由 "my surface"定义的物体，在其表面温度达到 500℃ "点火 "后，**经过 10 秒的线性上升，燃烧速率应为 1000 kW/m2**。请注意**，RAMP 中的时间 T 是指从点火开始的时间，而不是从模拟开始的时**间。还请注意，<font color=red>现在 "点火温度 "是表面属性，而不是材料属性</font>。

**表面点燃后，进入固体的热量传递仍在计算中，但燃烧速率与表面温度之间没有耦合关系**。因此，表面温度可能会升高过多。<font color=red>为了计算固体燃料汽化造成的能量损失，可以为表面指定 HEAT_OF_VAPORIZATION</font>。例如，当使用下面的线条时，材料表面的总热流量将减少 1000 kJ/kg 乘以瞬时燃烧速率。

```fortran
&SURF ID = 'my surface'
    COLOR = 'GREEN'
    MATL_ID = 'stuff'
    HRRPUA = 1000.
    IGNITION_TEMPERATURE = 500.
    HEAT_OF_VAPORIZATION = 1000.
    RAMP_Q = 'fire_ramp'
    THICKNESS = 0.01 /
```

最后，如果**希望在表面温度低于指定值时停止燃烧，请在 SURF 行设置 EXTINCTION_TEMPERATURE**。该值应小于或等于 IGNITION_TEMPERATURE。

参数 HRRPUA、IGNITION_TEMPERATURE、EXTINCTION_TEMPERATURE 和 HEAT_OF_VAPORIZATION 都是在**告诉 FDS，您希望自己控制燃烧速度**，但仍希望模拟燃料的加热和 "点火"。当这些参数出现在 SURF 行时，它们是协同作用的。如果 HRRPUA 单独出现，表面将在模拟开始时开始燃烧，就像一个引燃器。如果添加 IGNITION_TEMPERATURE（点火温度），则会延迟燃烧，直到达到指定温度。添加 HEAT_OF_VAPORIZATION 后，FDS 将计算燃料汽化所消耗的能量。对于这些选项中的任何一个，**如果一个 MATL 行是由包含指定 HRRPUA 的 SURF 行调用的，那么该 MATL 行应该只有热属性**。该 MATL 行不应该有反应参数、产物产量等，如前几节所述。**通过指定 HRRPUA，可以控制燃烧速率，而不是让材料根据周围环境条件进行热解**。另外需要注意的是，这个简单模型假定固体像典型的热塑性材料一样，即在表面附近热解，留下相对较少的焦炭。

### Scaling Pyrolysis (SPyro) Model: Scaled Burning Rate from Cone Data

FDS 有一个简单的基于比例的热解模型 (Spyro)，可将从锥形量热计或类似装置收集到的燃烧率数据按比例转换成不同的材料厚度，并考虑 FDS 模拟过程中的动态热反馈。该模型的输入与第 9.1.3 节类似，但增加了一些参数。该模型常用的参数有

`HRRPUA`(必填）SURF 的指定单位面积热释放率 (HRRPUA)，乘以 RAMP_Q。通常情况下，该模型的 HRRPUA 设置为 1.0 kW/m2。

`IGNITION_TEMPERATURE`(必填）指定材料的点火温度（摄氏度）。

`INERT_Q_REF`指定测试数据是否代表惰性测试设备，**在该设备中发生热解而不燃烧**。如果提供的是实验数据数组，则该标记适用于所有指定的测试数据。(默认为 False）

`RAMP_Q`(必填） 指定包含实验数据的 RAMP 的 ID，T 为时间，F 为测得的 HRRPUA（千瓦/平方米）。应调整试验数据，使斜坡中的 0 s 代表样品在试验中开始燃烧/热解的时间。

`REFERENCE_HEAT_FLUX`(必填）指定热解开始前测试设备施加到样品上的辐射热流量（千瓦/平方米），即水冷式热流量计所测量的值。

`REFERENCE_THICKNESS`指定实验中样品的厚度。如果没有指定，FDS 将假定实验厚度与 SURF 行定义的THICKNESS(1)相同。请注意，这只是试样的可燃部分，不包括任何隔热材料或其他惰性背衬材料。(默认厚度（1）)

:question:通过指定 REFERENCE_HEAT_FLUX、RAMP_Q 和 REFERENCE_THICKNESS 数组，最多可指定十个实验的数据。如果提供了多个实验的数据，当入射热通量在测试数据范围内时，FDS 将在实验数据之间进行内插。REFERENCE_HEAT_FLUX 和 REFERENCE_THICKNESS 的值必须按每组厚度中通量增加时厚度增加的方式分组。通常情况下，在获取样品进行锥形测试时，由于制造或样品制备的原因，厚度会略有不同。如果在一组测试中，参考热膨胀系数值是用于相同的厚度，则参考厚度应指定为相同的标称值。

还可以使用其他可选参数来调整模型行为，详情如下。

`MAXIMUM_SCALING_HEAT_FLUX`默认情况下，模型不会对用于缩放测试数据的预测热通量设置上限（默认为 100,000 kW/m2）。

`MINIMUM_SCALING_HEAT_FLUX`默认情况下，模型不会对用于缩放测试数据的预测热通量设置下限。在某些情况下，如粗网格上的微弱燃烧源，其热反馈分辨率可能较低（默认值为 0 kW/m2），为用于缩放的通量设置下限可能有助于模型预测。

`REFERENCE_HEAT_FLUX_TIME_INTERVAL`FDS 中的瞬时热反馈在不同的时间步长之间会有很大差异。在实际火灾中，**燃烧速率与样本温度息息相关**，**而热惯性意味着燃烧速率的变化比瞬时流量更慢**。通过使用 REFERENCE_HEAT_FLUX_TIME_INTERVAL 设置平滑窗口（默认为 1 秒），可以近似实现这种自然平滑。

演示缩放行为的示例 spyro_cone_demo.fds 如图 9.2 所示。在这个示例中，材料的锥体测试数据分别为 25、50 和 75 kW/m2。仅使用 50 kW/m2 时，样品暴露在 25、50 和 75 kW/m2 的通量下。可以看出，在 25 kW/m2 时，测试数据在时间上被拉长了 2 倍，燃烧率降低了 2 倍。同样，在 75 kW/m2 时，曲线被拉长了 50%，燃烧率提高了 50%。50 kW/m2 只返回测试数据曲线。第四个表面建模使用的是 25 和 75 kW/m2，样品暴露在 50 kW/m2 的通量下。得出的燃烧速率是 25 和 75 kW/m2 测试数据的平均值。外推法和内插法都不能完美地再现测试数据；但是，它们确实捕捉到了燃烧持续时间、峰值燃烧速率和峰值时间方面的一般行为。

![image-20240717093919110](/image-20240717093919110.png)

## Complex Pyrolysis Models

本节介绍固态材料燃烧时发生反应的参数。在阅读本节之前，强烈建议您阅读一些有关固相热解的背景材料，例如 Witkowski、Stec 和 Hull 所著的《Thermal Decomposition of Polymeric Materials》或 Torero 所著的《Flaming Ignition of Solid Fuels》，这两本书都收录在第 5 版的《SFPE Handbook of Fire Protection Engineering》中。

### Reaction Mechanism

FDS 中的实体表面可以由多层组成，每层有多个材料成分。材料成分通过 MATL 线描述，并在描述固体结构的 SURF 线上指定。每个 MATL 可在不同温度下发生多种反应。也可能不发生任何反应，而只是升温。但是，如果要通过一个或多个反应来改变形态，请用整数 N_REACTIONS 指定反应次数。必须设置 N_REACTIONS，否则 FDS 将忽略所有与反应相关的参数。请注意，多重反应的实验证据并不意味着单一材料正在进行多重反应，而是多种材料成分正在不同的温度下进行单独的反应。目前，每种材料的最大反应次数为 10 次，连续反应链最多可包含 20 个步骤。

:question:(<font color=red>这里的i，j定义和前面的MATL_ID定义不同？</font>)对于给定的材料，第 j 个反应可以产生其他固体材料（其名称用 MATL_ID(i,j)表示）、气体种类（其名称用 SPEC_ID(i,j)表示）和粒子（其粒子类别用 PART_ID(i,j)表示）。请注意，索引 i 的范围是从 1 到材料、气体种类或粒子类别的数量。该索引与输入文件中 MATL 或 SPEC 行的排列顺序并不一致。对于给定的反应，固态、气态或颗粒状产物的相对数量通过产量输入 FDS： 分别为 NU_MATL(i,j)、NU_SPEC(i,j) 和 NU_PART(i,j)。默认情况下，收益率均为零。如果 NU_MATL(i,j)非零，则必须通过 MATL_ID(i,j)（输入文件中还列出了另一个 MATL 的 ID）来说明固体残余物是什么。如果 NU_SPEC(i,j)非零，则必须通过 SPEC_ID(i,j)（输入文件中也列出的另一个 SPEC 的 ID）来说明气体种类。如果 NU_PART(i,j)非零，则必须通过 PART_ID(i,j)（输入文件中还列出了另一个 PART 的 ID）来说明粒子类别。如果指定了粒子，则粒子的插入率和数量由包含材料的 SURF 上的粒子输入控制。**理想情况下，产率之和应等于 1，这意味着反应物的质量是守恒的。不过，在某些情况下，产率之和小于 1 也是很方便的**。例如，混凝土的剥落或烧蚀可以说是一种消耗能量但不产生任何 "产物 "的 "反应"，因为混凝土被假定为大块从表面脱落或粉化。在该模型中，混凝土的质量是不守恒的，因为它基本上已经从该特定表面消失了。产生更多质量（产质量大于 1）将导致错误信息。

为保持一致性，也可为每个反应 j 中的每个物种 i 指定 HEAT_OF_COMBUSTION(i,j)。请注意，此处讨论的燃烧热（i,j）并不一定与气相燃烧所用代用FUEL（如 "PROPANE"）的燃烧热相同。当燃烧热不同时，将调整气相中代用FUEL的质量通量，以获得正确的热释放率。下一节将对此进行进一步讨论。

在下面的示例中，木材的热解被包含在使用有限速率反应而非默认混合控制模型的模拟中。请注意，本例中明确定义了所有气体种类（背景氮气除外），因此 FDS 需要明确告知固相反应会产生哪些气体种类。在本例中，82% 的木材转化为气态 "PYROLYZATE"，18% 转化为固态 "CHAR"。

```fortran
&SPEC ID = 'PYROLYZATE', MW=53.6 /
&SPEC ID = 'OXYGEN', MASS_FRACTION_0 = 0.23 /
&SPEC ID = 'WATER VAPOR' /
&SPEC ID = 'CARBON DIOXIDE' /

&MATL ID = 'WOOD'
    EMISSIVITY = 0.9
    CONDUCTIVITY = 0.2
    SPECIFIC_HEAT = 1.3
    DENSITY = 570.
    N_REACTIONS = 1
    A(1) = 1.89E10
    E(1) = 1.51E5
    N_S(1) = 1.0
    MATL_ID(1,1) = 'CHAR'
    NU_MATL(1,1) = 0.18
    SPEC_ID(1:4,1) = 'OXYGEN','WATER VAPOR','CARBON DIOXIDE','PYROLYZATE'
    NU_SPEC(1:4,1) = 0,0,0,0.82
    HEAT_OF_REACTION(1) = 430.
    HEAT_OF_COMBUSTION(4,1)= 14500. /
```

请注意，在这种情况下不需要与参数相关的指数，但显示这些指数是为了强调，一般来说，可以有多个反应具有相应的动力学参数和产物。

### Reaction Rates

材料成分 i 的单位体积质量$\rho_{s,i}(x,t)$是固体深度 x 和时间 t 的函数。它随着时间的推移如下式所示：
$$
\frac{\partial\rho_{{\mathrm{s},i}}}{\partial t}=-\sum_{j=1}^{{N_{{\mathrm{r},i}}}}r_{ij}+\sum_{{i^{\prime}=1}}^{{N_{{\mathrm{m}}}}}\sum_{j=1}^{{N_{{\mathrm{r},i^{\prime}}}}}\nu_{{\mathrm{s},i^{\prime}j}}r_{{i^{\prime}j}}\quad(i^{\prime}\neq i) \label{9.1}\tag{9.1}
$$
其中，
$$
r_{ij}=A_{ij}\rho_{{\mathrm{s},i}}^{{n_{{\mathrm{s},ij}}}}T_{{\mathrm{s}}}^{{n_{{\mathrm{t},ij}}}}\exp\left(-\frac{E_{ij}}{RT_{{\mathrm{s}}}}\right)X_{{\mathrm{O}_{2}}}^{{n_{{\mathrm{O}_{2},ij}}}}\label{9.2}\tag{9.2}
$$
术语 $r_{i j}$ 定义了正在进行第 j 个反应的第 i 种材料在温度 Ts 下的反应速率。方程$\eqref{9.1}$右侧的第二项表示其他材料对第 i 种材料产生的残留物，其产量为 $V_{\mathrm{s},i^{\prime}j}$。在第 i′ 个 MATL 行上，该术语用 NU_MATL(:,j) 表示。$\rho_{s,i}$是层中第 i 种物质成分的密度，定义为第 i 种物质成分的质量除以层的体积。因此，$\rho_{s,i}$是一个量，如果第 i 种材料成分作为其他反应的残留物产生，则$\rho_{s,i}$会增大；如果第 i 种材料成分分解，则$\rho_{s,i}$会减小。 $n_{s,ij}$是反应阶次，以 N_S(j)命名，默认为 1。如果不知道 ns 的值，假设其为 1 也是一个很好的起点。 $n_{t,j}$的名称为 N_T(j)。默认情况下，nt, j 为 0。

指前因子 $A_{i j}$ 在第 i 种材料的 MATL 行中以 A(j)的名称表示，单位为 $s^{-1}$。$E_{i j} $是活化能，通过 E(j) 进行计算，单位为 J/mol。请记住 1 千卡等于 4.184 千焦，并注意系数 1000。**对于给定反应，请指明 A 和 E，或两者都不指明**。不要只指定这两个参数中的一个。通常情况下，只有当这两个参数都来自一组共同的实验（如 TGA（热重分析））时，它们才有意义。

反应速率方程$\eqref{9.2}$的第四项可用于**模拟氧化反应**。如果异相反应阶数 $n_{\mathrm{O}_{2},ij}$ 大于零，则反应速率受局部氧气体积分数$ X_{O_2}$ 的影响。它是通过气相（第一个网格单元）氧体积分数 $X_{O_2,g}$ 计算得出的，假设扩散和消耗同时进行，因此浓度曲线处于平衡状态，深度 x 处的浓度为
$$
X_{\mathrm{O}_2}(x)=X_{\mathrm{O}_2,\mathrm{g}}\exp(-x/L_\mathrm{g})
$$
$n_{\mathrm{O}_{2},ij}$ 在第 i 种材料的 MATL 行中以 N_O2(j)命名。默认为零。$L_g$ 的名称为 GAS_DIFFUSION_DEPTH(j)，默认为 0.001 米。

您可以指定 MAX_REACTION_RATE(j) (1/s)，将反应速率$ r_{i j}$ 限制在指定值以下。

**Estimating Kinetic Parameters**

**大多数实际材料通常都没有动力学常数 A 和 E**。不过，有一种方法可以使用简化的反应方案来模拟材料分解。关键的假设是每种材料成分只发生一种反应。例如，如果复合材料发生了三种不同的反应，则必须用三种材料成分来表示，每种材料成分发生一种反应。如果还有额外的残留物，则需要第四种材料成分。任何或所有材料成分都可能留下残留物。

除了指定 A 和 E 外，FDS 还可以使用几个参数来推导有效值，其中最重要的是参考温度 (◦C)。要了解该参数，请参考图 9.3 所示的曲线图。这些曲线代表了假设的 TGA 实验结果，在该实验中，单组分材料经过单一反应将固体转化为气体。归一化质量（蓝色曲线，Ys）随着样品的缓慢加热而降低，在本例中加热速度为 5 K/min。归一化质量损失率（红色曲线）是归一化质量随时间变化的速率（$-dYs/dt$）。**该曲线的峰值在 FDS 中称为参考温度（REFERENCE_TEMPERATURE），不一定等同于点火温度，也不一定是燃烧固体的表面温度**。相反，它只是在 TGA 或类似实验仪器中，材料的质量分数以最大速度下降时的温度。

多组分固体中 i 组分的动力学常数为(:exclamation:这些公式是从考虑一阶反应的分析中得出的。使用此方法时，请勿在 MATL 行中指定反应阶次 N_S 的非统一值。)：
$$
E_{i,1}=\frac{\mathrm{e}r_{{\mathrm{p},i}}}{Y_{{\mathrm{s},i}}(0)}\frac{RT_{{\mathrm{p},i}}^{2}}{\dot{T}}\quad;\quad A_{i,1}=\frac{\mathrm{e}r_{{\mathrm{p},i}}}{Y_{{\mathrm{s},i}}(0)}\mathrm{e}^{{E/RT_{{\mathrm{p},i}}}}
$$
其中，$T_{p,i}$ 和 $r_{\mathrm{p},i}/Y_{\mathrm{s},i}(0)$ 分别为参考温度和速率。参考速率（REFERENCE_RATE）是在给定参考温度下的归一化质量损失率（单位：$s^{-1}$）除以进行反应的原始样品中材料成分的质量分数 $Y_{s,i}(0)$。对于单组分、单反应材料，$Y_{\mathrm{s},1}(0)=1$。HEATING_RATE ($\dot T$ ) 是 TGA（或等效的）测试仪器的温度上升速率。它以 K/min 为单位输入 FDS（在公式中以 K/s 表示）。默认值为 5 K/min。在图 9.3 中，**红色曲线（归一化质量损失率）下的面积等于加热速率（单位为 K/s）**。

![image-20240718195710092](/image-20240718195710092.png)

在很多情况下，由于无法获得微尺度量热数据，只能估算特定反应的REFERENCE_TEMPERATURE（Tp）。在这种情况下，可以指定一个附加参数来帮助微调反应速率曲线的形状，前提是已经进行了某种测量或估算，以说明反应是在什么温度和什么温度范围内进行的。PYROLYSIS_RANGE (ΔT) 是归一化质量损失率曲线的大致宽度（以摄氏度或开尔文为单位），假定其形状大致为三角形。其默认值为 80 ℃。利用这些输入参数，可以估算出峰值反应速率 $r_{p,i}$，并据此计算出 $E_{i,1}$，然后是$ A_{i,1}$。
$$
\frac{r_{\mathrm{p},i}}{Y_{\mathrm{s},i}(0)}=\frac{2\dot{T}}{\Delta T}\left(1-\nu_{\mathrm{s},i}\right)
$$
参数 $ν_{s,i} $是固体残渣的产量。

如果对这些参数的值有疑问，只需指定 REFERENCE_TEMPERATURE（参考温度）。请注意，FDS 将使用上述公式自动计算 A 和 E。:exclamation:如果指定 REFERENCE_TEMPERATURE（参考温度），请勿指定 A 和 E；如果指定 REFERENCE_RATE（参考速率），请勿指定 PYROLYSIS_RANGE （PYROLYSIS_RANGE）。 对于图 9.3 所示的材料分解，MATL 的形式为：

```fortran
&MATL ID = 'My Fuel'
    ...
    N_REACTIONS = 1
    SPEC_ID(1,1) = '...'
    NU_SPEC(1,1) = 1.
    REFERENCE_TEMPERATURE(1) = 300.
    REFERENCE_RATE(1) = 0.002
    HEATING_RATE(1) = 5.
    HEAT_OF_COMBUSTION(1) = ...
    HEAT_OF_REACTION(1) = ... /
```

请注意，在反应参数中添加索引是为了强调这些参数存储在长度等于 N_REACTIONS 的数组中。如果只有一个反应，可以省略 (1)，但使用它可以确保一致性。如果使用默认的燃烧模型，则可以使用相应的 SPEC_ID 表示反应产生了燃料气体。<font color=red>**HEAT_OF_COMBUSTION 是单位质量的燃料气体与氧气混合燃烧后释放的能量**。这与热解过程无关。</font>当模型中有多种材料发生热解时，通常可以使用一些平均气体种类来表示热解产物。为每种材料指定 HEAT_OF_COMBUSTION 可以确保不同材料的燃料蒸汽燃烧产生适当的能量。燃料气体的质量损失率会自动调整，使有效质量损失率乘以平均燃料种类的气相燃烧热得出预期的热释放率。该调整使用 REAC 行的 HOC_COMPLETE 值（见第 13.1.4 节）。例如，如果 REAC 行中指定的 HOC_COMPLETE 值是 MATL 行中指定值的两倍，则壁面单元内所含物质的质量将按热解模型确定的质量减少，但加入气相的质量将减少 50%。可以通过参数 HEAT_OF_COMBUSTION(i,j)为每个反应 j 中的每个物种 i 指定不同的燃烧热值。

**Modeling Upholstered Furnishings**

名为 Fires/couch.fds 的示例输入文件演示了软垫家具建模的一种简单方法。为沙发建模需要简化其结构和材料。最起码，我们希望将软垫家具建模为一层覆盖聚氨酯泡沫的织物。我们需要了解每种材料的热特性，以及上述 “参考 ”温度的估计值。泡沫的描述如下

```fortran
&MATL ID = 'FOAM'
    SPECIFIC_HEAT = 1.0
    CONDUCTIVITY = 0.1
    DENSITY = 40.0
    NU_SPEC = 1.
    SPEC_ID = 'POLYURETHANE'
    REFERENCE_TEMPERATURE = 280.
    HEAT_OF_REACTION = 800. /
```

请注意，这些特性完全是编造出来的。**织物和泡沫都通过单步反应分解成燃料气体**。每种燃料气体的成分和燃烧热都不同。FDS 会自动调整每种气体的质量损失率，以便 “有效 ”的燃料气体就是 REAC 行中指定的气体。图 9.4 显示了 1 分钟、2 分钟、3 分钟和 10 分钟后的火势。图中只显示了火焰区；烟雾被隐藏起来，以便您可以看到火势沿着沙发蔓延。图 9.4 中还显示了燃烧沙发的热释放率。预期热释放率 "是对这种尺寸家具的峰值热释放率的粗略估计。

![image-20240718200944074](/image-20240718200944074.png)

### Shrinking and Swelling materials

许多实用材料在热反应过程中厚度会发生变化。例如：

- 当材料从凝结相转移到气相时，非炭化材料会收缩。
- 泡沫等多孔材料在融化后会收缩，形成无孔层。
- 当形成多孔炭层时，一些炭化材料会膨胀，即变厚。
- 膨胀型防火材料会明显膨胀，形成一个隔热层。

在 FDS 中，**层厚度根据瞬时材料密度与材料纯密度（即 MATL 线上的密度）之比进行更新**。在涉及多个材料成分的情况下，膨胀和收缩量分别由这些比率的最大值和总和决定。用数学术语来说，这意味着在每个时间步长内，每个凝聚相单元的尺寸都会根据比率 δ 发生变化。
$$
\delta=\begin{cases}\max_{i}\left(\frac{\rho_{{\mathrm{s},i}}}{\rho_{i}}\right)&\mathrm{~if~}\max_{i}\left(\frac{\rho_{{\mathrm{s},i}}}{\rho_{i}}\right)\geq1\\\sum_{i}\left(\frac{\rho_{{\mathrm{s},i}}}{\rho_{i}}\right)&\mathrm{~if~}\max_{i}\left(\frac{\rho_{{\mathrm{s},i}}}{\rho_{i}}\right)<1&&\end{cases}
$$
例如，如果将密度为 500 kg/m3 的原始材料完全转化为密度为 1000 kg/m3 的残留物，材料层的厚度将是原始材料的一半。

**通过在 MATL 行将 ALLOW_SHRINKING 设为 F 来防止收缩**。将 MATL 行中的 ALLOW_SWELLING 设置为 F，可以防止膨胀。默认情况下，这些标记为 true。如果密度为非零的任何材料的相应标记设置为假，则不会发生收缩/膨胀。

### Multiple Solid Phase Reactions

图 9.3 所示的固相反应相当简单--单一的均质材料被加热并完全气化。图 9.5 描述了一种更复杂的情况。在这里，一种固体材料含有 10%（按质量计）的水和 90%的干固体。水在 100 ℃ 附近蒸发，干固体在 300 ℃ 附近热解，以固体残留物的形式留下 20% 的质量。这种情况下的全套参数列于 pyrolysis_2.fds。

![image-20240718201541754](/image-20240718201541754.png)

图 9.5 中包含两组曲线。实线表示使用 Matlab ODE 求解器计算出的方程组解，下面的虚线是使用 FDS 对 Matlab 解法进行的 “拟合”。实线材料的 MATL 线包含以下三个参数，它们定义了实线材料的分解：

```fortran
&MATL ID = '...'
	...
    REFERENCE_TEMPERATURE = 300.
    PYROLYSIS_RANGE = 100.
    HEATING_RATE = 5. /
```

REFERENCE_TEMPERATURE 是质量损失率达到峰值时的温度，单位为 ℃。HEATING_RATE 是 TGA 实验中使用的线性温升（℃/min），此处用 Matlab 解表示。PYROLYSIS_RANGE 是图 9.5 中第二个红色驼峰的大致 “宽度”，通过观察进行拟合。也就是说，100 ℃ 的值是通过试验和误差选择的。这通常是在 FDS 中选择动力学参数以匹配给定 TGA 曲线的方法。

### The Heat of Reaction

公式$\eqref{9.2}$描述了反应速率与温度的函数关系。大多数固相反应都需要能量，即反应是吸热的。HEAT_OF_REACTION(j) 表示单位质量反应物转化为反应产物所消耗的能量。**从技术上讲，这是生成物和反应物之间的焓差**。正值表示反应是吸热的，即反应从系统中带走能量。通常只有简单的相变反应（如水的汽化）才能准确知道 HEAT_OF_REACTION。**对于其他反应，则必须根据经验来确定 HEAT_OF_REACTION**（例如通过差示扫描量热法）。

### Liquid Fuels

液体燃料的蒸发率与对流加热率类似，**蒸发率是传质系数 hm 的函数**，就像第 8.2.23 节中讨论的热对流是传热系数 h 的函数一样(:exclamation:与对流换热系数一样，在描述液体池的 SURF 线上也可以选择指定一个固定的 MASS_TRANSFER_COEFFICIENT (m/s)。)。《FDS 技术参考指南》提供了有关蒸发率计算方法的更多详细信息。

液体燃料的特性在 MATL 行中给出：

```fortran
&REAC FUEL = 'ETHANOL'
    CO_YIELD = 0.001
    SOOT_YIELD = 0.008 /
&MATL ID = 'ETHANOL LIQUID'
    EMISSIVITY = 1.
    NU_SPEC = 1.
    SPEC_ID = 'ETHANOL'
    HEAT_OF_REACTION = 837
    CONDUCTIVITY = 0.17
    SPECIFIC_HEAT = 2.44
    DENSITY = 794
    ABSORPTION_COEFFICIENT = 1140
    BOILING_TEMPERATURE = 78.5 /
&SURF ID = 'ETHANOL POOL'
    COLOR = 'YELLOW'
    MATL_ID = 'ETHANOL LIQUID'
    THICKNESS = 0.1 /
```

<font color=red>**在 MATL 行中加入 BOILING_TEMPERATURE（沸腾温度）后，FDS 将使用其液体热解模型**</font>。它还会自动设置 N_REACTIONS=1，即唯一的 “反应 ”是从液态燃料到气态燃料的相变。**因此，本例中的 HEAT_OF_REACTION 为汽化潜热**。**导热系数、密度和比热用于计算通过传导进入液体的热量损失**，计算方法与用于固体的一维传热方程相同。**显然，液体的对流非常重要，但模型中并未考虑**。ABSORPTION_COEFFICIENT 表示液体对热辐射的深度吸收。液体并非只在表面吸收辐射，而是在表面附近的薄层吸收辐射。它对燃烧速率的影响可能很大。

在本例中，“ETHANOL ”是一个已知物种，即已列入附录 A。因此，只需说明其 CO 和烟尘产生量。如果种类不详，则必须提供更多信息。第 12.1.3 节包含详细信息，但简而言之，:question:**只有气体种类的分子量与液池蒸发模型相关**。如果液体有多种成分（如汽油或煤油），可为每种成分提供单独的 MATL 线路。如果每个 MATL 行包含相同的 SPEC_ID，则仍可使用单一气相燃料种类。如果是这种情况，则应在 MATL 行中提供液体成分的分子量（MW），单位为 g/mol。在计算各液体成分的蒸发率时，将使用这些唯一的分子量。

**Evaporation of a Pure Liquid**

Pyrolysis文件夹中名为 methanol_evaporation.fds 的示例案例提供了一个液体蒸发的例子。在一个 1 米乘 1 米的平底锅中装满甲醇，温度为$T_{\infty}=20^{\circ}\mathrm{C}$，暴露在均匀热通量 $\dot{q}^{\prime\prime}=20 \mathrm{kW/m^2}$ 下。甲醇的沸腾温度 $T_{\mathrm{b}}=64.65°\mathrm{C}$，比热 $c=2.48\mathrm{~kJ/(kg\cdot K)}$），汽化热 $h_\mathrm{v}=1099\mathrm{~kJ/kg}$。燃烧液体在稳定状态下的蒸发速率约为：
$$
\dot{m}^{\prime\prime}\approx\frac{\dot{q}^{\prime\prime}}{h_\mathrm{g}}\quad;\quad h_\mathrm{g}=c(T_\mathrm{b}-T_\infty)+h_\mathrm{v}
$$
在这个例子中，**甲醇在缺氧的环境中蒸发，不会发生燃烧**。图 9.6 的左图显示了计算的蒸发率 $\dot m^{\prime\prime}$与理想蒸发率 $\dot q/h_g$。前者接近后者，因为吸收的能量全部用于蒸发液体。右图显示了计算得出的液体表面温度与液体沸腾温度的关系。

![image-20240718203217057](/image-20240718203217057.png)

**Liquid Mixtures**

消防工程中关注的大多数液体燃料都不是纯液体，而是混合液体，如汽油。每种液体成分都有独特的沸点、汽化热、分子量和比热，这些都会影响其蒸发速度。**可以指定单独的液体成分，但让它们全部蒸发形成相同的气态燃料蒸汽**。 这样做的原因是为了节省计算成本。如果每种成分都要蒸发形成一种独特的气态燃料，那么每种成分都需要单独的传输方程和燃烧反应。请看下面的例子--碳氢化合物燃料混合物与水混合形成乳状液。水池的具体情况如下：

```fortran
&SPEC ID='WATER VAPOR' /
&REAC FUEL='N-HEXANE' /
&SURF ID = 'POOL'
    COLOR = 'YELLOW'
    MATL_ID(1,1:6) = 'HEXANE','HEPTANE','OCTANE','DECANE','BENZENE','WATER'
    MATL_MASS_FRACTION(1,1:6) = 0.521,0.054,0.063,0.023,0.200,0.139
    THICKNESS = 0.002 /
```

水会蒸发形成 “WATER VAPOR”，但其他成分都会形成 “N-HEXANE”。在每种液体成分的 MATL 行中，“WATER VAPOR”（水蒸气）或 “N-HEXANE”（正己烷）都被声明为 SPEC_ID，同时还包括沸腾温度（BOILING_TEMPERATURE）、MW、SPECIFIC_HEAT 和反应热（HEAT_OF_REACTION）（即汽化热）。此外，还可在 MATL 行中指定 HEAT_OF_COMBUSTION（燃烧热），以表明液体成分的燃烧热与正己烷不同，**FDS 应相应调整其蒸发速率**。

Pyrolysis文件夹下有一个演示液体混合物蒸发的示例，名为 liquid_mixture.fds。在该示例中，一个 1 米 x 1 米 x 2 毫米深的水池中含有碳氢化合物液体和水的混合物，完全蒸发后形成水蒸气和代用气体燃料蒸气（正己烷）。图 9.7 显示了水和燃料蒸气的质量与时间的函数关系。

![image-20240718203636506](/image-20240718203636506.png)

### Fuel Burnout

固体或液体燃料的热特性决定了其燃烧时间的长短。一般来说，燃尽时间是质量损失率$\dot m^{\prime\prime}$、密度 $\rho _s$ 和燃料层厚度 δs 的函数：
$$
t_{\mathrm{b}}=\frac{\rho_{\mathrm{s}}\delta_{\mathrm{s}}}{\dot{m}^{\prime\prime}}
$$
<font color=red>**不过，每种热解模式处理燃料燃尽的方式略有不同。下文各节将重点介绍这些差异**</font>。

**Solid Fuel Burnout When the Burning Rate is Specified**

<font color=red>如果使用 HRRPUA（单位面积热量释放率）或 MLRPUA（单位面积质量损失率）指定燃烧速率，**固体表面将以指定速率无限期地燃烧下去**，不会出现燃料烧尽的情况。</font>您可以使用 RAMP_Q 在所需时间停止燃烧。您可以使用燃烧热 ΔH、材料密度 $\rho _s$、材料厚度 δs 和 HRRPUA $\dot q_f^{\prime\prime}$ 来估算表面的 “燃尽时间”：
$$
t_{{\mathrm{b}}}=\frac{\rho_{{\mathrm{s}}}\delta_{{\mathrm{s}}}\Delta H}{\dot{q}_{{\mathrm{f}}}^{\prime\prime}}
$$
:question:燃烧时间不会自动计算和应用，因为在某些情况下，底层固体不被视为燃料；也就是说，燃烧速度和持续时间不是由固体表面的成分决定的。

在 SURF 行中指定 BURN_DURATION (s)（灼烧持续时间）可替代 HRR 的升降。这是点火后火势熄灭的持续时间。:exclamation:该参数的默认值是一个非常大的数字，这意味着在默认情况下，具有指定 HRR 的火焰将无限期燃烧。

**Solid Fuel Burnout When the Burning Rate is Not Specified**

如果您使用的是热解模型，其中 MATL 行的 N_REACTIONS 大于或等于 1，则 FDS 会根据层厚度、成分密度和计算出的材料反应速率自动计算热解固体燃料的燃尽时间。

**Liquid Fuel Burnout**

<font color=red>液体燃料的燃尽时间是根据液层厚度、液体密度和计算出的燃烧速率自动计算得出的</font>。

### Solid Fuels that can Burn Away

如果可燃固体被消耗后将从模拟中消失，则在应用于 OBST 的 SURF 行上设置 BURN_AWAY=T。当每个固体单元中的质量被热解反应或规定的 HRR 消耗后，固体物体会从计算中逐个单元消失。使用 BURN_AWAY 时应注意以下问题：

- 谨慎使用 BURN_AWAY。如果一个物体有可能被烧毁，就必须预留大量的额外内存来存储新暴露表面的额外信息。
- 可以 BURN_AWAY 的 OBST 的热传导限制为 1-D。在 SURF 行中，指定 THICKNESS约为单个网格单元的厚度，并设置 BACKING=’VOID’。假定固体的隔热性能相对较好，表面的深度温度曲线下降相对较快。移除网格单元时，新暴露的表面最初处于环境温度，但表面会迅速升温。
- 如果障碍物的体积因为要符合均匀网格而发生变化，FDS 不会像处理 HRRPUA 等与区域相关的各种数量时那样，调整燃烧速率以反映这种变化。
- 可以在 OBST 行中指定一个名为 BULK_DENSITY (kg/m3) 的参数来指定固体物体的可燃质量。**计算使用的是用户指定的物体尺寸，而不是网格调整后的物体尺寸**。该参数优先于计算可燃质量的所有其他参数。请注意，如果没有指定 BULK_DENSITY，燃烧的总质量将取决于网格分辨率。使用 BULK_DENSITY 参数可确保单位体积内的具体燃料质量与网格分辨率无关。请注意，**如果固相反应会产生固体残留物（如木炭或灰烬），则 BULK_DENSITY 指的是反应后转化为气体的固体质量**。
- 如果在 SURF 线上规定了 BURN_AWAY，则单一 SURF_ID 应适用于整个 OBST，而不是特定的面，因为不清楚如何移除在不同面上具有不同 SURF_ID 的固体障碍物。在这种情况下，当 BULK_DENSITY 指定的燃料质量而不是任何特定面的燃料质量被消耗时，OBST 将消失。
- 默认情况下，新露出的表面采用与原始障碍物相同的 SURF_ID。不过，您可以在 OBST 行中指定一个可选的 SURF_ID_INTERIOR，以定义新暴露表面的表面属性。例如，软垫的表面可能有一层织物，而软垫内新露出的网格单元则没有。
- 为了补偿不准确的障碍物区域，可以在 SURF 线上添加一个附加参数 AREA_MULTIPLIER。参数。它将用用户指定的系数乘以所有质量通量和能量通量。检查 如果将这两个参数结合在一起，BURN_AWAY 是否能如预期般工作。
- 物体的质量基于所有物质成分的密度（MATL），但只消耗已知物种的质量通量。如果气体产量之和小于 1，则需要更长的时间来消耗质量。

**案例**

标有 “Fires/box_burn_away ”的简单示例演示了如何迫使固体燃料从域中消失。这些示例展示了固体块状材料被热解直至完全消耗的过程。热通量是通过在盒子周围放置热表面产生的。由于自动点火温度（AUTO_IGNITION_TEMPERATURE）被设置为非常高的值，因此不会发生燃烧。选择固体材料的属性只是为了确保快速计算。目的是确保热解燃料的质量与原始木块的质量一致。燃料块边长为 0.4 米，密度为 20 千克/立方米。总质量为
$$
(0.4)^3\mathrm{~m^3}\times20\mathrm{~kg/m^3}=1.28\mathrm{~kg}
$$
Case 1 (box_burn_away1)固体材料在 200 ℃ 温度下进行单步热解反应，全部转化为燃料气体。图 9.8 显示了燃料气体的演变过程。

Case 2 (box_burn_away2)这种情况与情况 1 相似，只是固体物质汽化后形成分子量为 50 克/摩尔的惰性 “GAS”。

Case 3 (box_burn_away3)热解率通过 HRRPUA 隐式指定，即使燃料气体没有燃烧。

Case 4 (box_burn_away4)这种情况与情况 3 类似，但固体材料的燃烧热与主要气相燃料乙烯的燃烧热不同。固体材料的指定燃烧热为 30,000 kJ/kg，而乙烯的指定值为 40,000 kJ/kg。图 9.8 显示，生成的乙烯量为 0.75×1.28 千克 = 0.96 千克。由于只有一个气相反应，产生的乙烯气体与燃烧热较低的固体材料产生的热量相当。

![image-20240719205754233](/image-20240719205754233.png)

Case 5 (box_burn_away5)这个案例是案例 1 的重复，但 N_SIMPLE_CHEMSITRY_REACTIONS 设置为 2。 结果应与案例 1 一致，因为燃料气体的生成应基于 “METHANE ”的总燃烧热，而不是第一个反应的燃烧热。

Case 6 (box_burn_away6)固体材料产生的两种燃料气体质量相等，$m_1 = m_2 = 0.64 kg$，两种燃料气体的燃烧热相同，ΔH1 = ΔH2 = 50,000 kJ/kg。然而，气相反应产生的燃烧热不同，$ΔH_1^{\prime} = 50,000 kJ/kg$ 和 $ΔH_2^{\prime} = 25,000 kJ/kg$。因此，第二种燃料在气相中的有效质量将是原来的两倍。

Case 7 (box_burn_away7)本案例表明，可以烧毁并使厚度为零的薄障碍物消失。6.7.2 之前的 FDS 版本不允许发生这种情况。在测试案例中，一块 0.4 米 x 0.4 米 x 0.01 米、密度为 20 千克/立方米的薄板被加热并蒸发，产生 0.032 千克的燃料气体。

Case 8 (box_burn_away8)这种情况与情况 4 类似，不同之处在于燃烧速率是通过参数 MLRPUA 指定的。

![image-20240719210244827](/image-20240719210244827.png)

Case 9 (box_burn_away9)边长 L = 0.4 米、密度 ρ1 = 20 千克/立方米的固体立方体泡沫发生热分解，残余物分数为 ν1 = 0.5。块体由 δ = 0.002 m 的织物层覆盖，织物层的密度 ρ2 = 50 kg/m3，残留率 ν2 = 0.2。采用三维传热算法。气体燃料的预期质量为
$$
m=L^2\left((L-2\delta)(1-\nu_1)\rho_1+2\delta(1-\nu_2)\rho_2\right)=0.6592\text{m}
$$
请注意，三维热传导方程是通过三个坐标方向上的一维分段来求解的。每个分段都考虑了与其方向垂直的层，但没有考虑平行的层。因此，**如果考虑实际的三维物体，本例中的热解质量要小于预期**。

Case 10 (box_burn_away10)这种情况与箱体_burn_away1 相同，只是在固体的一侧增加了一块 1 厘米厚的板，板的材料相同。板厚 0.01 米乘 0.6 米乘 0.6 米，额外增加 0.072 千克燃料质量。

![image-20240720094646778](/image-20240720094646778.png)

Case 11 (box_burn_away11)在这种情况下，“盒子 ”由 0.4 米乘 0.4 米乘 1 厘米的板块组成，形成一个 10 厘米的立方体隔间。总共有 15 块板，每块板的密度为 20 千克/立方米。总重量为 0.48 千克。

![image-20240720095149961](/image-20240720095149961.png)

Case 1, 2D (box_burn_away_2D and box_burn_away_2D_residue)情况 1 在两个维度上重复。在后一种情况下，只有一半的质量转化为燃料，留下的残留物是原始质量的 50%。**通过将 BULK_DENSITY 设置为 10 kg/m3，箱子会被强制烧掉。这就是可燃质量**。当整个网格单元消失后，新的未燃烧表面暴露出来，这两种情况下的固体质量会虚增。增加的质量只是将剩余固体质量报告为表面密度和表面积乘积的假象。最终的固体质量和气态降解产物都应符合模拟结束时的预期值。结果如图 9.12 所示。

![image-20240720095619563](/image-20240720095619563.png)

## Testing a Pyrolysis Model

描述实际材料热解的 SURF 和 MATL 线由经验属性和基本属性组合而成，这些属性通常来自不同的来源。如何确定 FDS 中的各种属性值和相关热物理模型构成了对固体的适当描述？对于全尺度模拟而言，很难消除与气相和固相例程相关的不确定性。不过，您可以通过关闭气相来对任何一套固相模型进行简单检查。下文将介绍如何快速模拟锥形量热计和热重力分析 (TGA)、差示扫描量热计 (DSC) 和微量燃烧量热计 (MCC) 等台式测量。

### Simulating the Cone Calorimeter

本节介绍如何设置锥形量热计或类似仪器的简单模型。这并不是对仪器进行完整的三维模拟，而是对外部热通量作用下固相降解的一维模拟。虽然可以在 FDS 中创建锥形加热器和样品架的全三维模拟，但这样的模拟需要一定的时间才能完成，而且无法将固相模型的问题与气相的不确定性区分开来。因此，值得进行类似本文所述的快速模拟，以便仅测试固相模型。

1. 创建一个很小的网格，只需足够让 FDS 运行即可。由于气相计算基本上是被关闭的，因此您只需要总共九个单元格（IJK=3,1,3）就能让压力求解器正常工作。
2. 在 MISC 行设置 SOLID_PHASE_ONLY=T，以关闭所有气相计算并加快模拟速度。请注意，表面的对流换热仍使用环境温度。在这种情况下，传热系数可以指定，也可以取自气相导热系数除以壁面网格间距。
3. 创建 SPEC 行，列出热解过程中产生的任何气体种类。由于不允许气相燃烧，因此不需要 REAC 行。
4. 在时间行，设置 WALL_INCREMENT=1 以强制 FDS 每隔一个时间步更新固相（通常每隔一个时间步更新一次），并将 DT 设为适合固相计算的值。由于没有限制时间步长的气相计算，因此最好自行控制。
5. 像通常一样生成 MATL 线和一条 SURF 线，但在 SURF 线中添加 EXTERNAL_FLUX。这只是一个加热固体的 “虚拟 ”源。可以把它想象成一个完美的辐射板或锥形加热装置。您可以使用 TAU_EF 或 RAMP_EF 控制 EXTERNAL_FLUX。如果您希望在点火后增加热通量，以考虑火焰的额外辐射，这将非常有用。有关斜坡的详细信息，请参见第 11.1 节。
6. 在 SURF 行，设置气体温度 TMP_GAS_FRONT (◦C)，以及可选的 HEAT_TRANSFER_COEFFICIENT (W/(m2-K))，以便控制从气体到表面的对流热通量，反之亦然。
7. 将 SURF_ID 分配给横跨计算域底部的通风口。在计算域的所有其他面上创建开放式通风口。
8. 在固体表面添加固相输出设备，如 “WALL TEMPERATURE”、“TOTAL HEAT FLUX”、“GAUGE HEAT FLUX ”和 “WALL THICKNESS”。使用这些参数可以跟踪固体随时间变化的状况。各种气体的生成率通过 “MASS FLUX ”量和相应的 SPEC_ID 输出。请勿指定 “BURNING RATE”，因为 FDS 假定这是燃料气体的特定参数，而本练习中没有燃料气体。

将您的结果与锥形量热计等台式设备的测量结果进行比较。但请记住，计算和实验并不一定完全匹配。计算旨在消除与对流、燃烧和特定仪器现象有关的不确定性。下面是一个 FDS 输入文件，演示了如何通过运行非常简短的计算来测试候选热解模型。模拟只涉及固相模型。基本上，除了施加 50 kW/m2 的 “外部 ”热通量外，气相计算是关闭的。本例中的固体是一块 8.5 毫米厚的 PMMA 板。更多详情，请参阅《FDS 验证指南》中 “FAA 聚合物 ”标题下的内容。

```fortran
&HEAD CHID='pmma_example', TITLE='Black PMMA at 50 kW/m2' /
&MESH IJK=3,3,3, XB=-0.15,0.15,-0.15,0.15,0.0,0.3 /
&TIME T_END=600., WALL_INCREMENT=1, DT=0.05 /
&MISC SOLID_PHASE_ONLY=T /
&SPEC ID='METHANE' /
&MATL ID='BLACKPMMA'
    ABSORPTION_COEFFICIENT=2700.
    N_REACTIONS=1
    A(1) = 8.5E12
    E(1) = 188000
    EMISSIVITY=0.85
    DENSITY=1100.
    SPEC_ID='METHANE'
    NU_SPEC=1.
    HEAT_OF_REACTION=870.
    CONDUCTIVITY = 0.20
    SPECIFIC_HEAT = 2.2/
&SURF ID='PMMA SLAB'
    COLOR='BLACK'
    BACKING='INSULATED'
    MATL_ID='BLACKPMMA'
    THICKNESS=0.0085
    EXTERNAL_FLUX=50 /
&VENT XB=-0.05,0.05,-0.05,0.05,0.0,0.0, SURF_ID = 'PMMA SLAB' /
&DUMP DT_DEVC=5. /
&DEVC XYZ=0.0,0.0,0.0, IOR=3, QUANTITY='WALL TEMPERATURE', ID='temp' /
&DEVC XYZ=0.0,0.0,0.0, IOR=3, QUANTITY='MASS FLUX', SPEC_ID='METHANE', ID='MF' /
&DEVC XYZ=0.0,0.0,0.0, IOR=3, QUANTITY='WALL THICKNESS', ID='thick' /
&TAIL /
```

### Simulating Bench-scale Measurements like the TGA, DSC, and MCC

测量固体材料热物理性质的技术有很多。其中大部分涉及以相对缓慢的线性速率加热非常小的样品。通过这种方式，热传导最小化，样品可被视为热薄层。FDS 具有模拟热重分析 (TGA)、差示扫描量热法 (DSC) 和微量燃烧量热法 (MCC) 测量的特殊功能。要使用它，请像平常一样设置输入文件。然后，在要分析的 SURF 行上添加 TGA_ANALYSIS=T 标志。一次只能分析一个 SURF 行。分析多个 SURF 行需要多次运行。线性加热速率（K/min）和最终样品温度（◦C）分别通过 TGA_HEATING_RATE 和 TGA_FINAL_TEMPERATURE 指定。默认值为 5 K/min 和 800 ◦C。初始温度为 TMPA。请注意，该功能仅适用于描述由单层和多种反应成分组成的热厚样品的 SURF 行。 例如，以下 SURF 行描述了一种由三种成分组成的材料：

```fortran
&SURF ID = 'Cable Insulation'
    TGA_ANALYSIS = T
    TGA_HEATING_RATE = 60.
    THICKNESS = 0.005
    MATL_ID(1,1) = 'Component A',
    MATL_ID(1,2) = 'Component B',
    MATL_ID(1,3) = 'Component C',
    MATL_MASS_FRACTION(1,1:3) = 0.26,0.33,0.41 /
```

两个 TGA 条目将强制 FDS 执行 TGA、DSC 和 MCC 测量的数值版本。THICKNESS和 SURF 线上的其他边界条件将被忽略。运行分析只需一两秒，之后 FDS 将关闭而不运行实际模拟。 要运行模拟，可删除 TGA 条目或将 TGA_ANALYSIS 设置为 F。

> 注意：如果将 TGA_ANALYSIS 应用于多网格情况或 SURF 与尚未插入计算的 PART 类相关联的情况，FDS 可能找不到 SURF，从而产生错误。最好将域简化为单个网格中的单个粒子或壁单元。

TGA_ANALYSIS 的结果是一个逗号分隔的文件，名为 CHID_tga.csv。文件的第一列和第二列包括时间和样品温度。第三列是归一化样品质量，即样品质量除以初始质量。接下来的几列列出了各个材料成分的质量分数。下一栏是总质量损失率，单位为 s-1，然后是各材料成分的质量损失率。下一栏是单位质量样品的热释放率，单位为 W/g，这是典型的 MCC 测量值。最后一栏是样品吸收的热量，按其质量归一化，单位也是 W/g，这是典型的 DSC 测量方法。典型的木材分析结果如图 9.13 所示。在这种情况下，按质量计算含水量约为 10% 的木材样本加热并发生三个反应，包括水的蒸发。请注意，TGA 图包括燃料和水蒸气，而 MCC 结果只显示燃料。

输出量的详细情况将在第 22.10.17 节中讨论。有关这些测量技术以及如何解释这些技术的更多详情，请参阅《FDS 验证指南》。

![image-20240720104402334](/image-20240720104402334.png)

## Pyrolysis and Energy Conservation

反应热是物料转化为残余物和/或气体过程中获得或损失的能量。换句话说，反应热是当前固体温度下生成物的焓减去当前固体温度下初始物质的焓。要使总内能保持不变，这一点必须成立。一个难题是，虽然固体材料的反应热可能是已知的，但材料焓或任何残留物或气态产物的焓的详细信息却往往不为人知。在已知材料参考焓的情况下，您可以在 MATL 行输入以 kJ/kg 为单位的 REFERENCE_ENTHALPY（参考焓）和以 ℃ 为单位的 REFERENCE_ENTHALPY_TEMPERATURE（参考焓温度）。

FDS 将尝试调整所有材料的焓，使内能保持不变。为每种物质反应定义一个线性方程：
$$
H_{\mathrm{x}}\left(T_{\mathrm{ref}}\right)+H_{\mathrm{x,adj}}+H_{\mathrm{x,r}}\left(T_{\mathrm{ref}}\right)=\sum_{i=1}^{\mathrm{N_residues}}\nu_{\mathrm{i}}\left(H_{\mathrm{i}}\left(T_{\mathrm{ref}}\right)+H_{\mathrm{i,adj}}\right)+\sum_{j=1}^{\mathrm{N_species}}\nu_{\mathrm{j}}H_{\mathrm{j}}\left(T_{\mathrm{ref}}\right)
$$
其中，H(T) 是材料或气体的焓值；$H_r$ 是HEAT_OF_REACTION；$T_{ref}$ 是指定HEAT_OF_REACTION的温度；ν 是产热量；$H_{adj}$ 是常数，用于强制使用正确的焓值来平衡反应。在初始化过程中，材料的 H(T) 使用定义的 SPECIFIC_HEAT 或斜坡初始化。气体的 H(T) 根据第 12.1.2 节的讨论进行定义。<font color=red>**气体不包含调整参数，因为通常情况下，裂解产生的不是二氧化碳或水蒸气等预定义物种，就是 REAC 使用的燃料种类**</font>。对于预定物种，焓值是已知的。当 REAC 使用非预定义物种时，FDS 会调整物种焓，以获得正确的 HEAT_OF_COMBUSTION。这意味着无法再次调整以平衡物质反应。

结果是一个线性方程组，$H_{adj}$ 值是未知数。由此得到一个矩阵，其行数为所有材料的反应总数，列数为反应物或残留物的材料总数。行数和列数不一定相等。如果行数和列数相等，只要矩阵不是奇异的，就可以用标准矩阵求解。如果方程数多于材料数，则系统超定，可能没有节省能量的解法。在这种情况下，将对系统进行最小二乘法求解，以找到 Hadj 值的最佳可能值。在这种情况下，系统会发出警告信息。如果材料数多于反应数，则系统的求解不足，会出现无穷多个解。在这种情况下，矩阵的求解是为了得到 $H_{adj}$ 值的最小解。也就是说，它试图为 $H_{adj}$ 找出数值矢量大小最小的值。

如果是奇异矩阵，系统会发出警告，表示不做任何调整。当矩阵中的某一行是其他一行或多行的线性组合时，就会出现奇异矩阵。如果出现这种情况，很可能是 MATL 的某个定义出现了错误。

反应使用的 $T_{ref}$ 值是该反应的 REFERENCE_TEMPERATURE 指定值。如果没有给出任何值（当使用 A 和 E 定义反应时），则 FDS 将仅使用单一材料的单一反应进行虚拟 TGA。$T_{ref}$使用的是出现反应速率峰值的温度。由于在大多数情况下，材料的比热及其残余物和生成气体的比热并不相同，因此反应热与温度有关。FDS 将为反应热创建一个与温度相关的数组，其中 $T_{ref}$ 的值固定为 HEAT_OF_REACTION 指定的值。

通过在 MATL 行中设置 ADJUST_H=F，可以跳过调整焓的过程。当材料反应不代表实际化学反应时，应这样做。如果没有为带有反应的 MATL 指定 HEAT_OF_REACTION，则会设置 ADJUST_H=F。请注意，这意味着如果一个反应的 HEAT_OF_REACTION 实际上为零，并且需要进行焓值调整，则应在该反应的输入文件中将 HEAT_OF_REACTION 设置为 0。

如果产量之和小于 1，那么在求解 $H_{adj}$ 值时，FDS 将假定缺少的质量是一种与原始材料具有相同比热的材料。



# Ventilation

本章介绍如何对通风系统进行建模。有两种方法可以做到。首先，是明确指定进出隔室的空气流速，见第10.1节对简单速度边界条件的描述。第二，是使用暖通空调系统对气流速率进行建模，参见第10.2节对暖通空调系统建模的描述。

## Simple Vents, Fans and Heaters

建筑物内各个隔间的通风系统是通过速度边界条件来描述的。例如，**通过指定固体表面法线方向的速度，可以将新鲜空气吹入隔间，并将烟雾排出隔间**。然而，速度边界条件还有其他许多方面，下面将一一介绍。

### Simple Supply and Exhaust Vents

描述送风机或排气扇的最简单方法是在固体表面指定一个VENT，并指定一个具有某种形式的指定速度或体积流量的 SURF_ID。**速度的法向分量通常通过参数 VEL 直接指定。如果 VEL 为负值，则流向计算域，即供气通风口。如果 VEL 为正值，则气流流出计算域，即排气口**。例如：

```fortran
&SURF ID='SUPPLY', VEL=-1.2, COLOR='BLUE' /
&VENT XB=5.0,5.0,1.0,1.4,2.0,2.4, SURF_ID='SUPPLY' /
```

创建一个通风口，以 1.2 米/秒的速度向名义面积为 0.16 平方米的区域供气，具体取决于将通风口重新调整到 FDS 网格上。无论平面x = 5的方向如何，由于VEL的标志，气流将被引导进入房间。在这个例子中，VENT的面积可能不是精确的0.16 $m^2$，因为它可能与计算网格不完全对齐。**如果是这种情况，则可以指定VOLUME_FLOW而不是VEL**，单位为$m^3/s$。**如果气流正在进入计算域，VOLUME_FLOW 应为负数，这与 VEL 的约定相同**。需要注意的是，规定了 VOLUME_FLOW 的 SURF 可以由 VENT 或 OBST 调用，但要注意的是，在后一种情况下，障碍面上的速度将由指定的 VOLUME_FLOW 除以该特定面的面积得出。例如，

```fortran
&SURF ID='SUPPLY', VOLUME_FLOW=-5.0, COLOR='GREEN' /
&OBST XB=..., SURF_ID6='BRICK','SUPPLY','BRICK','BRICK','BRICK','BRICK' /
```

表明流向计算域的障碍物前 x 向表面的速度等于 5 立方米/秒除以面的面积（在 FDS 中近似）。

注意VEL和VOLUME_FLOW不应该在同一SURF行上指定。**选择取决于在给定的通风口是否需要精确的速度，或者是否需要给定的体积流量**。

还需注意的是，如果VENT或 OBST 穿过网格边界，则将在每个网格中重新计算指定的 VOLUME_FLOW，以获得所需的体积流量。在 FDS 6.3 及更早版本中，情况并非如此。Flowfields 文件夹中名为 `volume_flow_1.fds` 和 `volume_flow_2.fds` 的示例演示了可以将VENT或 OBST 划分到多个网格中。在这两个案例中，空气以 0.01 立方米/秒的速度从一个 1 米乘 1 米乘 1 米的方框中吸入。这些情况也确保了VENT或 OBST 无需与网格对齐即可产生所需的流速。图 10.1 显示了在指定体积流量的情况下，通过箱体相对面上的OPEN边界与VENT（左侧）或 OBST（右侧）所产生的体积流量。

![image-20240617194120512](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617194120512.png)

### Total Mass Flux

通常情况下，**通过设置固体表面的法向流速或体积流量来指定简单的供气或排气通风口**。不过，也可以通过参数 MASS_FLUX_TOTAL（总质量流量）来指定单位面积的总质量流量（$kg/(m^2 s)$）。**该参数使用与上述 VEL 相同的符号约定**。事实上，**输入的 MASS_FLUX_TOTAL 值会在内部转换成速度边界条件**，**其流出量的值会根据当地密度进行调整**。请注意，<font color=red>**MASS_FLUX_TOTAL 只能用于流出边界条件；对于流入边界条件，请使用 MASS_FLUX**</font>，这将在第 10.1.6 节中讨论。

### Heaters

你可以通过改变进入空气的温度来创建一个简单的加热通风口：

```fortran
&SURF ID='BLOWER', VEL=-1.2, TMP_FRONT=50. /
```

SURF_ID='BLOWER'的VENT会以 1.2 米/秒的速度将 50 ℃ 的空气吹入流域。将 VEL 设置为正值会将空气吸出，在这种情况下就不需要 TMP_FRONT。

注意，**如果指定HRRPUA或固相反应参数，则不应规定速度**。可燃气体以FDS计算的速度喷射。

### Louvered Vents

大多数实际的送风口都有某种格栅或百叶，它们的作用是改变或扩散进入的气流。通过规定气流的法向和切向分量，可以在一定程度上模拟这种效果。如上所述，**法向分量是通过 VEL 指定的**。**切向分量是通过一对实数 VEL_T 来指定的**，这对实数代表其他两个坐标方向（x 或 y 应在 y 或 z 之前）上所需的切向速度分量。例如，`Flowfields/tangential_velocity.fds` 示例中的行：

```fortran
&SURF ID='LOUVER', VEL=-2.0, VEL_T=3.0,0.0, TAU_V=5., COLOR='GREEN' /
```

是一个百叶通风口的边界条件，该通风口以 2 米/秒的法向速度和 3 米/秒的切向速度将空气推入空间。请注意，速度法向分量的负号表示流体注入计算域。切向速度为 3 米/秒，表示流体在正 y 方向流动。如图 10.2 所示，**使用 TAU_V 或 RAMP_V 对法线和切线速度分量进行加速**。

![image-20240617200903221](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617200903221.png)

在网格分辨率有限的情况下，可能没有足够的网格单元跨越开口，VEL_T 无法正常工作。在这种情况下，您可以考虑在VENT前简单地指定一个偏移一个网格单元的平板障碍物。平板将简单地将气流转向所有横向方向。

如果百叶通风口是HVAC系统的一部分，请参阅 10.2.7 了解如何指定百叶。

### Specified Normal Velocity Gradient

有时需要为边界法线方向的速度指定一个 Neumann 边界条件（指定梯度）。例如，下面的条件允许沿域顶流入和流出，但是$\partial w/\partial z=0$。**注意FREE_SLIP=T**只设置$\partial u/\partial z=0$和$\partial v/\partial z=0$：

```fortran
&SURF ID = 'sky', COLOR = 'INVISIBLE', VEL_GRAD=0., FREE_SLIP=T /
&VENT MB='ZMAX', SURF_ID='sky' /
```

### Species and Species Mass Flux Boundary Conditions

有两种气体种类边界条件（有关气体种类的一般性讨论，请参见第 12 章）。默认情况下，气体种类不会穿透固体表面，如果只需要穿透固体表面，则无需指定任何条件。如果在强迫流动边界（指定了 VEL、VOLUME_FLOW 或 MASS_FLUX_TOTAL）处物种的质量分数为某一数值，则将 MASS_FRACTION(:)设为相应 SURF 行上所需的物种质量分数。如果需要物种的质量通量，请设置 MASS_FLUX(:)，而不是 MASS_FRACTION(:)。如果设置了 MASS_FLUX(:)，请勿指定 VEL、VOLUME_FLOW 或 MASS_FLUX_TOTAL。这些参数将根据指定的质量通量自动计算。输入 MASS_FLUX(:)和通常的 MASS_FRACTION(:)**只能用于流入边界条件**。MASS_FLUX(:) 应为正数，单位为$ kg/（m^2 s）$。另外请注意，**使用 MASS_FRACTION 时不能指定背景物质**。背景物种的质量分数将被设置为其他物种未指定的质量分数。

下面是一个如何指定以$0.025 kg/(m^2 s)$的速率产生甲烷的表面的例子：

```fortran
&SPEC ID='METHANE' /
&SURF ID='METHANE BURNER', SPEC_ID(1)='METHANE', MASS_FLUX(1)=0.025 /
&VENT XB=..., SURF_ID='METHANE BURNER' /
```

下面是如何指定以0.1米/秒的速度吹出甲烷的表面的例子：

```fortran
&SPEC ID='METHANE' /
&SURF ID='METHANE BLOWER', MASS_FRACTION(1)=1.0, SPEC_ID(1)='METHANE', VEL=-0.1 /
&VENT XB=..., SURF_ID='METHANE BLOWER' /
```

请注意，如果指定的速度较小，则指定 VEL 和 MASS_FRACTION 的组合可能导致结果不准确，**因为扩散将主导质量输运**。要获得边界处准确的物种质量通量，请使用 MASS_FLUX。

或者，为速度边界（VEL、VOLUME_FLOW 或 MASS_FLUX_TOTAL）添加 CONVERT_VOLUME_TO_MASS=T，根据指定的边界成分（MASS_FRACTION）和温度（TMP_FRONT）将体积流量转换为质量流量：
$$
\dot{m}_{\alpha}^{\prime\prime}=\rho Z_{\alpha}u=\frac{p_{\infty}\overline{W}}{RT}Z_{\alpha}\frac{\dot{Q}}{A}
$$
其中，ρ 是密度，Zα 是 α 的质量分数，u 是表面法线速度，$p_∞$ 是环境压力，$\overline{W}$ 是混合物分子量，R 是理想气体常数，T 是表面温度，$\dot{Q}$ 是体积流量，A 是通风口面积。请注意，使用 CONVERT_VOLUME_TO_MASS=T 将 SURF 转换为质量通量边界条件，因此可能无法应用速度曲线。

### Tangential Velocity Boundary Conditions at Solid Surfaces

无滑移条件意味着表面的连续气体切向速度为零。在湍流中，速度通过厚度只有几毫米的边界层迅速增加到 "自由流 "值。在大多数实际模拟中，不可能直接解决边界层问题；因此，需要使用经验模型来表示边界层对整个流场的影响。对于 DNS（直接数值模拟），壁面处的速度梯度是直接根据壁面附近的解析速度计算出来的（默认情况下 NO_SLIP=T）。对于 LES（大涡模拟），采用的是 "对数定律 "壁面模型。"砂粒 "表面粗糙度1 （以米为单位）由 SURF 上的 ROUGHNESS 设置。要强制固体边界具有自由滑条件，请在 SURF 行上设置 FREE_SLIP=T。**在 LES 中，要覆盖壁模型并强制使用无滑动边界条件，请在 SURF 行上设置 NO_SLIP=T**。

### Synthetic Turbulence Inflow Boundary Conditions

空气等低粘度流体的实际流动很少在时间上完全静止或在空间上完全均匀--它们（在某种程度上）是湍流。当然，流动的湍流特性可能会对混合和其他行为产生重大影响，因此仅规定名义上恒定和均匀的边界条件可能是不够的。为了解决这个问题，FDS 采用了合成涡流法 (SEM)(**不能用于HVAC通风口，这是严格的质量通量边界**)。详细介绍参见 Jarrin [^19]。简而言之，"涡流 "在边界上的随机位置注入流动，并在边界附近相当于最大涡流长度尺度的短距离内随平均流平移。一旦涡流通过该区域，它就会在边界入口处以新的随机位置和长度尺度重新循环。漩涡被理想化为空间球形区域上的速度扰动，其直径（漩涡长度尺度）从均匀随机分布中选择。选择程序保证满足规定的一阶和二阶统计量（包括雷诺应力）。

**<font color=red>通过在VENT行设置湍流数量 N_EDDY、特征湍流长度尺度 L_EDDY、均方根速度波动 VEL_RMS 或雷诺应力张量分量 REYNOLDS_STRESS(3,3)，可以调用合成湍流</font>**。图 10.3 展示了使用 SEM 处理平剖面、抛物线剖面、大气剖面和湍流强度为 10%的斜坡剖面的示例（见湍流验证子目录中的 sem_* 测试系列）。大气剖面的输入线为：（有关剖面参数的进一步讨论，请参见第 16.5 节）。

```fortran
&SURF ID='inlet', VEL=-1, PROFILE='ATMOSPHERIC', Z0=0.5, PLE=0.3 /
&VENT MB='XMIN', SURF_ID='inlet', N_EDDY=100, L_EDDY=0.2, VEL_RMS=.1 /
```

![image-20240617205211679](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617205211679.png)

请注意，**雷诺应力是对称的，只需指定下三角部分。**均方根速度波动是各向同性的（每个分量都等效）。因此，$\mathrm{VEL{\_}RMS}\equiv\sqrt{2k/3}$，其中$k\equiv\langle\frac12u_i^{\prime}u_i^{\prime}\rangle $ 是单位质量的湍流动能。下面的示例说明了速度波动有效值与雷诺应力对角线分量之间的等效关系。请注意，如果指定了 VEL_RMS，则相当于

```fortran
REYNOLDS_STRESS(1,1) = VEL_RMS**2
REYNOLDS_STRESS(2,2) = VEL_RMS**2
REYNOLDS_STRESS(3,3) = VEL_RMS**2
```

REYNOLDS_STRESS的其他分量均为零。如果波动不是各向同性的，那么雷诺应力必须按组件方式指定。

在 Jarrin 的论文[^19]第 7 章中，他介绍了修正合成涡流法，其中涡流长度尺度是各向异性的。这样可以更真实地描述湍流边界层中的流向涡。要指定与 Jarrin 公式 (7.1) 中 $\sigma_{ij}$值相对应的长度尺度，请使用 L_EDDY_IJ(3,3)。下面是一个涡长尺度和雷诺应力分量随机值的示例：

```fortran
&VENT XB=... , SURF_ID='WIND', N_EDDY=500,
    L_EDDY_IJ(1,1)=21., L_EDDY_IJ(1,2)=6.22, L_EDDY_IJ(1,3)=4.23
    L_EDDY_IJ(2,1)=2.35, L_EDDY_IJ(2,2)=5.66, L_EDDY_IJ(2,3)=2.50
    L_EDDY_IJ(3,1)=5.42, L_EDDY_IJ(3,2)=0.78, L_EDDY_IJ(3,3)=1.01
    REYNOLDS_STRESS(1,1)=2.16, REYNOLDS_STRESS(1,2)=0., REYNOLDS_STRESS(1,3)=-0.47
    REYNOLDS_STRESS(2,1)=0., REYNOLDS_STRESS(2,2)=1.53, REYNOLDS_STRESS(2,3)=0.
    REYNOLDS_STRESS(3,1)=-0.47, REYNOLDS_STRESS(3,2)=0., REYNOLDS_STRESS(3,3)=4.259 /
```

**Synthetic Turbulence at OPEN Boundaries**

对于风模拟（见第 16.2 节），可能有必要增加一定程度的流入湍流，以便在不大幅增加计算域大小的情况下与大气条件相匹配。可以在 "OPEN "边界的 VENT 线上调用 Jarrin 的合成涡流法[^19]。该方法应与 WIND 线结合使用，以指定平均风场。例如：

```fortran
&WIND SPEED=10, DIRECTION=270, ... /
&VENT DB='XMIN', SURF_ID='OPEN', N_EDDY=500, L_EDDY=3, VEL_RMS=1 /
```

图 10.4 显示了一个示范案例（`sem_open_wind.fds`）的结果。根据莫宁-奥布霍夫曲线，地面温度设置为 20 ℃，环境温度设置为 19.18℃。入口处的均方根速度波动设为 1 m/s。横向边界为 "PERIODIC"。流入、流出和顶部边界条件设置为 "OPEN"。请注意，针对 WIND 开发了一种特殊的 OPEN 边界条件，FDS 技术指南对此进行了讨论。

![image-20240617210212591](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617210212591.png)

### Random Mass Flux Variation

目前合成涡流法的实施不允许在 SURF 线上定义质量通量的变化。例如，参数 HRRPUA 和 MASS_FLUX 遵循用户指定的时间历史，不包括随机波动。不过，您可以使用参数 MASS_FLUX_VAR 指定质量通量变化。例如，如果您希望单位面积 100 kW/m2 的热释放率变化率为 10%，则使用：

```fortran'
&SURF ID='burner', HRRPUA=100., MASS_FLUX_VAR=0.1 /
```

使用边界文件输出量“MASS FLUX”可能有助于可视化变化。例如,

```fortran
&BNDF QUANTITY='MASS FLUX', CELL_CENTERED=T /
```

## HVAC Systems

在某些情况下，仅仅定义固定流量和固定物种边界条件并不足以模拟暖通空调系统（HVAC）的行为。如果需要通过管道网络传输热量和燃烧产物，或者需要充分考虑火灾导致的隔间增压对管道网络中流量的影响，则可以使用耦合HVAC网络求解器。该求解器计算通过管道网络的流量，**管道网络被描述为管道段和节点的映射，其中节点可以是两个或多个管道的连接处（例如三通），也可以是管道段与 FDS 计算域的连接处**。有关消防安全工程中耦合混合建模的更多信息，感兴趣的读者可以参考 Ralph 等人关于该主题的文献综述[^22]。

默认情况下，HVAC求解器不允许在管道网络中进行质量存储（即在一个时间步长内，进入管道的物质会在一个时间步长内流出）。但是，如果为HVAC管道设置 N_CELLS，HVAC求解器将考虑质量存储，并计算管道中的瞬态物种和能量传输。

暖通空调（HVAC）组件，如风扇和二进制风门（全开或全关），都可纳入暖通空调网络，并与 FDS 控制功能相结合。有三种风扇型号可供选择。

如果输入文件中有暖通空调命名列表组，则会调用HVAC求解器。HVAC网络是通过提供管道输入、管道节点以及系统中的任何风扇、风阀、过滤器或加热和盘管来定义的。此外，您还必须定义HVAC网络与计算域的连接位置。HVAC组件的基本语法为

```fortran
&HVAC TYPE_ID='componenttype', ID='componentname', ... /
```

`TYPE_ID` 是一个字符串，表示 namelist 组定义的组件类型。TYPE_ID 可以是 DUCT、NODE、FAN、FILTER、AIRCOIL 或 LEAK（参见第 10.3.2 节）。

`ID `是一个字符串，表示组件的名称。该名称在该类型的所有其他组件中必须是唯一的；但是，不同类型的组件可以使用相同的名称（例如，一个管道和一个节点可以使用相同的名称，但两个管道不能使用相同的名称）。

样本案例的 HVAC 文件夹中提供了一些简单的 HVAC 系统示例，FDS 验证指南中也对此进行了讨论。

如《技术参考手册》所述，HVAC压力解决方案与 FDS 压力解决方案并不直接耦合。而是通过HVAC通风口的墙壁边界条件进行隐式耦合。有时这会导致稳定性问题。有两种方法可以解决这个问题。

第一种方法是在 MISC 行输入关键字 HVAC_PRES_RELAX，默认值为 1.0。在每个时间步长，FDS 都会评估 FDS 域与 HVAC 网络相邻节点的 FDS 气体单元的平均压力$P_{FDS}$。时间步长 n+1 时的节点压力 $P^{n+1}_{node}$ 取值为
$$
P_{node}^{n+1}=P_{node}^n\mathrm{(1-HVAC\_PRES\_RELAX)}+P_{FDS}^{n+1}\mathrm{HVAC\_PRES\_RELAX}
$$
将该参数设置为 0，可降低暖通空调解决方案对 FDS 域内短时瞬态压力变化的敏感性；但这样做也会导致暖通空调解决方案在较长时间的压力变化中滞后。

第二种方法是在 MISC 行设置关键字 HVAC_LOCAL_PRESSURE。设置后，FDS 将使用通风口处的ZONE压力加上通风口法线流的停滞压力来确定连接到 FDS 域的节点的压力边界条件，而不是使用ZONE压力加上根据 H 的本地值得出的压力。

### HVAC Duct Parameters

指定管道的典型输入行如下所示：

```fortran
&HVAC TYPE_ID='DUCT', ID='ductname', NODE_ID='node 1','node 2', AREA=3.14,
    LOSS=1.,1., LENGTH=2., ROUGHNESS=0.001, FAN_ID='fan 1', DEVC_ID='device 1' /
```

或者，如果您使用HVAC质量输运，如下所示：

```fortran
&HVAC TYPE_ID='DUCT', ID='ductname', NODE_ID='node 1','node 2', AREA=3.14,
    LOSS=1.,1., LENGTH=2., ROUGHNESS=0.001, FAN_ID='fan 1', DEVC_ID='device 1',
    N_CELLS=200 /
```

其中：

“AIRCOIL_ID”为风道内盘管的ID。盘管的运行可以通过装置或控制功能来控制。

AREA是管道的横截面积，单位为$m^2$.

DAMPER是指示风道中存在阻尼器的逻辑参数。阻尼器的状态由装置或控制功能控制(见第10.2.2节)。

DIAMETER为管道直径，单位为m。

“DEVC_ID”为风道内阻尼器、风机或风盘管所在DEVC的ID。另一个选项是CTRL_ID。

FAN_ID是管道中风机的ID。代替指定FAN_ID，您可以指定风管体积流率VOLUME_FLOW（$m^3/s$）。风机的运行可以通过装置或控制功能来控制。

LENGTH是管道的长度（m）。如果没有指定，它将自动计算为管道端点的XYZ之间的差，或者如果定义了WAYPOINTS，则作为端点之间沿路径的距离计算。

LOSS是一对实数，给出正向和反向无因次“小损失”损失系数($K_{minor}$)在管道中。较小的损失是通过三通、阀门和弯头等部件造成的压力损失。不过，您也可以使用 LOSS 表示墙壁摩擦损失，在这种情况下，请确保不设置 ROUGHNESS，这样HVAC求解器就不会计算摩擦系数。**正向**定义为从NODE_ID中列出的第一个节点到NODE_ID中列出的第二个节点的流。

MASS_FLOW是通过管道的固定质量流量(kg/s)。**不要为相同的管道同时指定MASS_FLOW和VOLUME_FLOW**。可以使用特征时间TAU_VF来定义tanh（TAU_VF>0）或$t^2$（TAU_VF<0）使流量随时间变化，或使用RAMP_ID指定随时间变化的流动。**只有当上游节点密度在求解过程中不会发生变化时，才应该指定MASS_FLOW**。

N_CELLS允许HVAC质量输运。它定义了离散管道中的单元数量。

NETWORK_ID用于烟雾视图可视化。在烟雾视图中，所有具有共同NETWORK_ID的管道和节点都可以作为一个组被选择或取消选择。如果没有给出值，则管道将被放置在未赋值的网络。

NODE_ID给出管道段两端节点的ID。管道中的正速度定义为从第一个节点流向第二个节点的流量。

PERIMETER与AREA一起用于指定**非圆形截面的管道**。

RAMP_LOSS如果指定了该RAMP，则该RAMP是LOSS的乘数。

REVERSE是一个逻辑参数，T表示指定的FAN_ID从第二个节点吹到第一个节点。REVERSE对VOLUME_FLOW或MASS_FLOW作为管道输入没有影响。如果风道指定了VOLUME_FLOW或MASS_FLOW，且需要逆流，则将输入的符号改为负。

ROUGHNESS是以m为单位的风管的绝对粗糙度，用于计算风管的摩擦系数。如果未设置ROUGHNESS，则HVAC求解器将不计算摩擦系数，并且壁面摩擦将为零-如果是这种情况，您可能希望在LOSS中考虑壁面摩擦损失。“完全光滑”的管道和圆管仍然有壁面损耗，**因此将粗糙度设置为零将告诉HVAC求解器计算最小摩擦系数(非零)-这与不设置粗糙度不同**。

ROUND表示圆形管道的标志。

SQUARE表示方形管道的标志。

VOLUME_FLOW是管道固定的流量（$m^3/s$）。只能指定MASS_FLOW或VOLUME_FLOW中的一个。可以使用特征时间TAU_VF来定义tanh（TAU_VF>0）或$t^2$（TAU_VF<0）使流量随时间变化，或使用RAMP_ID指定随时间变化的流动。VOLUME_FLOW不能被设备或控制功能控制。不过，这可以通过使用恒流量FAN来实现。

WAYPOINTS是单位为m的坐标数组，它定义了管道所经过的路径。目前这只用于HVAC网络的烟景可视化。最多可以定义30个WAYPOINTS。例如：WAYPOINTS(1,1:3)=1,1,1, WAYPOINTS(2,1:3)=2,2,2作为管道输入的一部分意味着管道从第一个节点开始，然后到达点(1,1,1)，然后到达点(2,2,2)，最后到达第二个节点。

注意:**风管只能输入AIRCOIL_ID、DAMPER或FAN_ID中的一个**。还请注意，如果指定了其中一个，但没有提供设备或控制功能，则将假设该项目处于on或open状态。

如果设置了ROUND或SQUARE，则只能设置AREA、DIAMETER或PERIMETER中的一个。否则需要三个中的两个。

为了减少HVAC求解器的计算成本，应将管道视为连接两个必须定义为节点的项目的任何长度的管道(即，连接到FDS域，过滤器或两个以上管道连接的位置)。也就是说，风管应该被认为是HVAC系统的任何部分，在给定的时间点，流动只能在一个方向上(流动可以随着时间的推移而逆转方向)。例如，图10.5的顶部显示了HVAC系统的一个部分，其中三通的流量经过一个膨胀接头、两个弯头、一个膨胀接头和一段直管，然后作为FDS域的连接终止。

![image-20240617151844874](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617151844874.png)

这可以输入为每个单独的配件或管道及其相关的面积和损失，如图中间所示；然而，这将导致5个管道段(每个组件一个)与6个节点连接，产生11个参数(5个速度和6个压力)，必须求解。这是不需要的，因为无论流量是在管道的任何一部分，相同的流量存在于所有其他部分；因此，任何段的速度都可以通过面积比求出来，$v_1/v_2=A_2/A_1$。由于流动损失与速度的平方成正比，因此可以使用管道的总长度和有效面积(Aeff)或直径来构造等效的管道。通过将风管的所有拟合损失($K_{minor}$)相加，可将风管各节段的压力损失折算为单个有效损失(Keff)，如下所示:
$$
K_{\mathrm{eff}}=\sum_i(K_{\mathrm{minor}})_i\left(\frac{A_{\mathrm{eff}}}{A_i}\right)^2
$$
其中i是拟合，Ai是与拟合损失相关的面积。

### HVAC Dampers

阻尼器可以用两种方式建模。

第一种方法是简单的二元(有流或无流)阻尼器。这可以通过添加关键字DAMPER以及CTRL_ID或DEVC_ID来放置在管道中。当控制或装置为T时，阻尼器将打开，当F时，阻尼器将关闭并阻塞100%的风道面积。下面的例子显示了一个带有阻尼器的管道，阻尼器与DEVC相连，DEVC在10秒关闭阻尼器。

```fortran
&HVAC TYPE_ID='DUCT',ID='EXHAUST 2',NODE_ID='TEE','EXHAUST 2',AREA=0.01,
    LENGTH=1.0,LOSS=0,0,DAMPER=T,DEVC_ID='TIMER'/
&DEVC QUANTITY='TIME',ID='TIMER',SETPOINT=10,INITIAL_STATE=T,XYZ=0,0,0/
```

为了使阻尼器处于关闭状态，然后在稍后的时间打开，DEVC的INITIAL_STATE不应设置为T。下面的例子显示了一个带有阻尼器的管道，它开始关闭，然后在10秒打开。

```fortran
&HVAC TYPE_ID='DUCT',ID='EXHAUST 2',NODE_ID='TEE','EXHAUST 2',AREA=0.01,
    LENGTH=1.0,LOSS=0,0,DAMPER=T,DEVC_ID='TIMER'/
&DEVC QUANTITY='TIME',ID='TIMER',SETPOINT=10,XYZ=0,0,0/
```

第二种方法是为管道指定RAMP_LOSS。这种方法将管道的LOSS数组乘以RAMP的输出。<font color=red>**这允许有泄漏的阻尼器和/或具有可变位置的阻尼器，而不是全开或全关。**</font>下面显示了一个例子，其中管道中的损耗在10秒时从1,1变化到11秒时的2000,2000。

```fortran
&HVAC TYPE_ID='DUCT',ID='EXHAUST 2',NODE_ID='TEE','EXHAUST 2',AREA=0.01,
    LENGTH=1.0,LOSS=1,1,RAMP_LOSS='LOSS RAMP'/
&RAMP ID='LOSS RAMP',T=10,F=1/
&RAMP ID='LOSS RAMP',T=11,F=2000/
```

### HVAC Node Parameters

下面是三个示例管道节点输入，分别表示典型的T型连接(多个管道连接)、到FDS域的连接以及到FDS域外环境的连接。

```fortran
&HVAC TYPE_ID='NODE', ID='tee', DUCT_ID='duct 1','duct 2',..'duct n',
    LOSS=lossarray, XYZ=x,y,z /
&HVAC TYPE_ID='NODE', ID='FDS connection', DUCT_ID='duct 1', VENT_ID='vent',
    LOSS=enter,exit /
&HVAC TYPE_ID='NODE', ID='ambient', DUCT_ID='duct 1', LOSS=enter,exit,
    XYZ=x,y,z, AMBIENT=T /
```

其中：

AMBIENT是一个逻辑值。如果为T，则节点与环境相连(**即相当于SURF线上的OPEN边界条件**)。

DUCT_ID给出连接到节点的管道的ID。如果节点为AMBIENT或具有VENT_ID，则只允许一个管道。一个节点最多可连接10个管道。

FILTER_ID为ID提供了一个位于节点的过滤器。带有过滤器的节点必须有两个连接的管道。**这意味着过滤器不能位于环境节点、连接到VENT的节点或具有三个或更多管道的节点**。

LOSS是一个n × n的实数数组，表示节点的无因次损失系数。LOSS(I,J)为从风管I流向风管J的损失系数，以下游风管面积表示(参见10.2.1中关于如何调整面积变化的损失的讨论)。对于终端节点(例如，连接到环境或VENT的节点)，LOSS输入为一对数字，表示进入HVAC系统的流量和退出HVAC系统的流量的损耗系数。

NETWORK_ID用于烟雾视图可视化。在 Smokeview 中，可以将具有共同 NETWORK_ID 的所有管道和节点作为一个组来选择或取消选择。如果没有给定值，节点将被置于未指定网络中。

VENT_ID为节点连接到FDS计算域的VENT的名称。不应该具有两个相同VENT_ID的VENT。

XYZ是一个实数三元组，**表示节点的坐标**。**如果节点连接到FDS域，则不要指定XYZ**，因为FDS将把它作为VENT的质心计算。

**一个风管节点必须有两个或更多的风管连接到它**，或者它必须有AMBIENT=T或指定的VENT_ID。当将VENT定义为HVAC系统的组件时，必须将SURF_ID设置为' HVAC '，你必须设置VENT_ID。

允许HVAC系统的单个排气管道跨越多个网格；但是，整个排气口必须位于单一压力区内。

请注意，用于HVAC系统的VENT必须在整个模拟过程中存在。**VENT不应该有CTRL_ID或DEVC_ID**。

这也包括它所附着的固体表面；即，任何OBST所附的VENT也需要在整个模拟过程中存在。打开或关闭连接到HVAC系统的VENT，需要在连接到VENT的管道中安装一个阻尼器。

### HVAC Fan Parameters

下面是FDS支持的三种风机的输入示例。

```fortran
&HVAC TYPE_ID='FAN', ID='constant volume', VOLUME_FLOW=1.0, LOSS=2./
&HVAC TYPE_ID='FAN', ID='quadratic', MAX_FLOW=1., MAX_PRESSURE=1000., LOSS=2. /
&HVAC TYPE_ID='FAN', ID='user fan curve', RAMP_ID='fan curve', LOSS=2. /
```

其中，

LOSS是风机不工作时流经风机的损失系数。FDS假定默认值为1。

MAX_FLOW为风机的最大体积流量，单位为$m^3/s$​。这个输入激活了一个二次风扇模型。取值必须大于0。

MAX_PRESSURE为风机失速压力，单位为Pa。这个输入激活了一个二次风扇模型。取值必须大于0。

RAMP_ID标识RAMP，该RAMP包含风机(Pa)与用户定义的风机曲线的体积流量($m^3/s$)的压降表。

TAU_FAN为风机定义tanh (TAU_FAN > 0)或$t^2$ ramp (TAU_FAN < 0)。这适用于由三种类型(恒定流量，二次型或用户定义的斜坡)的风机计算的流量。

VOLUME_FLOW为风机的固定体积流量，$m^3/s$。**如果您希望获得与时间相关的流量，请使用管道而非风机的 VOLUME_FLOW 输入**。

请注意，只能指定一组风扇模型输入（VOLUME_FLOW、RAMP_ID 或 MAX_FLOW + MAX_PRESSURE）。还要注意的是，FAN 定义的是一类风扇，而不是一个特定的风扇。因此，不止一个风道可以引用一个 FAN。

**Fan Curves**

在第 10.1 节中讨论了速度边界条件，其中风扇被简单地模拟为一个固体边界，**它可以吹出或吸入空气，与周围的压力场无关**。在暖通空调（HVAC）模型中，当使用 VOLUME_FLOW 指定风扇时，就会出现这种风扇建模方法。实际上，风机是根据安装在管道或歧管上的压降来运行的。一个非常简单的 "风机曲线 "如下所示：
$$
\dot{V}_{\mathrm{fan}}=\dot{V}_{\mathrm{max}}\mathrm{~sign}(\Delta p_{\mathrm{max}}-\Delta p)\sqrt{\frac{|\Delta p-\Delta p_{\mathrm{max}}|}{\Delta p_{\mathrm{max}}}}
$$
这个简单的“风扇曲线”是“二次”风扇模型，因为压力与体积流量的平方成正比。

无压差时的体积流量MAX_FLOW为$\dot{V}_{\mathrm{max}}$。压差$\Delta p=\Delta p_1-\Delta p_2$，表示下游室压差，或"zone”和上游。下标“1”表示下游，“2”表示上游。$\Delta p_{\mathrm{max}}$为风机可运行的最大压差，MAX_PRESSURE为正数。通过风扇的流量将从零压差时的$\dot{V}_{\mathrm{max}}$减小到$\Delta p_{\mathrm{max}}$时的$0 m^3/s$。如果压差超过这个值，空气将被迫向后通过风扇。如果下游压力变为负值，那么通过风机的体积流量就会增加超过MAX_FLOW。更复杂的风扇曲线可以通过定义RAMP来指定。在下面的示例输入中，每种类型指定一个风扇。VOLUME_FLOW为$10 m^3/s$的定容流量风机，MAX_FLUX=10,MAX_PRESSURE=500的二次型风机，以及RAMP设置增量为200pa的用户自定义风机二次型风机。

```fortran
&HVAC TYPE_ID='FAN', ID='constant volume', VOLUME_FLOW=10.0/
&HVAC TYPE_ID='FAN', ID='quadratic', MAX_FLOW=10., MAX_PRESSURE=500./
&HVAC TYPE_ID='FAN', ID='user fan curve', RAMP_ID='fan curve'/

&RAMP ID='fan curve',T=-10.00,F= 1000/
&RAMP ID='fan curve',T= -7.75,F= 800/
&RAMP ID='fan curve',T= -4.47,F= 600/
&RAMP ID='fan curve',T= 4.47,F= 400/
&RAMP ID='fan curve',T= 7.75,F= 200/
&RAMP ID='fan curve',T= 10.00,F= 0/
&RAMP ID='fan curve',T= 11.83,F= -200/
&RAMP ID='fan curve',T= 13.42,F= -400/
&RAMP ID='fan curve',T= 14.83,F= -600/
&RAMP ID='fan curve',T= 16.12,F= -800/
&RAMP ID='fan curve',T= 17.32,F=-1000/
```

图10.6显示了上述输入的风扇曲线。在验证指南中记录的`ashrae7`和`fan_test`示例案例中可以找到其他示例。

![image-20240617161701038](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617161701038.png)

**Jet Fans**

风扇不必像电源或排气风扇那样安装在坚固的墙壁上。如果你只是想把气体吹向一个特定的方向，制造一个障碍物OBST，至少一个单元厚，并应用于一个简单的HVAC系统相关的VENT行上。这使得热的烟雾气体可以穿过障碍物，就像一个独立的风扇一样。参见示例案例`jet_fan.fds`。在火附近放置一个带百叶窗的风扇(对角线向下吹)的火焰(见图10.7)。

![image-20240617162031674](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617162031674.png)

你也可以用四个平板在风扇周围做一个罩，形成一个短通道，把气体从一边吸进来，从另一边排出。代表风扇的障碍物可以放置在通道的中间(如果使用百叶窗风扇，则将风扇放置在通道的末端)。

**System Curves**

:question:HVAC系统可以用两条曲线来表征。一个，已经讨论过了，是风扇曲线，它描述了通过风扇的流量作为风扇上压头的函数。这是在最大压力下零流量和零压力下最大流量的曲线。第二个是系统曲线。这描述了HVAC系统中的流量如何随着风扇施加的压力的变化而变化。系统曲线说明了系统中的所有损失加上系统入口和出口的压力差。对于入口和出口压力相同的HVAC系统，系统曲线在零压力时流量为零，随着风扇压力的增加，流量也会增加。HVAC系统和风机的特定组合的工作点由这两条曲线的交点给出。

对于相对简单的HVAC网络，在任何给定的管道运行中只有一个风扇，并且网络进出口压力变化不大，FDS使用一种简单的方法来选择风扇压力，该方法基本上认为系统曲线与风扇曲线相反。对于更复杂的网络，FDS可以生成系统曲线。由于系统曲线取决于HVAC系统的具体配置(风扇和阻尼器的状态)以及系统入口和出口的压力，因此在每个时间步骤都要进行此操作。然后，通过找到该风扇曲线与该风扇系统曲线的交集来设置风扇的工作点(即，通过在风扇位置查找各种压力下HVAC系统中的流量建立的曲线)。这种方法显著地增加了HVAC求解器成本，因为它现在必须求解多个风机压力的系统曲线，确定工作点，然后执行用于壁面边界条件的HVAC解决方案。然而，由于HVAC求解器通常只占模拟总成本的很小一部分，因此增加的成本不应显著影响总体运行时间。

此方法通过在MISC行上设置HVAC_QFAN=T来打开。

### HVAC Filter Parameters

**过滤器必须位于有两个连接管道的节点上**。过滤器不能位于环境节点、连接到排气口的节点或具有三个或更多管道的节点。过滤器的样例输入如下：

```fortran
&HVAC TYPE_ID='FILTER', ID='filter 1', LOADING=0., SPEC_ID='SOOT',
    EFFICIENCY=0.99, LOADING_MULTIPLIER=1, CLEAN_LOSS=2., LOSS=100./
```

其中，

AREA是与流量损失测量相关的面积，单位为$m^2$。通常这是过滤器的面积。如果没有提供，则使用两个附加风管面积的平均值。

CLEAN_LOSS是过滤器清洁(零负荷)时流过过滤器的无因次损失系数。

EFFICIENCY是从0到1的物种去除效率的数组，其中**0表示没有去除该物种，1表示完全过滤该物种**。使用SPEC_ID标识物种。

LOADING是一个数组，包含每个过滤物种的过滤器初始负载（千克）。

LOADING_MULTIPLIER 是一个物种乘数 Mi 的数组，用于在计算过滤器损耗系数时计算过滤器的总负载。

LOSS调用线性损耗系数模型，其中无量纲损耗系数 K 是总负载的线性函数，即$K_{\mathrm{FILTER}}=K_{\mathrm{CLEAN_LOSS}}+K_{\mathrm{LOSS}}\sum\left(L_{i}M_{i}\right)$，其中 Li 是物种负载，Mi 是乘数。只能指定 LOSS 或 RAMP_ID 中的一个。

RAMP_ID 用于标识包含过滤器压降表的 RAMP，压降表是总负载（上述 LOSS 定义中的求和项）的函数。只能指定 LOSS 或 RAMP_ID 中的一个。

SPEC_ID标识LOADING_MULTIPLIER和LOADING输入的跟踪物种。

过滤器输入示例如下。这些线条定义了一个过滤器，它能以 100% 的效率去除 PARTICULATE 物种。过滤器的初始损耗系数为 1，过滤器每捕获一千克 PARTICULATE，损耗系数就会增加 7332。更多详细信息，请参阅验证指南中的示例案例` HVAC_filter`。

```fortran
&SPEC ID='PARTICULATE',MW=28.,MASS_FRACTION_0=0.001,SPECIFIC_HEAT=1./
&HVAC TYPE_ID='NODE',ID='FILTER',DUCT_ID='DUCT1','DUCT2',XYZ(3)=0.55,
    FILTER_ID='FILTER'/
&HVAC TYPE_ID='FILTER',ID='FILTER',CLEAN_LOSS=1.,SPEC_ID='PARTICULATE',EFFICIENCY=1.,
    LOSS=7732.446,LOADING_MULTIPLIER=1./
```

注意，一个过滤器输入指的是一类过滤器，多个管道可以引用相同的过滤器定义。

### HVAC Aircoil Parameters

空气盘管指的是一种从流经管道的空气中添加或去除热量的设备。在典型的HVAC系统中，这是通过将空气吹过装有工作流体（如冷冻水或制冷剂）的热交换器（因此称为空气盘管）来实现的。输入管路示例如下：

```fortran
&HVAC TYPE_ID='AIRCOIL', ID='aircoil 1', EFFICIENCY=0.5,
    COOLANT_SPECIFIC_HEAT=4.186, COOLANT_TEMPERATURE=10., COOLANT_MASS_FLOW=1./
```

其中，

COOLANT_MASS_FLOW为工作流体的流量(kg/s)。

COOLANT_SPECIFIC_HEAT是工作流体的比热(kJ/(kgK))。

COOLANT_TEMPERATURE是工作流体的入口温度(℃)。

EFFICIENCY为换热器效率，η，取值范围为0 ~ 1。**值为1表示换热器两侧出口温度相等**。

FIXED_Q为恒定热交换率。**负值表示热量从管道排出**。换热速率可由RAMP_ID或TAU_AC控制。

TAU_AC为空气线圈定义tanh (TAU_AC>0)或$t^2$坡道(TAU_AC<0)。这适用于空气线圈的FIXED_Q。或者，也可以指定RAMP_ID。

请注意，应指定 FIXED_Q 或 COOLANT_SPECIFIC_HEAT、COOLANT_MASS_FLOW、COOLANT_TEMPERATURE 和 EFFICIENCY 设置。在后一种情况下，热交换的计算分为两步。首先，确定出口温度，假设效率为100%(即两种流体在相同温度下出口)：
$$
T_{{\mathrm{fluid,out}}}=\frac{c_{p,\mathrm{gas}}u_{{\mathrm{duct}}}A_{{\mathrm{duct}}}\rho_{{\mathrm{duct}}}T_{{\mathrm{duct,in}}}+c_{{p,\mathrm{fluid}}}\dot{m}_{{\mathrm{fluid}}}T_{{\mathrm{fluid,in}}}}{c_{{p,\mathrm{gas}}}u_{{\mathrm{duct}}}A_{{\mathrm{duct}}}\rho_{{\mathrm{duct}}}+c_{{p,\mathrm{fluid}}}\dot{m}_{{\mathrm{fluid}}}}
$$
其次，利用EFFICIENCY计算实际换热量。
$$
\dot{q}_{\mathrm{coil}}=\eta c_{p,\mathrm{fluid}}\dot{m}_{\mathrm{fluid}}(T_{\mathrm{fluid,in}}-T_{\mathrm{fluid,out}})
$$
请注意，一个空气盘管输入指的是一类空气盘管，多个管道可以引用相同的空气盘管定义。

示例输入文件 `HVAC_aircoil.fds` 演示了如何使用空气盘管输入。恒定流量管道从地板抽走空气（定义为 28 g/mol，比热为 1 kJ/(kgK)），并以 1 立方米/秒的体积流量从天花板注入。工作流体的流速为 10 kg/s，温度为 100℃，比热为 4 kJ/(kgK)。空气盘管的效率为 50%。根据上述公式，空气盘管将为流经管道的气体增加 45.2 千瓦的热量，从而使管道出口温度达到 332 K。结果展示在图10.8。

![image-20240617165830742](F:\Projects\1_原子能院\1_FDS钠火项目\1_过程文档\FDS中钠燃烧模型添加.assets\image-20240617165830742.png)

### Louvered HVAC Vents

所建模的HVAC系统可能会有百叶窗将离开通风口的气流重新定向，或者实际通风口的方向可能不在 FDS 的某个轴线上。要定义HVAC出口的流向，可以在通风口上使用关键字 UVW。UVW 是表示VENT流向的矢量。例如：

```fortran
&OBST XB=1.0,2.0,0.0,1.0,0.0,1.0 /
&VENT XB=1.0,1.0,0.0,1.0,0.0,1.0, SURF_ID='HVAC', ID='HVAC OUTLET', UVW=-1,0,1 /
```

上述输入定义了一个位于 y-z 平面、朝向 -x 方向的通风口。流量矢量显示，该通风口的流量方向为 -x，向上倾斜 45 度（x 和 z 分量大小相等）。FDS 将设置通风口的切向速度，以获得 UVW 所指示的指定方向。**只有在通气口向域输入气体时才会这样做**。请注意，UVW 的值已归一化为单位矢量。

### HVAC Mass Transport

FDS 可以通过对单个HVAC管道进行离散化处理，来考虑HVAC网络中物种和焓传输的时间延迟。这可以通过HVAC管道输入的 N_CELLS 或设置 HVAC_MASS_TRANSPORT_CELL_L 来实现。输入 N_CELLS 将管道长度划分为 N_CELLS 均匀段。参数 HVAC_MASS_TRANSPORT_CELL_L 定义了单元长度，除非被 N_CELLS 改写，否则该长度将应用于输入文件中的所有管道。如果指定了单元长度，则管道的单元数取管道长度除以 HVAC_MASS_TRANSPORT_CELL_L 的整数。当前的暖通空调（HVAC）求解器不考虑暖通空调（HVAC）网络中的热损失。

如果一个风管被离散化，那么该风管中的所有其他风管也必须离散化。并不要求一个风管单元中的所有风管都使用相同的单元尺寸。风管单元是任何相互连接的HVAC组件的集合，其中两个组件之间存在通过穿越风管单元中的风管的路径。

如果您使用 DEVC 输出第 22.2.3 节所述的空间积分统计数据（如VOLUME MEAN、VOLUME INTEGRAL或MASS INTEGRAL），请注意，即使 XB 绑定的积分体积囊括了管道的空间位置，DEVC 也不会记录导管中的数量。例如，如果有 1 立方米的物种 1 在上游的 FDS 小室中初始化，并通过总体积大于 1 立方米的 HVAC 网络传输到下游的 FDS 小室，那么在其处于 HVAC 网络域期间，记录DENSITY的VOLUME INTEGRAL的 DEVC 输出的物种 1 的总质量值将减小为零。

默认情况下，**质量传输管道中的单元格初始化为环境值**。可以通过在 INIT 上指定 NODE_ID，再加上温度（TEMPERATURE）和/或 SPEC_ID，再加上体积（VOLUME_FRACTION）或质量（MASS_FRACTION），将管道初始化为其他值。然后，风道中的数值将通过对风道节点上的数值进行线性插值来设置。

### Specified Flow vs. Unspecified Flow

在FDS中定义HVAC网络有两种基本方法。

在第一种方法中，我们可以指定足够多的 VOLUME_FLOW 和 MASS_FLOW 输入，这样网络中各处的所有流量都是已知的。例如，如果一个三通有三个管道，其中两个管道有指定流量，那么根据该节点的质量守恒，第三个管道的流量是已知的。如果HVAC网络中的所有地方都指定了流量，那么就不需要管道和节点的 LOSS 输入。不要过多指定流量。例如，如果一个节点有三个管道，则不要为其中两个以上的管道指定 VOLUME_FLOW 或 MASS_FLOW。这样可以确保任何数值舍入误差不会导致守恒误差。 

在第二种方法中，一个或多个管道的流量没有指定，在这种情况下，FDS 必须求解管道两端的压力，以确定通过管道的流量。举例来说，如果一个三通有三个管道，而只有一个管道有指定流量，那么 FDS 将使用其他两个管道的相对压降来确定流量。如果没有提供LOSS输入，则 FDS 可能无法正确求解流量。再比如，HVAC网络中的损耗会限制管道中流量随时间变化的速度。如果有一条管道连接两个房间，但没有给出 LOSS 输入，那么微小的压力变化就会导致管道速度的巨大变化，从而增加数值不稳定的风险。如果您指定了一个暖通空调（HVAC）网络，FDS 将对该网络中的流量进行求解，那么您必须为每个可能的流动路径提供 LOSS 输入。FDS 将在启动时执行检查，如果发现指定的损失不足，将返回错误信息；但是，这种检查可能无法发现所有情况。

## Sealed Compartments, Leakage, and Void Spaces

所有建筑物都有与内部大空间相对密封的空间，如增压空间、封闭房间、HVAC管道等。在现实中，这些空间通过接缝和缝隙相连，没有一个是完全密封的。但在 FDS 中，除非您另有说明，否则这些空间都被假定为完全密封的。本节将介绍 “压力区 ”的概念以及如何使用它们，特别是如何处理泄漏。

这些空间非常重要，因为 FDS 假定压力由 “背景 ”分量$\overline{p}(z,t)$和扰动压力 $\tilde{p}(\mathbf{x},t)$组成。大多数情况下，p 只是静水压力，而$\tilde{p}$ 是流动引起的空间分辨扰动。如果计算域中没有密封的空隙，且至少有一个 OPEN 边界，则 FDS 可以假定背景压力只是大气压力，且在整个计算域中都是相同的。但是，如果存在空隙，其背景压力就会不同。例如，如果在密封隔间内起火，背景压力必须高于大气压力。

FDS 有一种算法可以识别计算域中的密封区域，即不与OPEN边界相连的区域。因此，您无需明确声明这些区域或 “压力区”。但是，如果您希望一个压力区通过泄漏路径连接到另一个压力区，则需要明确声明。下一节将讨论如何做到这一点。

### Specifying Pressure Zones

压力区可以是计算域中被固体障碍物与域的其他部分或外部隔开的任何区域。FDS 中有一种算法，可以完全根据您指定的障碍物来识别这些区域。因此，您不必在输入文件中明确标识这些区域。但是，您可能希望某个特定区域泄漏到另一个区域或域的外部。在这种情况下，压力区的基本语法是：

```fortran
&ZONE XYZ=1.2,3.4,5.6, LEAK_AREA(0)=0.001 /
```

参数 XYZ 指定了一个位于密封隔间内的单点（1.2,3.4,5.6），该点没有嵌入固体障碍物中。可以声明多个区域。区域的索引是指定泄漏和风扇所必需的，它由输入文件中指定区域的顺序决定。默认情况下，计算域的外部为 Zone 0。 如果没有 OPEN 边界，整个计算域将被假定为 Zone 1。

分配压力区有几个限制条件。首先，声明的压力区必须完全位于以实体障碍物为边界的区域内。可以通过移除压力区之间的障碍物来 “打破 ”压力区。下面举例说明如何打破压力区。其次，压力区可以跨越多个网格，但建议检查每个网格的压力以确保一致性。如果压力ZONE确实跨越多个网格，则无需为每个网格添加多个 XYZ 点。搜索算法将确定属于该压力区的所有其他网格单元。

请注意，如果移除分隔两个压力区的固体障碍物（如门或窗），FDS 将把两个压力区合并为一个压力区，使每个压力区内的背景压力几乎保持不变。

**Example Case: Pressure Rise in a Compartment**

这个例子测试了 FDS 的几个基本特性。在一个长 3 米、宽 0.002 米、高 1 米的狭窄通道中，以 0.1 千克/平方米/秒的速度向一个面积为 0.2 米乘 0.002 米的区域注入空气，持续 60 秒，在 1 秒内线性上升和下降。注入空气的总质量为 0.00244 千克。域假定为二维，壁为绝热，STRATIFICATION 设置为 F，以消除压力和密度随高度的微小变化。域被分为三个网格，每个网格长 1 米，网格划分完全相同。在 60 秒的注入时间内，压力、温度和密度都会上升。之后，根据状态方程，温度、密度和压力应保持不变。图 10.9 显示了计算结果。密度完全吻合，表明 FDS 注入了适当的质量。压力、密度和温度的稳态值与热力学第一定律得出的理想值一致。

![QQ_1722489370743](/QQ_1722489370743.png)

**Example Case: Breaking Pressure Zones**

在这个例子中，三个简单的隔间最初是相互隔离的，也与外部环境隔离。每个隔间都是一个独立的压力区。空气以每秒 0.1 千克的恒定速度吹入 Zone 1，到 10 秒时，Zone 1的压力增加了约 2000 帕，此时 Zone 1向 Zone 2打开，两个区的总压力下降到原来的约三分之一，因为合并压力区的容积增加了约三倍。15 秒后，打开通往 Zone 3的门，压力进一步降低，最后在 20 秒后，打开通往外部的门，压力恢复到环境压力。图 10.10 显示了每个隔间内的压力。请注意，压力并不是瞬间达到平衡的。相反，PRESSURE_RELAX_TIME（PRES 行）的作用是在指定时间内使各区达到平衡。这样做有几个原因。首先，在现实中，门窗不会像在 FDS 中那样神奇地消失。完全打开它们需要一定的时间，而减缓压力的增减是模拟这种效果的一种简单方法。其次，区域间相对较大的压力差会对流动求解器造成严重破坏，尤其是像 FDS 这样使用低马赫数近似的求解器。为了保持数值稳定性，FDS 会逐渐使压力达到平衡。第二点应该被视为一个警告。

![QQ_1722489524339](/QQ_1722489524339.png)

**不要使用 FDS 研究压力容器的突然破裂！**它的低马赫数配方不允许高速可压缩效应，而这种效应在此类分析中非常重要。本例中描述的区域破裂功能仅适用于舱室之间相对较小的压力差（<0.1 atm）。实际建筑物无论如何都无法承受更大的压力。

**Example Case: Irregularly Shaped Zone**

本示例与上一节中的示例类似，不同之处在于本示例中的压力区呈 L 形，并被分割成两个网格。目的只是确保压力区的规格在模型中得到适当考虑。图 10.11 比较了车厢内的预测压力和精确解法。空气注入隔间 5 秒钟后，隔间被打开到一个较小的隔间。15 秒后，较小的隔间向外打开。

![QQ_1722489892092](/QQ_1722489892092.png)

### Leaks

**除了核电站的安全壳建筑等少数明显的例外情况，现实世界中的建筑并不是气密的。**门窗沿线、墙壁相接处以及地板和天花板都会出现小缝隙。当隔间因火灾而增压时，空气就会从这些小缝隙中漏出。这就是所谓的泄漏。

由于泄漏面积通常非常小，因此泄漏本质上是一种亚网格现象。换句话说，不可能在数值网格上直接定义泄漏。有时可以将泄漏 “归并 ”到一个可通过网格解决的孔中，但这样做有两个问题。首先，泄漏面积很少与单个网格单元大小的孔的面积完全一致。其次，通过孔洞的流速可能很大，会导致数值不稳定。

处理泄漏的更好方法是利用HVAC模型。可以将发生泄漏的隔间表面视为一个大型HVAC通风口，通过一个很小的管道与外部相连。这样就可以在域中的大面积区域内消除泄漏（就像现实中一样），同时正确捕捉泄漏路径的实际面积。这有两种方法。第一种方法是只利用压力区。压力区是用户在计算域中指定的完全被固体障碍物包围的体积。例如，封闭房间的内部可以也应该被宣布为压力区。在这种方法中，压力区内的表面被标记为泄漏，这些表面可被视为HVAC通风口，通过细小的管道与外部相连，其面积即为泄漏面积。这种泄漏方法可以防止隔间内的压力随着火势的增长和衰减而发生较大变化，但无法考虑外部风力或烟囱效应等影响。第二种方法适用于位置明确的泄漏（裂缝大小为亚网格的裂缝门）或堆垛效应很重要的泄漏。它使用局部压力（包括区域压力），允许泄漏量的变化。

**Pressure Zone Leakage**

压力区渗漏法旨在捕捉通过墙壁发生的大量渗漏。这种方法假定泄漏气体量非常小，并且在穿过墙壁时会交换足够的热量，使其与墙壁表面温度相同。采用这种方法时，源区和目的区之间的压力将用于通过暖通空调模型计算泄漏流量。然后将该流量均匀施加到指定为泄漏路径一部分的所有表面上。第一步是定义压力区、泄漏区域以及发生泄漏的表面描述：

```fortran
&ZONE XYZ=..., LEAK_AREA(0)=0.0001 /
&ZONE XYZ=..., LEAK_AREA(1)=0.0002, LEAK_AREA(0)=0.0003 /
&SURF ID='LEAKY EXTERIOR WALL',..., LEAK_PATH=1,0 /
&SURF ID='LEAKY INTERIOR WALL',..., LEAK_PATH=1,2 /
```

第一行指定计算域中的一个区域为压力区 1。**请注意，ZONE行的顺序很重要；也就是说，顺序隐含地定义了区域 1、区域 2 等。0 区默认为环境压力外部。**在本例中，1 区和 0 区外部之间存在泄漏，泄漏面积为 0.0001 平方米（例如 1 厘米乘 1 厘米的孔）。2 区向 1 区泄漏（反之亦然），泄漏面积为 0.0002 平方米。2 区也向外泄漏，泄漏面积为 0.0003 平方米。请注意，各区不一定要物理连接才能发生泄漏，但除外部外，每个区都必须有指定的 LEAK_PATH 表面。在这里，1 号区和 2 号区都有由 “LEAKY EXTERIOR WALL ”和 “LEAKY INTERIOR WALL ”所定义的表面，以便提供一个可应用渗漏的表面。泄漏量均匀分布在分配给 LEAK_PATH 的所有实体表面上。LEAK_PATH 指定的两个压力区的顺序并不重要，施加泄漏的固体障碍物不必在两个区之间形成边界。请注意，可以使用 LEAK_PATH_ID 代替 LEAK_PATH。要使用 LEAK_PATH_ID，请提供两个ZONES的 ID，其中指定 “AMBIENT ”表示区域 0。

通过面积为 $A_L $的泄漏点的体积流量 $\dot V$ 由以下公式得出
$$
\dot{V}_{\mathrm{leak}}=C_{\mathrm{d}}A_{\mathrm{L}}\operatorname{sign}(\Delta p)\sqrt{2\frac{|\Delta p|}{\rho_{\infty}}}
$$
其中 $C_d$ 为排放系数，$Δp$ 为相邻隔间的压差（Pa），$\rho_{\infty}$ 为环境密度（千克/立方米）。这类公式中通常使用的排出系数有时假定为 1，但您也可以更改。

随着典型建筑物内部压力的升高，细小的缝隙、裂缝和其他泄漏通道会导致泄漏面积增大。根据 ASTM E779 等测试标准进行的泄漏测试提供了两个额外的数据点来量化这种行为。这就是 LEAK_PRESSURE_EXPONENT 和 LEAK_REFERENCE_PRESSURE。这些附加输入的使用在下式中分别表示为 n 和 $\Delta p_{\mathrm{ref}}$，其中 $A_{\mathrm{L,ref}}$ 由 LEAK_AREA 给出。
$$
A_\mathrm{L}=A_\mathrm{L,ref}\left(\frac{|\Delta p|}{\Delta p_\mathrm{ref}}\right)^{n-0.5}
$$
**默认情况下，n = 0.5，$\Delta p_{\mathrm{ref}}$ = 4 Pa，这意味着泄漏面积不会随压力变化**。DISCHARGE_COEFFICIENT 默认为 1。

HVAC输出量可用于确定泄漏流量。FDS 将连接 A 区和 B 区的管道命名为 “LEAK A B”，并将管道节点命名为 “LEAK A B”，表示 A 区一侧的泄漏，“LEAK B A ”表示 B 区一侧的泄漏。请注意，对于管道名称，FDS 将使用编号较低的区域作为 A 区。

FDS 的默认上限为 200 个ZONE输入。如有需要，可通过 MISC 行上的参数 MAX_LEAK_PATHS 增加这一上限。

**Localized Leakage**

局部泄漏方法可解决不一定从一个密封压力区泄漏到另一个密封压力区的情况。例如，部分打开的门所产生的缝隙可能太窄，无法明确解决，但模型中仍可表示热气体从顶部漏出和冷气体从底部进入的情况。局部泄漏方法使用的是局部压力而不是平均区域压力，这样就可以为跨度很大的门窗定义多条泄漏路径，例如在堆叠效应可能很重要的楼梯间。使用这种方法时，两条VENT通过一条 TYPE_ID=“LEAK ”的HVAC线路相连。例如，输入线

```fortran
&VENT XB=..., SURF_ID='SURF 1', ID='VENT 1' /
&VENT XB=..., SURF_ID='SURF 2', ID='VENT 2' /
&HVAC ID='LEAK1', TYPE_ID='LEAK', VENT_ID='VENT 1', VENT2_ID='VENT 2', AREA=0.001 /
```

在名为 “VENT 1 ”和 “VENT 2 ”的VENT之间指定 0.001 平方米的泄漏。如果泄漏路径通向域外，则设置 VENT2_ID='AMBIENT'，在这种情况下，第二个节点将被指定为第一个节点的名称，并加上'AMB'，例如'VENT 1 AMB'。每个 VENT 都必须有一个明确的 SURF_ID。壁面传热将根据指定的 SURF_ID 进行计算。以下是有关局部泄漏的一些规则和做法：

- 有局部泄漏的通风口的 SURF_ID 不是 “HVAC”。每个通风口都必须有一个明确的 SURF_ID。
- 每个VENT必须位于一个压力区内，但可以跨越多个 MESH。
- 根据公式 (10.7) 和 (10.8)，您可以在 HVAC 线路中添加参数 LEAK_PRESSURE_EXPONENT、LEAK_REFERENCE_PRESSURE 和 DISCHARGE_COEFFICIENT。
- 所有局部泄漏的 HVAC 组件都被赋予 NETWORK_ID='LEAK'。
- 用于局部渗漏的VENT不应被赋予带有 LEAK_PATH 输入的 SURF_ID。
- 局部泄漏区域不应也是在ZONE线上定义的 LEAK_AREA 的一部分。
- 用于局部泄漏的VENT不应有定义质量流量的任何其他输入。
- 通过在HVAC线路上设置 TRANSPORT_PARTICLES=T，可以通过局部泄漏路径传输粒子。这要求两个VENTs的面积和方向相同，偏移不超过一个网格单元。
- 在整个模拟过程中，必须有一个局部泄漏VENT。例如，如果您希望有一扇门在关闭时会泄漏，但在模拟过程中又会打开，那么请将泄漏通风口定义在地板上、门的上方或门的侧面。当门打开时，泄漏路径仍然存在，但泄漏路径上的压力将大大降低，泄漏流量与门口流量相比将微不足道。
- 与区域泄漏方法不同，局部泄漏可以选择保留流经泄漏点的气体能量。例如，对于使用压力区域泄漏的门裂缝，门顶部流出的气体温度与室外相同。为保持热气从泄漏处流出，请在HVAC输入中添加 LEAK_ENTHALPY=T。这将为每个流出的墙壁单元计算泄漏气流温度与表面温度之间的焓差，并将其作为热源添加到相邻的气体单元中。默认值为 LEAK_ENTHALPY=F。
- 局部泄漏可通过在 HVAC 输入上指定 LOSS 来改变流量损失。默认值为 LOSS=1，与压力区泄漏相同。

**Example Case: door_crack**

本例涉及一个小隔间，一侧墙壁装有风扇，另一侧墙壁装有一扇封闭的门，门底部有渗漏。在隔间内加了一个小火（160 千瓦）。起初，由于火的热量和风扇向隔间内吹入的空气，压力会上升。最终，隔间内的压力上升超过了风扇的最大压力，此时隔间开始从风扇和泄漏处排气。由于火灾，压力将继续上升，直到泄漏和风扇回流造成的压力释放与火灾造成的压力上升相等。

![QQ_1722491985132](/QQ_1722491985132.png)

### Breaking Pressure Zones

PRES 行中有两个参数用于控制与速度和压力耦合相关的迭代程序，其中一个称为 RELAXATION_FACTOR，默认值为 1。其中一个称为 RELAXATION_FACTOR，默认值为 1。当固体边界处的速度法向分量出现误差时，该参数要求在 1 个时间步长内进行修正。如果其值为 0.5，则修正将在 2 个时间步长内进行。

类似的参数还有 PRESSURE_RELAX_TIME。它控制着相邻舱室的压力在破裂后恢复平衡的速度。其默认值为 1 秒，即大约在一秒钟内达到平衡。

### Filling Pressure Zones

有时，一个复杂的几何体可能会有相对较小的空隙，这些空隙与域的其他部分或 OPEN 边界不相连。有时需要这些空间，有时不需要。也就是说，有时它们是几何体生成软件的产物。如果不希望在域内出现这些空隙，可以在 MISC 行设置一个名为 MINIMUM_ZONE_VOLUME 的参数。该参数的单位为 m3，用于告诉 FDS 填充所有小于最小体积的空隙。默认情况下，其值为 0 立方米，即不填充任何空隙。如果将其值设为很大，则所有空隙都会被填满。

在极少数情况下，可能需要完全抑制压力ZONE。虽然不推荐使用这种方法，但这种方法可能有助于调试或诊断。要删除所有隐式压力ZONE，请在 MISC 行设置 NO_PRESSURE_ZONES。这与设置较高的 MINIMUM_ZONE_VOLUME 值不同。相反，它告诉 FDS 忽略空隙并在整个域中使用相同的背景压力。

## Pressure Boundary Conditions

在某些情况下，指定边界处的压力比速度更方便。例如，假设您正在对隧道内部进行建模，其中一个入口处吹来的风会影响隧道内的整体流向。如果（也只有在）使用OPEN通风口来定义入口，那么边界处的*动态压力*可以这样指定：

```fortran
&VENT XB=..., SURF_ID='OPEN', DYNAMIC_PRESSURE=2.4, PRESSURE_RAMP='wind' /
&RAMP ID='wind', T= 0.0, F=1.0 /
&RAMP ID='wind', T=30.0, F=0.5 /
.
.
```

动态压力边界的使用对 FDS 算法的影响如下。在 OPEN 边界，流体动力压力（水头）H 规定为
$$
\begin{array}{rcl}H&=&\text{DYNAMIC\_PRESSURE}/\rho_{\infty}+|\mathbf{u}|^{2}/2\quad\text{(outgoing)}\\H&=&\text{DYNAMIC\_PRESSURE}/\rho_{\infty}\quad\text{(incoming)}\end{array}
$$
其中，$\rho_{\infty}$ 是环境密度，$\mathrm{u}$ 是边界上的最新速度值。PRESSURE_RAMP 允许改变压力与时间的函数关系。请注意，您不需要像其他各种斜坡一样，从零点开始增加或减少压力。在静止边界上产生正动态压力的净效果是将气流驱动到域中。然而，具有足够强度的火驱动气流可以反作用于进入的气流。

下面几行取自示例案例 pressure_boundary，演示了如何在隧道末端指定一个随时间变化的压力边界。隧道长 10 米，宽 1 米，高 1 米，中间有火，右侧有压力边界。左侧（XMIN）只是一个OPEN边界，没有指定压力。假定其处于环境压力下。

```fortran
&VENT MB = 'XMIN' SURF_ID = 'OPEN' /
&VENT MB = 'XMAX' SURF_ID = 'OPEN', DYNAMIC_PRESSURE=2.4, PRESSURE_RAMP='wind_ramp' /
&RAMP ID='wind_ramp', T= 0., F= 1. /
&RAMP ID='wind_ramp', T=15., F= 1. /
&RAMP ID='wind_ramp', T=16., F=-1. /
```

图 10.13 显示了 Smokeview 在隧道右侧入口施加正压前后拍摄的两张快照。火势向左倾斜，因为该方向有优先流。当正压变为负压时，火势又向右倾斜。

![QQ_1722492740986](/QQ_1722492740986.png)

## Special Flow Profiles

默认情况下，通风口喷射的空气具有均匀或 “顶帽 ”速度曲线，但 SURF 线的参数 PROFILE 可以产生其他曲线。

**Parabolic**

PROFILE='PARABOLIC'（抛物线剖面）将生成抛物线剖面，其中 VEL（米/秒）为最大速度，VOLUME_FLOW（立方米/秒）为所需体积流量。例如，Flowfields 示例文件夹中名为 parabolic_profile.fds 的测试用例演示了如何创建一个圆形或矩形通风口，每个通风口都有一个抛物线入口剖面。下面的两条VENT线分别创建了圆形和矩形入口，每个入口都以 0.5 立方米/秒的速度向隔间注入空气（或背景气体）。

```fortran
&SURF ID='BLOW', VOLUME_FLOW=-0.5, PROFILE='PARABOLIC' /
&VENT SURF_ID='BLOW', XB=-3,1,-3,1,0,0, RADIUS=2., XYZ=-1,-1,0 /
&VENT SURF_ID='BLOW', XB= 3,5,-2,1,0,0 /
```

该测试案例的目的是确保将适量的气体（在本例中为氮气）强制送入隔间，并通过压力升高加以确认。图 10.14 显示了带有这两个抛物面通风口的大型隔间中计算压力上升与实际压力上升的比较。根据方程和分析解法，压力应该上升：
$$
\frac{\mathrm{d}p}{\mathrm{d}t}=\frac{\gamma\dot{V}}Vp\quad\Longrightarrow\quad p(t)-p_0=p_0\left(\mathrm{e}^{\frac{\gamma\dot{V}}Vt}-1\right)
$$
其中，比热比 $\gamma$ = 1.4，体积流量 $\dot V$ = 1 m3/s，容积 V = 4000 m3，环境压力$ p_0$ = 101325 Pa。请注意，为获得这一简单结果，运行 FDS 时将 CONSTANT_SPECIFIC_HEAT_RATIO 选项设为 true。

![QQ_1724760004162](/QQ_1724760004162.png)

**Boundary Layer (Circular Vent)**

PROFILE='BOUNDARY LAYER'可用于使用 RADIUS 创建的圆形通风口。通过在 SURF 线上添加 VEL_BULK 和 VEL，FDS 将生成一个塞流核心剖面，最大速度由 VEL 给出，边界层为二次剖面。图 10.15 举例说明了圆形通风口的剖面形式。速度剖面（此处取垂直剖面）的函数形式为
$$
\left.w(r)=\left\{\begin{array}{ll}w_{\max}&\quad\mathrm{if}\quad r\leq R-\delta\\w_{\max}\left(1-\left(\frac{r-(R-\delta)}\delta\right)^2\right)&\quad\mathrm{if}\quad R-\delta<r\leq R\end{array}\right.\right.
$$
体积速度是体积流量除以圆形流通面积。VEL_BULK 为负值，指向域内。边界层厚度为 δ。这一特征对于处理最大流速高于体积流速的情况非常方便。下面是输入文件行的示例：

```fortran
&SURF ID='JET', VEL=-69, VEL_BULK=-53, PROFILE='BOUNDARY LAYER', ... /
```

![QQ_1724760068265](/QQ_1724760068265.png)

# User-Specified Functions

FDS 输入文件中指定的许多参数都是固定常数。不过，有几个参数可能会随时间、温度或空间而变化。通过命名列表组 RAMP 和 TABL，可以控制这些参数的行为。RAMP 允许您指定一个自变量（如时间）和一个因变量（如速度）的函数。TABL 允许您指定包含多个自变量（如实体角）和多个因变量（如喷洒器流速和液滴速度）的函数。

FDS 限制输入文件中可指定的 RAMP 数量。**该限制由 MISC 上的参数 MAX_RAMPS 控制。默认值为 100**。

## Time-Dependent Functions

在任何计算开始时，各处的温度都是环境温度，各处的流速都是零，没有任何东西在燃烧，所有物质的质量分数都是均匀的。您可以使用预定义函数或用户自定义函数指定时间历程，从而控制开启或关闭的速度。参数 TAU_Q、TAU_T 和 TAU_V 表示热释放率 (HRRPUA)、表面温度 (TMP_FRONT)、和/或法线速度 (VEL、VOLUME_FLOW) 或 MASS_FLUX_TOTAL 升温到规定值，以热释放率 $\dot{Q}(t)$为例：
$$
\left.\dot{Q}(t)=\left\{\begin{array}{ll}\dot{Q}_0\left(t/\tau\right)^2&\mathrm{if~TAU_Q~is~negative}\\\dot{Q}_0\tanh\left(t/\tau\right)&\mathrm{if~TAU_Q~is~positive}\end{array}\right.\right.
$$
 $\dot{Q}(t)$是用户指定的热释放率。如果火势按照 t 平方曲线上升，则在 TAU_Q 秒后保持恒定。这些规则也适用于 TAU_T 和 TAU_V。所有 TAU 的默认值都是 1 s[^11-1-1]。如果不希望使用 tanh 或 t 平方斜坡上升曲线，则可以输入用户自定义函数。为此，可将 RAMP_Q、RAMP_T 或 RAMP_V 设置为一个字符串，指定用于特定表面类型的斜坡函数，然后在输入文件的某处生成以下格式的行：

```fortran
&RAMP ID='rampname1', T= 0.0, F=0.0 /
&RAMP ID='rampname1', T= 5.0, F=0.5 /
&RAMP ID='rampname1', T=10.0, F=0.7 /
```

这里，T 是时间，F 表示热释放率、壁温、速度、质量分数等的应用分数。线性插值[^11-1-2]用于填充中间时间点。还要注意的是，T**AU 和 RAMP 是互斥的。对于给定的表面积，两者不能同时规定**。举例来说，一个简单的通风口可以通过管线进行控制：

```fortran
&SURF ID='BLOWER', VEL=-1.2, TMP_FRONT=50., RAMP_V='BLOWER RAMP', RAMP_T='HEATER
RAMP' /
&RAMP ID='BLOWER RAMP', T= 0.0, F=0.0 /
&RAMP ID='BLOWER RAMP', T=10.0, F=1.0 /
&RAMP ID='BLOWER RAMP', T=80.0, F=1.0 /
&RAMP ID='BLOWER RAMP', T=90.0, F=0.0 /
&RAMP ID='HEATER RAMP', T= 0.0, F=0.0 /
&RAMP ID='HEATER RAMP', T=20.0, F=1.0 /
&RAMP ID='HEATER RAMP', T=30.0, F=1.0 /
&RAMP ID='HEATER RAMP', T=40.0, F=0.0 /
```

使用 TAU_T 或 RAMP_T 控制表面温度的上升。t 时刻的表面温度 Tw(t) 为
$$
T_\mathrm{w}(t)=T_0+f(t)\left(\text{TMP FRONT}-T_0\right)
$$
其中，f (t) 是在时间 t 对 RAMP_T 进行评估的结果，T0 是环境温度，TMP_FRONT 与 RAMP_T 指定在同一 SURF 行。使用 TAU_MF(N) 或 RAMP_MF(N)，可以控制物种 N 的质量分数或质量通量的上升：

```fortran
&SURF ID='...', MASS_FLUX(1:2)=0.1,0.3, SPEC_ID(1:2)='ARGON','NITROGEN',
TAU_MF(1:2)=5.,10. /
```

表明氩气和氮气的注入速度分别为 0.1 千克/（平方米-秒）和 0.3 千克/（平方米-秒），注入时间分别约为 5 秒和 10 秒。

在评估时基 RAMP 时，RAMP 使用的时间是使用 RAMP 的项目（如 VENT、OBST、DEVC）激活后的时间。也就是说，如果使用 RAMP 的项目的激活时间与 T_BEGIN 相同（参见 6.2.1），则 RAMP 使用实际时间。否则，将使用 RAMP 激活时的时间进行评估。因此，如果设置 T_BEGIN 是为了测试一个最终与 RAMP 关联的基于时间的 CTRL 或 DEVC，则应将 T_BEGIN 设置为略低于 RAMP 激活的时间。例如，如果要测试一个将在 10 秒时打开的VENT，而其 SURF_ID 使用了 RAMP，那么 T_BEGIN 的设置应略低于 10 秒。

表 11.1 列出了 RAMP 可以控制的各种数量。

![QQ_1724761619015](/QQ_1724761619015.png)



****

[^11-1-1]:You can change the default ramp-up time by setting TAU_DEFAULT on the MISC line
[^11-1-2]:By default, FDS uses a linear interpolation routine to find time or temperature-dependent values between user-specified points. The default number of interpolation points is 5000, more than enough for most applications. However, you can change this value by specifying NUMBER_INTERPOLATION_POINTS on any RAMP line.

## Temperature-Dependent Functions

导热系数和比热等热特性会随着温度的变化而发生显著变化。在这种情况下，请使用 RAMP 函数：

```fortran
&MATL ID = 'STEEL'
FYI = 'A242 Steel'
SPECIFIC_HEAT_RAMP = 'c_steel'
CONDUCTIVITY_RAMP = 'k_steel'
DENSITY = 7850. /
&RAMP ID='c_steel', T= 20., F=0.45 /
&RAMP ID='c_steel', T=377., F=0.60 /
&RAMP ID='c_steel', T=677., F=0.85 /
&RAMP ID='k_steel', T= 20., F=48. /
&RAMP ID='k_steel', T=677., F=30. /
```

请注意，与时间斜坡不同，温度斜坡的参数 F 是实际的物理量，而不仅仅是其他量的一部分。因此，如果使用 CONDUCTIVITY_RAMP，则不应给出 CONDUCTIVITY 的值。还需注意的是，对于低于或高于给定范围的温度值 T，FDS 将假定其恒定值等于指定的第一个或最后一个 F。还请注意，**材料的密度不能用 RAMP 函数控制**。

## Spatially-Dependent Velocity Profiles

与在 SURF 上使用 PROFILE='ATMOSPHERIC'类似，也可以指定 PROFILE='RAMP'来生成表面速度法向分量的一维或二维剖面图。以下代码在 “XMIN ”边界上生成 u(z) 剖面图。

```fortran
&SURF ID='inlet', VEL=-7.72, PROFILE='RAMP', RAMP_V_Z='u_prof' /
&VENT MB='XMIN', SURF_ID='inlet'/
&RAMP ID='u_prof', T=0., F=0. /
&RAMP ID='u_prof', T=0.0098, F=0. /
&RAMP ID='u_prof', T=0.01005, F=0.2474 /
&RAMP ID='u_prof', T=0.01029, F=0.4521 /
&RAMP ID='u_prof', T=0.01077, F=0.6256 /
&RAMP ID='u_prof', T=0.01174, F=0.7267 /
&RAMP ID='u_prof', T=0.01368, F=0.8238 /
&RAMP ID='u_prof', T=0.01562, F=0.8795 /
&RAMP ID='u_prof', T=0.01756, F=0.9378 /
&RAMP ID='u_prof', T=0.0195, F=0.9663 /
&RAMP ID='u_prof', T=0.02144, F=0.9922 /
&RAMP ID='u_prof', T=0.02338, F=0.9987 /
&RAMP ID='u_prof', T=0.02532, F=1 /
&RAMP ID='u_prof', T=0.0588, F=1 /
```

请注意，V 表示表面法线方向的速度分量。您还可以指定 RAMP_V_X 和 RAMP_V_Y，并将其添加到 SURF 中。请注意，只有平面方向上的剖面会影响给定的曲面。也就是说，如果曲面的方向是 y-z 平面，则只有 RAMP_V_Y 和 RAMP_V_Z 适用。在 RAMP 的定义中，T 是自变量，F 是因变量。在本例中，T 是以米为单位的 Z 坐标，F 是与 SURF 线上的 VEL 相乘的因子。一个曲面可以有两个斜面。

T 无需与 FDS 网格直接相关。速度点将通过斜坡函数进行线性插值。事实上，这种功能对于将实验数据直接作为 FDS 的边界条件非常方便。您基本上只需要列出数据中的 T 和 F（如果需要，可以设置 VEL=-1）。FDS 验证指南[^23]中的 “Backward Facing Step ”标题下包含了这种特殊情况的结果。在此问题中，台阶高度为 h = 0.0098 m，入口剖面的规范对于正确匹配台阶下游的重新附着点至关重要。

## Scaling, Rotation and Translation

使用名为 “移动 ”的命名列表组，可以缩放、旋转和/或平移 FDS 仿真中的各种对象。例如，线条

```fortran
&MOVE ID='spin', ROTATION_ANGLE=45., X0=2., Y0=3., Z0=4., AXIS=1,0,0 /
```

会使对象围绕从点 (x0,y0, z0) 出发的方向向量 (AXIS) (1,0,0) 旋转 45◦。您可以通过定义因子 SCALE> 0. 或因子 SCALEX、SCALEY、SCALEZ 按不同方向缩放来缩放对象在其原始未旋转轴（x0,y0,z0）上的比例。您还可以使用参数 DX、DY、DZ（单位均为米）在三个坐标方向上平移对象。还可以使用 3×4 变换矩阵对物体进行旋转、缩放和平移。描述坐标为 x、y、z 的点 p 的变换方程为
$$
\left\{\begin{array}{c}x'\\y'\\z'\end{array}\right\}=\left[\begin{array}{cccc}i_1&j_1&k_1&a_1\\i_2&j_2&k_2&a_2\\i_3&j_3&k_3&a_3\end{array}\right]\left\{\begin{array}{c}x\\y\\z\\1\end{array}\right\}
$$
其中primes 表示点 p 的新位置。在这种情况下，上一条MOVE线的定义为

```fortran
&MOVE ID='My Move', T34 = i1,i2,i3, j1,j2,j3, k1,k2,k3, a1,a2,a3 /
```

其中，$(i_1, i_2, i_3)$, $( j_1, j_2, j_3)$ 和 $(k_1,k_2,k_3) $是用于旋转和缩放操作的正交基向量，$(a_1,a_2,a_3)$ 是平移向量。请注意，如果定义了 $\text{T34}$，它将优先于所有其他变换参数。

目前，移动功能只适用于点和线设备，今后将适用于非矩形沉浸对象。

# Chemical Species

FDS 主要是为研究火灾现象而设计的，只需用户输入最少的信息即可处理大部分基本的燃烧化学反应。不过，在许多应用中，您可能需要模拟无火状态下的气体运动，或者在涉及火的模拟中添加其他化学物质。气体种类通过输入组 SPEC 进行定义。该输入组可用于定义原始气体种类和混合气体种类（一种或多种原始 SPEC 的混合物）。

气体种类在模拟中可能扮演不同的角色。气体种类可能会被明确跟踪。换句话说，要为其求解传输方程。气体种类可能是一起传输的气体混合物的一个组成部分。例如，FDS 利用了火灾燃烧产物混合在一起传播的原理；您只需为这种 “混合气体 ”求解一个传输方程。或者，一种气体可能同时具有这两种特性，例如 H2O，它既可以是燃烧产物的混合体的一部分，也可以是追踪洒水器水滴蒸发产生的 H2O 的明确追踪体。

FDS 中的默认燃烧模型假定反应是混合控制的，并对三个物种的传输方程进行求解：产物和空气（默认背景）这两个集合物种以及燃料物种（如 REAC 上所定义）。没有理由为燃烧的主要反应物和产物——燃料、O2、CO2、H2O、N2、CO 和烟尘——求解单独的（代价高昂的）传输方程，因为它们都是这三种物质的预制函数。有关燃烧的更多详情，请参见第 13 章。目前，您只需认识到，**如果您只想模拟涉及碳氢化合物燃料的火灾，则不需要也不应该使用 SPEC 行明确列出燃烧的反应物和产物**。

## Specifying Primitive Species

SPEC 命名列表组用于在 FDS 中定义气体种类。一旦定义，该物种可作为单个物种（即原始物种）进行跟踪，和/或该物种可作为一个或多个集合物种的一部分使用，这些集合物种也是用 SPEC 定义的。一个物种既可以作为集合物种的一部分，也可以单独跟踪。通常情况下，计算中引入的额外气体与燃烧产物相同，如喷头喷出的水蒸气或灭火器喷出的二氧化碳。这些气体被单独追踪。因此，燃烧产生的水蒸气会通过 “产物”（PRODUCTS）集合变量进行跟踪，而喷淋水滴蒸发产生的水蒸气则会通过其自身的传输方程进行跟踪。

如果一个物种只作为一个或多个集合物种的一部分使用，则必须在 SPEC 行添加 LUMPED_COMPONENT_ONLY=T。这样 FDS 就不会在跟踪气体数组中为该物种分配空间。如果要将某种气体作为背景气体，则应在 SPEC 行设置参数 BACKGROUND=T。LUMPED_COMPONENT_ONLY=T 的物种不能作为单个物种使用，也不能作为背景物种使用。不过，BACKGROUND=T 的原始物种也可以作为集合物种定义的一部分。请注意，默认的背景物种是 AIR，它被定义为由 N2、O2、CO2 和 H2O 组成的集合物种。如果输入文件中没有定义背景物种，则 FDS 将通过内部创建第 12.2 节例 2 中所示的输入行来创建 AIR 背景物种。

请注意，虽然您可以在输入文件中使用 SPEC 定义任意数量的物种，但任何与物种列表相关的命名列表输入（如任何 SPEC_ID 输入或 MASS_FRACTION 输入）都**仅限于使用不超过 20 个物种**。

### Basics

每个 SPEC 行至少应通过字符串 ID 列出物种名称。一旦声明了额外的物种，就可以通过参数 MASS_FRACTION(:) 或 MASS_FLUX(:) 以及字符数组 SPEC_ID(:)将其引入表面。名为 gas_filling.fds 的简单输入文件提供了一个非常简单的示例，说明如何在模拟中引入气体。相关行列如下

```fortran
&SPEC ID='HYDROGEN' /
&SURF ID='LEAK', SPEC_ID(1)='HYDROGEN', MASS_FLUX(1)=0.01667, RAMP_MF(1)='leak_ramp' /
&RAMP ID='leak_ramp', T= 0., F=0.0 /
&RAMP ID='leak_ramp', T= 1., F=1.0 /
&RAMP ID='leak_ramp', T=180., F=1.0 /
&RAMP ID='leak_ramp', T=181., F=0.0 /
&VENT XB=-0.6,0.4,-0.6,0.4,0.0,0.0, SURF_ID='LEAK', COLOR='RED' /
&DUMP MASS_FILE=T /
```

氢气以 0.01667 $\mathrm{kg/(m^{2}s)}$的速度通过一个 1 米乘 1 米的通风口注入，3 分钟后关闭。此时氢气的总质量应为 3 千克（见图 12.1）。请注意，不需要氢气的特性，因为附录 A 中包含了氢气的特性。本例中的背景物质假定为空气。氢气的质量流量通过斜坡参数 RAMP_MF(1) 控制。参数 MASS_FILE=T 指示 FDS 生成一个包含氢气质量时间历史的输出文件。

![QQ_1725238062168](/QQ_1725238062168.png)

**Initial Conditions**

如果气体的初始质量分数不为零，则使用参数 MASS_FRACTION_0 来指定。例如，**如果您希望域中的初始浓度为 90%的背景（空气）与 10%的氩气稀释，请使用**

```fortran
&SPEC ID='ARGON', MASS_FRACTION_0=0.1 /
```

**Specifying Humidity**

如果使用的是默认的背景叠加物种 AIR，则可以在 MISC 中指定 HUMIDITY（湿度）来设置环境中水蒸气的质量分数。HUMIDITY 是水蒸气的相对湿度，单位为 %。默认为 40%。

:question:如果您定义的原始物种是水蒸气，那么 MASS_FRACTION_0 与湿度无关。也就是说，**为水蒸气物种设置 MASS_FRACTION_0 不会改变环境湿度，只会增加额外的水蒸气**。

### Pre-Defined Gas and Liquid Properties

附录 A 列出了在 FDS 中列出其属性的气体和液体。这些物质的物理性质是已知的，无需具体说明。使用这些物质时，您只需指定正确的 ID，并根据需要提供初始质量分数。然后，FDS 将使用预编译数据计算各种热物理性质。

### User-Defined Gas and Liquid Properties

如果附录 A 中未包含气体种类，则必须指定其热物理特性。通过使用下面讨论的输入，您还可以覆盖预定义气体种类的默认属性。对于附录 A 中未包含的气体种类，应在 SPEC 行中指定其分子量（MW），单位为 g/mol， 否则将使用氮气的分子量。如果指定了化学式，分子量将由 FDS 计算。**如果参与反应的物种不是燃料物种，则还应指定参考焓，见第 12.1.3 节**。下面将讨论其余的热物理性质，如传导性、扩散性、焓、粘度、吸收性（热辐射）和液体性质。大多数属性可以定义为一个恒定值，或使用 RAMP 作为与温度相关的查找表。对于后者，**如果气室温度高于或低于 RAMP 的端点，则将使用端点值。FDS 不会超出 RAMP 的端点**。

**如果未指定电导率、粘度或扩散率，则将假定氮的伦纳德-琼斯参数和物种的指定分子量来计算**。如果未指定比热或参考焓，请参阅第 12.1.3 节中的假设。

请注意，使用 LES 时，传导性、粘度或扩散性的分子值不用于传输计算（参见《FDS 技术参 考指南》[^24] 题为 “动量传输和压力 ”的章节）。不过，在计算传热和传质系数的相关关系中会用到它们。

**Specifying a Chemical Formula**

如果希望 FDS 计算气体种类的分子量，可以输入 FORMULA 而不是分子量 MW。这也将被 Smokeview 用作气体种类的标签。FORMULA 是一个字符串，由元素及其原子数组成。也可以给出括号中的子组。元素名称由其标准的、区分大小写的 IUPAC 缩写（例如，C 表示碳，He 表示氦）给出。以下均为等效缩写：

```fortran
&SPEC ID='ETHYLENE GLYCOL', FORMULA='C2H6O2'/
&SPEC ID='ETHYLENE GLYCOL', FORMULA='OHC2H4OH'/
&SPEC ID='ETHYLENE GLYCOL', FORMULA='C2H4(OH)2'/
```

与定义反应的简单化学方法兼容的燃料可以使用 C、H、O 和 N 输入，这些输入指定了燃料分子中这些元素的原子数。如果使用了这些输入，则不应指定 FORMULA，反之亦然。下面的示例与前面的示例是等价的：

```fortran
&SPEC ID='ETHYLENE GLYCOL', C=2, H=6, O=2/
```

**Conductivity**

热导率有三种指定方式：使用 CONDUCTIVITY (W/(mK))将其定义为常数；使用 RAMP_K 将其定义为温度对比热斜率；FDS 使用 MW、SPEC 上的 PR_GAS（默认值为 MISC 上的 PR）以及伦纳德-琼斯电势参数 σ (SIGMALJ) 和 ε/k (EPSILONKLJ) 计算。**如果没有指定输入，FDS 将使用 MW 和氮的伦纳德-琼斯参数计算电导率**。

**Diffusivity**

扩散率假定为给定物种与背景物种之间的二元扩散系数。扩散系数有三种指定方式：使用 DIFFUSIVITY (m2/s)将其定义为常数；使用 RAMP_D 将其定义为温度对扩散系数的斜率；或使用 MW 和伦纳德-琼斯势参数 σ (SIGMALJ) 和 ε/k (EPSILONKLJ) 由 FDS 计算。如果没有指定输入，FDS 将使用 MW 和伦纳德-琼斯参数计算氮的扩散率。

请注意，湍流扩散率 $D_\mathrm{t}=\mu_\mathrm{t}/\mathrm{Sc}_\mathrm{t}$受湍流施密特数 $\mathrm{Sc}_\mathrm{t}$ 控制，默认为 0.5，并假定所有被跟踪物种的施密特数相同。在某些特殊情况下，**通常是气溶胶（如烟尘）的情况下，改变湍流施密特数可能与其他物种无关**。为此，您可以在 SPEC 行中为原始物种（没有亚种的物种）设置湍流施密特数。例如，以下几行为以乙烯为主要燃料的原始物种设置了跟踪，允许对烟尘进行不同的湍流输运（请注意，与气体物种相比，烟尘颗粒的输运速度非常慢[^25][^26]）。

```fortran
&SPEC ID='NITROGEN', MASS_FRACTION_0=0.762470, BACKGROUND=T/
&SPEC ID='OXYGEN', MASS_FRACTION_0=0.230997 /
&SPEC ID='CARBON DIOXIDE', MASS_FRACTION_0=0.000591 /
&SPEC ID='WATER VAPOR', MASS_FRACTION_0=0.005941 /
&SPEC ID='CARBON MONOXIDE', MASS_FRACTION_0=0.000000 /
&SPEC ID='SOOT', MASS_FRACTION_0=0.000000, TURBULENT_SCHMIDT_NUMBER=60. /
&SPEC ID='ETHYLENE', MASS_FRACTION_0=0.000000 /
```

**Enthalpy**

混合气体的焓值由下式求得：
$$
h(T)=h(T_{\mathrm{ref}})+\int_{T_{\mathrm{ref}}}^Tc_p(T') \mathrm{d}T'
$$
其中，$c_p$ 是 SPECIFIC_HEAT（$\mathrm{kJ}/(\mathrm{kg} \mathrm{K})$），可选择使用 RAMP_CP，与温度相关。$h(T_{\mathrm{ref}})$的值可以通过两种方式指定。第一种是指定 REFERENCE_TEMPERATURE, Tref (℃)，并使用 REFERENCE_ENTHALPY, h(Tref) (kJ/kg) 指定该温度下的焓值。第二种是指定 ENTHALPY_OF_FORMATION，单位为 kJ/mol。在此输入中，Tref 取自 MISC 行中的 H_F_REFERENCE_TEMPERATURE。任一参考温度的默认值均为 25℃。

如果没有输入 $h(T_{\mathrm{ref}})$，则 FDS 将假定 0 K 时的焓为 0 kJ/kg，也就是说，如果给定了 SPECIFIC_HEAT 常量，则 REFERENCE_ENTHALPY 将设为 $h(T_{\mathrm{ref}})=c_pT_{\mathrm{ref}}$。对于 RAMP_CP，RAMP 将从 0 K 积分到 Tref。

如果没有输入比热，则将使用关系式根据分子量计算气体的比热：
$$
c_{p,\alpha}=\frac\gamma{\gamma-1}\frac R{W_\alpha}
$$
**比热比 GAMMA 默认为 1.4，可在 MISC 行中更改**。如果希望所有气体比热都遵循这一关系，请在 MISC 行设置 CONSTANT_SPECIFIC_HEAT_RATIO=T。**对于高分子量物质，使用默认伽马值会导致比热值非常低，从而导致默认消防模型出现问题**。在这种情况下，建议定义比热。如果 FDS 使用该关系式确定比热，则建议您检查 CHID.out，确认已创建合理的比热值。

请注意，化学反应中使用的物种必须是预定义的，或者具有明确定义的 $h(T_{\mathrm{ref}})$。但 REAC 输入中定义为 FUEL（燃料）的物质除外，只要定义了 HEAT_OF_COMBUSTION（燃烧热）或反应为适用 EPUMO2 的简单化学反应即可。**指定 SPECIFIC_HEAT 或 RAMP_CP 均被视为明确定义了 h(Tref)**。如果仍希望使用默认 EPUMO2 或 13,100 kJ/kg，则需要在 REAC 输入中明确定义。

另请注意，如果使用了预定义的物种名称，并且在本节中为该物种指定了任何与焓相关的输入，则 FDS 将不会使用预定义的形成焓。

**Viscosity**

气体种类的动态粘度可以通过以下三种方式之一指定：使用 VISCOSITY 将其定义为常数；使用 RAMP_MU 将其定义为温度与粘度的斜坡关系；或者使用伦纳德-琼斯势参数 σ (SIGMALJ) 和 ε/k (EPSILONKLJ) 计算。如果没有提供粘度输入，FDS 将使用 Lennard-Jones 值来计算氮气。

**Radiative Properties**

可以吸收和发射热辐射的物种是通过 SPEC行上的 RADCAL_ID 参数定义的。如附录 A 所示，一些预定义物种已经定义了该参数。不过，还有许多其他物种具有吸收能力。对于附录 A 中未列出的吸收性物种，RADCAL_ID 可用来确定一个 RadCal [^27] 物种作为替代物。例如

```fortran
&SPEC ID='ETHANOL', RADCAL_ID='METHANOL' /
```

在计算乙醇的吸收率时，将使用甲醇的 RadCal 吸收率。**对于 RadCal 中不存在的吸收物种，建议选择分子官能团和分子质量相似的 RadCal 代用物**。红外光谱受物种分子官能团的影响很大。

物种分子质量也会影响光谱：**特定分子官能团中较重的物种往往比相同官能团中较轻的物种吸收和发射更多的红外辐射**。对于简单的化学反应，如果燃料不在附录 A 中，且 REAC 行未提供 FUEL_RADCAL_ID，则将使用甲烷的吸收特性。

**Gibbs Energy**

如果在 REAC 输入中使用 REVERSE=T 指定了逆向化学反应，则平衡常数将根据吉布斯自由能确定。可以在 SPEC 行中使用 RAMP_G_F 指定物种的吉布斯自由能（kJ/mol）与温度的函数关系。**关于有限速率动力学的第 13.3 节提供了一个逆向反应示例**。

**Liquids**

只有在为附录 A 未列出的物种定义液滴时，才需要详细的液体属性。第 15.3.1 节介绍了必要的属性。

**Prandtl Number**

可以使用 SPEC 上的 PR_GAS 指定气体种类的普朗特尔数。如果没有给出数值，则将使用 MISC 上 PR 的默认值。如果 PR_GAS为已知气体种类定义，它将覆盖现有值。

### Air

在 FDS 中，空气有两种预定义种类。第一个预定义物种是空气的默认背景物种。这是一个由氧气、氮气、二氧化碳和水蒸气组成的集合物种，其质量分数由 Y_CO2_INFTY、Y_O2_INFTY 和 HUMIDITY 输入值控制。如果没有将其他 SPEC 输入值定义为 “BACKGROUND”，则 FDS 会自动定义该集合物种。**请注意，ID='AIR' 不能用于 SPEC 输入，除非该输入或其他 SPEC 输入被定义为背景。**第二个预定义种类是 LJ AIR 的原始种类。这是一种有效气体，其分子量和焓值根据 Y_CO2_INFTY 和 Y_O2_INFTY 输入值定义，其他热物理性质使用空气的伦纳德-琼斯参数。**对于无燃烧的模拟，使用 LJ AIR 作为 “BACKGROUND ”气体可略微降低计算成本。**

### Two Gas Species with the Same Properties

一般来说，一个给定的 ID 只能定义一个物种；但是，您可能希望为一个物种的多个入口水流建模，并能确定这些水流的混合程度。**这可以通过定义具有单一成分的新物种来实现**。例如，线条:

```fortran
&SPEC ID='CARBON DIOXIDE', LUMPED_COMPONENT_ONLY=T/
&SPEC ID='CO2 1',SPEC_ID='CARBON DIOXIDE'/
&SPEC ID='CO2 2',SPEC_ID='CARBON DIOXIDE'/
&DEVC XYZ=..., QUANTITY='MASS FRACTION', SPEC_ID='CO2 1', ID='Device 1'/
&DEVC XYZ=..., QUANTITY='MASS FRACTION', SPEC_ID='CO2 2', ID='Device 2'/
```

定义两个重复的物种，它们都是二氧化碳。两者都将使用二氧化碳的内置属性数据（注意，为重复物种指定一个或多个属性将覆盖默认属性）。每个重复物种的 ID 都可以用于输入文件的其余部分。在本例中，给出了 LUMPED_COMPONENT_ONLY 属性，以便 FDS 只跟踪 CO2 1 和 CO2 2，而不跟踪二氧化碳。请注意，您为重复物种提供的 ID 不能与任何其他原始或集合 SPEC 输入的 ID 相匹配。另外请注意，:exclamation:**该功能只能用于复制预定义的物种（即附录 A 中列出的物种）**。

在上例中，两行 DEVC 代表重复物种的 ID。**如果使用的是原始物种 ID，那么输出结果将是包含该原始物种的所有物种的质量分数总和**。例如，如果上例中的输出量如下所示，那么设备 1 将只输出 CO2 1 的质量分数，而设备 2 将输出两者的总和。

```fortran
&DEVC XYZ=..., QUANTITY='MASS FRACTION', SPEC_ID='CO2 1', ID='Device 1'/
&DEVC XYZ=..., QUANTITY='MASS FRACTION', SPEC_ID='CARBON DIOXIDE', ID='Device 2'/
```

<font color=red>另一种应用是，如果您想将洒水器蒸发的水与燃烧产生的水分开跟踪。</font>通过以下输入就可以做到这一点：

```fortran
&REAC FUEL='PROPANE', ... /
&SPEC ID='WATER VAPOR SPK', SPEC_ID='WATER VAPOR' /
&PART ID='Sprinkler Droplets',SPEC_ID='WATER VAPOR SPK'/
&DEVC XYZ=..., QUANTITY='MASS FRACTION', SPEC_ID='WATER VAPOR SPK', ID='Spr H2O'/
&DEVC XYZ=..., QUANTITY='MASS FRACTION', SPEC_ID='WATER VAPOR', ID='All H2O'/
```

名为 WATER VAPOR SPK 的气体种类具有与 WATER VAPOR 相同的特性。第一个设备只记录水滴蒸发产生的水，第二个设备则记录喷洒器和燃烧产生的水。

**默认情况下，重复物种被认为是一个集合物种，而不是原始物种**。也就是说，默认情况下，重复物种不能用于集合物种定义。设置 PRIMITIVE=T 后，FDS 会将重复物种视为原始物种，并允许在物种集合定义中使用。需要注意的是，**当这样做时，就不能再将基于 SPEC_ID 的输出结果汇总到原始物种和重复物种上，因为汇总是根据原始物种名称进行的。**下面的示例对此进行了演示。O2 和 O3 是氧原子的重复物种。O3 被定义为原始物种，而 O2 仅被视为集合物种。DEVC 的初始输出依次为 0.3（OXYGEN 的 0.1 加上 O2 的 0.2）、0.2（O2 初始值）和 0.3（O3 初始值）。请注意，OXYGEN 输出值不是 0.6，因为 O3 被定义为新的原始物种。

```fortran
&SPEC ID='NITROGEN',BACKGROUND=T/
&SPEC ID='OXYGEN',MASS_FRACTION_0=0.1/
&SPEC ID='O2 LUMPED',SPEC_ID='OXYGEN',MASS_FRACTION_0=0.2/
&SPEC ID='O2 DUPLICATE PRIMITIVE',SPEC_ID='OXYGEN',MASS_FRACTION_0=0.3,PRIMITIVE=T/
&DEVC XYZ=0.5,0.5,0.5,QUANTITY='MASS FRACTION',SPEC_ID='OXYGEN'/
&DEVC XYZ=0.5,0.5,0.5,QUANTITY='MASS FRACTION',SPEC_ID='O2 LUMPED'/
&DEVC XYZ=0.5,0.5,0.5,QUANTITY='MASS FRACTION',SPEC_ID='O2 DUPLICATE PRIMITIVE'/
```

### Soot

SOOT "的预定义种类是用 FORMULA=‘C’ 定义的。**要指定含有其他原子的烟尘，请使用 FORMULA**。:exclamation:如果未指定新的热物理性质，则在定义 FORMULA 时应将分子量保持在 12 g/mol 附近，即 FORMULA='C0.86H1.7'，而不是 FORMULA='C10H20'。

## Specifying Lumped Species (Mixtures of Primitive Species)

SPEC 命名列表组还允许您定义物种混合物。**物种混合物的目的是减少显式求解的物种传输方程的数量**。例如，空气由氮气、氧气、水蒸气和二氧化碳组成。如果我们定义了空气中的四种成分，则总共有四种物质。或者，我们可以定义一个代表空气混合物的 “集合物种”，这样可以节省计算时间，因为我们只需求解一个传输方程。集合物种是指一组以相同比例进行迁移和反应的物种。**这意味着混合物中每种成分的分子扩散率都是相同的**，这是一种近似值[^12-1]。

以下输入定义了等效的初始混合物。但在第一个例子中明确跟踪了三个物种，而在第二个例子中只指定了背景混合物。请注意，该示例代表了在输入文件中未明确定义背景时 FDS 创建的背景物种。还需注意的是，**任何隐式定义的物种（如空气背景物种中的氮气、氧气、水蒸气和二氧化碳， 或简单化学的集合产物物种中的物种，见 13.1.1）都可以被 DEVC 或 SLCF 等任何输出所引用**。

**Example 1: All primitive species**

```fortran
&SPEC ID='NITROGEN', BACKGROUND=T / Note: The background must be defined first.
&SPEC ID='OXYGEN', MASS_FRACTION_0=0.23054 /
&SPEC ID='WATER VAPOR', MASS_FRACTION_0=0.00626 /
&SPEC ID='CARBON DIOXIDE', MASS_FRACTION_0=0.00046 /
```

**Example 2: Defining a background species**

```fortran
&SPEC ID='NITROGEN', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='OXYGEN', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='WATER VAPOR', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='CARBON DIOXIDE', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='AIR', BACKGROUND=T,
SPEC_ID(1)='NITROGEN', MASS_FRACTION(1)=0.76274,
SPEC_ID(2)='OXYGEN', MASS_FRACTION(2)=0.23054,
SPEC_ID(3)='WATER VAPOR', MASS_FRACTION(3)=0.00626,
SPEC_ID(4)='CARBON DIOXIDE', MASS_FRACTION(4)=0.00046 /
```

逻辑参数 LUMPED_COMPONENT_ONLY 表示该物种仅作为集合物种的一部分存在。**当参数为 T 时，FDS 将不分配空间单独跟踪该物种。**定义集合物种的参数有:

背景（BACKGROUND） 表示将此集合物种作为背景物种。

ID 识别物种名称的字符串。您必须提供该字符串。该 ID 不能与另一个 SPEC 输入的 ID 相同。

SPEC_ID 字符数组，包含组成集合物种的原始物种名称。

MASS_FRACTION 按 SPEC_ID 所列顺序排列的集合物种各组分的质量分数。FDS 将把这些值归一化为 1。也可指定 VOLUME_FRACTION（体积分数）。**请勿在 SPEC 行中同时使用这两个参数**。

MASS_FRACTION_0 集合物种的初始质量分数。

**定义集合物种时，必须使用 MASS_FRACTION 或 VOLUME_FRACTION 来定义组成物种**。在 FDS 中添加集合物质后，某些 FDS 输入中 SPEC_ID 的含义发生了变化。<u>对于 INIT、MATL、PART 和 SURF，SPEC_ID 指的是被跟踪的原始物种或集合物种</u>。对于需要 SPEC_ID 的输出和设备（DEVC），SPEC_ID 输入既可以指被跟踪的原始物种，也可以指集合物种或未被跟踪的集合物种成分。关于 REAC，请参阅第 13 章关于指定反应的讨论。

:question:(如何使用)**使用 COPY_LUMPED 可以创建一个单独跟踪的叠加物种副本**。例如，如果在上面的例 2 中添加以下一行

```fortran
&SPEC ID='AIR2', COPY_LUMPED=T, SPEC_ID='AIR'/
```

那么 FDS 将创建一个 AIR 集合物种的副本，称为 AIR2。

### Combining Lumped and Primitive Species

在某些情况下，您可能希望将单个原始物种既作为集合物种的一部分，又作为单独跟踪的物种。例如，在使用简单化学（第 13.1.1 节）时，FDS 会将水蒸气包含在产品种类和空气背景种类中。如果您还希望在模拟中使用洒水器，则需要将洒水器中的水蒸气与空气或产品中的水蒸气分开跟踪。只需添加一行即可：

```fortran
&SPEC ID='WATER VAPOR'/
```

这将覆盖用 LUMPED_COMPONENT_ONLY=T 定义的隐含水蒸气种类，并使 FDS 将水蒸气作为单独的种类进行跟踪。请注意，在这种情况下，如果您要求输出水蒸气的质量分数，您将得到空气中的水蒸气和产品中的水蒸气，以及从洒水器水滴中蒸发出来的水蒸气。如果您希望在这种情况下（隐含定义了水蒸气）单独跟踪来自喷淋器的水蒸气，可以按照第 12.1.5 节中的示例进行定义：

```fortran
&SPEC ID='SPRINKLER WATER VAPOR',SPEC_ID='WATER VAPOR'/
```

对洒水器使用 “SPRINKLER WATER VAPOR（洒水器水蒸气）”物种，可以单独跟踪洒水器产生的水蒸气。

****

[^12-1]:湍流扩散通常以几个数量级占主导地位，使相等的扩散率成为一个很好的近似



# Combustion

燃烧有两种建模方式。**默认情况下，燃料和氧气的反应是无限快的，并且只受混合控制，因此称为混合控制。**另一种方法是精细反应。后一种方法通常需要非常精细的网格分辨率，在大规模火灾应用中并不实用。本章将介绍这两种方法，**重点介绍更常用的混合控制模型**。

控制燃烧的参数有两组。第一组称为 COMB 命名列表组，包含与所有反应相关的参数。特定反应的具体参数通过 REAC 命名列表组指定。**只能有一个 COMB 行，但如果有多个反应，则可以有多个 REAC 行**。如果是模拟火灾，必须使用 REAC 行指定燃料和基本化学计量。<u>除非主要修改数值参数，否则无需指定 COMB 行</u>。

## Single-Step, Mixing-Controlled Combustion

这种燃烧方法在下文中称为 “简单化学 ”燃烧模型，它考虑的是主要由 C、H、O 和 N 组成的单一燃料种类，在一个混合控制步骤中与氧气反应生成 H2O、CO2、烟尘和 CO。REAC 行提供了有关反应的信息。从 FDS 6 开始，您必须指定 REAC 行才能建立火灾模型。您需要定义基本的燃料化学反应以及 CO 和烟尘的燃烧后生成量（默认生成量为 0）。可以定义多个简单化学反应，但每个简单化学反应必须有一个唯一的燃料。

### Simple Chemistry Parameters

在简单化学模型中，假定每个反应的形式为
$$
\mathrm{C_{x}H_{y}O_{z}N_{v}+\nu_{{O_{2}}}O_{2}\to\nu_{{CO_{2}}}~CO_{2}+\nu_{{H_{2}O}}~H_{2}O+\nu_{CO}~CO+\nu_{S}~Soot+\nu_{{HCN}}~HCN+\nu_{{N_{2}}}~N_{2}}
$$
您只需指定燃料的化学式、一氧化碳和烟尘的产量以及烟尘中氢的体积分数 $X_H$。FDS 将使用这些信息自动计算出化学计量系数，具体如下：
$$
\begin{array}{rcl}\nu_{{\mathrm{O_{2}}}}&=&\nu_{{\mathrm{CO_{2}}}}+\frac{\nu_{{\mathrm{CO}}}}{2}+\frac{\nu_{{\mathrm{H_{2}O}}}}{2}-\frac{\mathrm{z}}{2}\\\nu_{{\mathrm{CO_{2}}}}&=&\mathrm{x}-\nu_{{\mathrm{CO}}}-\nu_{{\mathrm{HCN}}}-\left(1-X_{{\mathrm{H}}}\right)\nu_{{\mathrm{S}}}\\\nu_{{\mathrm{H_{2}O}}}&=&\frac{\mathrm{y}}{2}-\frac{X_{{\mathrm{H}}}}{2}\nu_{{\mathrm{S}}}-\frac{\nu_{{\mathrm{HCN}}}}{2}\\\nu_{\mathrm{CO}}&=&\quad\frac{W_{\mathrm{F}}}{W_{\mathrm{CO}}}y_{\mathrm{CO}} \\V_{\mathrm{s}} &=&=-\frac{W_\mathrm{F}}{W_\mathrm{S}}y_\mathrm{S} \\V_{\mathrm{HCN}} &=&\quad\frac{W_{\mathrm{F}}}{W_{\mathrm{HCN}}}y_{\mathrm{HCN}} \\V_{\mathrm{N}_{2}} {rcl}&=&\frac{\mathrm{v}}{2}-\nu_{\mathrm{HCN}} \\W_{\mathrm{s}} {rcl}&=&X_\mathrm{H}W_\mathrm{H}+(1-X_\mathrm{H})W_\mathrm{C}\end{array} 
$$
使用简单化学模型时，可在 REAC 线路上设置以下参数。请注意，**各种产量都是针对通风良好的火焰燃烧后条件的**。有一些选项可以预测通风不足的火灾情况下各种物质的产气量，但这些特殊模型仍然需要一氧化碳、烟尘和下面列出的任何其他物质的燃烧后产气量。

FUEL（必填） 用于标识反应燃料种类的字符串。燃料种类必须是预定义种类或在 SPEC 输入中定义的种类。附录 A 列出了可用的预定义种类。如果 FUEL 在表中，则 FDS 将使用预定义的燃料热物理性质和化学式。有关指定用户定义种类的详细信息，请参阅第 12.1 节。

ID 用于标识反应的字符串。通常情况下，FDS 不使用该标签，但如果指定了多个反应，则该标签对 REAC 行非常有用。

CO_YIELD 转化为一氧化碳的燃料质量分数，$y_{CO}$。请注意，该参数仅适用于简单化学模型。(默认为 0）。

SOOT_YIELD 转化为烟雾微粒的燃料质量分数，$y_s$。请注意，该参数仅适用于简单化学模型。(默认为 0）。

HCN_YIELD 转化为氰化氢的燃料质量分数，$y_{HCN}$。请注意，该参数仅适用于应用简单化学模型且燃料中含有氮的情况。(默认为 0）。

FUEL_RADCAL_ID 用于燃料的 RadCal 种类。默认值是燃料种类的默认 RadCal 种类，如果没有默认种类，则为 “METHANE”。详见第 14.3.1 节。

**环境空气成分的质量分数是在 MISC 上使用输入值指定的**：

Y_O2_INFTY 环境中氧气的质量分数（干燥空气的默认值为 0.232378）

Y_CO2_INFTY 环境中二氧化碳的质量分数（干燥空气的默认值为 0.000595）

背景空气相对湿度，单位为 %（默认为 40 %）。

这里给出了几个 REAC 线路示例

```fortran
&REAC FUEL = 'METHANE' /
```

在这种情况下，不需要公式或原子数，因为燃料已列在附录 A 中。假设烟尘和 CO 的产率为零。FDS 将根据预定义值计算生成物的产率和燃烧热。

```fortran
&REAC FUEL = 'PROPANE'
SOOT_YIELD = 0.01
CO_YIELD = 0.02
HEAT_OF_COMBUSTION = 46460. /
```

在这种情况下，燃料种类也是预先确定的。不过，这里的燃烧热是明确指定的，而不是计算出来的。此外，还指定了次要物质的产率，煤烟产率指定为 0.01，一氧化碳产率指定为 0.02。有关燃烧热的详细信息，请参见第 13.1.2 节。

```fortran
&SPEC ID = 'MY FUEL'
FORMULA = 'C3H8O3N4'/
&REAC FUEL = 'MY FUEL'
HEAT_OF_COMBUSTION = 46124. /
```

在这种情况下，燃料不是预定义的。因此，必须在 SPEC 上定义 FORMULA 或原子数。该输入定义了 FORMULA。在这种情况下，燃烧热是已知并指定的；**但如果没有指定，FDS 将使用 EPUMO2 和燃料化学成分计算燃烧热**。需要注意的是，简单化学式也可用于燃料为集合物种的情况，只要定义的原始物种只包含 C、H、N 和 O 原子即可。示例见第 13.2.2 节。

在使用简单化学反应时，FDS 将自动创建三个集合物种： 空气（AIR）、燃料（FUEL）和产品（PRODUCTS）。燃料种类的实际名称将是 REAC 行中给出的名称（例如上面最后一个示例中的 MY FUEL）。FDS 创建这些集合物种的方式与创建输入文件的方式相同。**FDS 首先定义原始种类，然后定义混合种类**。实质上，FDS 内部创建的输入行与第 12.2 节例 2 中的输入行类似。这意味着在进行简单化学反应时，即使您没有在输入文件中明确定义氧气，也可以请求输出氧气，因为 FDS 已经隐式定义了氧气。

可定义多个简单化学反应。每个新反应都需要 FDS 跟踪新的燃料和产物混合物。

### Heat of Combustion

在 FDS 中，气相化学反应（或反应体系）的单位体积能量释放（$kJ/m^{3}$）是将给定时间步长内该体积中各物种密度的净变化之和乘以各物种的形成焓（kJ/kg）得出的。在此公式中，需要指定所有参与物种的形成焓。如果反应（简单化学反应或用户自定义反应）只包含附录 A 中定义的物种，则所有形成焓都是已知的。这些值可在 FDS 源代码 data.f90 中找到。对于附录 A 中未包含物种的反应，有几个选项可确保指定所有生成焓。

**Option 1: Specify Enthalpy of Formation**

您可以在 SPEC 行指定未知焓，单位为 kJ/mol：

```fortran
&SPEC ID = 'GLUCOSE', FORMULA = 'C62H12O6', ENTHALPY_OF_FORMATION=-1.297E3 /
```

注意 FDS 还将使用 REFERENCE_ENTHALPY、SPECIFIC_HEAT 或 RAMP_CP 来定义形成焓，详见第 12.1.3 节。

**Option 2: Specify Heat of Combustion**

对于给定的反应，**如果唯一缺少形成焓值的物质是燃料，只要在 REAC 上指定以 kJ/kg 为单位的 HEAT_OF_COMBUSTION，就可以找到缺少的值**。第 13.2.2 节提供了一个例子，其中燃料聚氯乙烯的形成焓值未指定，但 REAC 行上的燃烧热值已指定。**指定 HEAT_OF_COMBUSTION 将导致 FDS 根据 SPEC 输入重新计算任何燃料种类的形成焓**。如果同一FUEL在多个反应中出现这种情况，将写入警告信息。

**Option 3: Specify Heat of Combustion Based on Oxygen Consumption (Simple Chemistry)**

如果没有指定燃料的形成焓和燃烧热，仅在简单化学情况下，假定燃烧热为
$$
\Delta h\approx\frac{\nu_{\mathcal{O}_2}W_{\mathcal{O}_2}}{\nu_{\mathcal{F}}W_{\mathcal{F}}}\mathrm{~EPUMO2~~~kJ/kg}
$$
EPUMO2 (kJ/kg) 是单位质量氧气消耗所释放的能量。默认值为 13 100 千焦/千克。在 FDS 中，化学反应的化学计量系数按燃料的化学计量系数进行归一化，从而有效地将νF 设为 1。请注意，如果同时指定 EPUMO2 和 HEAT_OF_COMBUSTION，FDS 将忽略 EPUMO2 的值。请注意，如果使用了选项 1，则不会使用 EPUMO2 的假定值。如果希望继续使用默认值，请在 REAC 行中添加 EPUMO2=13100。

**如果已在 MATL 线路中指定了反应热，而材料的燃烧热与支配气相反应的反应热不同，则在 MATL 线路中添加 HEAT_OF_COMBUSTION (kJ/kg)**。在真实的火灾场景中，建筑物内的各种燃烧物可能会产生多种燃料气体。通过 REAC 命名列表组指定主要反应的化学计量。如果燃烧材料的化学计量与全局反应不同，则使用 HEAT_OF_COMBUSTION 来确保从燃烧物体注入流域的燃料量相等。

手册中列出的纯燃料（如一种燃料）的燃烧热值通常是在假设完全燃烧的情况下，使用燃料和产物的形成焓计算得出的。这种理想的燃烧热并不考虑真实火灾中出现的 SOOT_YIELD、CO_YIELD 或 HCN_YIELD。碳和氢转化为烟尘、CO 和 HCN，而不是 CO2 和 H2O，会导致有效燃烧热降低。设置 IDEAL=T 将根据 SOOT_YIELD、CO_YIELD 和 HCN_YIELD 的输入值降低 HEAT_OF_COMBUSTION。

另一种确定燃烧热的方法是在量热计中燃烧已知质量的材料，然后用热释放率除以质量损失率（称为有效燃烧热）。在 IDEAL=F 表示的这种方法中，热释放率的测量值包含了产生的任何烟尘、CO 或 HCN 的影响，无需进行调整。默认值为 IDEAL=F。请注意，预定义的燃料种类已定义了其形成热；因此，这些种类的燃烧热将根据烟尘和 CO 的产生情况进行适当调整。

如果指定 EPUMO2 而不是 HEAT_OF_COMBUSTION，则不会更改 EPUMO2（即 FDS 始终将 EPUMO2 视为 IDEAL=F）。

如果反应定义不足，FDS 将在计算开始时返回错误信息。

### Time-Step Simple Chemistry

默认的简单化学单步燃烧模型有一个两步选项**。在需要两步法的每个简单化学反应的 REAC 行中，将 N_SIMPLE_CHEMISTRY_REACTIONS 设置为 2**，即可调用该选项。适用于默认单步模型的所有其他参数仍然适用。两步法基本上是在第一步中将燃料分子中的所有碳转化为一氧化碳和烟尘，然后在第二步中将大部分一氧化碳和烟尘氧化为二氧化碳。燃料分子中的氢也可以在第一步中形成 H2 或 H2O。
$$
\mathrm{C}_{x}\mathrm{H}_{\mathrm{y}}\mathrm{O}_{\mathrm{z}}\mathrm{N}_{\mathrm{v}}+\nu_{\mathrm{O}_{2,1}}\mathrm{O}_{2}\quad\longrightarrow\quad\underbrace{\nu_{\mathrm{H}_{2,1}}\mathrm{H}_{2}+\nu_{\mathrm{H}_{2}\mathrm{O},1}\mathrm{H}_{2}\mathrm{O}+\nu_{\mathrm{CO},1}\mathrm{CO}+\nu_{\mathrm{S},1}\mathrm{Soot}+\nu_{\mathrm{HCN},1}\mathrm{HCN}+\nu_{\mathrm{N}_{2,1}}\mathrm{N}_{2}}_{\mathrm{Int.~Products}}\\\text{Int. Products}+\nu_{\mathrm{O}_{2,2}}\mathrm{O}_{2}\quad\longrightarrow\quad\nu_{\mathrm{CO}_{2}}\mathrm{CO}_{2}+\nu_{\mathrm{H}_{2}\mathrm{O},2}\mathrm{H}_{2}\mathrm{O}+\nu_{\mathrm{CO},2}\mathrm{CO}+\nu_{\mathrm{S},2}\mathrm{Soot}+\nu_{\mathrm{HCN},2}\mathrm{HCN}+\nu_{\mathrm{N}_{2,2}}\mathrm{N}_{2}
$$
默认情况下，在第一步中，燃料中三个碳原子中的两个会转化为 CO。这一假设还没有可靠的依据，**可以通过 REAC 行中的参数 FUEL_C_TO_CO_FRACTION 来改变碳在 CO 和烟尘中的分布**。默认值为 2/3。此外，默认情况下燃料中五个氮原子中有一个会转化为 HCN。该值是根据含氮燃料在一定当量比范围内的测试结果得出的[^28]，可以通过参数 FUEL_N_TO_HCN_FRACTION 进行更改。此外，燃料分子中的一部分氢可在第一步中形成 H2。该控制参数称为 FUEL_H_TO_H2_FRACTION，默认值为零，因为人们对这种化学反应还不太了解，所以将其添加到两步法中，作为未来研究的占位符。

请注意，参数 CO_YIELD、SOOT_YIELD 和 HCN_YIELD 保留了其在单步简单化学模型中的含义；也就是说，它们代表了这些物种的焰后产率。从本质上讲，**两步法模型承认一氧化碳和烟尘在火焰包络线内的浓度远高于它们的焰后产率**。

**只有当您对近火焰现象感兴趣时，才应使用两步简单化学选项**，在这种情况下，增加的 CO 和烟尘浓度会在火焰化学和辐射发射中发挥重要作用。火焰的分辨率也应相当高。什么是 “相当好 ”取决于具体情况，但只需指出，您应该通过运行简单的模拟实验，看看使用和不使用两步法是否会产生明显不同的结果。两步法的代价是为被称为 “中间产物 ”的标量变量增加一个额外的传输方程。

Species 文件夹中的示例案例：propane_flame_2reac.fds 和 propane_flame_2reac_simple.fds，可以简单演示两步简单化学反应。这两个案例都采用了相同的两步反应方案：
$$
\begin{array}{rcl}\mathrm{C_{3}H_{8}+3~O_{2}}&\longrightarrow&2\mathrm{~CO+C+4~H_{2}O}\\2\mathrm{~CO+C+4~H_{2}O+2~O_{2}}&\longrightarrow&3\mathrm{~CO_{2}+4~H_{2}O}\end{array}
$$
简单版输入文件的燃烧参数设置如下：

```fortran
&REAC FUEL='PROPANE', SOOT_YIELD=0., CO_YIELD=0., N_SIMPLE_CHEMISTRY_REACTIONS=2,
FUEL_C_TO_CO_FRACTION=0.6667 /
```

为简化输入文件复杂形式的设置，火焰后烟尘（C）和一氧化碳（CO）生成量设置为零。在火焰包络线内，烟尘和一氧化碳将按照指定的 FUEL_C_TO_CO_FRACTION 生成，即燃料分子中 3 个碳原子中的 2 个碳原子形成一氧化碳，并形成1 个碳原子。图 13.1 显示了模拟开始几秒钟的热释放率和辐射热释放率，以检查两种计算方法是否相同。

![QQ_1725260345627](/QQ_1725260345627.png)

同样位于 Species 文件夹中的 multiple_reac_n_simple.fds 案例对两步简单化学反应进行了更复杂的演示。该案例包含三个反应，其中两个具有两步简单化学反应（FUEL_C_TO_CO_FRACTION 和 FUEL_C_TO_CO_FRACTION 的值不同），第三个反应仅具有简单化学反应（CO_YIELD 为 0.3）。在这种情况下，三个方框中的每个方框初始化时都含有一个反应产生的少量燃料，但氧气 不足，无法完成第一步（或唯一一步）。图 13.2 中的结果表明，FDS 以适当的产率正确执行了每个反应的一个或两个步骤。

![QQ_1725260463613](/QQ_1725260463613.png)

### Complete Heat of Combustion

如第 9.2 节和第 15.3.1 节所述，在气相中对固体或液滴的燃料质量损失进行调整，以获得正确的总热释放率。如果使用多步反应方案（如上一节中讨论的），则第一步 REAC 行的 HEAT_OF_COMBUSTION 并非该燃料的全部燃烧热。使用该值来调整质量损失率将导致错误的热释放率。**如果定义的是多步反应，且燃料是通过热解或蒸发产生的，则应在第一步的 REAC 行设置参数 HOC_COMPLETE。**该值将用于调整质量损失率，而不是 HEAT_OF_COMBUSTION。请注意，如果使用两步简单化学反应，FDS 将自动计算 HOC_COMPLETE 的值。

### Turbulent Combustion

除非您执行的是直接数值模拟（DNS），否则燃料和氧气的反应速率并不是基于燃料和氧气在解析度较高的火焰片上的扩散。相反，**FDS 调用半经验规则来确定给定时间步长下给定网格单元内燃料和氧气的混合速率**。每个计算单元可视为一个批量反应器，其中只有混合成分可以发生反应。**变量$\zeta\left(t\right)$ 表示未混合的部分**，范围从 0 到 1，由方程控制：
$$
\frac{\mathrm{d}\zeta}{\mathrm{d}t}=\frac{-\zeta}{\tau_{{\mathrm{mix}}}}
$$
这里，$\tau_{\mathrm{mix}}$是混合时间尺度。物种的质量变化是由混合和化学反应中的生成/分解率共同决定的。**如果网格单元最初未混合，默认情况下 $\zeta_{0}=1$，则认为网格单元内的燃烧是非预混合的**。在这种情况下，燃料和空气在时间步开始时被认为是完全分离的，必须在燃烧前混合在一起。这意味着，如果混合速度足够慢，即使网格单元中存在足够的氧气来燃烧所有燃料，在时间步结束时也可能存在未燃烧的燃料。如果单元最初完全混合，即$\zeta_0=0$，则认为燃烧是预混合的（例如，相当于无限快速混合）。<u>您可以使用 COMB 行的参数 INITIAL_UNMIXED_FRACTION 设置每个单元在每个时间步开始时的混合量</u>。

混合时间 $\tau_{\mathrm{mix}}$是相关点附近湍流程度的函数。不过，您可以通过在 COMB 行设置 FIXED_MIX_TIME (s) 来覆盖 $\tau_{\mathrm{mix}}$的计算。另外，您也可以通过在 COMB 行设置下限值 TAU_CHEM 和/或上限 TAU_FLAME，来限制 $\tau_{\mathrm{mix}}$的计算值。

《技术参考指南》[^29] 包含有关湍流燃烧模型的更多详细信息。

### Flame Extinction

由于相关物理机制通常发生在亚网格尺度上，因此模拟因引入二氧化碳或水雾等灭火剂或封闭隔间内氧气耗尽而导致的灭火过程具有挑战性。火焰熄灭的原因是温度降低以及燃料或氧气供应稀释。<font color=red>**FDS 中有两个火焰熄灭模型，可根据网格单元温度以及氧气和燃料浓度确定燃烧是否可行**。</font>简而言之，要发生燃烧，必须有足够的氧气和燃料将单元温度从当前值提高到临界火焰温度 (CFT)。临界火焰温度基于贝勒在《SFPE 手册》[^30] 中讨论的氧指数 (OI) 概念。氧指数是熄灭时氧化剂流中氧气的体积分数。在此极限氧浓度 $T_{OI} $下，燃料和氧气的化学计量混合物的绝热火焰温度[^13-1]被视为 CFT。表 13.1 列出了 CFT ( $T_{OI} $) 的值。两种灭火模型都使用 CFT。

EXTINCTION_MODEL 在 COMB 行指定[^13-2]。超大涡模拟（VLES）和简单超大涡模拟（SVLES）模式默认使用 “EXTINCTION 1”，而 DNS 和 LES 则使用 “EXTINCTION 2”。这两种模式的区别在于，**“EXTINCTION 1 ”模式只考虑网格单元温度和氧气浓度**，因为在 “EXTINCTION 2 ”模式中，没有调用详细的热物理气体物种属性。一般来说，“EXTINCTION 2 ”需要相对较细的网格，因为它在计算临界火焰温度时使用的是体细胞温度。

**Extinction Model 1**

图 13.3 左侧的图概括了 “EXTINCTION 1 ”模型，显示了燃烧可行的单元温度和氧气浓度范围。**该模型用于网格单元相对较大、火焰无法分辨的模拟**。具体而言，这意味着在大约 600 °C 以上，除非氧气浓度降至零，否则火焰不会熄灭。该模型有几个相关参数。首先，LOWER_OXYGEN_LIMIT（有时也称为低氧指数）是图 13.3 中实线左端的氧气体积分数。表 13.1 列出了各种燃料的数值。其次，在 FREE_BURN_TEMPERATURE 以上（默认值为 600℃），燃烧不会被抑制。默认值是闪蒸的典型指标。最后，CRITICAL_FLAME_TEMPERATURE 确定了斜线与 x 轴的交点。表 13.1 列出了各种燃料的数值，但考虑到该模型的简易性，建议使用默认值。

![QQ_1725263435957](/QQ_1725263435957.png)

<center>Table 13.1: Default Critical Flame Temperatures for common fuels, from Table 17.3 of Ref. [16].</center>

![QQ_1725263458290](/QQ_1725263458290.png)

**Extinction Model 2**

图 13.3 右图概括了 “EXTINCTION 2 ”模式。在这个模型中，CRITICAL_FLAME_TEMPERATURE 起到了更大的作用，因为网格单元中必须有足够的燃料和氧气才能使其温度超过 CFT。该模型对物种成分焓的计算也更为精确。对于未列出的燃料，您可以在 REAC 行中设置 CFT，或者直接接受默认值 1427 ℃（1700 K）。如果您知道特定燃料的氧指数 $X_{OI}$，则可以通过以下公式计算 CFT：
$$
T_{\mathrm{OI}}=T_0+X_{\mathrm{OI}}\frac{\Delta H_{\mathrm{c}}/r}{n\overline{c_p}}
$$
其中，

$T_0$:燃料/空气混合物的初始温度（环境条件）（K）

$X_{OI}$:限制氧气体积分数

$\Delta H_{\mathfrak{c}}/r$:每摩尔氧气消耗的燃烧热（kJ/mol）

$n$:每摩尔燃料/空气混合物的燃烧产物摩尔数

$\overline{c_p}$:$T_0$ 至 $T_{OI} $范围内燃烧产物的平均热容量（kJ/（mol-K)

**Extinction Model Verification**

在名为 Extinction/extinction_x.fds 的验证案例中，100 个密封的小盒子被初始化，温度从 300 K 到 1875 K，氧气质量分数从 0.0115 到 0.2185，结合燃料的化学计量，其余为氮气。假定甲烷发生一步完全反应：
$$
\mathrm{CH}_4+2\mathrm{O}_2\to\mathrm{CO}_2+2\mathrm{H}_2\mathrm{O}
$$
如图 13.3 所示，根据 “EXTINCTION 1 ”和 “EXTINCTION 2 ”模型，每个方框中的氧气和甲烷浓度以及温度决定了燃烧的发生或不发生。基于 “EXTINCTION 2 ”模型的 FDS 预测结果（右图）证实，根据反应物和生成物的热物理性质，维持燃烧（红色十字）或导致熄灭（蓝色星星）的条件与预期结果非常接近。更简单的模型 “EXTINCTION 1”（左图）仅仅符合指定的燃烧-不燃烧标准。有关灭火模型的更多详细信息，请参阅《技术参考指南》[^24]。

### Piloted Ignition

默认情况下，FDS 采用 “EXTINCTION 1 ”或 “EXTINCTION 2 ”模型来确定燃烧是否可行。**如果发生局部熄灭，未燃烧的燃料气体如果在域的其他地方与足够的氧气混合，就会重新点燃，即使这种重新点燃在现实中可能不会发生**，因为温度可能太低而无法维持燃烧。为了防止出现虚假的再次点火，可以在 REAC 行上设置 AUTO_IGNITION_TEMPERATURE（自动点火温度），单位为 °C，低于该温度将不会发生燃烧。对于大多数相关燃料，AIT 可在 Beyler 的《SFPE 手册》[^30] 章节中找到。默认 AIT 为 -273 ℃，这意味着燃料和氧气混合后会燃烧，前提是任何一种灭火模型都允许发生燃烧。

**如果网格尺寸大于 10 厘米，则可能需要降低 AIT 值**。AIT 的目的只是防止燃料和氧气自燃，这是 FDS 的默认行为。如果指定了 AIT，则还必须指定必须存在某种形式的热源/点火源才能起火；或者可以在 REAC 行上指定真正的六元组 AIT_EXCLUSION_ZONE，以指定一个即使在其他地方都执行 AIT 时仍会发生自燃的区域。请注意，您可以如下指定多个排除区：

```fortran
&REAC ..., AIT_EXCLUSION_ZONE(1:6,1)=..., AIT_EXCLUSION_ZONE(1:6,2)=... /
```

可以使用 AIT_EXCLUSION_ZONE_DEVC_ID(N) 或 AIT_EXCLUSION_ZONE_CTRL_ID(N)（其中 N 指所列禁区的索引）来控制禁区的开启和关闭。如果只有一个禁区，则无需添加索引。如果指定设备或控制器的状态为 “true”，则禁区生效。

点火区方法的另一种替代方法是指定一种 AIT 值较低的 “先导燃料”。在存在先导燃料且局部单元温度高于为特定先导燃料反应指定的 AIT 的单元中，燃烧将被允许进行。例如，您可以使用受控的燃料质量流量来初始化一系列粒子：

```fortran
&REAC FUEL='METHANE', ..., AUTO_IGNITION_TEMPERATURE=540. /
&REAC FUEL='ETHYLENE', ..., AUTO_IGNITION_TEMPERATURE=-273. /
```

在定义了适当的化学成分后，上述 REAC 行将允许乙烯用作先导燃料，从而避免任何存在乙烯及其氧化剂的单元出现点火阈值温度。您还可以使用以下输入行模拟火花点火：

```fortran
&REAC FUEL='METHANE', AUTO_IGNITION_TEMPERATURE=540 /
&PROP ID='spark', SPARK=T /
&DEVC ID='spark-1', XYZ=..., QUANTITY='TIME', SETPOINT=10, PROP_ID='spark' /
```

在这种情况下，除非网格单元温度超过 540 ℃，否则甲烷和空气不会燃烧。然而，在包含指定点 XYZ 的网格单元内，10 秒时会产生一个 “火花”，这实际上会使 AIT 变为 0 K，并允许燃料和空气点燃，前提是存在适量的燃料和空气。

## Complex Stoichiometry

上述 “简单化学 ”参数仅适用于燃料分子只包含 C、O、H 和 N 的情况。这意味着您必须明确指定气体种类或种类混合物以及反应的化学计量。

### Balancing the Atoms

考虑涉及甲烷的单一反应。当您指定 REAC 行为

```fortran
&REAC FUEL='METHANE' /
```

FDS 假设反应如下
$$
1\underbrace{(\mathrm{CH}_4)}_{\mathrm{Fuel}}+9.636\underbrace{(0.2076\mathrm{~O}_2+0.7825\mathrm{~N}_2+0.0095\mathrm{~H}_2\mathrm{O}+0.0004\mathrm{~CO}_2)}_{\mathrm{Air}}\longrightarrow\\10.636\underbrace{(0.0944\mathrm{~CO}_2+0.1966\mathrm{~H}_2\mathrm{O}+0.7090\mathrm{~N}_2)}_{\mathrm{Products}}
$$
默认情况下，空气中存在微量的二氧化碳和水蒸气，与氮气一样，它们也会被带入反应中。这一点很重要，因为甲烷单步反应的更复杂的指定方法如下：

```fortran
&SPEC ID='NITROGEN', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='OXYGEN', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='WATER VAPOR', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='CARBON DIOXIDE', LUMPED_COMPONENT_ONLY=T /
&SPEC ID='METHANE' /
&SPEC ID='AIR', BACKGROUND=T,
SPEC_ID(1)='OXYGEN', VOLUME_FRACTION(1)=0.2076,
SPEC_ID(2)='NITROGEN', VOLUME_FRACTION(2)=0.7825,
SPEC_ID(3)='WATER VAPOR', VOLUME_FRACTION(3)=0.0095,
SPEC_ID(4)='CARBON DIOXIDE', VOLUME_FRACTION(4)=0.0004 /
&SPEC ID='PRODUCTS',
SPEC_ID(1)='CARBON DIOXIDE', VOLUME_FRACTION(1)=0.0944,
SPEC_ID(2)='WATER VAPOR', VOLUME_FRACTION(2)=0.1966,
SPEC_ID(3)='NITROGEN', VOLUME_FRACTION(3)=0.7090 /
&REAC FUEL='METHANE', SPEC_ID_NU='METHANE','AIR','PRODUCTS',
NU=-1,-9.636,10.636, HEAT_OF_COMBUSTION=50000. /
```

反应的化学计量使用与被跟踪物种[^13-3] SPEC_ID_NU(N) 相对应的化学计量系数 NU(N)。如果使用复杂的化学计量，则不需要输入 FUEL。如果没有输入 FUEL，FDS 将假定它是 SPEC_ID_NU 中 NU 值为负的第一个物种。REAC 行中有几个参数用于控制化学计量的规格：

CHECK_ATOM_BALANCE 如果提供了参与反应的所有物种的化学式，那么 FDS 将检查化学计量学以确保原子是保留的。**将此标志设置为 F 将绕过此检查**。(默认为 T）

REAC_ATOM_ERROR 反应化学计量检查的误差容限（以原子为单位）。(默认为 1.E-5）

REAC_MASS_ERROR 反应化学计量质量平衡检查的相对误差容限，计算公式为（生成物质量 - 反应物质量）/（生成物质量）。(默认值 1.E-4）

### Complex Fuel Molecules

**Fuels Compatible with Simple Chemistry** 对于只含有 C、H、N 和 O 的复杂燃料分子，仍然可以使用简单的化学反应参数。考虑到天然气通常是多种气体成分的混合物。为了生成燃料混合物，需要定义原始（组分）种类。每种原始气体都将获得一个 LUMPED_COMPONENT_ONLY 名称，这意味着这些气体中的每一种都不会被明确跟踪，因为它们是混合物的组分。请注意，**这些集合成分只能包含 C、H、N 和 O 原子**。可以使用定义的原始成分创建集合燃料 “natural gas”，然后使用简单的化学方法定义反应（第 13.1.1 节）。(第 13.1.1 节）：

```fortran
&SPEC ID='METHANE', LUMPED_COMPONENT_ONLY=T/
&SPEC ID='ETHYLENE', LUMPED_COMPONENT_ONLY=T/
&SPEC ID='NITROGEN', LUMPED_COMPONENT_ONLY=T/
&SPEC ID='CARBON DIOXIDE',LUMPED_COMPONENT_ONLY=T/
&SPEC ID='natural gas'
SPEC_ID(1)='METHANE', VOLUME_FRACTION(1)=92.2
SPEC_ID(2)='ETHYLENE', VOLUME_FRACTION(2)= 3.3
SPEC_ID(3)='NITROGEN', VOLUME_FRACTION(3)= 3.9
SPEC_ID(4)='CARBON DIOXIDE',VOLUME_FRACTION(4)= 0.6/
&REAC FUEL='natural gas'
SOOT_YIELD=0.01 /
```

**Fuels Not Compatible with Simple Chemistry** 例如，氯通常存在于建筑材料和家用材料中，由于氯容易形成酸性气体 HCl，因此您可能希望在基本反应方案中考虑到氯。假设火灾中的主要燃料是聚氯乙烯（PVC）。无论其聚合物结构如何，在建模时都可将其视为 C2H3Cl。假设燃料中的所有 Cl 都转化成了 HCl，您可以使用指定燃料的适当烟尘和 CO 产率推导出单步反应机制。在本例中，使用 SFPE 手册 [^31] 计算出 PVC 的烟尘和 CO 产率，分别为 0.172 和 0.063。对于给定的物种 $\alpha$，其化学计量系数 $\nu_{\alpha}$ 可根据其产率 $y_{\alpha}$ 和分子量 $W_{\alpha}$ 根据公式求得：
$$
\nu_\alpha=\frac{W_\mathrm{F}}{W_\alpha}y_\alpha 
$$
由于假定所有的 Cl 都转化成了 HCL，因此其余的化学计量系数来自原子平衡。现在我们可以写出一个方程，其中包含适当的化学计量系数数值。
$$
\begin{aligned}1\underbrace{(\mathrm{C}_2\mathrm{H}_3\mathrm{C})}_{\mathrm{Fuel}}+1\underbrace{(1.53\mathrm{~O}_2+1.53\mathrm{~(3.76)~N}_2)}_{\mathrm{Air}}&\longrightarrow\\&1\underbrace{(\mathrm{HCl}+\mathrm{H}_2\mathrm{O}+0.14\mathrm{~CO}+0.96\mathrm{~CO}_2+0.90\mathrm{~C}+1.53\mathrm{~(3.76)~N}_2)}_{\mathrm{Products}}\end{aligned}\tag{13.12}\label{13.12}
$$
本例中选择的燃料聚氯乙烯（PVC）在附录 A 中没有定义，因此必须在 SPEC 行中定义其特性。在本例中，我们使用了该物种的化学式。此外，本例还将使用集合物种公式，以尽量减少需要求解的标量输运方程的数量。因此，没有显式输运方程的每个物种都是 LUMPED_COMPONENT_ONLY（单个物种）。

```fortran
&SPEC ID = 'PVC', FORMULA = 'C2H3Cl' /
&SPEC ID = 'OXYGEN', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'NITROGEN', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'HYDROGEN CHLORIDE', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'WATER VAPOR', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'CARBON MONOXIDE', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'CARBON DIOXIDE', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'SOOT', LUMPED_COMPONENT_ONLY = T /
```

氧化剂和生成物都是由多种原始气体组成，因此需要 SPEC 线来定义混合气体的组成。您可以使用组成气体的 MASS_FRACTIONS 或 VOLUME_FRACTIONS 来定义 SPEC。如果公式 $\eqref{13.12}$ 得到了适当的平衡，则可以直接使用原始物种的化学计量系数来定义集合物种。

```fortran
&SPEC ID='AIR', BACKGROUND=T
SPEC_ID(1)='OXYGEN', VOLUME_FRACTION(1)=1.53,
SPEC_ID(2)='NITROGEN', VOLUME_FRACTION(2)=5.76 /
&SPEC ID='PRODUCTS',
SPEC_ID(1)='HYDROGEN CHLORIDE', VOLUME_FRACTION(1)=1.0,
SPEC_ID(2)='WATER VAPOR', VOLUME_FRACTION(2)=1.0,
SPEC_ID(3)='CARBON MONOXIDE', VOLUME_FRACTION(3)=0.14,
SPEC_ID(4)='CARBON DIOXIDE', VOLUME_FRACTION(4)=0.96,
SPEC_ID(5)='SOOT', VOLUME_FRACTION(5)=0.90,
SPEC_ID(6)='NITROGEN', VOLUME_FRACTION(6)=5.76 /
```

要设置燃料的初始浓度，需要使用 INIT 管线：

```fortran
&INIT MASS_FRACTION(1)=0.229, SPEC_ID(1)='PVC' /
```

**由于这不是一个简单的化学问题，因此应指定聚氯乙烯的形成焓或反应燃烧热**。在本例中，PVC 的燃烧热取自 SFPE 手册 [^31]。

```fortran
&REAC FUEL='PVC', HEAT_OF_COMBUSTION=16400, SPEC_ID_NU='PVC','AIR','PRODUCTS',
NU=-1,-1,1, FIXED_MIX_TIME=0.1 /
```

请注意，NU 的符号与该物种是被消耗（-）还是被生产（+）相对应。图 13.4 显示了样本案例 PVC_Combustion 中生成物的质量分数。另外请注意，NU 值反映了 SPEC 行中定义的物种组成。例如，如果 PVC SPEC 定义为 CH1.5Cl0.5，那么 REAC 将要求 NU=-2,-1,1。本示例中使用了 0.1 秒的固定湍流混合时间，这只是因为反应物最初是在一个没有强加流量的腔室内混合的。**通常情况下，这一参数是不必要的**。

![QQ_1725266473317](/QQ_1725266473317.png)

### Multiple Fast Reactions

**对于大规模火灾模拟，数值网格通常过于粗糙，无法解析详细的有限速率火焰化学反应**。不过，您仍然可以指定一个由多个快速反应组成的燃烧方案。例如，请考虑以下描述丙烷燃烧过程中作为中间物质的 CO 和烟尘形成的三步方案：
$$
\begin{aligned}\mathrm{C}_3\mathrm{H}_8+3\mathrm{O}_2&\longrightarrow\quad2\mathrm{CO}+4\mathrm{H}_2\mathrm{O}+\mathrm{C}\\\mathrm{CO}+0.5\mathrm{O}_2&\longrightarrow\quad\mathrm{CO}_2\\\mathrm{C}+\mathrm{O}_2&\longrightarrow\quad\mathrm{CO}_2\end{aligned}
$$
在第一步中，燃料迅速转化为 CO、H2O 和烟尘 (C)，然后 CO 和烟尘在有氧气的情况下转化为 CO2。相对于网格单元内反应物的混合时间，所有反应都是 “快速 ”的，但第二和第三个反应的发生速度假定比第一个反应慢。默认情况下，FDS 会强制所有快速反应同时瞬时发生。但是，**如果您想指定反应按顺序进行，请使用参数 PRIORITY**，如下面的输入行：

```fortran
&SPEC ID='NITROGEN', BACKGROUND=T /
&SPEC ID='PROPANE', MASS_FRACTION_0=0.0 /
&SPEC ID='OXYGEN', MASS_FRACTION_0=0.23 /
&SPEC ID='WATER VAPOR', MASS_FRACTION_0=0.0 /
&SPEC ID='CARBON MONOXIDE', MASS_FRACTION_0=0.0 /
&SPEC ID='CARBON DIOXIDE', MASS_FRACTION_0=0.0 /
&SPEC ID='SOOT', MASS_FRACTION_0=0.0 /
&REAC ID='R1'
FUEL='PROPANE'
通过为反应 R2 和 R3 指定 PRIORITY=2，可以假设第一个反应 R1 首先发生，然后是 R2 和 R3。这一顺序允许在缺氧的隔室中积累烟尘和 CO。SPEC_ID_NU='PROPANE','OXYGEN','CARBON MONOXIDE','WATER VAPOR','SOOT'
NU=-1,-3,2,4,1 /
&REAC ID='R2'
FUEL='CARBON MONOXIDE'
SPEC_ID_NU='CARBON MONOXIDE','OXYGEN','CARBON DIOXIDE'
NU=-1,-0.5,1
PRIORITY=2 /
&REAC ID='R3'
FUEL='SOOT'
SPEC_ID_NU='SOOT','OXYGEN','CARBON DIOXIDE'
NU=-1,-1,1
PRIORITY=2 /
```

通过为反应 R2 和 R3 指定 PRIORITY=2，可以假设第一个反应 R1 首先发生，然后是 R2 和 R3。这一顺序允许在缺氧的隔室中积累烟尘和 CO。

请注意，**在此反应方案中，灭火模型适用于第一个反应，但不适用于第二个和第三个反 应**，因为默认灭火模型仅适用于多个快速反应中的第一个反应。有关灭火的更多信息，请参阅第 13.1.6 节。

### Multiple Fuels

有时，您的设计/模型火灾可能需要用**一种以上的燃料或一种以上的单步化学反应**来描述。在此示例中，可以考虑聚氨酯和木材同时发生两个混合控制反应。这两种燃料都是附录 A 中未包含的复杂分子，因此必须在 SPEC 行中定义。聚氨酯的化学式为 C25H42O6N2，木材的化学式为 CH1.7O0.74N0.002。考虑聚氨酯的燃烧反应，其烟尘产率为 ys = 0.131，一氧化碳产率为 yCO= 0.01 [^31]：
$$
\begin{aligned}1\underbrace{(\mathrm{C}_{25}\mathrm{H}_{42}\mathrm{O}_6\mathrm{N}_2)}_{\mathrm{Fuel}}+27.32741\underbrace{(\mathrm{O}_2+3.76\mathrm{~N}_2)}_{\mathrm{Air}}&\longrightarrow\\&1\underbrace{(19.74412\mathrm{~CO}_2+0.16659\mathrm{~CO}+21\mathrm{~H}_2\mathrm{O}+5.08930\mathrm{~C}+103.7511\mathrm{~N}_2)}_{\text{Products{\_}1}}\end{aligned}\tag{13.16}\label{13.16}
$$
而烟尘产率为 ys = 0.015 和一氧化碳产率为 yCO= 0.004 的木材的反应[^31]则为
$$
\begin{aligned}1\underbrace{(\mathrm{CH}_{1.7}\mathrm{O}_{0.74}\mathrm{N}_{0.002})}_{\mathrm{Fuel}}+1.021246\underbrace{(\mathrm{O}_2+3.76\mathrm{~N}_2)}_{\mathrm{Air}}&\longrightarrow\\&1\underbrace{(0.964384141\mathrm{~CO}_2+0.003655\mathrm{~CO}+0.85\mathrm{~H}_2\mathrm{O}+0.03196\mathrm{~C}+3.84076\mathrm{~N}_2)}_{\text{Products}{\_}2}\end{aligned}\tag{13.17}\label{13.17}
$$
与第 13.2.2 节中的示例类似，我们将使用物种集合方法来尽量减少 FDS 需要运输的物种数 量。因此，物种的定义如下：

```fortran
&SPEC ID = 'POLYURETHANE', FORMULA = 'C25H42O6N2' /
&SPEC ID = 'WOOD', FORMULA = 'CH1.7O0.74N0.002' /
&SPEC ID = 'OXYGEN', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'NITROGEN', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'WATER VAPOR', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'CARBON MONOXIDE', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'CARBON DIOXIDE', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'SOOT', LUMPED_COMPONENT_ONLY = T /
```

对公式 $\eqref{13.16}$ 和公式 $\eqref{13.17}$ 的研究表明，虽然Products_1 和Products_2 由相同的物种组成，但这些物种的存在比例并不相同。因此，我们必须构建两个独立的产品集总物种。

```fortran
&SPEC ID = 'AIR',
SPEC_ID(1) = 'OXYGEN', VOLUME_FRACTION(1)=1,
SPEC_ID(2) = 'NITROGEN', VOLUME_FRACTION(2)=3.76,
BACKGROUND=T /
&SPEC ID = 'PRODUCTS_1',
SPEC_ID(1) = 'CARBON DIOXIDE', VOLUME_FRACTION(1) = 19.74412,
SPEC_ID(2) = 'CARBON MONOXIDE', VOLUME_FRACTION(2) = 0.16659,
SPEC_ID(3) = 'WATER VAPOR', VOLUME_FRACTION(3) = 21.,
SPEC_ID(4) = 'SOOT', VOLUME_FRACTION(4) = 5.08930,
SPEC_ID(5) = 'NITROGEN', VOLUME_FRACTION(5) = 103.7111 /
&SPEC ID = 'PRODUCTS_2',
SPEC_ID(1) = 'CARBON DIOXIDE', VOLUME_FRACTION(1) = 0.96438,
SPEC_ID(2) = 'CARBON MONOXIDE', VOLUME_FRACTION(2) = 0.00365,
SPEC_ID(3) = 'WATER VAPOR', VOLUME_FRACTION(3) = 0.85,
SPEC_ID(4) = 'SOOT', VOLUME_FRACTION(4) = 0.03196,
SPEC_ID(5) = 'NITROGEN', VOLUME_FRACTION(5) = 3.84076 /
```

一旦构建了集合物种，我们就可以定义 REAC 线路。

```fortran
&REAC ID = 'plastic',
FUEL = 'POLYURETHANE',
HEAT_OF_COMBUSTION=26200,
SPEC_ID_NU = 'POLYURETHANE','AIR','PRODUCTS_1'
NU=-1,-27.32741,1 /
&REAC ID = 'wood'
FUEL = 'WOOD',
HEAT_OF_COMBUSTION=16400,
SPEC_ID_NU = 'WOOD','AIR','PRODUCTS_2'
NU=-1,-1.02121,1 /
```

在这两个反应中，所选燃料的 ENTHALPY_OF_FORMATION 对 FDS 来说都是未知的，因此要为每个反应指定 HEAT_OF_COMBUSTION。通常情况下，单位面积热释放量（HRRPUA）参数与 SPEC_ID（如果有多个 REAC 输入）和 MASS_FRACTION（如果 HRRPUA 是燃料混合物）一起用于指定 SURF 行上的火灾规模。也可以通过指定每种燃料的质量通量来使用多种燃料。在本例中，我们希望两种燃料都从同一燃烧器中流出，并在 60 秒后升至 1200 千瓦的火力。首先，我们通过定义VENT来创建一个 1 平方米的燃烧器：

```fortran
&VENT XB=4.0,5.0,4.0,5.0,0.0,0.0, SURF_ID='FIRE1', COLOR='RED'/
```

VENT指向 SURF_ID='FIRE1'，我们可以用这两种燃料来定义它。每种燃料的质量通量值由所需的热量释放、每种燃料在总热量释放率中所占的比例、燃烧器面积以及每种燃料的燃烧热决定。在这种情况下，我们需要 1200 千瓦的火焰，其中每种燃料对总热释放率（600 千瓦）的贡献为 50%。
$$
\dot{m}_{\mathrm{poly}}^{\prime\prime}=\frac{600\mathrm{~kW}}{1\mathrm{~m}^2}\frac1{26200\mathrm{~kJ/kg}}=0.022901\mathrm{~kg/(m^2s)}\\\dot{m}_{\mathrm{wood}}^{\prime\prime}=\frac{600\mathrm{~kW}}{1\mathrm{~m}^2}\frac1{16400\mathrm{~kJ/kg}}=0.036585\mathrm{~kg/(m^2s)}
$$

```fortran
&SURF ID='FIRE1', SPEC_ID(1)='POLYURETHANE', MASS_FLUX(1)=0.022901, RAMP_MF(1)='poly'
SPEC_ID(2)='WOOD', MASS_FLUX(2)=0.036585, RAMP_MF(2)='wood'/
```

请注意，每种燃料的 SPEC_ID、MASS_FLUX 和 RAMP_MF 都相互对应。哪种燃料是 (1)并不重要，重要的是编号要一致。我们还希望每种燃料都遵循一个斜坡，即在初始时间火的功率为 0 kW，在 100 s 时达到 1200 kW，并在 600 s 模拟的剩余时间内保持在 1200 kW。

```fortran
&RAMP ID='poly', T = 0, F = 0.0 /
&RAMP ID='poly', T = 50 , F = 0.5 /
&RAMP ID='poly', T = 100, F = 1.0 /
&RAMP ID='poly', T = 600, F = 1.0 /
&RAMP ID='wood', T = 0 , F = 0.0 /
&RAMP ID='wood', T = 50 , F = 0.5 /
&RAMP ID='wood', T = 100, F = 1.0 /
&RAMP ID='wood', T = 600, F = 1.0 /
```

在这里，T 代表时间，F 代表 SURF 线上指定的质量通量的一部分。图 13.5 比较了 FDS 输出的热释放率（HRR）与所定义斜坡的预期热释放率。请注意，在此模拟中，FDS 输出的热释放率（HRR）有 10 秒的平均值（&DUMP DT_HRR=10），预期结果考虑了这一平均值。

![QQ_1725269317706](/QQ_1725269317706.png)

请注意，**在使用多个化学反应时，必须在 COMB 行设置 SUPPRESSION=F**。

### Using the EQUATION input parameter

在使用所有原始变量（即无集合物种）指定反应方案时，通过输入参数 EQUATION（方程）可 以方便地以文本形式指定反应。其规则如下

- 必须明确跟踪物种。
- 物种名称是 SPEC 行或物种 ID 中定义的化学式。
- 每个物种前都给出了化学计量，并用星号隔开。允许使用实数，但不允许使用指数符号（如 201.1，但不是 2.011E2）。
- 反应物和生成物之间用等号隔开。

例如，如果该反应定义的是利用原始物种完全燃烧甲烷，那么以下反应就等效：

```fortran
&REAC FUEL='METHANE', EQUATION ='METHANE+2*OXYGEN=CARBON DIOXIDE+2*WATER VAPOR' /
&REAC FUEL='METHANE', EQUATION ='CH4+2*O2=CO2+2*H2O' /
&REAC FUEL='METHANE', EQUATION ='METHANE+2*O2=CO2+2*H2O' /
```

## Finite Rate Combustion

默认情况下，**FDS 使用混合控制燃烧模型，这意味着反应速率是无限的，仅受物种浓度的限制**。不过，FDS 也可以使用阿伦尼乌斯模型进行有限速率反应。由于有限速率反应需要完全解析的温度场（即在能够解析火焰温度的网格上进行模拟），<font color=red>**因此建议仅当 FDS 以 DNS 模式运行时（MISC 行上的 SIMULATION_MODE='DNS'）才调用有限速率反应**</font>。只有当反应中消耗或需要（第三体或催化剂）的所有物质的质量分数都大于 ZZ_MIN_GLOBAL，且本地单元温度高于 FINITE_RATE_MIN_TEMP（均在 COMB 上指定）时，才会计算特定的有限反应。ZZ_MIN_GLOBAL 的默认值为 1×10-10，一般来说已经足够。使用自由基方程的详细化学计算可能是个例外。用户应考虑将 FINITE_RATE_MIN_TEMP 设置为 100℃ 左右，以避免对详细动力学的 ODE 进行不必要且昂贵的时间积分。

**Single Step Reaction**

考虑丙烷完全燃烧的单步反应机制：
$$
\mathrm{C}_3\mathrm{H}_8+5\mathrm{O}_2\to3\mathrm{CO}_2+4\mathrm{H}_2\mathrm{O}\tag{13.20}\label{13.20}
$$
在这种情况下，我们明确定义了所有原始物种：

```fortran
&SPEC ID='NITROGEN', BACKGROUND=T/
&SPEC ID='PROPANE' /
&SPEC ID='OXYGEN' /
&SPEC ID='WATER VAPOR' /
&SPEC ID='CARBON DIOXIDE' /
```

燃料 C3H8 的速率表达式为
$$
\frac{\mathrm{d}C_{\mathrm{C}_3\mathrm{H}_8}}{\mathrm{d}t}=-k\prod{C_\alpha}^{N_{S,\alpha}}\tag{13.21}\label{13.21}
$$
其中，$C_{\alpha}$是物种 $\alpha$的浓度，单位为$mol/cm^3$，速率常数定义为
$$
k=AT^{N_T}\mathrm{e}^{-E_a/RT}
$$
A 是前指数因子 [ $((\mathrm{mol/cm}^3)^{1-n})/\mathrm{s}$]，其中$n=\sum N_{S,\alpha}$是反应阶数,

Ea 是活化能[J/mol]，

$N_{S,\alpha}$是一个包含浓度指数的数组（默认值为化学计量系数）

$N_T$ 是温度指数（默认为 0，表示与温度无关）

R 是通用气体常数，即 $\text{8.314 J/(mol-K)}$。

如果我们使用从实验或文献（此处为 Westbrook 和 Dryer [^31]）中找到的阿伦尼乌斯参数，则式 $\eqref{13.20}$ 所定义的单步丙烷反应的速率表达式就变成了：
$$
\frac{\mathrm{d}C_{\mathrm{C}_3\mathrm{H}_8}}{\mathrm{d}t}=-8.6\times10^{11}T^0\mathrm{~e}^{-125520/RT}C_{\mathrm{C}_3\mathrm{H}_8}^{0.1}C_{\mathrm{O}_2}^{1.65}
$$
由此得出的 REAC 线路为：

```fortran
&REAC ID = 'R1'
FUEL = 'PROPANE'
A = 8.6e11
E = 125520
SPEC_ID_NU = 'PROPANE','OXYGEN','CARBON DIOXIDE','WATER VAPOR'
NU = -1,-5,3,4
SPEC_ID_N_S = 'PROPANE','OXYGEN'
N_S = 0.1,1.65 /
```

数组 SPEC_ID_NU 包含作为生成物或反应物参与反应的被跟踪物种列表。需要注意的是，LUMPED_COMPONENT_ONLY=T 的原始物种不能在反应中使用，因为它没有被单独跟踪。数组 SPEC_ID_N_S 包含公式$\eqref{13.21}$中指数为 N_S 的物种列表。**该数组必须只包含原始物种，即不包含物种混合物**。化学计量系数 NU 数组可直接从公式$\eqref{13.20}$中提取。

### Multiple Step Reaction

如果我们将公式 $\eqref{13.20}$扩展到包括 Westbrook 和 Dryer [^31]提出的一氧化碳生成反应，就可以得到：
$$
\begin{aligned}\mathrm{C}_3\mathrm{H}_8+3.5\mathrm{O}_2&\to3\mathrm{CO}+4\mathrm{H}_2\mathrm{O}\\\mathrm{CO}+0.5\mathrm{O}_2&\Leftrightarrow\mathrm{CO}_2\end{aligned}
$$
在这种情况下，我们将结合快速化学和有限速率化学来创建混合反应机制。和以前一样，我们使用原始物种而不是混合物。每个反应（包括逆反应）都需要一条 REAC 线。丙烷氧化反应是快速化学反应，而可逆的一氧化碳反应是有限速率反应。阿伦尼乌斯参数根据 Andersen 等人的研究修改而成[^32]：

```fortran
&REAC ID = 'R1'
FUEL = 'PROPANE'
SPEC_ID_NU = 'PROPANE','OXYGEN','CARBON MONOXIDE','WATER VAPOR'
NU = -1,-3.5,3,4 /
&REAC ID = 'R2'
FUEL = 'CARBON MONOXIDE'
A = 1.5e9
E = 41840
SPEC_ID_NU = 'CARBON MONOXIDE','OXYGEN','CARBON DIOXIDE'
NU = -1,-0.5,1
SPEC_ID_N_S = 'OXYGEN','CARBON MONOXIDE','WATER VAPOR'
N_S = 0.25,1,0.5 /
&REAC ID = 'R3'
FUEL = 'CARBON DIOXIDE'
A = 6.16e13
E = 328026
SPEC_ID_NU = 'CARBON DIOXIDE','OXYGEN','CARBON MONOXIDE'
NU = -1,0.5,1
SPEC_ID_N_S = 'OXYGEN','CARBON DIOXIDE','WATER VAPOR'
N_S = -0.25,1,0.5
N_T = -0.97 /
```

就反应 R2 而言，反应速率取决于水蒸气浓度，这一点可以从分配的 N_S 值看出。但是，水蒸气并不明确参与反应，因为它没有被分配一个化学计量系数 NU。这类反应在教科书中通常写为
$$
\mathrm{aX+bY}\xrightarrow{H_2O}{X_aY_b}
$$
不过，在输入 FDS 时，由于 H2O 既不是生成物也不是反应物，因此在化学反应中不会使用 EQUATION 或 NU 来指定它。**取而代之的是使用 N_S 给出一个速率指数，表示需要 H2O 的存在**。

如前所述（第 13.1.2 节），能量释放是通过时间步中物种的净变化以及每个物种的形成焓来计算的。这种方法使得指定内热反应（如可逆 CO2 反应 (R3)）与典型的 FDS 放热燃烧反应没有区别。



### Reaction Rates from Equilibrium Constants

在某些情况下，一个可逆反应只有正向速率参数是已知的，反向速率参数必须从平衡状态下获得。这可以通过在 REAC 行添加 REVERSE=T 来实现。FDS 将创建一个逆反应，其中逆反应的 NU 值设置为正反应的 -NU。反向速率常数将通过反应的吉布斯自由能变化来确定。反向反应的 ID 将是正向反应的 ID，并附加 _R。下面是氢气与氧气燃烧以及相应的反向水蒸气解离反应的示例（摘自 [^33]）。在这种情况下，逆反应 ID 应为 R1_R。
$$
\mathrm{H}_2+0.5\mathrm{O}_2\leftrightarrows\mathrm{H}_2\mathrm{O}
$$

```fortran
&REAC ID = 'R1'
REVERSE = T
FUEL = 'HYDROGEN'
A = 0.85e16
E = 167360.
RADIATIVE_FRACTION=0.0
SPEC_ID_NU='HYDROGEN','OXYGEN','WATER VAPOR'
SPEC_ID_N_S='HYDROGEN','OXYGEN'
NU= -1,-0.5,1
N_S = 0.25,1.5
N_T = -1 /
```

### Third Body Reactions

有些反应需要与第三体（任何其他分子）碰撞才能激活反应。这类反应在教科书中通常写为
$$
\mathrm{aX+bY+M}\to {X_aY_b+M}
$$
在反应的 REAC 行中添加 THIRD_BODY=T 即可指定这种类型的反应。**物种 M 不应另行定义**。在某些第三体反应中，一种或多种气体物种作为碰撞物种的效率可能较高或较低。可以使用 THIRD_EFF_ID(N) 和 THIRD_EFF(N)列出任何具有非统一碰撞效率的物种，以定义特定物种的碰撞效率。

### Catalysts

有些反应需要特定分子的存在来稳定反应，而不是像第三体反应那样需要任何物种的存 在。下面举例说明：
$$
\mathrm{aX+bY+Z}\to {X_aY_b+Z}
$$
在 SPEC_ID_NU 中列出两次催化剂种类，并给出等式两边的 NU 值，即可指定催化剂。反应将使用净 NU 在 FDS 中向前推进，NU_S 的默认值为左侧的化学计量系数。对于逆反应，催化剂的 NU_S 值将是右侧的化学计量系数。

### Chemical Time Integration

燃烧反应的常微分方程组（ODE）在一个时间步长内使用多种求解器之一求解。**求解器通过 COMB 行上的字符串 ODE_SOLVER 指定。**所选的求解器控制所有反应。**如果所有反应都是快速反应，即在混合过程后瞬间发生，则默认求解器为 “EXPLICIT EULER”**。如果任何反应都是有限速率的，则默认求解器为 “RK2 RICHARDSON”，这是一种四阶方案，由三个二阶 Runge-Kutta 步骤和 Richardson 外推法生成（第三步提供了一种误差控制方法；详情见《FDS 技术指南》[^29]）。另外还有两种方案--“RK2 ”和 “RK3”，分别是不带理查森外推法的二阶和三阶 Runge-Kutta 方案。

化学反应时间积分的一个重要考虑因素是给定 FDS 时间步长下 ODE 求解器的迭代次数。对于无限快化学反应，迭代次数为 1；对于有限速率化学反应，迭代次数可以在 1 和 MAX_CHEMISTRY_SUBSTEPS（默认值 20）之间变化，取两者中的较小值，以满足 ODE 求解器 RICHARDSON_ERROR_TOLERANCE 的误差容限。如果达到最大值，可以增加迭代次数或降低积分器的误差容限约束。也可以通过设置 N_FIXED_CHEMISTRY_SUBSTEPS 来固定迭代次数。其默认值为-1，即时间步数由 ODE 求解器决定。这些不同的数值参数都在 COMB 行中设置，并且与所有反应相关。

如果多个反应的时间尺度变化很大，您可能需要在 COMB 行指定 CHECK_REALIZABILITY 为 T，这样在积分过程中，如果物种质量分数没有保持在 0 和 1 之间，程序就会发出警告。

## Aerosol Deposition

**在 FDS 中可以模拟烟雾和气溶胶在固体表面的沉积**。调用气溶胶沉积模型的方法是在 SPEC 行中定义一个参数 AEROSOL=T，同时定义 DENSITY_SOLID、CONDUCTIVITY_SOLID 和 MEAN_DIAMETER 参数。默认情况下，当 AEROSOL=T 时，FDS 将计算《技术参考指南》[^29]中讨论的所有气溶胶沉积机制。为便于诊断，可使用逻辑参数 GRAVITATIONAL_DEPOSITION、THERMOPHORETIC_DEPOSITION 和 TURBULENT_DEPOSITION，有选择地禁用每种表面沉积机制。逻辑参数 DEPOSITION 可禁用所有表面沉积。在气相中，气溶胶的飘移会受到重力和温度梯度的影响。这些影响可以通过 GRAVITATIONAL_SETTLING 和 THERMOPHORETIC_SETTLING 有选择性地关闭。**所有沉积参数都在 MISC 行**。可以使用名为 “DEPOSITION VELOCITY（沉积速度）”的固相输出 QUANTITY 输出壁面沉积速度。

参数 THERMOPHORETIC_DIAMETER 可用来定义颗粒直径，**以在计算热泳力时代替 MEAN_DIAMETER**。这可能适用于片状或串状气溶胶粒子，因为热泳力可作用于构成较大气溶胶的每个主要粒子。

### Example Case: Soot Deposition from a Propane Flame

propane_flame_deposition 示例说明了如何在 FDS 中定义一个调用气溶胶沉积模型的反应。燃料为丙烷，指定烟尘产率为 0.0544。请注意，这是一个仅用于演示和验证目的的人造烟尘产率。反应式如下
$$
1\underbrace{(\mathrm{C}_3\mathrm{H}_8)}_{\mathrm{Fuel}}+4.8\underbrace{(\mathrm{O}_2+3.7619\mathrm{~N}_2)}_{\mathrm{Air}}\longrightarrow1\underbrace{(18.10631\mathrm{~N}_2+2.8\mathrm{~CO}_2+4\mathrm{~H}_2\mathrm{O})}_{\mathrm{Products}}+0.2\underbrace{\mathrm{C}}_{\mathrm{Soot}}\tag{13.29}\label{13.29}
$$
请注意，烟尘的化学计量系数确保产生的烟尘质量是消耗燃料质量的 0.0544 倍。本示例使用了集总组分公式，以尽量减少需要求解的标量传输方程的数量。请注意，**必须通过在 SPEC 行定义 AEROSOL=T 来明确跟踪烟尘沉积**。

```fortran
&SPEC ID = 'PROPANE' /
&SPEC ID = 'OXYGEN', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'NITROGEN', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'WATER VAPOR', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'CARBON DIOXIDE', LUMPED_COMPONENT_ONLY = T /
&SPEC ID = 'SOOT', AEROSOL = T /
```

如果公式$\eqref{13.29}$得到了适当的平衡，就可以直接使用原始物种的化学计量系数来定义集合物种：

```fortran
&SPEC ID = 'AIR', SPEC_ID ='NITROGEN','OXYGEN',
VOLUME_FRACTION = 3.76,1., BACKGROUND = T /
&SPEC ID = 'PRODUCTS', SPEC_ID ='NITROGEN','CARBON DIOXIDE','WATER VAPOR',
VOLUME_FRACTION = 18.10978,2.81643,4.0 /
```

丙烷的燃烧热见《SFPE 手册》[^34]。

```fortran
&REAC FUEL = 'PROPANE', HEAT_OF_COMBUSTION=44715.,
SPEC_ID_NU = 'PROPANE','AIR','PRODUCTS','SOOT',
NU=-1.,-4.81643,1.,0.18357/
```

注：NU 的符号与该物种是被消耗（-）还是被生产（+）相对应。图 13.6 显示了煤烟在墙壁表面的沉积情况。该边界量由下面的输入给出。

```fortran
&BNDF QUANTITY='SURFACE DEPOSITION', SPEC_ID='SOOT' /
```

![QQ_1725279001891](/QQ_1725279001891.png)

### Soot Surface Oxidation

在计算烟尘沉积时，如果当地温度足够高且存在氧气，表面上的烟尘会发生氧化。**通过 MISC 输入的逻辑标志 SOOT_OXIDATION 启用烟尘氧化**。氧化反应是利用烟尘表面密度和当地氧气摩尔分数计算出来的单步阿伦尼乌斯反应。该反应使用的速率常数为 4.7×10^12，活化能为 211 kJ/mol。这些数值基于 Hartman、Beyler、Riahi 和 Beyler [^35]的研究成果。

烟灰氧化不能使用简单的化学反应，必须使用原始化学物质。请参见验证指南中的 soot_oxidation_wall 示例案例。

## Aerosol Agglomeration

**随着时间的推移，气溶胶颗粒会相互碰撞并粘在一起，形成更大的颗粒。这个过程称为聚结**。FDS 中的聚结模型是通过定义气溶胶种类和粒度分区自动调用的。可以通过 MISC 输入的逻辑标志 AGGLOMERATION 关闭聚结模型。通过在气溶胶种类的 SPEC 行中给出最小颗粒直径（MIN_DIAMETER，以 m 为单位）、最大颗粒直径（MAX_DIAMETER，以 m 为单位）和所需的粒度分区数（N_BINS）来定义颗粒分区。请注意，如果定义了多个气溶胶物种，聚结模型将独立聚结每个物种，**即不同物种的粒子不会聚结成一个更大的混合物种粒子**。以下输入将烟尘种类定义为气溶胶，在 1 到 100 μm 之间有 10 个分区。每个分区都将创建为自己的集合物种，命名为 SOOT_1 至 SOOT_10。颗粒分区的摘要将写入 CHID.out 文件。

```fortran
&SPEC ID='SOOT', AEROSOL=T,MIN_DIAMETER=1.E-6,MAX_DIAMETER=100.E-6,
N_BINS=10,LUMPED_COMPONENT_ONLY=T/
```

将气溶胶凝聚与化学反应结合起来可能是可取的。也就是说，一种或多种气溶胶可以作为反应物或产物参与化学反应。请注意，如上所述，气溶胶分布的跟踪种类会附加上仓号。在 FDS 中，跟踪的是这些亚种，您必须明确指定反应中亚种的化学计量（见第 13.2 节）。下面是正庚烷燃烧生成烟尘气溶胶的示例，有五个粒度分区。

```fortran
&SPEC ID='N-HEPTANE' /
&SPEC ID='NITROGEN',LUMPED_COMPONENT_ONLY=T/
&SPEC ID='OXYGEN',LUMPED_COMPONENT_ONLY=T/
&SPEC ID='CARBON DIOXIDE',LUMPED_COMPONENT_ONLY=T/
&SPEC ID='CARBON MONOXIDE',LUMPED_COMPONENT_ONLY=T/
&SPEC ID='WATER VAPOR',LUMPED_COMPONENT_ONLY=T/
&SPEC ID='SOOT',LUMPED_COMPONENT_ONLY=T,
AEROSOL=T,N_BINS=5,
MIN_DIAMETER=0.023,MAX_DIAMETER=11.5/
&SPEC ID='AIR',BACKGROUND=T,
SPEC_ID='NITROGEN','OXYGEN','CARBON DIOXIDE','WATER VAPOR',
VOLUME_FRACTION=40.94283132,10.85911,0.020216389,0.497368688/
&SPEC ID='PRODUCTS',
SPEC_ID='NITROGEN','CARBON DIOXIDE','WATER VAPOR','CARBON MONOXIDE',
VOLUME_FRACTION=40.94283132,6.868439402,8.490526567,0.028618803/
&REAC FUEL='N-HEPTANE',
SPEC_ID_NU='N-HEPTANE',
'AIR',
'PRODUCTS',
'SOOT_1',
'SOOT_2',
'SOOT_3',
'SOOT_4',
'SOOT_5',
NU=-1,-1,1,0.035837089,0.030715589,0.026822578,0.023205152,0.02026202,
RADIATIVE_FRACTION=0.44 /
```

## Aerosol Scrubbing

**喷水可以清除空气中的气溶胶。**例如，降雨可以降低空气中花粉和其他微粒的浓度。通过在 MISC 上设置 AEROSOL_SCRUBBING=T，可以在 FDS 中模拟这种行为。设置此项后，气溶胶洗涤模型就会开启，从气相中清除气溶胶。气溶胶一旦被清除，其质量将不再被跟踪；也就是说，气溶胶洗涤模型只是充当气溶胶的汇。

## Vapor Condensation

如果用 AEROSOL=T 定义了具有液体特性的物种（如WATER VAPOR,），则 FDS 将预测该物种的凝结。FDS 会创建名为 ID_COND 的第二个物种。例如，如果物种是WATER VAPOR，那么第二个物种将被称为WATER VAPOR_COND。这第二个物种将是跟踪凝结相的气溶胶物种。冷凝蒸汽的颗粒直径由 MEAN_DIAMETER 给出，冷凝物种比热将使用 SPECIFIC_HEAT_LIQUID 液体值，颗粒密度将使用 DENSITY_LIQUID 而不是 DENSITY_SOLID。冷凝相的初始质量分数可以用 MASS_FRACTION_COND_0 来定义。例如，下面的输入将水蒸气定义为可冷凝物质，其初始蒸汽质量分数为 0.1，初始冷凝物质量分数为 0.05。

冷凝程序需要有成核点才能启动冷凝过程。如果已经存在冷凝气体，则使用冷凝颗粒的数量。否则，FDS 将假定细气溶胶（花粉、细菌孢子等）的背景浓度。默认值为每立方米 10,000,000 个成核点。可以通过将 NUCLEATION_SITES 设置为 MISC 来更改该值。

```fortran
&SPEC ID='WATER VAPOR', AEROSOL=T,MEAN_DIAMETER=1.E-6,
MASS_FRRACTION_0=0.1,MASS_FRACTION_COND=0.05/
```

气室和壁室都可能发生冷凝。冷凝导致的壁面热量传递可以通过冷凝热流量（QUANTITY of CONDENSATION HEAT FLUX）输出。冷凝的蒸汽量可通过冷凝相 SPEC_ID 的表面沉积量（QUANTITY of SURFACE DEPOSITION）输出。

****

[^13-1]:**如果您想知道每个指定反应的实际绝热火焰温度，请在 COMB 行添加 COMPUTE_ADIABATIC_FLAME_TEMPERATURE=T**。结果将写入名为 CHID.out 的文件。
[^13-2]:要消除任何气相抑制，请在 COMB 线路上设置 SUPPRESSION=F。
[^13-3]:“跟踪 ”物种是指 LUMPED_COMPONENT_ONLY 为 F 的物种。

# Radiation

## Basic Radiation Parameters: The RADI Namelist Group

RADI 是包含辐射求解器相关参数的命名列表组。**输入文件中只能有一行 RADI**。

火灾科学中的一个重要量是以热辐射形式释放的火灾热释放率，通常称为辐射率，符号表示为 $\chi_{\mathrm{r}}$。它是火势大小、火焰温度以及燃料和燃烧产物化学成分的函数。在大规模火灾模拟中，火焰温度（相对于平均单元温度）的计算并不可靠，因为在相对较粗的数值网格上，火焰片的分辨率并不高。**因此，辐射传输方程（RTE）中的源项因与 $T^4$ 有关而无法可靠计算**。作为一种实用的替代方法，REAC 行上的参数 RADIATIVE_FRACTION 允许您明确指定以热辐射形式释放的总燃烧能量的比例。默认情况下，在 LES 计算中，RADIATIVE_FRACTION 设置为基于反应FUEL的特定值；在 DNS 计算中，RADIATIVE_FRACTION 设置为零。表 14.1 列出了一些常见纯燃料的默认辐射分数。其中许多值都是基于 Tewarson 对相对较小火焰的测量值[^34]。这些值可能会随着火灾规模的增大而改变；因此，Beyler [^39]引用的测量值可能更适合较大的火灾。如有疑问，请选择适合您的火灾的数值。对于给定的燃料，没有一个单一的辐射分数值。

<center>Table 14.1: Default radiative fraction for some common fuels.</center>

![image-20241017163605648](/../FUG6.9.1翻译.assets/image-20241017163605648.png)

在 FDS 中，有四种处理热辐射的方法，下文将对此进行说明。

### Radiation Option 1. No Radiation Transport

通过在 RADI 行添加 RADIATION=F 语句，可以关闭 RTE 求解器（节省大约 20% 的 CPU 时间）。如果燃烧正在进行而辐射被关闭，则总放热率会因 RADIATIVE_FRACTION 而降低，RADIATIVE_FRACTION 是 REAC 行的输入值。表 14.1 列出了各种纯燃料的默认值。当 RADIATION 设置为 F 时，火灾的辐射能量会从计算域中消失。对于火灾模拟或任何温度上升数百摄氏度的情况，不建议关闭辐射传输。该功能主要用于诊断目的或温度变化相对较小的情况。

### Radiation Option 2. Optically-Thin Limit; Specified Radiative Fraction

在某些火灾场景中，您可能希望通过将 RADI 行中的 OPTICALLY_THIN 设为 T 来将 RTE 中的吸收系数$\kappa$ 设为零，在这种情况下，所有气体对热辐射的再吸收都将被忽略。从本质上讲，火会辐射出用户指定的 RADIATIVE_FRACTION 能量，这些能量会被传送到域边界，而不会被较冷的气体重新吸收。在车厢火灾场景中，冷热烟雾对热辐射的吸收和发射是一个重要的考虑因素，因此您不希望这样做。相反，您可能希望在车厢外或相对较大的开放空间发生火灾时选择此选项，因为您希望明 确规定传输到目标和实体边界的净辐射能量。例如，由于烟雾和燃烧产物会重新吸收辐射能量，因此超大型碳氢化合物燃料火灾的辐射部分会随着直径的增大而减小。这就是为什么大型油火看起来主要由烟雾组成，而这些烟雾会遮挡外部物体的热辐射。这种现象很难预测，而且可能与电网有关。在这种情况下，您可能只需在 REAC 行指定 RADIATIVE_FRACTION，然后在 RADI 行指定 OPTICALLY_THIN=T，在这种情况下，火灾将辐射指定的部分能量，而 FDS 将不会尝试计算燃烧产物或周围气体对这些能量的再吸收。

### Radiation Option 3. Optically-Thick; Specified Radiative Fraction (LES Default)

在正常运行时，RTE 会将热辐射气体（如火焰）的能量转移到较冷的吸收气体（如水蒸气或烟尘微粒）。使用 RadCal 计算的吸收系数 $\kappa$ 对热辐射的发射和吸收都有影响。由于典型的大规模火灾模拟无法很好地解决火焰温度问题，因此在辐射分量$\chi_{\mathrm{r}}$乘以单位体积局部热释放率 $\dot q{\prime}{\prime}{\prime}$ 大于 10 kW/m3 的网格单元中，要对 RTE 中的源项进行调整。
$$
\chi_\mathrm{r}\dot{q}^{\prime\prime\prime}>10\mathrm{~kW/m^3}\label{14.1}\tag{14.1}
$$
该调整可确保燃烧区域（即火场）的净辐射量是指定的 RADIATIVE_FRACTION 乘以该区域产生的总燃烧能量。在其他地方，热气体和冷气体根据其体积温度和辐射特性，特别是吸收系数$\kappa$，发射和吸收热辐射。

在输出文件 CHID_hrr.csv 中的 Q_RADI 列中，计算域的净辐射损失将作为时间函数进行报告。Q_RADI 的绝对值除以总热释放率 HRR 通常不完全等于指定的 RADIATIVE_FRACTION。原因是指定的火灾能量辐射部分可能会被烟雾和水蒸气等较冷的燃烧产物重新吸收，从而降低 Q_RADI 的绝对值。或者，热层烟雾和燃烧产物会升温并发出热辐射，从而增加 Q_RADI 的绝对值。

在公式 (14.1) 所定义的区域中，应用于 RTE 源项的修正系数默认介于 1 和 100 之间，这意味着修正系数只会在必要时增加燃烧区域的净辐射输出，以达到所需的 RADIATIVE_FRACTION。不过，您可以通过以下方式改变修正的默认行为。首先，您可以通过 RADI 行上的 QR_CLIP 将公式 $\eqref{14.1}$ 中的 10 改为-1，从而强制在所有网格单元中修改 RTE 源项，在这种情况下，求解器将对整个域而不仅仅是发生燃烧的单元应用辐射分数。这将从根本上迫使整个域的净辐射损失服从 RADIATIVE_FRACTION。其次，您可以通过改变校正因子 C_MIN 的下限，将其从默认值 1 改为 RADI 线上的 0.5，从而允许 RTE 源项增大或减小，以达到所需的 RADIATIVE_FRACTION。相应的参数 C_MAX 将修正系数限制为 100。时变校正因数可通过带有数量 RTE SOURCE CORRECTION FACTOR 的设备输出。由于 RTE 源校正因子是一个全局值，因此设备的位置并不重要。

### Radiation Option 4. Optically-Thick; Unspecified Radiative Fraction (DNS Default)

如果可以假定温度场解析度很高，并且辐射吸收系数和 RTE 源项无需修正即可计算，那么 RADIATIVE_FRACTION 应该设为零。这是 DNS（直接数值模拟）的默认设置，对于高分辨率的 LES 计算，例如网格单元只有几毫米大小的情况，也可以设置为零。当然，要对网格分辨率进行研究，以确定所产生的辐射分数（即 -Q_RAD/HRR）是否与网格无关。

## Spatial and Temporal Resolution of the Radiation Transport Solver

有几种方法可以提高离散辐射传输方程（RTE）的空间和时间精度，但每种方法通常都会增加计算时间。可以通过整数参数 NUMBER_RADIATION_ANGLES 增加角度数（默认为 100）来提高空间精度。确定是否需要更高的空间分辨率的一个好方法是添加 “综合强度 ”量的切片（SLCF）文件。通常情况下，在热源附近会看到较高的数值，而在较远的地方这些数值会降低。理想情况下，您应该在远离热源的地方看到一个较为平滑的圆形图案，但由于跟踪辐射强度的实心角数量有限，您将在远场看到一个非物理的星形图案。如果远离热源处没有重要的 “目标”，则可以忽略这种非物理模式，但如果有重要的目标，则应增加角度数，直到在感兴趣的区域内看到相对平滑的模式。

Kim 和 Trouvé [^40] 对精确角度分辨率的要求进行了研究。他们认为，在发射源表面积为 S 的情况下，目标与发射源之间的距离为 H，精确分辨率（NRAcritical）所需的实体角数为
$$
\mathrm{NRA}_{\mathrm{critical}}=N_\Omega\times\frac{4\pi H^2}S
$$
其中 $N_{\Omega}$ 应介于 5 和 10 之间。

调用辐射求解器的频率可以通过一个名为 TIME_STEP_INCREMENT 的整数来改变，即从每 3 个时间步改变为每 3 个时间步。可以使用名为 ANGLE_INCREMENT 的整数将更新角度的增量从 5 减小到 5。如果将 TIME_STEP_INCREMENT 和 ANGLE_INCREMENT 都设为 1，辐射场将在一个时间步长内全部更新，但计算成本将大幅增加。默认情况下，辐射传输方程每 15 个时间步完全更新一次。考虑到 CFL 约束所要求的相对较小的时间步长，15 个时间步通常仍然是一个相对较短的时间间隔。提高辐射求解器的时间分辨率很少能提高计算的整体精度。空间分辨率更为重要。

如果使用多个网格，辐射求解器无法在单个时间步长内将能量从一个网格传递到另一个网格。如果发现辐射强度从一个网格传播到另一个网格时有明显延迟，可以使用 RADIATION_ITERATIONS 增加辐射强度在单个时间步内的更新次数，默认值为 1。您很少需要这样做，除非从不同切片文件的动画中可以明显看出。

辐射求解器会在计算开始前调用，以便在您指定的初始温度为非环境温度时建立辐射场。默认情况下，辐射和壁面边界例程会迭代三次以建立热平衡。要更改迭代次数，请在 RADI 行设置 INITIAL_RADIATION_ITERATIONS。

## Absorption Coefficient of Gases and Soot

默认情况下，FDS 采用灰色气体模型来计算辐射吸收系数。其他选项包括宽带模型（在辐射文献中通常称为盒式模型）和灰气加权和模型（WSGG）。FDS 技术参考指南》[^29] 对这些模型进行了详细讨论。如果模拟涉及燃烧，则会自动考虑燃烧过程中最常见气体（水蒸气、二氧化碳、一氧化碳、燃料）和烟尘颗粒的辐射特性。在没有燃烧或辐射物种的模拟中，可以通过在 RADI 行指定 KAPPA0 来使用恒定的吸收系数。

您可以使用 QUANTITY='ABSORPTION COEFFICIENT' 输出灰色吸收系数。宽频带和 WSGG 模型在每个位置都使用了多个吸收系数值，而 “ABSORPTION COEFFICIENT”输出量只显示其中一个值，因此对于多频带模型来说，该输出量并不实用。

如果要对氧化铝进行建模，可以通过在 MISC 上设置 AEROSOL_AL2O3=T，用氧化铝的光学特性来代替烟尘的光学特性。任何 RADCAL_ID='SOOT' 的物质都将被视为氧化铝。

### Gray Gas Model (default)

吸收系数是气体成分和温度的函数。在模拟开始时，FDS 会多次调用 RadCal 窄带模型，以建立一个与温度有关的查询表，其中包含模拟中所有气体以及烟尘的灰色特定吸收系数。RadCal 有几个注意事项：

**Path Length**

对于给定的气体温度和物种组成，RadCal 只计算与波长无关的单一有效吸收系数。要计算该系数，需要用户指定 PATH_LENGTH（米），默认值为 0.1 米。PATH_LENGTH 的默认值为 0.1 米。根据应用的不同，PATH_LENGTH 的选择可以基于火灾、隔间或整个计算域的物理大小。选择默认值是为了准确捕捉火本身及其周围的辐射传热。对于这一长度范围，一个有用的 “经验法则 ”是 4V/A，其中 V 是所关注区域的体积，A 是所覆盖的表面积。该区域可能是火灾本身或闪过的隔间所占据的体积。另外，如果应用涉及计算远处目标的热通量，更合适的 PATH_LENGTH 可能是火灾到目标的距离。在任何情况下都应进行敏感性分析，以确定所选 PATH_LENGTH 对预测值的影响。

**Fuel Species**

RadCal 的原始版本只包括甲烷的吸收数据，甲烷被用作任何燃料的替代物。不过，RadCal 已经添加了更多燃料种类。目前的燃料清单包括 甲烷、乙烯、乙烷、丙烷、正己烷、甲醇、甲苯、丙烯和 MMA。除这些物质外，还有以下 RadCal 物质 二氧化碳、一氧化碳、水蒸气和烟尘。

### Wide Band Model (Box Model)

要使用可选的宽带（盒）模式，请在 RADI 行设置 WIDE_BAND_MODEL=T。建议仅在燃料相对无泡时使用该选项，因为它会大大增加计算成本。不要指定 RADIATIVE_FRACTION，因为它不会被使用。

使用宽波段模型时，电磁波谱被划分为相对较少的波段，在每个波段内，吸收系数被假定为常数，因此被称为 “盒”。这些值由 RadCal 计算得出。WIDE_BAND_MODEL=T 时的默认操作假定有六个波段，波段限值集已预先定义为水、二氧化碳、一氧化碳和少数几种燃料的六个波段。这些燃料是(’ETHANE’, ’ETHYLENE’, ’METHANE’, ’METHANOL’, ’N-HEPTANE, ’PROPANE’, ’PROPYLENE’, and ’TOLUENE’.) “乙烷”、“乙烯”、“甲烷”、“甲醇”、“正己烷”、“丙烷”、“丙烯 ”和 “甲苯”。

可以通过在 RADI 线路上指定 BAND_LIMITS 来设置自己的频段限制。限值应以升序排列，单位为微米（μm）。波段的最大数目为 9，在这种情况下，您可以指定 10 个用逗号分隔的实数。

### Weighted Sum of Gray Gases (WSGG)

要激活 WSGG 模型，请在 RADI 行设置 WSGG_MODEL=T。WSGG 模型以四个灰色系数的加权和来计算吸收系数，每个系数都是气体成分（水蒸气、 二氧化碳和烟尘）和温度的函数。其他气体将被忽略。请勿设置 BAND_LIMITS。

## Radiative Absorption and Scattering by Particles

拉格朗日粒子对热辐射的吸收和散射包含在辐射传输方程中。辐射特性可以通过在相应的PART行中指定材料折射率的分量，使用关键字 REAL_REFRACTIVE_INDEX 和 COMPLEX_REFACTIVE_INDEX来给出。或者，也可以将这两个与波长相关的量值以表格形式列出，并使用 RADIATIVE_PROPERTY_TABLE 进行调用。更多详情请参见第 15.3.2 节。

水和燃料颗粒（液滴）的辐射特性是自动确定的。对于燃料，假定使用庚烷的特性。庚烷值可通过在 PART行中指定来覆盖。

此处列出了影响粒子与辐射相互作用计算的其他参数。RADTMP 是假定的辐射源温度。它用于计算平均散射和吸收截面时的光谱加权。默认值为 900 ℃。NMIEANG 是米氏相位函数数值积分中的角度数。增加 NMIEANG 可以提高水滴辐射特性的精度。提高精度的代价体现在初始化阶段，而不是实际模拟过程中。NMIEANG 的默认值为 15。对于每一类粒子，米氏系数都是在很大的水滴直径范围内计算的，以确保涵盖所有可能的运行情况。为加快初始化阶段的速度，可通过参数 MIE_MINIMUM_DIAMETER 和 MIE_MAXIMUM_DIAMETER 限制直径范围。此外，还可以使用 MIE_NDG 参数指定米氏系数表的大小。

## Other Considerations

**Multi-fuel radiative fraction** 如果存在多种燃料，例如一种燃料用于纸板燃烧，一种燃料用于聚苯乙烯燃烧，那么辐射分数将作为反应加权值进行局部计算，类似于 Gupta 等人[^41]所描述的方法。例如，如果两种燃料的辐射率分别为 20% 和 40%，网格单元中的热量分别为 80% 和 20%，则$\chi_{\mathrm{r}}$ 将为 0.8×0.2+0.2×0.4 = 0.24。因此，$\chi_{\mathrm{r}}$ 将随时间和空间而变化。多燃料辐射分数的值可以通过 CHI_R 的输出量 QUANTITY 输出。

**Time variation of radiative fraction** 即使是单一燃料种类，全局火焰辐射分数也可能取决于问题的其他参数，如全局等效比。如果需要辐射分数的时间变化，可以通过 REAC 线上的斜坡函数 RAMP_CHI_R 来实现。运行包含 RAMP 的 ramp_chi_r 测试用例的结果如图 14.1 所示。

```fortran
&REAC FUEL='METHANE', RADIATIVE_FRACTION=1.0, RAMP_CHI_R='CHI_R RAMP' /
&RAMP ID='CHI_R RAMP', T= 0.0, F=0.238 /
&RAMP ID='CHI_R RAMP', T= 2.0, F=0.238 /
&RAMP ID='CHI_R RAMP', T= 4.0, F=0.182 /
&RAMP ID='CHI_R RAMP', T= 6.0, F=0.158 /
&RAMP ID='CHI_R RAMP', T= 8.0, F=0.140 /
&RAMP ID='CHI_R RAMP', T= 10.0, F=0.140 /
```

![image-20241017191456988](/../FUG6.9.1翻译.assets/image-20241017191456988.png)

# Particles and Droplets

拉格朗日粒子可以用来表示各种太小而无法在数值网格上解析的物体。FDS 考虑了三大类拉格朗日粒子：无质量示踪剂、液滴和其他一切。描述粒子的参数可在 PART 行中找到。

## Basics

不同类型拉格朗日粒子的属性通过 PART 命名列表组指定。一旦使用 PART 行描述了特定类型的粒子，就可以通过参数 PART_ID 在输入文件的其他地方调用该粒子类型的名称。没有保留的 PART_ID，**所有 PART_ID 都必须定义**。例如，一个输入文件可能有多个 PART 行，包含不同类型拉格朗日粒子的属性：

```fortran
&PART ID='my smoke',... /
&PART ID='my water',... /
```

粒子可以通过几种不同的方式引入计算：**可以通过喷头或喷嘴引入**（液滴通常通过这种方式引入），可以在吹气孔或燃烧面引入（质量示踪粒子或代表余烬的粒子通常通过这种方式引入），也可以**随机引入或在指定体积内的固定点引入**（代表亚网格尺度物体的固体粒子通常通过这种方式引入）。详情请见下文。

描述粒子的方式取决于粒子的类型。如果您只想要无质量示踪剂，请在 PART 行指定 MASSLESS=T。如果您指定了 SPEC_ID，那么 FDS 会自动假定您需要的是相对较小的热稀薄蒸发液滴。对于任何其他类型的粒子，例如代表办公室杂波或植被等亚网格尺度物体的粒子，您可以在 PART 行添加 SURF_ID。下面将介绍所有这些不同类型的粒子。

**Computational versus Physical Particles**

为了保持质量和能量守恒，同时最大限度地降低计算成本，FDS 计算粒子通常代表大量具有相同几何和热物理特性的物理粒子。在 FDS 中，每个粒子都有一个加权系数，代表每个计算粒子的物理粒子数。您可以使用 DEVC 输出 “PARTICLE WEIGHTING FACTOR”，或在 Smokeview 中查看 “PARTICLE WEIGHTING FACTOR”。

## Massless Particles

**拉格朗日粒子最简单的用途是可视化**，在这种情况下，粒子被视为无质量的示踪剂。在这种情况下，粒子通过直线

```fortran
&PART ID='tracers', MASSLESS=T, ... /
```

请注意，**如果粒子是无量纲的，就不适合根据任何特定属性给它们着色**。<u>粒子不是根据气相量着色，而是根据粒子本身的属性着色</u>。例如，非无质量粒子的 “粒子温度（PARTICLE TEMPERATURE）”指的是粒子本身的温度，而不是局部气体温度。另外请注意，如果 MASSLESS=T，则取样系数（第 22.9 节）将设为 1，除非您另有说明。

**Turbulent Dispersion (Massless Tracers)**

**无质量示踪粒子也可用于模拟不影响平均流场（被动标量）的示踪气体的扩散**。粒子的数量密度可以转化为局部质量浓度。请参阅第 22.10.16 节中的如何输出数浓度。

要考虑子网格尺度的湍流运动，请在 PART 行添加 TURBULENT_DISPERSION=T。然后，粒子将根据子网格扩散率进行随机行走。**示例请参见验证套件 WUI 目录中的 random_walk 测试用例**。

**Turbulent Dispersion (Massive Particles)**

TURBULENT_DISPERSION=T 也可用于大质量粒子。在这种情况下，不使用随机行走模型；相反，阻力计算中使用的流体速度增加了一个波动分量，该分量来自对子网格动能的估计。FDS 技术参考指南[^29]中讨论了详细的计算方法。

## Liquid Droplets

不只是无质量示踪剂的拉格朗日粒子可分为两大类--**液滴或固体粒子**。本节介绍前者，下一节介绍后者。

要定义蒸发液滴，必须通过 PART 行的 SPEC_ID 指定蒸发产生的气体种类名称。例如

```fortran
&PART ID='my droplets', SPEC_ID='WATER VAPOR', ... /
```

通过指定 SPEC_ID，可以隐式调用液滴蒸发模型。或者，如果指定一个 SURF_ID，则表示指定了一个固体粒子，其行为与给定的 SURF 线一致。固体粒子将在第 15.4 节中介绍。

默认情况下，液滴蒸发使用带有 B-number的 Ranz-Marshall 相关性[^42]。通过在 PART 上设置 EVAP_MODEL，可以使用其他相关性。可用选项包括：

- RANZ-MARSHALL NO B-NUMBER 使用无 B-number的 Ranz-Marshall 相关性。
- RANZ-MARSHALL B-NUMBER 使用 Ranz-Marshall 相关性，同时将蒸发物种 B-number应用于努塞尔特数和舍伍德数相关性。**这是默认值**。这是 Sazhin [^43] 的 M0 模型。
- RANZ-MARSHALL LEWIS B-NUMBER 是使用基于薄膜条件下计算的路易斯数的 B-number与舍伍德数相关的默认相关性。这是 Sazhin [^43] 的 M1 模型。
- RANZ-MARSHALL FLUX-LIMITED LEWIS NO B-NUMBER 是前一个模型加上一个应用于 B-number的通量限制因子。这就是 Sazhin [27] 提出的 M2 模型。

### Thermal Properties

您需要为液滴提供的属性取决于 SPEC_ID 是否列在附录 A 中，以及 “Liquid ”一栏是否勾选了 “Y”，即液滴的液体属性已知。以下各小节将说明在不同情况下应如何操作。请注意，液滴的 INITIAL_TEMPERATURE (℃)（初始温度）是在 PART行中指定的。其默认值为 MISC 行中的模拟总体环境温度 TMPA。

**从液滴到气体的传热和蒸发使用相关的传热和传质系数。**这些系数可以分别使用 PART 行中的 HEAT_TRANSFER_COEFFICIENT_GAS 和 MASS_TRANSFER_COEFFICIENT 来指定。

**Known Liquid/Gas Species**

如果附录 A 中列出了 SPEC_ID，且 “Liquid ”一栏选中了 “Y”，则只需列出以下内容：

```fortran
&SPEC ID='WATER VAPOR' /
&PART ID='water droplets', SPEC_ID='WATER VAPOR', ... /
```

PART 行还可能列出其他可选参数，但这些参数是绝对必要的。此外，如果 SPEC_ID='WATER VAPOR'（水蒸气），液滴不仅会被赋予水的热物理性质，还会被设置为水的辐射吸收属性，并且在 Smokeview 中液滴会被染成蓝色。

**Unknown Liquid/Gas Species**

如果SPEC_ID没有在附录A的“Liquid”栏中以“Y”列出来，则必须在 SPEC 一栏中提供该液体的以下所有属性：

- DENSITY_LIQUID (kg/m3)
- SPECIFIC_HEAT_LIQUID (kJ/(kgK)) 如果液体比热是温度的函数，则使用 RAMP_CP_L 提供函数 $c_p(T)$。
- VAPORIZATION_TEMPERATURE 液体的沸腾温度, $T_{\mathrm{boil~}}(^{\circ}\mathbb{C})$
- MELTING_TEMPERATURE 液体的熔化（凝固）温度(℃)
- ENTHALPY_OF_FORMATION **气体的形成热**（kJ/mol）。
- HEAT_OF_VAPORIZATION 液体的汽化潜热$h_\mathrm{v}\mathrm{~(kJ/kg)}$
- H_V_REFERENCE_TEMPERATURE 与HEAT_OF_VAPORIZATION有关的温度（℃）
- VISCOSITY_LIQUID 液体的粘度(kg/(ms))
- CONDUCTIVTY_LIQUID 液体的导热系数(W/(mK))
- BETA_LIQUID 液体的热膨胀系数(1/K)

请注意，FDS 将调整液体焓，使以下关系成立：
$$
h_\mathrm{gas}(T_\mathrm{boil})=h_\mathrm{liquid}(T_\mathrm{boil})+h_\mathrm{v}
$$
**Custom Liquid/Gas Species**

请注意，液滴蒸发模型中只能使用一种气体，因为该模型不考虑蒸发的蒸馏曲线。不过，可以为 SPEC 指定自定义属性。除上述液体属性外，请参阅第 12.1.3 节 “用户自定义气体属性”。

**Fuel Liquid/Gas Species**

<font color=red>**<u>如果液滴燃烧，PART 行上的 SPEC_ID 应指定 REAC 行上的 FUEL</u>**</font>。根据燃烧模型的不同，您可能不需要创建单独的 SPEC 行。燃料液滴在 Smokeview 中默认为黄色，所产生的燃料蒸汽将根据 REAC 行上指定的燃烧模型进行燃烧。燃料液滴会蒸发成等量的燃料蒸汽，这样产生的热释放率（假设完全燃烧）等于蒸发率乘以 HEAT_OF_COMBUSTION。**HEAT_OF_COMBUSTION 可以在 PART 行或 REAC 行指定，也可以由 FDS 自动计算**。如果在 PART行中指定了 HEAT_OF_COMBUSTION，燃烧速率将根据该特定液滴的燃烧热与模型中其他燃料的燃烧热之间的差异进行调整。如果让 FDS 自动计算燃烧热，请运行模型几个时间步，并查找 CHID.out 文件中列出的 “Heat of Combustion”。使用该值指定喷嘴的流量，以达到所需的热释放率。

如果使用喷嘴产生燃料液滴，其特性的指定方式与喷洒器相同。如果附录 A 中列出了燃料种类，且标有 “RadCal Surrogate”的一栏不是空白，则将为液滴分配与所列种类相对应的燃料辐射吸收特性。

需要注意的是，为了限制喷淋模拟的计算成本，液滴在撞击到计算域的 “底面 ”时就会消失，无论其是否为固体。但是，在使用液体燃料时，可能不希望出现这种情况。**要阻止 FDS 从计算域的 “底面 ”移除液滴，可在 MISC 行添加 POROUS_FLOOR=F 短语**。<u>另一种解决方案是确保燃料着陆的 OBST 至少有一格厚</u>。

在示例文件（Fires/spray_burner.fds）中，庚烷从两个喷嘴向下喷入一个铁锅中。流量线性增加，使火势在 20 秒内增至 2 兆瓦，稳定燃烧 20 秒，然后在 20 秒内线性下降：

```fortran
&REAC FUEL='N-HEPTANE',SOOT_YIELD=0.01 /
&DEVC ID='nozzle_1', XYZ=4.0,-.3,0.5, PROP_ID='nozzle', QUANTITY='TIME', SETPOINT=0. /
&DEVC ID='nozzle_2', XYZ=4.0,0.3,0.5, PROP_ID='nozzle', QUANTITY='TIME', SETPOINT=0. /
&PART ID='heptane droplets', SPEC_ID='N-HEPTANE',
QUANTITIES(1:2)='PARTICLE DIAMETER','PARTICLE TEMPERATURE',
DIAMETER=1000., SAMPLING_FACTOR=1 /
&PROP ID='nozzle', PART_ID='heptane droplets', HEAT_OF_COMBUSTION=44500.,
FLOW_RATE=1.97, FLOW_RAMP='fuel', PARTICLE_VELOCITY=10.,
SPRAY_ANGLE=0.,30., SMOKEVIEW_ID='nozzle' /
&RAMP ID='fuel', T= 0.0, F=0.0 /
&RAMP ID='fuel', T=20.0, F=1.0 /
&RAMP ID='fuel', T=40.0, F=1.0 /
&RAMP ID='fuel', T=60.0, F=0.0 /
```

其中许多参数不言自明。请注意，2 兆瓦的火力是通过 2 个喷嘴以 1.96 升/分钟的速度喷射庚烷实现的：
$$
2\times1.97\mathrm{~\frac{L}{min}}\times\frac{1}{60}\mathrm{~\frac{min}{s}}\times684\mathrm{~\frac{kg}{m^{3}}}\times\frac{1}{1000}\mathrm{~\frac{m^{3}}{L}}\times44500\mathrm{~\frac{kJ}{kg}}=2000\mathrm{~kW}
$$
HEAT_OF_COMBUSTION 参数优先于整个反应方案的 HEAT_OF_COMBUSTION 参数。因此，如果其他液滴或固体物体具有不同的燃烧热，有效燃烧速率会进行调整，使总放热速率符合预期。不过，应该进行这样的练习，以确保情况确实如此。本例的 HRR 曲线见图 15.1。

还需注意的是，这一特征与网格有关。如果网格单元太粗，蒸发的燃料可能会被稀释到无法燃烧的程度。适当的分辨率取决于燃料类型和从喷嘴喷出的燃料量。请始终按照整体模拟的分辨率测试燃烧器。

### Radiative Properties

水滴和燃料滴的辐射特性是自动确定的。对于燃料，假定其具有庚烷的特性。对于其他类型的粒子，可以通过使用关键字 REAL_REFRACTIVE_INDEX 和 COMPLEX_REFRACTIVE_INDEX 在相应的 PART 行上指定材料折射率的分量来给出辐射特性。另外，也可以使用光谱属性表（TABL）指定这两个量的波长相关值，该表的 ID 在 PART 行中通过 RADIATIVE_PROPERTY_TABLE 标出。光谱属性表的每一行都包含三个实数：波长（μm）、折射率的实部和复部。折射率的实部应为正数。如果大于 10，则粒子被视为完全反射球。复数部分应为非负数。小于 $10^{-6}$ 的数值被视为非吸收值。下面是一个使用光谱特性表的示例，列出了波长为 1、5 和 10 μm 时的特性。

![image-20241018094825741](/../FUG6.9.1翻译.assets/image-20241018094825741.png)

```fortran
&PART ID='my particles',..., RADIATIVE_PROPERTY_TABLE='radtab' /
&TABL ID='radtab', TABLE_DATA= 1.0,1.33,0.0001 /
&TABL ID='radtab', TABLE_DATA= 5.0,1.33,0.002 /
&TABL ID='radtab', TABLE_DATA=10.0,1.33,0.001 /
```

在计算粒子对热辐射的吸收时，FDS 使用粒子温度和密度的运行平均值。RUNNING_AVERAGE_FACTOR 设置在 PART 行，默认值为 0.5（液滴）和 0（固体颗粒）。0 表示不使用运行平均值。同样，参数 RUNNING_AVERAGE_FACTOR_WALL 也设置在 PART 行，用于控制固体表面液滴或颗粒质量的运行平均值。其默认值与 RUNNING_AVERAGE_FACTOR 相同。

### Size Distribution

**液滴的大小分布**用累积体积分数（CVF）1[^15-1]指定，由PART行中的字符串 DISTRIBUTION 表示。默认值为 “ROSIN-RAMMLER-LOGNORMAL”：
$$
\left.F(D)=\left\{\begin{array}{cc}\frac{1}{\sqrt{2\pi}}\int_0^D\frac{1}{\sigma D^{\prime}}\exp\left(-\frac{[\ln(D^{\prime}/D_{\mathrm{v},0.5})]^2}{2\sigma^2}\right)&\mathrm{d}D^{\prime}&(D\leq D_{\mathrm{v},0.5})\\\\1-\exp\left(-0.693\left(\frac{D}{D_{\mathrm{v},0.5}}\right)^\gamma\right)&(D>D_{\mathrm{v},0.5})\end{array}\right.\right.
$$
或者，您也可以单独指定 “LOGNORMAL ”或 “ROSIN-RAMMLER”，而不是两者的组合。图 15.2 显示了可能的尺寸分布。请注意，“LOGNORMAL ”分布和 “ROSIN-RAMMLER ”分布在尾部具有不理想的属性，这就是通常使用两者组合的原因。图 15.2 还显示了规定分布与实际实现的液滴大小分布之间的比较。虚线表示测量的液滴大小分布，实线表示规定的采样分布。采样分布是用 HISTOGRAM 函数测量的。使用的液滴样本量为 10000 个。

中值体积直径 $D_{\mathrm{v},0.5}$ 通过 PART行上的参数 DIAMETER（μm）指定。在液滴蒸发的情况下，必须指定 DIAMETER（在这种情况下，还需要指定 SPEC_ID，以指示蒸发液滴产生的气体种类）。对数正态分布的宽度 σ 用 PART 行的 SIGMA_D 指定。Rosin-Rammler分布的宽度$\gamma$ 用 GAMMA_D（默认值 2.4）指定。请注意，在组合分布中，参数 σ 计算为$\sigma=2/(\sqrt{2\pi}\left(\ln2\right) \gamma)=1.15/\gamma $, 可确保两个函数在 $D=D_{\mathrm{v},0.5}$ 处平滑连接。如果想取消这一功能，也可以在 PART 行添加 SIGMA_D 的值。**$\gamma$值越大，液滴大小在中值附近的分布就越窄**。

![image-20241018095955640](/../FUG6.9.1翻译.assets/image-20241018095955640.png)

您可以指定自己的累积分数 (CNF)[^15-2]，方法是在 PART 行指定 CNF_RAMP_ID，并在 RAMP 中给出 CNF：

```fortran
&PART ID='my droplets',..., CNF_RAMP_ID='my CNF' /
&RAMP ID='my CNF', T= 0.1, F=0.000000 /
&RAMP ID='my CNF', T= 200., F=0.000003 /
...
&RAMP ID='my CNF', T=2000., F=1.000000 /
```

请注意，RAMP 变量 T 表示直径，单位为微米。图 15.2 中的第四幅图是指定 CNF 并据此计算 CVF 的示例。它与第一幅图中指定 CVF 并计算 CNF 的情况基本相反。

在模拟中产生液滴时，会根据给定的分布随机选择其直径。为避免颗粒重量过小，内置分布在 CNF_CUTOFF 和 (1 - CNF_CUTOFF) 的累积分数处截断。注意 CNF_CUTOFF 是在 MISC 行设置的。CNF_CUTOFF 的默认值为 0.005。您可以通过指定 MAXIMUM_DIAMETER（默认值为极大值）来防止选择过大的液滴。尺寸分布的下限通过 MINIMUM_DIAMETER 设置，其默认值为 DIAMETER 值的 0.005 倍。如果给定了 CNF_RAMP_ID，则 MINIMUM_DIAMETER 的默认值将设置为 CNF_CUTOFF 对应的斜面直径。请注意，如果 MINIMUM_DIAMETER 的加权液滴质量接近单元格中气体质量的数值精度，则 MINIMUM_DIAMETER 值过小可能会导致数值问题。如果 MINIMUM_DIAMETER 的值非常小（<0.01 μm），系统将发出警告。当液滴直径减小到 KILL_DIAMETER 以下时，就会被移除。对于单色分布，KILL_DIAMETER 设置为液滴初始直径质量的 0.5%。否则，当液滴质量为 MINIMUM_DIAMETER 质量的 0.5%时，液滴将被去除。液滴直径范围被划分为一系列分区[^15-3]。

**为防止 FDS 生成液滴分布，请在部件行将 MONODISPERSE 设为 T，这样每个液滴的直径都会相同**。

如果在 PART 行设置 CHECK_DISTRIBUTION=T，FDS 将在名为 CHID_PART_ID_cdf.csv 的文件中写出该特定粒子类别的累积分布函数。如果这样做，可能需要避免在 PART 行的 ID 中出现空格。

### Dense Clouds of Droplets

如果局部液滴密度相对较高，例如在洒水器或软管喷嘴处，单个液滴上的阻力会因激流效应而减小。FDS 包含一个子模型，用于计算由于唤醒效应导致的阻力减小。如果局部液体体积分数大于一个称为 DENSE_VOLUME_FRACTION 的临界值，就会在PART行调用该模型。将该参数设置为一个相对较大的数字（1 即可），就可以关闭减少湍流模型。默认值为 $1×10^{-5}$。

### Primary Breakup

使用 DENSE_VOLUME_FRACTION 减少尾流可能无法为消防水龙带流提供足够的阻力减少。为适应这种情况，FDS 引入了一种 “初级分离 ”方法。如果在 PART行中设置了 PRIMARY_BREAKUP_LENGTH，那么在粒子飞行到该距离之前，其阻力系数将乘以 PRIMARY_BREAKUP_DRAG_REDUCTION_FACTOR（也在PART行中设置），通常是一个很小的值，甚至为零。这样，粒子流在不稳定之前就像软管流一样。这些参数都是经验值，应根据具体的软管喷嘴调整模型，例如参见 [^44]。

```fortran
&PART ID='hose stream',..., PRIMARY_BREAKUP_LENGTH=10,
PRIMARY_BREAKUP_DRAG_REDUCTION_FACTOR=0 /
```

### Secondary Breakup

如果在PART行设置了 BREAKUP=T，粒子可能会发生二次分裂。在这种情况下，您还应指定液体的SURFACE_TENSION（N/m）以及由此产生的体积直径中值比率 $D_{\mathrm{v},0.5}$，即 BREAKUP_RATIO。默认值为 3/7。可选择指定分布参数 BREAKUP_GAMMA_D 和 BREAKUP_SIGMA_D。这些参数的定义与第 15.3.3 节中的 GAMMA_D 和 SIGMA_D 相同。

### Warning Messages Related to Droplets

对于任何涉及液滴的模拟，PROP 行中的 PARTICLES_PER_SECOND 都是一个重要参数，该参数由包含喷洒器或喷嘴坐标的 DEVC 行指定。**默认值为每秒 5000 个粒子**。在某些情况下，该值可能过低，您可能需要提高。原因是 FDS 明确跟踪的每个液滴都代表许多实际液滴，而这一个 “超级液滴 ”对模拟的影响可能相对较大。例如，网格单元内的单个液滴可能会在一个时间步长内迅速降低气体温度--如果单元内有更多液滴，就不会出现这种情况。您甚至可能在名为 case_name.err 的输出文件中看到类似的警告信息：

```fortran
WARNING Delta TMP_G. Mesh: 5 Particle: 3245
```

这意味着在对Mesh 5 中的某个网格单元进行温度更新时，索引为 3245 的液滴导致单元气体温度（TMP_G）变化过快。如果只看到几条这样的信息，考虑到液滴数量和时间步长，问题不大。但是，如果您持续看到这些信息，您可能需要增加 PARTICLES_PER_SECOND（每秒粒子数），以降低单个液滴在单个时间步长内发生如此剧烈变化的可能性。

## Solid Particles

拉格朗日粒子可以表示从办公室杂波到植被等各种子网格尺度的对象。要创建固态非液体粒子，必须在 PART 行添加 SURF_ID。指定的 SURF 行包含描述粒子热物理特性和几何参数的参数。这些属性与应用于 OBST 或 VENT 的属性相同。FDS 对粒子使用的固相传导和热解算法与对实体墙使用的相同。

如果与粒子类别相关的 SURF 线需要，粒子会因周围气体的对流和远近来源的辐射而升温。对流换热系数考虑了粒子的几何形状，而辐射热流量则基于综合强度。也就是说，辐射热通量是所有角度的平均值。

### Basic Geometry and Boundary Conditions

为了演示固体粒子的基本语法，以下输入行创建了一个热球集合：

```fortran
&PART ID='spheres', SURF_ID='HOT', STATIC=T, PROP_ID='ball' /
&SURF ID='HOT', TMP_FRONT=500., RADIUS=0.005, GEOMETRY='SPHERICAL' /
&PROP ID='ball', SMOKEVIEW_ID='SPHERE', SMOKEVIEW_PARAMETERS(1)='D=0.01' /
&INIT PART_ID='spheres', XB=0.25,0.75,0.25,0.75,0.25,0.75, N_PARTICLES=10 /
```

PART 行确定了粒子的类别。在这种情况下，SURF_ID 的存在表示粒子是固体，具有 SURF 行 “HOT ”给出的属性。STATIC 是一个逻辑参数，默认值为 F，表示粒子是否静止。PROP_ID 引用了一个 PROP（属性）行，它只是告诉 Smokeview 将粒子绘制成直径为 0.01 米的球体。INIT 行将在给定的体积中随机填充 10 个这样的热球。详见第 15.5.3 节。

如果 SURF 线包含一个 MATL_ID，粒子质量将基于所引用 MATL 线的DENSITY。如果不进行深度热传导计算，请不要指定 MATL_ID。相反，您可以指定表面温度 TMP_FRONT (℃)、单位面积热释放率 HRRPUA (kW/m2) 或粒子质量 MASS_FLUX (kg/(m2 s))。

固体颗粒的几何（GEOMETRY）选项有 “球面”（SPHERICAL）、“线面”（CYLINDRICAL）或 “方形”（CARTESIAN）。默认情况下，几何参数为 “CARTESIAN”，在这种情况下，您需要提供矩形板的长度和宽度。假定矩形板前后对称（注意，这意味着您应在 SURF 行设置 “BACKING=‘INSULATED’（背衬）”）。您只需指定构成半厚度的层数。数组 THICKNESS(N) 表示钢板各层的厚度，而不是钢板本身的总厚度。如果板仅由一种材料组成，则指定的厚度为板的半厚度。

对于 “CYLINDRICAL”或 “SPHERICAL ”粒子，请指定各层的INNER_RADIUS和THICKNESS。或者，如果圆柱体或球体是实心的，只有一个材料成分，也可以只指定 RADIUS。INNER_RADIUS 的默认值为 0 m，这意味着圆柱体或球体的半径是THICKNESS的总和。请记住，层数应从表面开始列出，而不是从中心开始。对于 “CYLINDRICAL（圆柱形）”粒子，还需指定一个长度（LENGTH）。

**Thermally Thick Droplet Model**

请注意，如果将GEOMETRY设置为 “SPHERICAL（球形）”并指定沸腾温度（BOILING_TEMPERATURE），从而调用液体热解模型，那么传质关系将遵循蒸发液滴的传质关系。该模型与默认液滴模型的区别在于，在这种情况下，内部液滴温度将使用一维传导求解器求解。通常情况下，需要降低 CELL_SIZE_FACTOR 以获得足够的液滴内部分辨率--您应该通过检查 CHID.out 文件仔细检查固相节点的数量。

### Drag

运动或静止粒子产生的阻力详见《FDS 技术参考指南》“拉格朗日粒子 ”一章[^29]。对于固体粒子，默认的阻力定律是孤球体的阻力定律。要调用不同的阻力定律，例如单独圆柱体的阻力定律，请在 “部分 ”行设置 DRAG_LAW = “CYLINDER”。表 15.1 概述了可用的阻力定律。如果上述选项均不适用，则可以通过在 PART 行中设置 DRAG_COEFFICIENT 来指定粒子类别（特定 PART_ID）的阻力系数常量。DRAG_COEFFICIENT 优先于 DRAG_LAW。

<center>Table 15.1: Drag laws available in FDS</center>

| DRAG_LAW           | Reference            |
| ------------------ | -------------------- |
| ’SPHERE’ (default) | FDS Tech Guide [^29] |
| ’CYLINDER’         | FDS Tech Guide [^29] |
| ’DISK’             | FDS Tech Guide [^29] |
| ’POROUS MEDIA’     | Sec. 15.4.8          |
| ’SCREEN’           | Sec. 15.4.9          |

如果要对植被等相对密集的固体颗粒集合进行建模，则应明确设置 DRAG_COEFFICIENT，而不是依赖于球体和圆柱体的相关性，因为球体和圆柱体是为相对独立的物体而不是集群而开发的。

### Radiation Absorption and Emission

固体颗粒会吸收和释放热辐射。粒子对每个网格单元 i jk 的辐射吸收系数的贡献由以下公式给出：
$$
\kappa_{\mathrm{p},ijk}=\frac{\sum\varepsilon_{\mathrm{p}}A_{\mathrm{p}}}{4V_{ijk}}
$$
其中，求和是在每个网格单元的体积 Vi jk 上进行的。每个颗粒的发射率为 εp，Ap 为颗粒表面积。

### Size Distribution

默认情况下，给定类别的固体颗粒都是单分散的；**也就是说，具有相同的初始尺寸**，该尺寸通过 PART行上指定的 SURF 行来指定。不过，也可以指定实体圆柱体和球体直径的分布。假设有一组直径均匀分布在 4000 μm 和 6000 μm 之间的圆柱形木棒：

```fortran
&SURF ID='rod', MATL_ID='...', THICKNESS=0.0030, LENGTH=0.02, GEOMETRY='CYLINDRICAL' /
&PART ID='rods', SURF_ID='rod', ..., MONODISPERSE=F, CNF_RAMP_ID='dist', N_STRATA=1 /
&RAMP ID='dist', T=4000., F=0. /
&RAMP ID='dist', T=6000., F=1. /
```

杆的材料属性通过 MATL 线（未显示）指定。**棒材的标称半径由 SURF 行的参数 THICKNESS（米）给出，但棒材直径的分布由 PART 行的参数 CNF_RAMP_ID（累计数分数）指定**。RAMP 线表示杆直径的累积分布函数，其中成对的 (T,F) 表示在 4000 μm 和 6000 μm 之间的均匀分布。注意，**分布的单位是 μm，而不是 m**。参数 N_STRATA 表示细分直径范围的箱数，这里设为 1，因为与典型的液滴粒度分布相比，该范围相对较小。请注意，**用于表面传热的粒子阵列是根据 SURF 的厚度分配的。**为避免潜在的阵列尺寸问题，建议将表面厚度定义为 RAMP 的最大值。

下面是一个如何应用**固体颗粒分布的示例**。在名为 WUI/hot_rods.fds 的示例中，L = 0.02 米长的木棒被倒在高温（800 ℃）地板上燃烧，木棒的半径均匀分布在 r = 0.002 米和 r = 0.003 米之间（f (r) = 1000，0.002 < r < 0.003；其他地方f (r) = 0 ）。材料的原始密度为 ρp = 440 kg/m3。在 10 秒钟的时间内，共有 4000 根棒材从一个小喷口喷出。
$$
m=4000\times\pi\overline{r^2}L\rho_{\mathfrak{p}}\approx0.7 \mathrm{kg}\quad;\quad\overline{r^2}=\int_{0.002}^{0.003}r^2f(r) \mathrm{d}r\approx6.333\times10^{-6}
$$
图 15.3 显示了棒的半径和质量随时间变化的分布情况。请注意，8% 的质量仍然是焦炭。

![image-20241127223359269](./../FUG6.9.1翻译.assets/image-20241127223359269.png)

### Solid Particle Movement on Solid Surfaces

默认情况下，固体颗粒不会像液滴那样 “粘 ”在或附着在固体表面上。不过，**您可以通过在 PART 行中设置 ADHERE_TO_SOLID=1，让固体粒子像液滴一样运动**，在这种情况下，粒子会被粘住，并被重新分配新的速度和方向。如果表面是水平的，则方向是随机选择的。**如果是垂直面，则方向是向下的。**通过PART行上的参数 HORIZONTAL_VELOCITY 和 VERTICAL_VELOCITY，可以控制粒子水平或垂直（向下）移动的速度。默认值分别为 0.2 米/秒和 0.5 米/秒。如果您希望粒子真正粘在表面而不移动，请将这两个值设为 0。

### Splitting Particles

如果在 PART 线上指定了ORIENTATION矢量，那么粒子的辐射通量就会像传统的热通量计一样，按照矢量方向的法线平板来计算。也就是说，热通量不是整个粒子的综合平均值，而是给定方向的定向热通量。一般规则之所以有这种例外情况，是因为单个颗粒通常被用作 “目标”，以记录域中给定方向上给定点的热通量。**可以将这些颗粒视为不会干扰流动的微小热通量计**。

### Gas Generating Particles

拉格朗日粒子可用于以指定速率生成气体。其语法与实体墙的语法类似。例如，以下输入行创建了三个粒子--一个形似矩形板，一个形似圆柱，一个形似球体--分别生成氩气、二氧化硫和氦气。这些粒子没有质量；它们只是用来以指定的速率生成气体。

```fortran
&SPEC ID='ARGON' /
&SPEC ID='SULFUR DIOXIDE' /
&SPEC ID='HELIUM' /
&INIT PART_ID='plate', XYZ=-1.,0.,1.5, N_PARTICLES=1 /
&INIT PART_ID='tube', XYZ= 0.,0.,1.5, N_PARTICLES=1 /
&INIT PART_ID='ball', XYZ= 1.,0.,1.5, N_PARTICLES=1 /
&PART ID='plate', SAMPLING_FACTOR=1, SURF_ID='plate bc', STATIC=T /
&PART ID='tube', SAMPLING_FACTOR=1, SURF_ID='tube bc', STATIC=T /
&PART ID='ball', SAMPLING_FACTOR=1, SURF_ID='ball bc', STATIC=T /
&SURF ID='plate bc', THICKNESS=0.001, LENGTH=0.05, WIDTH=0.05, SPEC_ID(1)='ARGON',
MASS_FLUX(1)=0.1, TAU_MF(1)=0.001 /
&SURF ID='tube bc', GEOMETRY='CYLINDRICAL', LENGTH=0.05, RADIUS=0.01,
SPEC_ID(1)='SULFUR DIOXIDE', MASS_FLUX(1)=0.1, TAU_MF(1)=0.001 /
&SURF ID='ball bc', GEOMETRY='SPHERICAL', RADIUS=0.01, SPEC_ID(1)='HELIUM',
MASS_FLUX(1)=0.1, TAU_MF(1)=0.001 /
```

在这种情况下，不需要计算热传导的深度。**重要的只是表面积**。对于板来说，表面积是长度乘以宽度的两倍。对于圆柱体，面积是半径的两倍乘以长度乘以 π。对于球体，面积是半径的 4π 乘以半径平方。图 15.4 显示了名为 surf_mass_part_specified.fds 的测试用例的输出结果，表明气体的产生率符合预期。

![image-20241127224146920](./../FUG6.9.1翻译.assets/image-20241127224146920.png)

### Porous Media

可以使用颗粒的三维阵列来表示多孔介质产生的阻力，如下面多孔铝基体的例子：

```fortran
&SURF ID='LIGAMENT', MATL_ID='ALUMINUM ALLOY', THICKNESS=7.3E-5,
GEOMETRY='CYLINDRICAL', HEAT_TRANSFER_COEFFICIENT=10. /
&MATL ID='ALUMINUM ALLOY', DENSITY=2690., CONDUCTIVITY=218., SPECIFIC_HEAT=0.9 /
&PART ID='FOAM', DRAG_LAW='POROUS MEDIA', SURF_ID='LIGAMENT',
POROUS_VOLUME_FRACTION=0.12, STATIC=T,
DRAG_COEFFICIENT=0.1,0.1,0.1, PERMEABILITY=1.0E-7,1.E-7,1.E-7 /
&INIT XB=1.010,1.095,0.0,0.5,0.0,0.5, N_PARTICLES_PER_CELL=1, CELL_CENTERED=T,
PART_ID='FOAM' /
```

泡沫韧带的基本几何形状由 SURF 线定义。假定韧带由铝合金制成，其属性见 MATL 线。假设圆柱形韧带的半径用THICKNESS示。请注意，SURF 行通常要求的圆柱体LENGTH是自动计算的，以便达到 PART 行中 POROUS_VOLUME_FRACTION 指定的泡沫所占网格单元的体积分数。从某种意义上说，泡沫的模型是一个被切成小块的长圆柱体，每个网格单元中只有一个颗粒。SURF输入 POROUS_VOLUME_FRACTION 和THICKNESS并不直接影响阻力计算。**它们用于定义表面积，以计算气体和多孔介质之间的传热**。

PART 行提供颗粒的相关信息，包括颗粒对气流产生的阻力。POROUS MEDIA 的 DRAG_LAW 表示多孔介质的特殊阻力模型。该模型表明，通过介质的压降由以下公式给出
$$
\Delta p=\delta ({\mu \over K}u+\rho{Y\over \sqrt K}u^2)
$$
其中，δ 是泡沫块在流动方向上的厚度（流动方向上的单元尺寸或 INIT 输入中流动方向上的 XB 尺寸中的较小者），μ 是气体的粘度，u 是流动方向上的速度分量，ρ 是气体的密度，K 是以 m2 为单位的PERMEABILITY，Y 是无量纲惯性项，由您使用参数DRAG_COEFFICIENT 指定。**使用多孔介质模型时，必须为所有三个方向指定 PERMEABILITY 和 DRAG_COEFFICIENT**。

INIT 线表示多孔介质使用六元 XB 所占的体积。通过指定参数 N_PARTICLES_PER_CELL=1 和 CELL_CENTERED=T，在泡沫占据的每个单元的中心插入一个粒子。

Sprinklers_and_Sprays 文件夹中包含一个涉及多孔介质的计算示例。输入文件名为 porous_media.fds。

### Screens

可以使用二维粒子阵列来表示窗纱施加的阻力，如下例所示：

```fortran
&INIT N_PARTICLES_PER_CELL=1, CELL_CENTERED=T, PART_ID='SCREEN',
XB=1.01,1.02,0.0,1.0,0.0,1.0/
&PART ID='SCREEN', DRAG_LAW='SCREEN', FREE_AREA_FRACTION=0.4, STATIC=T,
SURF_ID='SCREEN', ORIENTATION=1,0,0 /
&SURF ID='SCREEN', THICKNESS=0.00015, GEOMETRY='CYLINDRICAL',
MATL_ID='ALUMINUM' /
&MATL ID='ALUMINUM', DENSITY=2700., CONDUCTIVITY=200., SPECIFIC_HEAT=0.9 /
```

INIT 线使用六元组 XB 指定屏幕的平面。通过指定参数 N_PARTICLES_PER_CELL=1，在每个单元格中插入一个粒子。粒子可以通过包含屏幕材料属性的 SURF_ID 进行定义。通过 DRAG_LAW 参数可以指定屏幕的特殊拖曳定律。ORIENTATION（方向）是荧幕的法线方向，FREE_AREA_FRACTION（自由面积）是荧幕表面开放面积的比例。在示例中，自由面积为 40%、金属丝直径为 0.0003 米的铝筛被放置在 x 轴的法线上。请注意，SURF 线上的 LENGTH 参数将自动计算，因此滤网占据的网格单元流动面积等于 1- FREE_AREA_FRACTION。通过滤网的压降计算公式为
$$
\Delta p=l ({\mu \over K}u+\rho{Y\over \sqrt K}u^2)
$$
其中，l 是滤网厚度（等于金属丝直径），μ 是气体粘度，u 是滤网法线速度，ρ 是气体密度，Y 和 K 是经验常数，由 [^45] 给出。
$$
\begin{array}{rcl}K&=&3.44\times10^{-9}\text{FREE AREA FRACTION}^{1.6}\text{ m}^{2}\\Y&=&0.043\text{ FREE AREA FRACTION}^{2.13}\end{array}
$$
这种相关性是通过FREE_AREA_FRACTION为 0.3 至 0.6 的筛选得出的。

MISC 输入参数 PARTICLE_CFL_MAX 可控制滤网（或其他多孔介质）压降的时间步长。**如果滤网或其他多孔介质会带来数值不稳定性，将 PARTICLE_CFL_MAX 的值减小到 1 以下可以解决这些问题**。

### Electrical Cables

瑞典国家测试和研究所 (SP) 的 Petra Andersson 和 Patrick Van Hees 提出，在将电缆视为均质圆柱体的假设下，可以通过简单的一维传热计算预测电缆的热诱发电气故障 (THIEF)[^46]。他们对聚氯乙烯电缆的分析结果令人鼓舞，表明分析的简化是合理的，应推广到其他类型的电缆。THIEF 模型的基本假设如下：

1. 热量主要沿径向渗入圆形截面的电缆。这大大简化了分析，同时也比较保守，因为假定电缆完全被热源包围。
2. 电缆的成分是均匀的。实际上，电缆是由多种不同类型的聚合物材料、纤维素填料和导电金属（通常为铜）构成的。
3. 假定均质电缆的热特性--导热性、比热和密度--与温度无关。实际上，聚合物的热导率和比热都与温度有关，但这一信息很难从制造商处获得。
4. 假定电缆在加热过程中不会发生分解反应，模型中不考虑点火和燃烧。事实上，热塑性电缆会熔化，热固性电缆会形成炭化层，两者都会释放挥发性气体，直至并超过电气故障点。
5. 当电缆护套内的温度达到实验确定的值时，就会发生电气故障。

显然，Andersson 和 Van Hees 的 THIEF 模型有很多固有假设，但他们对各种聚氯乙烯 (PVC) 电缆的分析结果表明，**该模型足以对更多种类的电缆进行工程分析**。美国核管理委员会赞助了一项名为 CAROLFIRE 的电缆故障研究[^47]。CAROLFIRE 项目的主要目标是确定电力、控制和仪器电缆束内各种电气故障模式（如热短路、接地短路）的特征。该项目的次要目标是开发一个简单的模型，用于预测电缆特定内部区域达到根据经验确定的阈值温度时由热引起的电气故障。CAROLFIRE 测试报告第二卷介绍了用于上述目的的测量结果。第三卷介绍了建模情况。

在暴露温度或热通量随时间变化的情况下，THIEF 模型只能预测电缆内部随时间变化的温度曲线。**该模型无法预测电缆在什么温度下会发生电气故障**。这一信息需要从实验中收集。CAROLFIRE 实验计划包括台架规模的单根电缆实验，在这些实验中，对受到均匀热通量作用的电缆表面和内部各点进行了温度测量。这些实验提供了电缆内部温度与电气故障之间的联系。该模型只能预测内部温度，并在达到给定温度时推断出电气故障。据推测，**电缆最中心点的温度并不一定是电气故障的指标**。这种分析方法使用的是电缆护套内的温度，而不是最中心的温度，因为这是多导体电缆最有可能首先发生电气短路的地方。

要在 FDS 中使用 THIEF 模型，请在输入文件中添加类似下面的行：

```fortran
&MATL ID='plastic', DENSITY=2535., CONDUCTIVITY=0.2, SPECIFIC_HEAT=1.5 /
&SURF ID='cylinder', THICKNESS=0.00815, LENGTH=0.1, MATL_ID='plastic',
GEOMETRY='CYLINDRICAL' /
&PART ID='Cable Segment', SURF_ID='cylinder', ORIENTATION=0,0,1,
STATIC=T /
&INIT ID='Cable', XB=0.01,0.01,0.,0.,0.,0., N_PARTICLES=1, PART_ID='Cable Segment' /
&DEVC ID='Cable Temp', INIT_ID='Cable',
QUANTITY='INSIDE WALL TEMPERATURE', DEPTH=0.0015 /
```

THIEF 模型假定电缆塑料材料的导热系数为 0.2 W/（mK），比热为 1.5 kJ/（kgK）。**如果更改这些值，则不再使用 THIEF 模型**。密度是电缆单位长度的质量除以横截面积。THICKNESS是圆柱形电缆的半径，单位为米。FDS 需要 LENGTH（米），因为它假定电缆是一定长度的圆柱段。它对模拟没有影响，其值通常是一个网格单元的大小。方向（ORIENTATION）告诉 FDS 当前辐射源的方向。STATIC=T 可防止电缆移动。INIT 行用于在计算域内定位缆线。DEVC 行记录电缆内部温度，本例中为表面下 1.5 毫米。这通常是护套厚度。

**Target Particles**

若要将固体颗粒指定为传热目标，请在 PART 上指定 TARGET_ONLY。设置此标志并给出材料属性后，FDS 将使用当地气体温度和辐射条件计算粒子温度；但粒子不会与气体交换能量或动量。设置此标志后，CARTESIAN粒子的SURF将不再被视为半厚板。这样就可以在 SURF 上使用 TMP_GAS_BACK 和 EMISSIVITY_BACK 等背面边界条件。如果仍希望厚度（THICKNESS）代表从两侧加热的板厚度的一半，则在 SURF 行设置 BACKING='INSULTATED'。目标粒子被视为静态粒子（STATIC），但可以使用 INIT 上的 PATH_RAMP 和/或 ORIENTATION_RAMP 进行定位。

## Particle Insertion

**<font color=red>在模拟中引入液滴或粒子有三种方法</font>**：

1. 使用 PROP 行定义喷头或喷嘴，该行包含一个 PART_ID，用于指定颗粒或液滴参数。单个喷洒器或喷嘴通过 DEVC 行指定。
2. 将 PART_ID 添加到 SURF 行，在这种情况下，颗粒或液滴将以 VEL 的负值表示的向外法线速度从该表面喷出。
3. 创建一条 INIT 线，在计算域内定义一个体积，在该体积内初始化和/或定期引入粒子/液滴。

在模拟中包含数十万个粒子是很平常的事。由于内存限制，在 Smokeview 中可视化所有粒子有时并不现实。**要限制粒子数量，可以在 PART 行中使用以下参数**：

SAMPLING_FACTOR 输出文件 CHID.prt5 的采样系数。该参数可用于减小用于模拟动画的粒子输出文件的大小。对于 MASSLESS 粒子，默认值为 1，这意味着每个粒子或液滴都将显示在 Smokeview 中。所有其他类型粒子的默认值为 10。第 15.2 节将讨论 MASSLESS 粒子。

AGE 粒子或液滴存在的秒数，计算中将删除该粒子或液滴。在试图减少模拟中的液滴或粒子数量时，这是一个非常有用的参数。

在设置与粒子/液滴插入相关的参数时要小心，因为数百万个粒子/液滴很容易使模拟不堪重负。DUMP 行中的参数 MAXIMUM_PARTICLES 设置了任何给定网格在任何给定时间内可包含的最大粒子数。默认值为 1000000。如果超过此值，FDS 将自动删除粒子，从最老的粒子开始。

**默认情况下，FDS 最初会为每个网格分配 50 个粒子的空间。**如果需要更多粒子，数组将通过 NEW_PARTICLE_INCREMENT （一个在 PART 行设置的整数）进行扩展。默认值为 1000。在大多数情况下，这应该足够了。不过，对于粒子数量非常多的情况，例如野外火灾模拟，可能需要增加该值以节省重新分配的时间。这不会影响如何将粒子插入到域中（如上所述），只会影响在超出当前分配时预留多少新存储空间。一定要小心，因为有可能出现大量超额分配并预留大量未使用内存的情况。



### Particles Introduced at a Solid Surface

在固体表面引入粒子有三种方法。您可以**指定粒子质量通量**并定期注入粒子；您可以将粒子的产生限制在活跃燃烧的表面（作为产生余烬的一种手段）；您也可以指定粒子表面密度并在模拟开始时引入粒子。

**Particles specified using a mass flux**

如果粒子具有质量并从固体表面引入，**则在 SURF 行指定 PARTICLE_MASS_FLUX**。每 DT_INSERT 秒插入每个固体单元的粒子数由定义固体表面的 SURF 行上的 NPPC（**每单元粒子数**）指定。DT_INSERT 的默认值为 0.01 秒，NPPC 为 1：

```fortran
&PART ID='particles', ... /
&SURF ID='SLOT', PART_ID='particles', VEL=-5., PARTICLE_MASS_FLUX=0.1 /
&OBST XB=-0.2,0.2,-0.2,0.2,4.0,4.4, SURF_IDS='INERT','SLOT','INERT' /
```

创建一个障碍物，以 0.1 kg/(m2 s) 的速率和 5 m/s 的速度将颗粒从其侧面喷出（负号表示颗粒从表面喷出）。**如果为了与数值网格保持一致而改变了障碍物或通风口的尺寸，FDS 将调整质量通量**。ID 除了作为标识符外没有其他意义。默认情况下，**粒子的初始速度为表面法向速度**。这意味着指定粒子的表面必须具有指向计算域的非零法向速度。如果表面正在燃烧，该操作会自动进行。如果不是，则可以指定一个非零的负 VEL 值，或者如果您不希望同时注入气体，可以指定 VEL_PART。VEL_PART 的符号约定与 VEL 相同。**如果指定了 VEL_PART，它将覆盖表面的气体速度，并在 VEL_PART 处注入粒子**。有一个名为 particle_flux.fds 的简单输入文件可以演示上述输入行如何从一个区块中产生粒子流。如图 15.5 所示，10 秒后地面上的粒子累积质量预计为 0.64 千克。

![image-20241127164405516](./../FUG6.9.1翻译.assets/image-20241127164405516.png)

还请注意，您**可以独立控制从固体表面喷射出的粒子**。例如，一个设备可以控制风扇的启动，但您可以覆盖该设备并单独控制微粒。为此，请在定义粒子的 PART 行中通过 DEVC_ID 或 CTRL_ID 指定设备或控制器。有关设备和控制器的更多信息，请参阅第 18.4 和 18.5 节。

**Particles specified using an ember generation height**

如果指定了 EMBER_GENERATION_HEIGHT（米），则假定粒子代表余烬（或火带），并且只在活跃燃烧（燃料质量通量不为零）的表面生成。**高度参数决定了产生颗粒的燃烧面的垂直偏移距离**。这在垂直燃料结构可能无法确定的情况下非常重要，例如水平集火蔓延（第 17.5 节），但产生微粒的高度对升空潜能值也有影响。如果只为 EMBER_GENERATION_HEIGHT 提供了一个数字，则所有粒子都将在该偏移距离处生成。如果提供了两个数字，则会在指定的偏移范围内按照均匀分布随机生成粒子。例如，如果 EMBER_GENERATION_HEIGHT=0.0,1.0，**那么粒子将在燃烧表面上方 1.0 米以内的任何位置生成**。

然后就可以用前面介绍的方法来设定余烬产生的速度。可以使用 DT_INSERT 和 NPPC 设置数量通量，并根据指定的 PARTICLE_MASS_FLUX 对这些粒子进行加权。**在用这种方法模拟微粒生成时，建议设置 VEL_PART=0.0，这样微粒就会从静止状态开始，被周围的气流自然吹起**。

**Particles specified using a surface density**

您可以为模拟开始时引入的粒子指定 PARTICLE_SURFACE_DENSITY （千克/平方米），而不是质量通量。您可以为每个单元引入 NPPC 颗粒，但 1 个颗粒就足以代表指定的表面密度。该功能**对于创建亚网格尺度的干燥植被燃料非常有用**。

### Particles or Droplets Introduced at a Sprinkler or Nozzle

使用 PROP 线描述设备的特征，使用 DEVC 线确定设备在计算域中的位置和方向，从而将洒水器或喷嘴添加到仿真中。PARTICLES_PER_SECOND 是每个活动喷头或喷嘴每秒插入的水滴数量（默认为 5000）。它列在 PROP 行中，其中包括喷洒器或喷嘴的其他属性。请注意，该参数只影响喷头和喷嘴。更改该参数不会改变流速，但会改变用于表示流量的水滴数量。在某些模拟中，最好将 PARTICLES_PER_SECOND 增加到默认值以上，这样粒子/液滴质量在域内的分布会更均匀。如果该参数过小，可能会导致非物理蒸发模式，有时甚至会导致数值不稳定。如果在启动喷洒器或喷嘴后不久遇到数值不稳定性，可考虑增大 PARTICLES_PER_SECOND，以产生更平滑、更逼真的蒸发模式。请记住，对于真实的洒水器或喷嘴，每秒产生的水滴要比模拟的多得多。

PROP 行中指定的 PARTICLE_VELOCITY 表示液滴/粒子的初始速度。如果该值相对较大，FDS 将通过气相时间步长的子步长来计算液滴/粒子的轨迹，以确保液滴/粒子在一个子时间步长内穿越的网格单元不超过一个。MISC 行的参数 PARTICLE_CFL 对时间步长的限制更为严格，默认设置为 F（见第 19.3.3 节）。如果为 T，则气相时间步长受粒子 CFL 限制。通常情况下，没有必要限制气相时间步长以考虑快速液滴/粒子--亚时间步长通常就足够了。

### Particles or Droplets Introduced within a Volume

有时，在域的特定区域内引入拉格朗日粒子会很方便。为此，请使用 INIT 行，其中包含要插入的粒子类型的 PART_ID。通过 INIT 行指定的粒子可以代表多种不同类型的子网格尺度对象。粒子可以是无质量的示踪剂，也可以是有质量的固体或液体粒子。如果不是无质量粒子，则以 kg/m3 为单位指定 MASS_PER_VOLUME。请勿将该参数与下一节中解释的 “密度”（DENSITY）相混淆。例如，水的密度（DENSITY）为 1000 kg/m3，而一升水分解成水滴并扩散到一立方米的体积（MASS_PER_VOLUME）为 1 kg/m3。插入的拉格朗日粒子数量由参数 N_PARTICLES 控制。

**Randomly Distributed Particles within a Specified Volume**

INIT 行中的参数 N_PARTICLES 表示在域的指定区域内插入的粒子数量。根据参数 SHAPE =（'BLOCK'[^15-4]、'CYLINDER'、'CONE'、'LINE'、'RING'），该区域可以有多种形状。对于 “BLOCK”、“CONE ”和 “RING”，粒子位置默认为随机分布。对于 “RING”，可以通过在 INIT 行中设置 UNIFORM=T 来统一粒子的位置。默认情况下，区域是一个矩形的 “BLOCK”，用实数六元组 XB 指定。XB 的格式与 OBST 行的格式相同。

```fortran
&INIT PART_ID='my particles', XB=..., N_PARTICLES=..., MASS_PER_VOLUME=... /
```

请注意，指定区域的体积是根据 SHAPE 尺寸计算的，与该区域内是否有实体障碍物无关。还需要注意的是，在大多数应用中，粒子的数量 N_PARTICLES 在某种程度上是任意的，但应选择为每个网格单元至少提供几个粒子。然后，FDS 会自动为每个粒子分配一个加权系数，以确保达到 MASS_PER_VOLUME。另一方面，在某些应用中，指定粒子数量可能非常重要。例如，如果使用粒子来模拟电缆燃烧，则可能需要指定实际燃烧的电缆数量。MASS_PER_VOLUME 可以通过 INIT 行的斜坡函数 RAMP_PART 来上下调节。

如果六元组 XB 指定的体跨越网格边界，**请注意 N_PARTICLES 指的是整个体，而不仅仅是特定网格内的体**。FDS 会自动计算分配给每个网格所需的粒子数。

或者，您也可以指定 SHAPE=“CONE”，这样粒子就会随机分布在一个垂直的圆锥体内。这主要用于表现树木。圆锥体的尺寸通过参数 RADIUS、HEIGHT 和基准位置 XYZ 来指定。后者是一个实数三元组，指定了圆锥体底部中心点。下面举例说明如何制作一棵树：

```fortran
&PART ID='tree crown foliage',
DRAG_LAW='CYLINDER',
SURF_ID='needles',
QUANTITIES='PARTICLE TEMPERATURE','PARTICLE MASS','PARTICLE DIAMETER',
STATIC=T,
COLOR='FOREST GREEN' /
&INIT PART_ID='tree crown foliage',
XYZ=0.0,0.0,0.0,
RADIUS=1,
HEIGHT=2,
SHAPE='CONE',
N_PARTICLES_PER_CELL=1,
CELL_CENTERED=T,
MASS_PER_VOLUME=2.0 /
```

请注意，在本示例中，每个网格单元都指定了一个颗粒，位置正好位于单元的中心。单个颗粒实际代表的松针数量取决于指定的 MASS_PER_VOLUME 和单个圆柱形颗粒的质量。该信息将由 SURF 行 “needles ”提供。

此外，对于 “CONE ”和 “CYLINDER ”形状，还可以指定 INNER_RADIUS。这将删除一个具有指定内半径的同心体，留下一个圆锥形或圆柱形外壳。如果树冠的叶子集中在体积的外部，这将非常有用。需要注意的是，MASS_PER_VOLUME 只适用于外壳所占的体积，因此在指定固定 MASS_PER_VOLUME 的 INNER_RADIUS 时，树冠的总质量会减少。不同树冠几何形状的示例可在 fds/Verification/WUI/ 目录中的 tree_shapes.fds 验证案例中找到。

**Specifying a Fixed Number of Particles per Grid Cell**

在一些特殊应用中，您可能需要指定 N_PARTICLES_PER_CELL，以表示指定区域中每个网格单元内的粒子数量。使用 N_PARTICLES_PER_CELL 时，粒子将随机放置在每个单元格中。如果设置 CELL_CENTERED=T，粒子将被放置在每个单元格的中心。

**Specifying aWeight Factor for Particles**

使用 PARTICLE_WEIGHT_FACTOR 来指定每个计算粒子所代表的实际粒子数量。这可以与 N_PARTICLES_PER_CELL 结合使用，以在同一网格单元中放置大量相同粒子时降低计算成本。

**Single Particle Insertion**

如果只引入一个粒子（这通常是创建一个目标的简便方法），可以使用实数三元组 XYZ 而不是 XB 来指定粒子的位置。您可以使用实数三元组 UVW 为单个粒子赋予初始速度。您还可以添加 DX、DY 和/或 DZ 来创建一排粒子，这些粒子与 XYZ 的偏移量以米为单位递增。例如

```fortran
&INIT PART_ID='target', XYZ=1.2,3.4,5.6, N_PARTICLES=10, DX=0.1 /
```

从点（1.2,3.4,5.6）开始创建一条由 10 个粒子组成的直线，粒子间距为 0.1 米。详见第 22.10.12 节。
在特殊情况下，您可能希望在激活特定装置后，每隔 DT_INSERT s 在特定点以特定速度插入一个液滴，如下所示：

```fortran
&INIT N_PARTICLES=1, XYZ=..., UVW=..., DIAMETER=200., DT_INSERT=0.05,
PART_ID='drops', DEVC_ID='nozzle' /
```

请注意，INIT 行上的 DIAMETER (μm) 仅对液滴有效。它优先于标有 “drops ”的 PART 行上的 DIAMETER。名为 bucket_test_3 的简单测试用例演示了这一功能，其中水滴从一个共同点向不同方向发射。水滴的大小、速度、插入频率和质量通量各不相同，并检查水的质量是否保持不变（见图 15.6）。

![image-20241222093347251](./../FUG6.9.1翻译.assets/image-20241222093347251.png)

**Periodic Insertion of Particles within a Specified Volume**

如果您希望在给定区域内周期性地引入粒子，而不仅仅是在初始阶段，请将 INIT 行中的 DT_INSERT 设置为正值，表示插入的时间增量（秒）。参数 N_PARTICLES 现在表示每 DT_INSERT 秒插入的液滴/粒子的数量。如果液滴/微粒有质量，则使用 MASS_PER_TIME (kg/s) 而不是 MASS_PER_VOLUME 来表示每秒插入的质量。可以使用 INIT 行上的斜坡函数 RAMP_PART 来上下调整该参数。

如果希望延迟液滴的插入，可以在 INIT 行中使用 DEVC_ID 或 CTRL_ID 来命名控制设备。有关控制设备的更多信息，请参见第 18.4 节。

**Controlled Particle Movement**

粒子可以是静态、无质量的示踪剂（随波逐流），也可以是巨大的液滴或热厚的固体（受到阻力），还可以由 PATH_RAMP 控制其位置。当热源或质量源的位置随时间发生变化时，这种方法就会派上用场。或者，您可能希望 DEVC 测量位置随时间变化；DEVC 可以通过带有 PATH_RAMP 的 INIT 线与粒子相连，我们接下来将讨论这一点。

INIT 参数 PATH_RAMP(1:3)是一个由三个字符串组成的列表，表示与粒子的 x、y 和 z 位置相关的斜坡 ID。我们对粒子使用体积插入法，N_PARTICLES=1。示例可在 fds/Verification/Miscellaneous/ 目录中的验证案例 part_path_ramp_jog.fds 中找到。示例输出如图 15.7 所示。实现路径斜坡所需的基本要素如下：

```fortran
&RAMP ID='PART RAMP X', T=0, F=0/ start position at X=0 m at Time=0 s
&RAMP ID='PART RAMP X', T=10, F=5/ move linearly to X=5 m at Time=10 s
! define a particle class as a mass source
&PART ID='MASS SOURCE', SAMPLING_FACTOR=1, SURF_ID=..., PROP_ID=.../
! initialize the particle position and assign path ramp
&INIT ID='JOG', XB=..., PART_ID='MASS SOURCE',
PATH_RAMP(1)='PART RAMP X', N_PARTICLES=1 /
! monitor the position (or other quantities) using a device
&DEVC QUANTITY='PARTICLE X', INIT_ID='JOG', ID='X', TIME_AVERAGED=F /
```

![image-20241222093620034](./../FUG6.9.1翻译.assets/image-20241222093620034.png)

### Controlled Particle Orientation

可以通过在 INIT 行上指定 ORIENTATION_RAMP 来控制使用 INIT 行放置的粒子的方位角。ORIENTATION_RAMP 为粒子方位的三个组成部分分别指定了一个 RAMP。必须定义所有三个分量。在每个时间步，RAMP 的输出将归一化为矢量大小为 1。在下面的示例中，粒子方向通过绕 Z 轴旋转，在 10 秒内从 -x 变为 +x。

```fortran
&PART ID='MY PART',SURF_ID='PART SURF',STATIC=T, ORIENTATION=1,1,1/
&INIT ID='ONE PART',PART_ID='MY PART',XYZ=0.975,1,1,
ORIENTATION_RAMP(1:3)='O1','O2','O3',N_PARTICLES=1/
&RAMP ID='O1',T=0, F=-1/
&RAMP ID='O1',T=10,F= 1/
&RAMP ID='O2',T=0, F= 0/
&RAMP ID='O2',T=5, F= 1/
&RAMP ID='O2',T=10,F= 0/
&RAMP ID='O3',T=0, F= 0/
&RAMP ID='O3',T=10,F= 0/
```

请注意，“PART ”输入必须包含 “方向”（ORIENTATION），因为这将向 FDS 发出信号，为该类粒子的角度辐射通量分配阵列空间。测试用例中使用了该输入块，测试用例包括一个 1 立方米的盒子，盒子的 +x 壁辐射通量为 10 kW/m2，其余各壁辐射通量为 1 kW/m2。结果如图 15.8 所示。

![image-20241222093828303](./../FUG6.9.1翻译.assets/image-20241222093828303.png)

## Particle Removal

可以通过多种方式从模拟中移除拉格朗日粒子：

1. 在 “PART ”行中指定 AGE（年龄），以便在插入后的这段时间后清除微粒。
2. 当液滴碰到计算域的 “floor ”时，无论其是否为固体，液滴都会消失。这一特性模拟了地面排水沟的存在。**要阻止 FDS 从计算域的 “floor ”上清除液滴，可在 “MISC ”行添加 POROUS_FLOOR=F。**但要注意的是，落在地板上的液滴会继续沿随机选择的方向水平移动，弹开障碍物，消耗 CPU 时间。还要注意的是，**固体颗粒不会像液滴那样从域的底部消失**。
3. **如果液滴或微粒被吸入抽气孔，除非指定 PARTICLE_EXTRACTION_VELOCITY 的最小值（m/s），否则不会被移除。**也就是说，如果通风口的抽吸速度超过此值，颗粒或液滴将从模拟中移除。否则，液滴/颗粒的行为将与撞击其他固体表面无异。默认情况下，该参数是一个较大的正值，这意味着您必须指定一个小于正常通风口萃取速度的正值，该参数才会生效。如果希望提取所有颗粒/液滴，请将数值设置为很小的正数。

## Suppression byWater

水灭火模型由三个主要部分组成：水滴在空气中的传输、水在固体表面的跟踪以及预测燃烧速率的降低。本节将讨论后两个部分。

### Droplet Movement on Solid Surfaces

当液滴[^15-5]撞击固体表面[^15-6]时，它会被粘住，并被重新分配新的速度和方向。如果表面是水平的，则方向是随机选择的。如果是垂直面，则方向向下。通过 PART 行上的 HORIZONTAL_VELOCITY 和 VERTICAL_VELOCITY 参数可以控制液滴水平或垂直（向下）移动的速度。默认值分别为 0.2 m/s 和 0.5 m/s。

当液滴撞击固体表面时，它会在等体积半球的横截面积上传递热量。当足够多的液体聚集在表面上形成一层膜时，热量传递的面积是基于膜而不是单个液滴。一旦形成膜层，液滴的直径并不重要，因为假定它会与形成膜层的其他液滴混合。但是，当液滴以 “滴落 ”的形式离开固体表面时，它会重新形成液滴，其新的直径可以通过PART行上的 SURFACE_DIAMETER 来指定，单位为微米。

固体表面和液膜层之间的传热利用的是经验湍流传热相关性，该相关性是液体特性和用户指定的横向流速（HORIZONTAL_VELOCITY）或纵向流速（VERTICAL_VELOCITY）的函数。**详情请参见《FDS 技术参考指南》中的 “拉格朗日粒子 ”一章**。另外，您也可以在 PART 行中指定一个常数 HEAT_TRANSFER_COEFFICIENT_SOLID，单位为 W/m2/K。

在某些应用中，例如在扑灭货架储藏商品火灾时，允许水滴沿着固体物体的底部水平移动是非常有用的。这种现象很难精确建模，因为它涉及表面张力、表面孔隙率和吸水性以及复杂的几何形状。不过，可以通过在 MISC 行中设置 ALLOW_UNDERSIDE_PARTICLES=T 来捕捉部分效果。该值通常为假。此外，请注意，当液滴撞击到障碍物时，垂直方向会被假定为与 Z 轴重合，无论重力矢量 GVEC 有何变化。

名为 Sprinklers_and_Sprays/cascade.fds 的测试用例可用于演示水滴在固体障碍物上运动的各种特征。图 15.9 左侧的图像显示了 1 L 水滴从一个方框阵列的两侧层叠而下的情况。右图显示水的总质量保持不变。请注意，部分水蒸发到最初湿度为零的隔间中。

![image-20241222094644641](./../FUG6.9.1翻译.assets/image-20241222094644641.png)

### Reduction of the Burning Rate

水通过冷却燃料表面和改变从固体中释放出燃料气体的化学反应来降低燃料热解速率。如果固体或液体燃料已通过 MATL 行给出了反应参数，则无需设置任何额外的抑制参数。假定水流冲击燃料表面会从热解过程中带走能量，从而降低燃料的燃烧速率。如果燃料表面被指定为 HRRPUA（单位面积热释放率），则需要指定一个参数来控制水的灭火效果，因为这种类型的模拟火灾本质上就像一个气体燃烧器，其流速是明确指定的。水灭火的经验方法是用指数函数来描述热解速率的降低。燃料的局部质量损失率用以下形式表示
$$
\dot m_f^{\prime\prime}(t)=\dot m_{f,0}^{\prime\prime}(t)e^{\int k(t)dt}
$$
这里$\dot m_{f,0}^{\prime\prime}(t)$是用户指定的无水时单位面积的燃烧率，k 是单位面积当地水质量$m_{\text w}^{\prime\prime}$的函数，单位为 kg/m2。
$$
k(t)={\text E\_\text {COEFFICIENT}} m_{\text w}^{\prime\prime}(t)\quad 1/s
$$
参数 E_COEFFICIENT 必须通过实验获得，单位为 m2/（kgs）。通常情况下，当燃料比较复杂，如纸箱包装的商品时，就会使用这种抑制算法。Sprinklers_and_Sprays/e_coefficient.fds 这个简单的示例案例演示了该参数的使用。下图所示的 SURF 线定义了一个 0.6 米乘 0.6 米的气体燃烧器，在燃烧器上方放置了一个水喷嘴。喷嘴在点火 10 秒后的 0.1 秒内喷出 0.1 升水。水的单位面积质量为 0.1/0.36 ≈ 0.278 kg/m2。图 15.10 显示了火的热释放率，在大约 20 秒内从 36 kW 下降到 0 kW。考虑了两种情况，一种是燃烧器和边缘由传统 OBST 构成，另一种是燃烧器由浸入式边界 GEOM 构成。

```fortran
&SURF ID='FUEL', HRRPUA=100., E_COEFFICIENT=1. /
```

预期的HRR曲线为：
$$
\dot{Q}(t)=36\mathrm{e}^{-0.278(t-10.4)}\quad\mathrm{kW}
$$
![image-20241222095500495](./../FUG6.9.1翻译.assets/image-20241222095500495.png)

****

[^15-1]: CVF表示小于给定直径的液滴在总质量中所占的比例。
[^15-2]: CNF 表示总液滴中直径小于给定直径的部分。
[^15-3]: 默认情况下，颗粒大小范围被分为六个分区，采样的颗粒被划分到这些分区中。这样可以确保在整个粒度范围内分配到合理数量的粒子。要更改默认的分仓数，请在 PART 行设置 N_STRATA。
[^15-4]: 在这种情况下，无需指定 SHAPE='BLOCK'，只需省略 SHAPE。
[^15-5]: 默认情况下，固体粒子不会像液滴一样粘附在固体表面。不过，您可以通过在 PART 行中设置 ADHERE_TO_SOLID=1，让固体粒子像液滴一样运动。
[^15-6]: 如果不想让液滴积聚在固体表面，请在 PART 行设置 ADHERE_TO_SOLID=-1。对于液滴，该值通常为 1。

# Wind and Atmospheric Stratification

描述大气层的大部分参数都输入到一个名为 WIND 的命名行中。在 FDS 中指定风向有多种方法：

1. 如果您只想指定风速和风向，并随时间和高度改变这些量，请参见第 16.1 节。
2. 如果计算域的外围相对平坦，并且对表面粗糙度和大气条件有一定了解，请参阅第 16.2 节，了解如何应用莫宁-奥布霍夫(Monin-Obukhov)相似性理论。
3. 如果您的计算域跨度达数公里，并希望根据压力梯度和科里奥利力应用风，或者希望应用地转风，请参见第 16.3 节。
4. 如果您想按照风洞的方法对风进行建模，即创建一个 “风墙”，将计算域的整个侧面变成一个巨大的风扇，横向吹出空气，请参见第 16.4 节。

第 16.5 节讨论了大气的温度分层。除非您选择应用基于莫宁-奥布霍夫理论的风和温度曲线，否则这一点非常重要。最后，第 16.6 节讨论了室外模拟的边界条件。

## Wind Method 1: SpecifiedWind Speed and Direction

在 FDS 中引入风的最简单方法是指定其速度（SPEED）和方向（DIRECTION）。例如，如果西南风的风速为 5 米/秒，请添加以下一行：

```fortran
&WIND SPEED=5., DIRECTION=225. /
```

这里假定除了地面摩擦力的影响外，风速和风向不随高度变化。风向DIRECTION遵循通常的气象学惯例--北风的方向为 0◦，从北向南吹，或在 FDS 坐标系中为负 y 方向。东风的风向为 90◦，从东吹到西，或负 x 方向。

风速SPEED和风向DIRECTION可以使用 RAMP 函数作为时间和/或高度的函数。关于时间，请考虑以下几行输入：

```fortran
&WIND SPEED=1., RAMP_SPEED_T='spd', RAMP_DIRECTION_T='dir' /
&RAMP ID='dir', T= 0, F=300 /
&RAMP ID='dir', T= 600, F=330 /
&RAMP ID='dir', T=1200, F=350 /
.
.
&RAMP ID='spd', T= 0, F=2.8 /
&RAMP ID='spd', T= 600, F=3.1 /
&RAMP ID='spd', T=1200, F=3.5 /
.
.
```

这些线条分别根据 RAMP 函数 “spd ”和 “dir ”指示 FDS 随时间改变风速和风向。参数 T 代表时间（秒）。对于风向斜坡函数，F 代表与北方（Y 正方向）的夹角（度）。对于速度斜坡函数，F 代表基本 SPEED 的乘数，在本例中为 1 米/秒。
您还可以使用斜坡函数 RAMP_SPEED_Z 和 RAMP_DIRECTION_Z 随高度改变风速分量。

```fortran
&WIND SPEED=1., RAMP_SPEED_Z='spd', RAMP_DIRECTION_Z='dir' /
&RAMP ID='dir', Z= 0, F=300 /
&RAMP ID='dir', Z= 200, F=330 /
&RAMP ID='dir', Z= 500, F=350 /
.
.
&RAMP ID='spd', Z= 0, F=1.0 /
&RAMP ID='spd', Z= 200, F=1.5 /
&RAMP ID='spd', Z= 500, F=1.8 /
.
.
```

参数 Z 代表高度（米）。与上述时间函数一样，在方向斜坡函数中，F 代表与北方（Y 正方向）的夹角，单位为度。该值与 RAMP_DIRECTION_T 设置的任何时间变化值相加。对于速度斜坡函数，F 表示基准 SPEED 的乘数。该值乘以 RAMP_SPEED_T 设置的任何时间变化值。

通常，对于长达数小时的较长时间模拟，您可能无法确切知道风向的变化情况，但您可以根据大气的稳定性等级提供一个估计值。使用大气弥散界的术语[^48]，风向的扰动可以建模为：
$$
\theta^{\prime}(t+\delta t)=R^2\theta^{\prime}(t)+N\left(0,\sqrt{1-R^2}\sigma_\theta\right)\quad;\quad R=\mathrm{e}^{-\delta t/\tau}\quad;\quad\theta^{\prime}(0)=0
$$
其中，N(μ,σ) 表示均值为 μ、标准偏差为 σ 的正态随机变量；$\sigma_{\theta}$（SIGMA_THETA，以 WIND 线上的度数为单位）取决于大气的稳定性等级；$\tau$（TAU_THETA）是一个时间尺度，默认值为 300 秒。

**Example**

在名为 Atmospheric_Effects 的样本文件夹中，名为 wind_example_nn.fds 的输入文件展示了风的功能。每个案例都考虑了一块 1000 米 x 1000 米 x 100 米高的平坦地形。在名为 wind_example_5 和 wind_example_10 的示例中，5 米/秒的风速在 10 分钟内转向 90◦。图 16.1 显示了平均速度分量的延迟，这是由于只在外部边界施加了风廓线。

![image-20241222101344363](./../FUG6.9.1翻译.assets/image-20241222101344363.png)

## Wind Method 2: Monin-Obukhov Similarity

莫宁-奥布霍夫(Monin-Obukhov)相似理论根据地表和大气条件提供垂直风速和温度曲线。这些剖面图应用于计算域的外部边界；因此，外围地形必须相对平坦。计算域内可能会有山丘或山谷，但外围应该是平坦的，以便风场远离边界自然形成。

### Basic Equations

假定风速曲线 u 和势温[^16-1] θ 随高度 z 变化，其变化规律为
$$
\begin{aligned}&u(z)&&=\quad\frac{u_*}{\kappa}\left[\ln\left(\frac{z}{z_0}\right)-\Psi_\mathrm{m}\left(\frac{z}{L}\right)\right]\\&\theta(z)&&=\quad\theta_0+\frac{\theta_*}{\kappa}\left[\ln\left(\frac{z}{z_0}\right)-\Psi_\mathrm{h}\left(\frac{z}{L}\right)\right]\end{aligned}
$$
式中 $u_{\star}$ 为摩擦速度，κ = 0.41 为冯卡尔曼Von Kármán常数，z0 为气动粗糙度长度，$\theta_{\star}$为缩放势温，$\theta_0$为地面势温，L 为奥布霍夫Obukhov长度，相似函数为 Dyer [^49]提出的函数：
$$
\begin{array}{rcl}\Psi_{\mathfrak{m}}\left(\frac{\zeta}{L}\right)&=&\begin{cases}&-5\frac{z}{L}&:&L\geq0\\\\&2\ln\left[\frac{1+\zeta}{2}\right]+\ln\left[\frac{1+\zeta^2}{2}\right]-2\tan^{-1}(\zeta)+\frac{\pi}{2}&:&L<0&&\end{cases}\end{array}
$$

$$
\begin{array}{rcl}\Psi_{\mathrm{h}}\left(\frac{z}{L}\right)&=&\begin{cases}&-5\frac{z}{L}&:&L\geq0\\\\&2\ln\left[\frac{1+\zeta^{2}}{2}\right]&:&L<0&&&\end{cases}\zeta=\left(1-\frac{16z}{L}\right)^{1/4}\end{array}
$$

奥布霍夫Obukhov长度 L 表示大气的热稳定性。当 L 为负值时，大气分层不稳定；当 L 为正值时，大气分层稳定。当 L 接近于零时，分层的稳定或不稳定效应最强。因此，中性分层大气的奥布霍夫长度为无限大。一般来说，不稳定大气的温度会随高度的增加而降低，风向/风速的波动也相对较大。不稳定大气受浮力产生的湍流影响很大，导致混合增强。相反，高度稳定的大气条件会抑制湍流混合。

如果没有报告或不知道这些参数，可以根据基本气象条件进行估算。仅根据在某一高度 $z_{ref}$ 处测得的平均风速 $u_{ref}$，就可以计算出摩擦速度：
$$
u_*=\frac{\kappa u_\mathrm{ref}}{\ln(z_\mathrm{ref}/z_0)-\Psi_\mathrm{m}(z_\mathrm{ref}/L)}
$$
奥布霍夫Obukhov长度 L 可从表 16.1 中选择。表 16.2 列出了气动粗糙度长度[^16-2] $z_0$ 的建议值。

<center>Table 16.1: Suggested values of the Obukhov length, L (m).</center>

![image-20241222102220858](./../FUG6.9.1翻译.assets/image-20241222102220858.png)

<center>Table 16.2: Davenport-Wieringa roughness length classification [^50].</center>

![image-20241222102306784](./../FUG6.9.1翻译.assets/image-20241222102306784.png)

缩放势能温度$\theta_{\star}$ 可通过关系式求得：
$$
\theta_*=\frac{u_*^2\theta_0}{g\kappa L}\quad;\quad\theta_0=\theta_{\mathrm{ref}}/\left(1+\frac{u_*^2}{g\kappa^2L}\left[\ln(z_{\mathrm{ref}}/z_0)-\Psi_{\mathrm{h}}(z_{\mathrm{ref}}/z_0)\right]\right)
$$
或者，也可以根据显热通量的表达式估算出比例势能温度：
$$
\dot{q}_\mathrm{c}^{\prime\prime}=-\rho c_pu_*\theta_*
$$
请注意，热通量的正值表示地面比上面的空气温暖。图 16.2 显示了一些风廓线示例。请注意，L 的符号决定了大气是稳定还是不稳定；也就是说，相对于地面温度，温度是升高还是降低。

### Applying Monin-Obukhov Profiles to FDS

下面的输入线表示，在一个阳光明媚的日子里，西南风以 5 米/秒的速度吹向相对平坦的乡村地 带：

```fortran
&WIND SPEED=5., Z_REF=3, DIRECTION=225., L=-100., Z_0=0.03 /
```

如果 L 的值不为零，则表示要使用莫宁-奥布霍夫Monin-Obukhov曲线。SPEED 表示 Z_REF（米）高度处的风速。如果未指定 Z_REF，则假定风速取自离地 2 米的高度。除非指定 TMP_REF（◦C），否则假定 Z_REF 处的温度为指定的环境温度 TMPA。风向DIRECTION遵循通常的气象惯例--北风的风向为 0◦，从北向南吹，或 FDS 坐标系中的 y 负方向。东风的方向为 90◦，从东吹到西，或者说是负 x 方向。您只能在时间上改变风向，而不能在空间上改变风向：

```fortran
&WIND ..., RAMP_DIRECTION_T='dir' /
&RAMP ID='dir', T= 0, F=300 /
&RAMP ID='dir', T= 600, F=330 /
&RAMP ID='dir', T=1200, F=350 /
```

这里，T 是时间（秒），F 是风向（度）。您不能在时间或空间上改变速度。
如果您知道 $u_{\star}$ 或 $\theta_{\star}$ 的值，可以在 WIND 行输入 U_STAR (m/s) 和 THETA_STAR (K)。否则，它们将由 L 和 z0 计算得出。请勿同时输入所有四个参数。
此外，不要在定义地面的 SURF 线上指定可能与指定 M-O 参数不一致的参数。考虑到大气剖面是在边界处施加的，通常一个固定的温度就足够了。

**Example**

在名为 Atmospheric_Effects 的样本文件夹中，名为 wind_example_nn.fds 的输入文件展示了风的功能。每个案例都考虑了一块 1000 米 x 1000 米 x 100 米高的平坦地形。在名为 wind_example_32 的示例中，域中散布着各种矩形块来表示建筑物，风力保持稳定。图 16.3 显示了指定的垂直方向风速和温度剖面与计算的时间平均剖面的比较。剖面图应该相似，但不完全相同。

![image-20241222103021784](./../FUG6.9.1翻译.assets/image-20241222103021784.png)

![image-20241222103035218](./../FUG6.9.1翻译.assets/image-20241222103035218.png)

## Wind Method 3: Advanced Meteorological Concepts

**如果您的计算域跨度达数公里，您可能会考虑使用一组更基本的参数来描述风场**。这是一个挑战，因为从几个气象站获得的近场、近地表风速或温度读数很难推断出远场气象条件。如果您想学习这门课程，您很可能需要通过一些试验和错误来确保您的远场条件能够产生与气象站获得的数据接近的结果。

### Pressure Gradient Force

风是由水平气压梯度驱动的，它将气团从表面气压高的区域推向气压低的区域。这种可选的压力梯度力 F 是动量方程中添加的额外力项：
$$
\frac{\partial\mathbf{u}}{\partial t}+\cdots=\mathbf{F}/\rho
$$
压力梯度力与边界层高度 H 上的平均风速 U 的关系为 [^50] 。
$$
\|\mathbf{F}\|\approx\rho C_\mathrm{D}\frac{U^2}{H}
$$
其中，$C_D$ 是无量纲阻力系数，对于相对光滑的表面，阻力系数为 $2×10^{-3}$，而对于粗糙或森林覆盖的表面，阻力系数为 $2×10^{-2}$。该关系式适用于中性稳定条件，即多风且表面加热程度相对较低。对于不稳定的条件，即风小和表面加热较强，该关系式变为
$$
\|\mathbf{F}\|\approx\rho b_{\mathrm{D}}\sqrt{gH\frac{\Delta\theta}{\theta}}\frac{U}{H}
$$
其中，$b_D = 1.83×10^{-3}$，Δθ/θ 是地面与边界层中间高度之间潜在温度的相对变化。请注意，这些关系都是近似值。如果要与特定的风力测量值相匹配，需要进行一些数值实验。

例如，PRESSURE_GRADIENT_FORCE 是以 Pa/m 为单位输入 WIND 行的

```fortran
&WIND PRESSURE_GRADIENT_FORCE=0.01, DIRECTION=315, INITIAL_SPEED=5 /
```

风向DIRECTION遵循通常的气象学惯例--北风的方向为 0◦，从北向南吹，或在 FDS 坐标系中为负 y 方向。东风的方向为 90◦，从东吹到西，或者说是负 x 方向。您只能在时间上改变风向，而不能在空间上改变风向：

```fortran
&WIND ..., RAMP_DIRECTION_T='dir' /
&RAMP ID='dir', T= 0, F=300 /
&RAMP ID='dir', T= 600, F=330 /
&RAMP ID='dir', T=1200, F=350 /
```

T 是时间（秒），F 是风向（度）。INITIAL_SPEED 设置了模拟开始时的水平风速分量。这是为了方便起见，因为仅通过压力梯度力缓慢增加风速可能需要数小时的模拟时间。INITIAL_SPEED 仅设置初始风速，不会产生长期影响。您可以使用 RAMP_PGF_T 来及时改变压力梯度力（PRESSURE_GRADIENT_FORCE）。

在某些应用中，例如隧道，压力梯度力是引入外力导致的气流的一种便捷方法。在这种情况下，使用矢量 FORCE_VECTOR(1:3)以及相应的时间斜坡 RAMP_FVX_T、RAMP_FVY_T 和 RAMP_FVZ_T 来控制每个单独的分量有时更为方便。PRESSURE_GRADIENT_FORCE 只是 FORCE_VECTOR 的大小，单位相同。

### Coriolis Force

科里奥利力考虑了旋转参照系[^50]。科里奥利加速度对纳维-斯托克斯方程右侧的影响如下：
$$
\frac{\mathrm{Du}}{\mathrm{D}t}=...-2\mathbf{\Omega}\times\mathbf{u}
$$
其中 $\boldsymbol{\Omega}$是旋转矢量（见图 16.4）。要在 FDS 中应用科里奥利力，您有两种选择：一是通过 CORIOLIS_VECTOR(3)直接在 WIND 线上指定 $\boldsymbol{\Omega}$ 的分量；二是采取简单的方法，只需指定域的纬度LATITUDE（度），只要将 x 方向与东面对齐即可。在后一种情况下，FDS 将为您计算旋转矢量，计算公式为
$$
\boldsymbol{\Omega}=\omega\begin{bmatrix}0\\\cos(\phi\pi/180)\\\sin(\phi\pi/180)\end{bmatrix}
$$
其中，$\omega$ 是地球的自转速率，约为 1.16×10-5 2π/s。
决定科里奥利力是否重要的非维数是罗斯比数。设 U 为相关的速度尺度，L 为问题的长度尺度。科里奥利频率为$f_c=2\omega\sin(\phi\pi/180)$。罗斯比Rossby数为
$$
\mathrm{Ro}=\frac{U}{f_cL}
$$
**当罗斯比数较大时，科里奥利力可以忽略不计。在建筑火灾中，通常就是这种情况**，因为 U 和 L 的数量级是统一的，$f_c=\mathscr{O}(10^4)$。

### Geostrophic Wind

当科里奥利力与稳定状态下的水平压力梯度达到平衡时，地转风就会从横向动量方程中得到[^50]。水平风分量可写成
$$
U_{g}=-\frac{1}{\rho f_{c}}\frac{\partial\bar{p}}{\partial y}V_{g}=+\frac{1}{\rho f_{c}}\frac{\partial\bar{p}}{\partial x}
$$
如果知道地转风速，可以通过 GEOSTROPHIC_WIND(1:2) = (Ug,Vg) 在 WIND 行输入。请注意，在 x 处输入风速意味着在 y 处输入平均压力梯度，反之亦然。当指定风向时，FDS 将根据公式 (16.15) 将该值转换为隐含的 FORCE_VECTOR。**要实现指定的高空地转风，必须同时打开科里奥利力**（见第 16.3.2 节）。由于地转风等同于应用 FORCE_VECTOR，因此也可以应用时间斜坡（见第 16.3.1 节）。

![image-20241222104523830](./../FUG6.9.1翻译.assets/image-20241222104523830.png)

### Surface Roughness

在 “完全粗糙 ”极限下，FDS 使用的默认壁面模型由以下对数定律给出：
$$
\frac{u(z)}{u_*}=\frac{1}{\kappa}\ln\left(\frac{z}{s}\right)+8.5
$$
砂粒粗糙度 s 与第 16.2 节讨论的空气动力粗糙度长度 z0 有关。将莫宁-奥布霍夫相似理论给出的速度剖面（式 (16.2)）代入式 (16.17)，并注意到在地面附近$\psi_{\mathrm{m}}\approx0$，则粗糙度系数的有效换算为
$$
s=z_0\operatorname{e}^{8.5\kappa}\approx32.6z_0
$$
砂粒粗糙度 s 是通过参数 ROUGHNESS (m) 在 SURF 图线上指定的。与 M-O 相似性理论中的对应参数 z0 相比，该参数具有更直观的含义，因为它可以被视为地面障碍物的特征高度。表 16.2 列出了 z0 的建议值，公式 16.18 可用来计算输入到定义地面的 SURF 线的 ROUGHNESS 长度。

### Thermal Boundary Conditions at the Ground

相对于空气温度的地面温度是确定大气边界层稳定性的一个重要考虑因素。冷空气吹过温暖的地面会比暖空气吹过寒冷的地面导致更大的扩散。您可以在定义地面的 SURF 线上应用多种热边界条件：(1) 使用 WALL_TEMPERATURE (◦C)（墙面温度）设置固定或随时间变化的温度；(2) CONVECTIVE_HEAT_FLUX (kW/m2)；或 (3) 将地面定义为热厚固体的参数。设置 CONVECTIVE_HEAT_FLUX（对流热通量）便于与莫宁-奥布霍夫相似理论进行联系，在莫宁-奥布霍夫相似理论中，公式 (16.7) 和 (16.8) 可以结合使用，以提供地表对流热通量的表达式：
$$
\dot{q}_\mathrm{c}^{\prime\prime}=-\frac{u_*^3\theta_0\rho c_p}{g\kappa L}
$$
请注意，ρ（kg/m3）是密度，cp 是地面附近空气的比热。

### Example

图 16.5 显示了 FDS 在一个 1000 米方形域、具有周期性边界、高度为 200 米的域上生成的速度和温度剖面。风场是利用不同数值的压力梯度力 F 生成的，地面的 CONVECTIVE_HEAT_FLUX ($\dot q_c^{\prime\prime}$ ) 和表面 ROUGHNESS (s) 有几个不同的数值。公式 (16.18) 和 (16.19) 用于将指定的 $\dot q_c^{\prime\prime}$和 s 转换为 L 和 z0，然后用于生成莫宁-奥布霍夫速度和温度曲线，以比较模拟结果。请注意，这些模拟并不直接调用莫宁-奥布霍夫Monin-Obukhov曲线。相反，M-O 剖面是用来测试 FDS 模拟是否只使用指定的压力梯度力 F、表面粗糙度 s 和表面热通量 $\dot q_c^{\prime\prime}$就能产生逼真的垂直剖面。

![image-20241222105229065](./../FUG6.9.1翻译.assets/image-20241222105229065.png)

## Wind Method 4: The “Wall of Wind”

使用莫宁-奥布霍夫Monin-Obukhov相似理论指定风的另一种方法是在计算域的外部边界指定幂律风廓线。这实质上创建了一个 “风墙”，在 FDS 早期版本中是指定风的推荐方法。不过，上述技术更可取，因为它们能以更自然的方式处理计算域的横向边界。

要指定 “风墙”，可在分配给计算域外部横向边界的 SURF 线上设置 PROFILE='ATMOSPHERIC'。这将产生一个幂律大气风廓线，其形式为$u=u_0(z/z_0)^p$ ，其中 z 是离地面的高度。如果规定了大气剖面，也应规定 Z0 为 z0，PLE 为 p。VEL 指定了参考速度 u0。请注意，z0 并非地面，而是测量风速的地面以上高度，如高架气象站。假设地面高度为 0 米；要改变这一假设，请将 WIND 行中的 GROUND_LEVEL 设置为适当的高度。注意不要应用低于 GROUND_LEVEL 的大气速度剖面（如负 Z），否则 FDS 会出错停止。

使用 “风墙 ”方法时要注意，风场的形成需要时间。为了加快速度，您可能希望将整个域内的气流初始化为所选的风速，但您可能不希望这个初始风场无限期地存在下去。在这种情况下，请添加一行：

```fortran
&WIND U0=..., V0=..., W0=... /
```

其中 U0、V0 和 W0 为所需的初始风场。直接设置速度分量将使模拟初始化为恒定流场，但流场将逐渐消失，SURF 线和大气剖面将控制风流。

## Temperature Stratification

注：如果您选择应用莫宁-奥布霍夫Monin-Obukhov风速和温度曲线，则本节内容不适用。
通常情况下，在大气层的前几百米处，温度每千米下降几摄氏度。**在考虑烟雾上升时，这种微小的温度变化非常重要，因为烟雾上升时温度会迅速降低**。大气的 LAPSE_RATE 可以在 WIND（风向）行中指定，单位为 ◦C/m。**负号表示温度随高度降低。只有在室外计算域高度为几十米或几百米时才需要设置**。LAPSE_RATE 的默认值为 0 ◦C/m。
另外，如果希望温度随高度发生非线性变化，也可以在 WIND 行指定 RAMP_TMP0_Z。例如

```fortran
&WIND ..., RAMP_TMP0_Z='T profile', ... /
&RAMP ID='T profile', Z= 0.001 , F= 1.0258 /
&RAMP ID='T profile', Z= 0.500 , F= 1.0019 /
&RAMP ID='T profile', Z= 1.000 , F= 1.0000 /
&RAMP ID='T profile', Z= 1.900 , F= 0.9986 /
&RAMP ID='T profile', Z= 3.000 , F= 0.9977 /
&RAMP ID='T profile', Z= 4.000 , F= 0.9972 /
```

Z 的值是离地面的高度（米）。F 的值是给定高度处的温度（开氏度）与环境温度（开氏度）之比（TMPA+273）。
默认情况下，FDS 假设密度和压力随高度降低，与应用或域大小无关。对于大多数模拟来说，这种影响可以忽略不计，但可以通过在 WIND 行设置 STRATIFICATION=F 来完全关闭。

### Stack Effect

高层建筑通常会因内部和外部的温差而产生浮力引起的空气流动，即所谓的烟囱效应[^51]。这些温差会在垂直竖井（楼梯间、中庭、电梯井等）内产生气流，原因是不同楼层存在泄漏或开口。要在 FDS 中模拟这种现象，必须在计算域中包含整栋建筑或建筑内外的大部分区域。根据 WIND 行输入的指定温度曲线捕捉大气中压力和密度的下降非常重要。

如果烟道流经的泄漏路径较小，则应将建筑物划分为一个或多个压力区ZONE。可根据暖通空调组件来定义泄漏路径。需要注意的是，泄漏模型将建筑物整个高度上的所有泄漏面结合在一起，因此会平均压力梯度。在进行叠加效应计算时，应定义单独的泄漏路径。下面将介绍一个简单的例子。

**Example Case: Atmospheric_Effects/stack_effect**

堆栈效应测试案例是对一栋 100 米高的建筑物进行的二维模拟，建筑物内部的气温比外部气温略高。大楼仅在顶层和底层有泄漏通道。由于楼内空气温度略高，楼内气压也略高，从而将空气排出楼外，反过来又将地面层的空气吸入楼内。室内空气温度 Tb 最初为 20 ◦C (293 K)，室外空气温度 T∞ 为 10 ◦C (283 K)。LAPSE_RATE 设置为 0 ◦C/m；因此，建筑物外的 T0(z) = T∞，建筑物内的 T0(z) = Tb。使用暖通空调求解器，在底层上方 2.5 米处和屋顶下方 2.5 米处定义了两个小型泄漏开口。每个开口的面积为 0.01 平方米，损耗系数为 2（例如，进入泄漏路径的入口损耗为 1，从泄漏路径的出口损耗为 1，这两个损耗都表示尖锐边缘开口）。

建筑物内外的初始密度分层可通过关系式计算得出：
$$
\frac{\rho_0(z)}{\rho_\infty}=\exp\left(-\frac{g\overline{W}}{RT_0}z\right)
$$
其中 R 是通用气体常数，g 是重力加速度，W 是空气的平均分子量，z 是GROUND_LEVEL以上的高度，T0 是环境温度。将此公式应用于下通风口和上通风口的外部和内部位置，得出密度分别为 1.2412、1.1989、1.2272 和 1.1858 kg/m3。

由于建筑物的开口在高度上等距分布，因此中性平面应接近其中点。计算方法如下
$$
\frac{\Delta H}{H_{\mathrm{n}}}=1+\frac{T_{\mathrm{b}}}{T_{\infty}}
$$
其中，Hn 是底部通风口上方的中性面高度，ΔH = 95 米是泄漏点之间的距离。由此得出中性面高度为下通风口上方 46.68 米或建筑物底部上方 49.18 米。请注意，这与建筑物底部上方 50 米的中点值相近。建筑物墙壁上的压力差由以下公式计算得出
$$
\Delta p=\frac{\overline{W}p_0(z)g\Delta z}{R}\left(\frac{1}{T_\infty}-\frac{1}{T_\mathbf{b}}\right)
$$
其中，Δz 是泄漏点到中性面的距离。利用中性面位置，下通风口的 Δz 值为 -46.68 m，上通风口的 Δz 值为 +48.32 m，这分别导致下通风口和上通风口的压力差为 -19.4 Pa 和 +20.4 Pa。在暖通空调动量方程中使用损耗 2 和压力差，得出底部的稳态流入速度为 3.95 m/s，顶部的流出速度为 4.15 m/s。速度和密度结果如图 16.6 所示。

![image-20241222110145122](./../FUG6.9.1翻译.assets/image-20241222110145122.png)

## External Boundary Conditions

对于典型的室外模拟，计算域的横向外部边界和上边界要么是开放的，要么是周期性的，下边界代表地球。在进行室外模拟时，不要改变重力矢量，因为有很多假设是假定地面向下，天空向上。

FDS 假定地面初始温度为环境温度 TMPA，大气温度根据稳定性条件随高度增加或减少。您可以使用 TMP_FRONT 将地面温度设置为不同的温度，或者提供材料属性，让地面自然升温或降温。您还可以设置 CONVECTIVE_HEAT_FLUX，正值表示地面温度高于上方空气温度。

通常情况下，域顶被设置为 “OPEN”，这意味着即使风场或多或少与之平行，也可能会有热羽流从计算域中升起。

计算域的横向边界可以设置为 SURF_ID=“OPEN”、“PERIODIC ”或 “PERIODIC FLOW ONLY”。SURF_ID='OPEN'是通常的流入/流出条件，适用于计算域向无限环境空隙开放的情况。SURF_ID=“PERIODIC ”假定计算域在每个方向上无休止地重复。这是一个重要的假设，因为使用莫宁-奥布霍夫Monin-Obukhov相似性理论建模的湍流大气边界层的发展距离远远超出了计算域。SURF_ID='PERIODIC FLOW ONLY'与'PERIODIC'相同，只是只有速度场是周期性的，而标量不是。也就是说，您不希望从计算域东部边界流出的烟羽立即在西部边界重新出现，尽管您可能仍然希望速度场是周期性的。

****

[^16-1]:势温度为$\theta=T\left(\frac{p_0}{p}\right)^{R/(W_\mathrm{air}c_p)}$，其中$p_0$通常为100kPa，$R/(W_{air}c_p)\approx 0.286$.
[^16-2]:请注意，空气动力粗糙度$ z_0$ 与第 10.1.7 节中讨论的砂粒粗糙度 s 不同。更多信息，请参见第 16.3.4 节。

# Wildland Fire Spread



# Devices and Control Logic

洒水器、烟雾探测器、热通量计和热电偶看似毫不相干，但从 FDS 的角度来看，它们只是根据所赋予的属性以特定方式运行的设备。它们可以用来记录模拟环境中的某些数量，如热电偶；也可以代表复杂传感器的数学模型，如烟雾探测器；在某些情况下，它们还可以触发事件发生，如计时器。
所有广义上的设备都是通过命名列表组 DEVC 指定的。此外，高级功能和属性可通过名为 CTRL（控制）和 PROP（属性）的附加命名列表组来实现。

## Device Location and Orientation

无论具体属性如何，每个设备都需要设置在计算域内的某个点上，或者像光束烟雾探测器那样设置在计算域的某个跨度上。例如，自动喷水灭火装置在计算域内的定位线为

```fortran
&DEVC XYZ=3.0,5.6,2.3, PROP_ID='Acme Sprinkler 123', ID='Spk_39' /
```

设备的物理坐标由实数三元组 XYZ 给出。FDS 使用这些坐标来确定设备所在的气室或壁室。设备的评估使用设备所在单元的单元中心值或面中心值，不进行插值。设备的属性包含在以 PROP_ID 指定的 PROP 行中，下面将对 FDS 中包含的每种特殊设备进行说明。字符串 ID 只是一个描述符，用于在输出文件中识别设备，以及是否有任何操作与其激活相关。

并非所有设备都需要通过 PROP_ID 与特定属性集关联。例如，点对点输出量可通过单个 DEVC 行指定，如

```fortran
&DEVC ID='TC-23', XYZ=3.0,5.6,2.3, QUANTITY='TEMPERATURE' /
```

它指示 FDS 记录给定点的温度与时间的函数关系。ID 是输出文件中的一个标签，其名称为 CHID_devc.csv。请注意，FDS 输出的是存储在该单元格中的数据，而不会对周围单元格进行任何插值。

有些设备有特定的方向。任何放置在固体表面的设备都需要 IOR（方向索引）参数。数值 ±1 或 ±2 或 ±3 表示设备 “指向 ”的方向。例如，IOR=-1 表示设备安装在朝负 x 方向的墙上。ORIENTATION（方向）用于不在表面上但需要指明方向的设备，如洒水器。ORIENTATION 使用实数值三元组指定，实数值三元组表示方向矢量的分量。ORIENTATION 的默认值为 (0,0,-1)。例如，默认的向下喷洒喷头可以转向其他方向。如果指定

```fortran
&DEVC XYZ=3.0,5.6,2.3, PROP_ID='...', ID='...', ORIENTATION=0.707,0.707,0.0 /
```

喷洒器将指向正 x 和正 y 方向的中点。对于其他设备，ORIENTATION 只会改变 Smokeview 绘制设备的方式。

水喷淋器喷洒到地面的密度取决于水喷淋臂的位置。与其根据水喷淋器与管道连接的每一个可能方向重新定义喷洒模式，还不如给 DEVC 提供参数 “旋转”（ROTATION）。默认 ROTATION 为 0 度，对于向下喷水器来说，就是正 X 轴。正 ROTATION 将使 0 度点向 Y 轴正方向旋转。

## Device Output

每个设备都有一个与之相关的数量。每个 DEVC 数量的时间历史会输出到一个逗号分隔的 ASCII 文件 CHID_devc.csv（输出文件格式参见第 27.3 节）。该文件可导入大多数电子表格软件包。大多数电子表格程序都会限制列数（例如 2003 版 Microsoft Excel 的列数限制为 256 列）。默认情况下，FDS 不限制逗号分隔值（.csv）文件中的列数。如果电子表格应用程序允许的列数少于输入文件中 DEVC 或 CTRL 的列数，则应在 DUMP 行设置 COLUMN_DUMP_LIMIT 等于 T。使用 DEVC_COLUMN_LIMIT 和 CTRL_COLUMN_LIMIT 指示设备和控制输出文件的列数限制。它们的默认值是 254。如果设备或控件的数量超过限制，则将写入多个输出文件。文件名后将附加一个数字。例如，如果需要两个设备文件，它们将分别命名为 CHID_1_devc.csv 和 CHID_2_devc.csv。

DEVC 输出每 DT_DEVC 秒或 RAMP_DEVC 指示的离散时间写入文件，这两个时间都在 DUMP 行中指定。默认情况下，输出 QUANTITY 在两次打印之间按时间平均计算。要避免这种情况，请在 DEVC 行中添加 TIME_AVERAGED=F。

DEVC 行的一个有用选项是添加 RELATIVE=T，表示只输出QUANTITY初始值的变化。这对验证和确认研究非常有用。您也可以通过在 DEVC 行将 ABSOLUTE_VALUE 设为 T 来输出设备数量的绝对值。

**您可以通过乘以 CONVERSION_FACTOR 和/或添加 CONVERSION_ADDEND 来更改输出 QUANTITY 的值。**例如，要将温度输出从默认的 ◦C 改为 ◦F，CONVERSION_FACTOR 应设为 1.8，CONVERSION_ADDEND 应设为 32。然后，您可以通过设置 UNITS='F' 或其他任何设置来更改输出文件中的单位。如果不转换输出 QUANTITY 的默认值，则无需设置 UNITS。

如果不想在输出文件中包含 DEVC QUANTITY，可在 DEVC 行设置 OUTPUT=F。有时，设备只是用作时钟或控制设备。在这种情况下，您可能希望防止其输出扰乱输出文件。如果 DEVC QUANTITY='TIME'，则 OUTPUT 会自动设置为 F。

所有设备都必须有规定的QUANTITY。**某些特殊设备（第 18.3 节）的 QUANTITY 指定在 PROP 行上**。与 DEVC 线路相关的 PROP 线路上指定的 QUANTITY 将覆盖 DEVC 线路上指定的 QUANTITY。

## Special Device Properties

许多设备比较容易描述，如点测量，只需在 DEVC 行中包含几个参数即可。然而，对于更复杂的设备，要在每条 DEVC 线路上列出所有属性是很不方便的。例如，一个模拟可能包括数百个喷淋器，但每次设置喷淋器时都要列出喷淋器的属性是很乏味的。对于这些设备，可使用名为 PROP 的单独命名列表组来存储相关参数。每个 PROP 行都有一个唯一的 ID，并通过 PROP_ID 字符串由 DEVC 行调用。**描述 PROP 组的最佳方式是列出各种特殊设备及其属性。**

### Sprinklers

要指定一个或多个喷洒器，您需要指定属于各种命名列表组的几组不同参数。例如，下面是一个基本的喷洒器描述：

```fortran
&SPEC ID='WATER VAPOR' /
&PART ID='my droplets', DIAMETER=1000., SPEC_ID='WATER VAPOR' /
&PROP ID='K-11', QUANTITY='SPRINKLER LINK TEMPERATURE', RTI=148., C_FACTOR=0.7,
ACTIVATION_TEMPERATURE=74., OFFSET=0.10, PART_ID='my droplets', FLOW_RATE=189.3,
PARTICLE_VELOCITY=10., SPRAY_ANGLE=30.,80., SMOKEVIEW_ID='sprinkler_upright' /
&DEVC ID='Spr-1', XYZ=22.8,19.7,7.4, PROP_ID='K-11' /
&DEVC ID='Spr-2', XYZ=22.8,22.7,7.4, PROP_ID='K-11' /
```

一个名为 “Spr-1 ”的洒水器位于 XYZ 给定的空间点上。这是一个 “K-11 ”型喷淋器，其属性在 PROP 行中给出。请注意，各种名称（ID）对 FDS 来说没有任何意义，只是作为将一个事物与另一个事物联系起来的一种手段，因此应尽量使用有意义的 ID。参数 QUANTITY='SPRINKLER LINK TEMPERATURE'对 FDS 确实有特殊意义，它指示 FDS 使用标准 RTI（响应时间指数 [^52]）算法计算设备的启动。PROP 组中与水喷淋器相关的属性包括

RTI 响应时间指数，单位 $(m·s)^{1/2}$（默认为 100）。

C_FACTOR 传导系数，单位 $(m/s)^{1/2}$（默认为 0）。

ACTIVATION_TEMPERATURE 单位℃（默认74℃）

INITIAL_TEMPERATURE link的初始温度，单位℃（默认TMPA）

FLOW_RATE 单位L/min。**该参数仅适用于液滴。**另一种方法是以 $L/(min\ bar^{1/2}) $为单位提供 K_FACTOR，以 bar 为单位提供 OPERATING_PRESSURE，即喷头的表压。流量由 $K\sqrt p$ 得出。请注意，**1 bar 相当于 14.5 psi**，$1\ gpm (gal/min) $相当于 3.785 L/min，$1\ gpm/psi^{1/2}$ 相当于 $14.41\ L/min/bar^{1/2}$ 。
MASS_FLOW_RATE 单位kg/s。**对于液滴，该参数可以代替 FLOW_RATE，但对于固体颗粒则必须使用。**如果指定了 MASS_FLOW_RATE，则还必须指定 PARTICLE_VELOCITY。

OFFSET **模拟中最初放置水滴的喷头周围球体的半径（米）（默认为 0.05 米）**。**假定在 OFFSET 以外，水滴已完全碎裂并独立传输。**请勿在网格边界 OFFSET 米范围内设置喷头或喷嘴。否则，进入相邻网格的液滴将被剔除。喷洒器的整个喷洒模式不必位于一个网格内，但喷洒器本身周围的体积必须位于一个网格内。

PARTICLE_VELOCITY 液滴初速。(默认为 0 米/秒）

ORIFICE_DIAMETER 喷嘴孔径，单位 m（默认为 0 m）。通过提供 FLOW_RATE 和 ORIFICE_DIAMETER 的值，该输入为设置液滴速度提供了另一种方法，在这种情况下，液滴速度是通过流速除以孔口面积计算得出的。如果没有关于液滴速度的任何信息，请使用这种方法。不过，为了再现特定的喷雾曲线，您通常必须对 PARTICLE_VELOCITY 进行微调。如果指定了 PARTICLE_VELOCITY 或 SPRAY_PATTERN_TABLE，则不会使用 ORIFICE_DIAMETER。

SPRAY_ANGLE 喷射液滴时所经过的一对角度（单位：度）。相对于以洒水器为中心、半径为 OFFSET 的球体南极，这些角度勾勒出锥形喷洒模式。例如，SPRAY_ANGLE=30,80.将引导喷水通过 ORIENTATION 向量（默认为 0,0,-1）的 30◦ 和 80◦ 之间的区域（见图 18.1）。可以通过一对喷射角度来指定椭圆喷射模式。例如，SPRAY_ANGLE(1:2,1)=0.,60.和 SPRAY_ANGLE(1:2,2)=0.,30.定义了一个在 x 轴方向有 60 度角、在 y 轴方向有 30 度角的喷洒模式。从上往下看，喷型就像一个椭圆。SPRAY_PATTERN_SHAPE 决定了液滴在指定的 SPRAY_ANGLE 范围内的分布方式。可选项有 “UNIFORM（均匀）”和 “GAUSSIAN（高斯）”。默认分布为 “GAUSSIAN”。参数 SPRAY_PATTERN_MU 控制 “GAUSSIAN ”分布中液滴最大密度的纬度。分布宽度由参数 SPRAY_PATTERN_BETA 控制。

SPRAY_PATTERN_TABLE 包含喷型描述的 TABL 行的名称。

PART_ID 包含液滴属性的 PART 行名称。更多详情请参见第 15 章。

PRESSURE_RAMP 指定管道压力与有效喷头和喷嘴数量关系的 RAMP 线路名称。

SMOKEVIEW_ID 要包含在 Smokeview 动画中的喷头图纸名称。

![image-20241222114050542](./../FUG6.9.1翻译.assets/image-20241222114050542.png)

**Specifying Complex Spray Patterns**

以更先进的喷洒器选项为例，喷洒器的喷洒模式为椭圆形，喷洒角内的质量流量分布均匀：

```fortran
&PROP ... SPRAY_ANGLE(1:2,1)=0.,60., SPRAY_ANGLE(1:2,2)=0.,30.,
SPRAY_PATTERN_SHAPE='UNIFORM' /
```

对于全锥形喷头，参数 SPRAY_PATTERN_MU 默认设置为零。对于空心锥形喷雾，该参数设置为 SPRAY_ANGLE(1:2,1)的平均值，即 X 方向的喷雾角度。下面的示例使用 SPRAY_PATTERN_MU 来定义介于全锥形喷雾和空心锥形喷雾之间的喷雾：

```fortran
&PROP ... SPRAY_ANGLE=0.,30., SPRAY_PATTERN_MU=15. /
```

图 18.2 展示了参数 SPRAY_PATTERN_MU 和 SPRAY_PATTERN_BETA 对分布的影响。图中每一行的最大角度 SPRAY_ANGLE(2,1) 都在 22.5 到 45 度之间变化。每幅图中的扩散参数 SPRAY_PATTERN_BETA 从 0（均匀分布）到 1000（狭窄分布）不等。分布的峰值角度 SPRAY_PATTERN_MU 从 0 到 10 到 20，从顶行到底行依次变化。

![image-20241222114318912](./../FUG6.9.1翻译.assets/image-20241222114318912.png)

如果需要比 SPRAY_ANGLE 更复杂的喷型，则可以使用 TABL 命名列表组指定 SPRAY_PATTERN_TABLE。在 PROP 行使用 FLOW_RATE 指定总流量，使用 SPRAY_PATTERN_TABLE 指定喷型名称，然后使用一个或多个 TABL 表格行：

```fortran
&TABL ID='table_id', TABLE_DATA=LAT1,LAT2,LON1,LON2,VELO,FRAC /
```

其中，给定 “table_id ”的每一行 TABL 都提供了指定实心角下喷洒模式的球面分布信息。LAT1 和 LAT2 是实心角的边界，以从南极量起的度数为单位（0 表示南极，90 表示赤道，180 表示北极）。请注意，这并不是指定纬度的传统方法，而是一种基于典型洒水车向下洒水这一事实的方便系统，这也是 0 度被指定为 “南极 ”或 -z 方向的原因。参数 LON1 和 LON2 是实体角的边界（单位也是度），其中 0（或 360）与 -x 轴对齐，90 与 -y 轴对齐。VELO 是液滴在插入点的速度（米/秒）。FRAC 是应从该特定固体角度流出的液体占总流量的比例。

在名为 bucket_test_2 的测试案例中，喷洒由两个喷射口组成，每个喷射口的速度为 5 米/秒，总流量为 60 升/分钟。第一个喷流占总流量的 0.2%，第二个喷流占总流量的 0.8%。喷射中心位于 “赤道 ”下方 60 ◦ 处，相距 180 ◦。

```fortran
&PROP ... FLOW_RATE=60., SPRAY_PATTERN_TABLE='TABLE1' /
&TABL ID='TABLE1', TABLE_DATA=30,31, 0, 1,5,0.2 /
&TABL ID='TABLE1', TABLE_DATA=30,31,179,180,5,0.8 /
```

请注意，每组 TABL 行必须有唯一的 ID。还要注意的是，TABL 行可以任意顺序指定。图 18.3 验证了喷头释放 5 公斤水（1 kg/s，5 秒）。

![image-20241222114327986](./../FUG6.9.1翻译.assets/image-20241222114327986.png)

**Varying Pipe Pressure**

在实际的自动喷水灭火系统中，管道压力受驱动自动喷水灭火器数量的影响。通常情况下，当第一个水喷淋器启动时，压力会高于设计值，随着启动的水喷淋器越来越多，压力会逐渐降低。管道压力对流速、液滴速度和液滴大小分布都有影响。在 FDS 中，可使用 PRESSURE_RAMP 在 PROP 线上指定变化的管道压力。在每条 RAMP 线上，打开的喷头或喷嘴数量与一定的管道压力（bar）相关联。例如

```fortran
&PROP ID='My nozzle'
OFFSET=0.1
PART_ID='water drops'
FLOW_RATE=0.9
OPERATING_PRESSURE = 10.0
PARTICLE_VELOCITY=15.0
SPRAY_ANGLE=0.0,80.0
PRESSURE_RAMP = 'PR1' /
&RAMP ID = 'PR1' T = 1, F = 16. /
&RAMP ID = 'PR1' T = 2, F = 10. /
&RAMP ID = 'PR1' T = 3, F = 8. /
```

这些线条表示第一个喷淋器启动时的压力为 16 巴，两个喷淋器启动时的压力为 10 巴，三个或更多喷淋器启动时的压力为 8 巴。在计算主动喷水灭火器的数量时，FDS 会考虑具有给定 PART_ID 的所有主动喷水灭火器或喷嘴。

使用压力斜坡时，FLOW_RATE 和 PARTICLE_VELOCITY 都取决于 OPERATING_PRESSURE。请指定 FLOW_RATE、K_FACTOR 和 OPERATING_PRESSURE。在后一种情况下，流速由$K\sqrt p$给出，液滴速度由液体密度和 ORIFICE_DIAMETER 给出。如果使用喷雾模式表，则通过 $K\sqrt p$和 ORIFICE_DIAMETER 分别确定表中每一行的液滴速度。粒度分布的中值直径按 $d_m(p) = d_m(p_o)(p_o/p)^{1/3}$ 的比例计算，其中 $p_o$ 为操作压力，$d_m(p_o) $由相应部件行的参数 DIAMETER 指定。

在某些模拟中，可能会有几组独立的喷头或喷嘴。例如，一组喷嘴用于喷射燃料，另一组喷嘴用于喷水。在这种情况下，水流不会受到有多少个燃油喷嘴打开的影响。要使 PRESSURE_RAMP 只计算喷头或喷嘴的子集，可在 DEVC 行中使用关键字 PIPE_INDEX。例如

```fortran
&DEVC ID='Spr_1', XYZ=2.00,2.00,8.00, PROP_ID='My nozzle', PIPE_INDEX=1 /
&DEVC ID='Spr_2', XYZ=1.00,1.00,8.00, PROP_ID='My nozzle', PIPE_INDEX=1 /
&DEVC ID='Fuel_1', XYZ=2.00,2.00,1.00, PROP_ID='Fuel Spray', PIPE_INDEX=2 /
&DEVC ID='Fuel_2', XYZ=1.00,1.00,1.00, PROP_ID='Fuel Spray', PIPE_INDEX=2 /
```

这些线条表明，燃油喷嘴与洒水器是一个独立的管网。有了这些输入，喷水器的 PRESSURE_RAMP 将不会计算任何活动的燃油喷嘴。有关使用 PIPE_INDEX 的更多详情，请参阅《验证指南》中的示例 flow_rate_2。

### Nozzles

喷嘴与洒水器非常相似，只是它们不是根据标准 RTI（响应时间指数）模型激活的。要模拟在给定时间启动的喷嘴，可直接在 DEVC 行指定 QUANTITY（数量）和 SETPOINT（设定点）。以下各行：

```fortran
&DEVC XYZ=23.91,21.28,0.50, PROP_ID='nozzle', ORIENTATION=0,0,1, QUANTITY='TIME',
SETPOINT=0., ID='noz_1' /
&DEVC XYZ=26.91,21.28,0.50, PROP_ID='nozzle', ORIENTATION=0,0,1, QUANTITY='TIME',
SETPOINT=5., ID='noz_2' /
&PROP ID='nozzle', PART_ID='heptane drops', FLOW_RATE=2.132,
FLOW_TAU=-50., PARTICLE_VELOCITY=5., SPRAY_ANGLE=0.,45. /
```

设计两个相同类型的喷嘴，一个在零时启动，另一个在 5 秒时启动。请注意，喷嘴必须有指定的 PROP_ID，PROP 行必须有指定的 PART_ID，以描述液滴。

**Example Case: Setting the Flow Rate of a Nozzle**

该示例演示了压力斜坡和控制逻辑在喷嘴打开和关闭中的应用。它还可作为水流量的验证测试。有四个喷嘴在指定时间打开：0 秒、15 秒、30 秒和 45 秒。打开喷嘴的数量是通过 “OPEN NOZZLES ”装置测量的。图 18.4 显示了 FDS 结果与准确的预期值的比较。请注意，“OPEN NOZZLES ”只计算属于指定 PIPE_INDEX 的喷嘴。压力斜坡的设计目的是在所有开放喷嘴值下提供 10 升/分钟的总流量。在数学上，这意味着
$$
nK\sqrt p=10 L/min\quad \rightarrow \quad p=(\frac{10L/min}{nK})^2
$$
其中 n 是打开的喷嘴数量。相应的喷嘴和压力斜坡定义如下

```fortran
&PROP ID='Head', OFFSET=0.10, PART_ID='water drops', K_FACTOR=2.5,
OPERATING_PRESSURE=1.,
PRESSURE_RAMP='PR', PARTICLE_VELOCITY=2., SPRAY_ANGLE= 0.,60. /
&RAMP ID='PR', T= 1., F=16. /
&RAMP ID='PR', T= 2., F=4. /
&RAMP ID='PR', T= 3., F=1.778 /
&RAMP ID='PR', T= 4., F=1. /
```

使用测量单位面积累积质量的装置对水进行跟踪，并将其整合到总楼面面积中。水的总质量应在 60 秒内从零增加到 10 千克。图 18.4 显示了 FDS 预测结果与分析结果的比较。FDS 结果的轻微延迟是由于水滴落在地板上所需的时间造成的。

![image-20241222144238069](./../FUG6.9.1翻译.assets/image-20241222144238069.png)

### Specified Entrainment (Velocity Patch)

喷淋头的几何形状和喷雾雾化细节在火灾计算中实际上是无法解决的。因此，很难预测喷水器的局部气相夹带。作为一种替代方法，可以指定喷头附近的局部气体速度。PROP 线可用于指定特定速度分量的多项式函数，并可通过一个装置将该函数 “补 ”入流场中。该装置的数量为 “VELOCITY PATCH（速度补丁）”，最初处于非激活状态。如第 18.4 节所述，必须使用单独的控制设备激活速度补丁。您可以使用 XB 为设备指定速度补间的局部区域。多项式定义为围绕 XYZ 点的二阶泰勒展开（XYZ 的默认值为 XB 的中心）。然后，FDS 使用沉浸边界法迫使局部速度分量满足多项式。多项式由系数 P0、PX(1:3) 和 PXX(1:3,1:3)指定，它们分别代表 XYZ 点的第 k 个速度分量值、一元导数和二元导数。请注意，一阶导数由一个三分量数组表示，二阶导数由一个对称的 3×3 数组表示，只需指定上三角部分。多项式的计算公式为（注意重复指数的求和是隐含的）：
$$
u_k(\mathbf{r})=\underbrace{(u_k)_0}_{\mathcal{P}0}+r_i\underbrace{\left(\frac{\partial u_k}{\partial x_i}\right)_0}_{\mathrm{PX(1:3)}}+\frac{r_ir_j}{2}\underbrace{\left(\frac{\partial^2u_k}{\partial x_i\partial x_j}\right)_0}_{\text{PXX(1:3,1:3)}}
$$
向量 r 是速度存储位置相对于 XYZ 点的位置。具体的速度分量由 PROP 中的整数 VELOCITY_COMPONENT 指定。下面我们提供一组 PROP 和 DEVC 行的示例，用于指定速度垂直分量的抛物线剖面。

```fortran
&PROP ID='p1', VELOCITY_COMPONENT=3, P0=-1,PXX(1,1)=5,PXX(2,2)=5 /
&DEVC XB=-.1,.1,-.1,.1,.9,.95, QUANTITY='VELOCITY PATCH',PROP_ID='p1', DEVC_ID='t1'/
&DEVC ID='t1', XYZ=0,0,.9, QUANTITY='TIME', SETPOINT=10/
```

在本例中，一个速度片段在模拟过程中的 10 秒钟处被激活。在 XB=-.1,.1,-.1,.1,.9,.95 框内具有交错存储位置的任何 w 速度分量都将被推向多项式曲线 “p1 ”指定的值。必须确保设备盒包含交错的存储位置（有关面心速度存储位置的讨论，请参阅理论手册 [^29]）。

### Heat Detectors

QUANTITY='LINK TEMPERATURE'定义了一个热探测器，它使用的启动算法与洒水器基本相同，但不喷水。

```fortran
&DEVC ID='HD_66', PROP_ID='Acme Heat', XYZ=2.3,4.6,3.4 /
&PROP ID='Acme Heat', QUANTITY='LINK TEMPERATURE', RTI=132.,
ACTIVATION_TEMPERATURE=74. /
```

与洒水器一样，RTI 是响应时间指数，单位为 $\sqrt {m\cdot s}$。ACTIVATION_TEMPERATURE 是链接激活温度，单位为摄氏度（默认为 74 ◦C）。INITIAL_TEMPERATURE 是链路的初始温度，单位为 ◦C（默认为 TMPA）。

### Smoke Detectors

在输入文件中定义一个烟雾探测器，其条目类似于

```fortran
&DEVC ID='SD_29', PROP_ID='Acme Smoke Detector', XYZ=2.3,4.6,3.4 /
&PROP ID='Acme Smoke Detector', QUANTITY='CHAMBER OBSCURATION', LENGTH=1.8,
ACTIVATION_OBSCURATION=3.24 /
```

为单参数 Heskestad 模型。请注意，**烟雾探测器必须有 PROP 行**，在这种情况下，可以在 PROP 行中指定 DEVC QUANTITY。对于四参数 Cleary 模型，请使用 PROP 行，如

```fortran
&PROP ID='Acme Smoke Detector I2', QUANTITY='CHAMBER OBSCURATION',
ALPHA_E=1.8, BETA_E=-1.1, ALPHA_C=1.0, BETA_C=-0.8,
ACTIVATION_OBSCURATION=3.24 /
```

其中两个特征填充时间或 “滞后 ”时间的形式为
$$
\delta t_e=\alpha_eu^{\beta_e}\quad;\quad\delta t_c=\alpha_cu^{\beta_c}
$$
默认探测器参数适用于特征长度LENGTH为 1.8 米的 Heskestad 模型。对于 Cleary 模型，必须明确列出所有 ALPHA 和 BETAs。表 18.1 列出了不明电离和光电探测器的建议常数。ACTIVATION_OBSCURATION 是阈值，单位为 %/m。阈值可根据制造商提供的常用设置进行设置。默认设置[^18-1]为 3.24 %/m（1 %/ft）。

<center>Table 18.1: Suggested values for smoke detector model [^53]. See Ref. [^54] for others.</center>

![image-20241222145611069](./../FUG6.9.1翻译.assets/image-20241222145611069.png)

**Defining Smoke**

默认情况下，FDS 假设火灾产生的烟雾与热释放率成正比。REAC 行上的 SOOT_YIELD=0.01 值表示烟雾产生率为燃料燃烧率的 0.01。这种情况下的 “烟雾 ”并没有被 FDS 明确跟踪，而是被假定为燃烧产物的一个函数。

不过，假设您想定义自己的 “烟雾”，并想在不考虑 HRR 的情况下指定其产生率（甚至代替实际的火，如燃烧源）。您可能还想定义烟雾的质量消光系数和假定分子量（因为它将像气体物种一样被跟踪）。最后，您还需要使用 Smokeview 中的 SMOKE3D 功能将烟雾可视化（第 22.8 节）。请使用以下几行：

```fortran
&SPEC ID='MY SMOKE', MW=29., MASS_EXTINCTION_COEFFICIENT=8700. /
&SURF ID='SMOLDER', TMP_FRONT=1000., MASS_FLUX(1)=0.0001, SPEC_ID='MY SMOKE',
COLOR='RED' /
&VENT XB=0.6,1.0,0.3,0.7,0.0,0.0, SURF_ID='SMOLDER' /
&PROP ID='Acme Smoke', QUANTITY='CHAMBER OBSCURATION', SPEC_ID='MY SMOKE' /
&DEVC XYZ=1.00,0.50,0.95, PROP_ID='Acme Smoke', ID='smoke_1' /
&SM3D QUANTITY='DENSITY', SPEC_ID='MY SMOKE' /
```

使用与上述相同的烟雾探测器模型，但现在算法中使用的是物种 “MY SMOKE”，而不是与块状物种相关的物种。请注意，您的物种不会参与辐射计算。它只是作为烟雾的替代物。

### Beam Detection Systems

通过指定光束的端点（x1,y1,z1）和（x2,y2,z2）以及检测器启动时的总遮挡率，可以定义光束检测器。FDS 会确定哪些网格单元位于两个端点所定义的线性路径上。光束探测器响应的计算公式为
$$
\text{Obscuration}=\left(1-\exp\left(-K_\mathrm{m}\sum_{i=1}^N\rho_{\mathrm{s},i}\Delta x_i\right)\right)\times100\%
$$
其中，i 是光束路径上的网格单元，$\rho_{s,i}$是网格单元的烟尘密度，$\Delta x_i$是光束穿过网格单元的距离，$K_m$ 是质量消光系数。输入文件中的行格式为

```fortran
&DEVC XB=x1,x2,y1,y2,z1,z2, QUANTITY='PATH OBSCURATION', ID='beam1', SETPOINT=33.0 /
```

类似的QUANTITY是 “TRANSMISSION”，由以下表达式给出：
$$
\text{Transmission}=\exp\left(-K_\mathrm{m}\frac{L_0}{L}\sum_{i=1}^N\rho_{\mathrm{s},i}\Delta x_i\right)\times100\%/\mathrm{m}
$$
请注意，传输率的单位是 %/m，而不是像遮挡率那样的 %。L 是光束的总路径长度，$L_0$ 是 1 米的参考尺寸。

**Example Case: A Beam Detector**

一个 10 米乘 10 米乘 4 米的隔间中充满了 20 ◦C 的空气，其密度为 $\rho=1.195\ kg/m^3$。质量分数为 $Y_s = 3×10^{-5} $的均匀分布气体代表烟雾。烟雾 "密度为 $\rho_s ≡ \rho Y_s = 3.585×10^{-5} kg/m^3$。使用默认的质量消光系数 $K_m = 8700 m^2/kg$，计算出光学深度为 $K ≡ K_m\rho_s = 0.3119 m^{-1}$。舱内有三个光束探测器，路径长度均为 L = 10 m，但方向不同。预计路径遮蔽率为 $100(1-exp(-KL)) = 95.58\%$。请注意，本例使用 8 个网格来横跨计算域，并允许光束从一个网格穿过另一个网格。

这个案例也为 Smokeview 渲染的烟雾弥漫的车厢提供了检验依据。九根立柱距离前墙的距离以 1 米为单位递增。根据公式 (22.23) 计算，可见距离为 $S ≡3/K =9.6 m$。参考图 18.5，在距离前墙 8.9 米处，应该可以勉强看到第九根圆柱。图 18.5 底部的曲线图比较了 Smokeview 用来给柱子着色的像素值和预期值。像素值为 0 到 255 之间的整数，其中 255 为白色，0 为黑色。

![image-20241222150611460](./../FUG6.9.1翻译.assets/image-20241222150611460.png)

### Aspiration Detection Systems

吸气检测系统将一系列烟雾测量装置组合在一起。吸气系统由采样管网组成，采样管网将空气从一系列位置吸到一个中心点，在该中心点进行模糊度测量。要在 FDS 中定义这样一个系统，您必须提供采样位置、采样流速、每个采样位置的传输时间，如果需要警报输出，还必须提供整体模糊度 “设定点”。一个或多个 DEVC 输入用于指定采样位置的详细信息，另外一个输入用于指定中央探测器：

```fortran
&DEVC XYZ=..., QUANTITY='DENSITY', SPEC_ID='SOOT', ID='soot1', DEVC_ID='asp1',
FLOWRATE=0.1, DELAY=20 /
&DEVC XYZ=..., QUANTITY='DENSITY', SPEC_ID='SOOT', ID='soot2', DEVC_ID='asp1',
FLOWRATE=0.2, DELAY=10 /
...
&DEVC XYZ=..., QUANTITY='DENSITY', SPEC_ID='SOOT', ID='sootN', DEVC_ID='asp1',
FLOWRATE=0.3, DELAY=30 /
&DEVC XYZ=..., QUANTITY='ASPIRATION', ID='asp1', BYPASS_FLOWRATE=0.4,
SETPOINT=0.02 /
```

其中，DEVC_ID 是每个采样点用于参考中央检测器的值，FLOWRATE 是气体流速（千克/秒），DELAY 是采样点到中央检测器的传输时间（秒），BYPASS_FLOWRATE 是任何从计算域外吸入系统的空气的流速（千克/秒）（考虑到采样网络中位于 MESH 输入定义域之外的部分），SETPOINT 是警报阈值模糊度，单位为 %/m。吸气系统的输出计算公式为
$$
\text{Obscuration}=\left(1-\exp\left(-K_{\mathrm{m}}\frac{\sum_{i=1}^N\rho_{\mathrm{s},i}(t-t_{\mathrm{d},i})\dot{m}_i}{\sum_{i=1}^N\dot{m}_i}\right)\right)\times100\%/\mathrm{m}
$$
其中，$\dot m_i$ 是取样位置 i 处的质量流速，$\rho_{s,i}(t-t_{d,i})$是取样位置 i 处的烟尘密度，$t_{d,i}$ 是当前时间 t 之前的时间（DELAY），$K_m$ 是与可见光相关的 MASS_EXTINCTION_COEFFICIENT。
请注意，FDS 实际上并不根据FLOWRATE从计算域中移除气体；FLOWRATE只是一个加权系数。

**Example Case: aspiration_detector**

一个边长 2 米的立方体隔间内有一个三处取样的抽吸系统。三个位置的流速相等，分别为 0.3 千克/秒、50 秒、100 秒和 150 秒。吸气检测器没有规定旁路流速。燃烧产物以 1 千克/秒的速度强制进入隔间底部。SOOT_YIELD=0.001。质量以 1 千克/秒的速度从隔间顶部排出。随着时间的推移，吸气探测器显示出越来越模糊的现象。由于第一个采样点的传输时间为 50 秒，再加上将燃烧产物传输到采样点的时间很短，因此最初的上升延迟时间略高于 50 秒。由于取样点的延迟时间，探测器的响应有三个高原。采样点位于同一地点，因此每个高原代表有额外三分之一的烟尘被传送到检测器。采样点的烟尘密度为 $7.1×10^{-5} kg/m^3$。如图 18.6 所示，使用该值计算出的高原为 18%、33.2% 和 45.7%。

![image-20241222151219765](./../FUG6.9.1翻译.assets/image-20241222151219765.png)

### Fire Depth

在某些情况下，沿某一路径输出火的特征深度可能很有用。例如，**在模拟野外火灾等蔓延性火灾时，这一参数就非常重要**。定义火灾深度的方法有很多，但一个简单的选择是使用类似于光束探测器的逻辑，计算穿过热量释放体积大于阈值的区域的光束长度。这个 “FIRE DEPTH ”量可以写成：
$$
\mathrm{Fire~Depth}=\sum_{i=1}^{N}C_{i}\Delta x_{i};C_{i}=\left\{\begin{array}{cc}0&\dot{q}_{i}^{\prime\prime\prime\prime}\leq\dot{q}_{\mathrm{thresh}}^{\prime\prime\prime\prime}\\1&\dot{q}_{i}^{\prime\prime\prime}>\dot{q}_{\mathrm{thresh}}^{\prime\prime\prime\prime}\end{array}\right.
$$
与光束探测器一样，i 是光束路径上的一个网格单元，$\Delta x_i$ 是光束在网格单元内穿过的距离。阈值$\dot q^{\prime\prime\prime}_{thresh}$ 是通过在 DEVC 行上设置 SETPOINT 来实现的，单位为 kW/m3。如果没有提供该值，则默认为第 22.8 节所述的渲染 HRRPUV 的阈值。

## Basic Control Logic

设备可用于控制各种操作，如创建和移除障碍物，或激活和关闭风扇和通风口。每个设备都有一个相关的数量（QUANTITY），无论是直接包含在 DEVC 线路中，还是间接包含在可选的 PROP 线路中。使用 DEVC 参数 SETPOINT，可以在 QUANTITY 值超过或低于给定的 SETPOINT 时触发动作。以下参数决定了设备的控制方式：

SETPOINT 设备状态发生变化时的数值。对于检测类型的设备（如热或烟雾），该值取自设备的 PROP 输入，无需在 DEVC 线上指定。

TRIP_DIRECTION 正整数表示，当设备值大于设定点时，设备将从初始状态（INITIAL_STATE）开始变化，而当设备值小于设定点时，设备将等于初始状态（INITIAL_STATE）。负整数的行为则相反。当设备值小于 SETPOINT 时，设备将从 INITIAL_STATE 开始变化，而当设备值大于 SETPOINT 时，设备将等于 INITIAL_STATE。默认值为 +1。

LATCH 如果该逻辑值设置为 T，设备将只改变状态一次。默认值为 T。

INITIAL_STATE 该逻辑值是设备的初始状态。默认值为 F。例如，如果与设备相关的障碍物要消失，则设置 INITIAL_STATE=T。

如果希望使用比单个设备及其设定点更复杂的逻辑来控制 FDS，则可使用 CTRL 输入指定控制功能。有关 CTRL 功能的更多信息，请参见第 18.5 节。最简单的设备示例就是计时器：

```fortran
&DEVC XYZ=1.2,3.4,5.6, ID='my clock', QUANTITY='TIME', SETPOINT=30. /
```

通过参数 DEVC_ID=“my clock ”与设备相关的任何内容都将在 30 秒后改变状态。例如，如果将文本添加到 OBST 行中，30 秒后该障碍物的 INITIAL_STATE 将从 F 变为 T。 换句话说，它将在 30 秒后创建，而不是在模拟开始时创建。这就是打开一扇门或一扇窗的简单方法。

使用 DEVC 输出控制 FDS 时，使用 DEVC 的瞬时值。**对于某些QUANTITY类型（如TEMPERATURE），该输出可能会产生很大的噪声。**为防止虚假尖峰导致 DEVC 状态改变，可以指定参数 SMOOTHING_FACTOR。它对 DEVC 输出进行指数平滑处理，具体如下：
$$
\bar{x}^n=\bar{x}^{n-1}\text{ SMOOTHING\_FACTOR}+x^n\text{ (1-SMOOTHING\_FACTOR)}
$$
其中，n 为时间步长，x 为瞬时设备输出，$\bar x$ 为平滑输出。SMOOTHING_FACTOR 的默认值为 0，表示不执行平滑处理。请注意，SMOOTHING_FACTOR 只改变传递给控制函数的值，对写入 CHID_devc.csv 文件的 DEVC 值没有影响。

设备的每次状态变化都会记录到日志文件中，参见第 27.5 节。

### Creating and Removing Obstructions

在许多火灾现场，打开或关闭一扇门或一扇窗都会导致火势的急剧变化。有时这些动作是有意为之，有时则是火灾的结果。在火灾数据系统的计算框架内，这些动作表现为设置或移除固体障碍物，或打开或关闭外部通风口。

通过指定字符串 DEVC_ID（DEVC_ID 表示 OBST 行中要创建或移除的 DEVC ID 名称）来移除或创建实体障碍物。这将指示 FDS 在设备状态变为 F 或 T 时分别删除或创建障碍物。例如

```fortran
&OBST XB=..., DEVC_ID='det2' /
&DEVC XYZ=..., ID='det2', INITIAL_STATE=T /
```

会在指定的 DEVC 改变状态时移除给定的障碍物。

使用以TIME为测量量的 DEVC，可以在预定时间创建或移除障碍物。例如，以下指令将使指定的孔洞（HOLE）和障碍物（OBSTructions）在不同的指定时间出现/消失。这几行是名为 create_remove.fds 的简单测试用例的一部分。

```fortran
&OBST XB=0.3,0.4,0.1,0.9,0.1,0.9, COLOR='PURPLE' /
&HOLE XB=0.2,0.4,0.2,0.3,0.2,0.3, COLOR='RED', DEVC_ID='timer1' /
&HOLE XB=0.2,0.4,0.7,0.8,0.7,0.8, COLOR='GREEN', DEVC_ID='timer2' /
&OBST XB=0.7,0.8,0.2,0.3,0.2,0.3, COLOR='BLUE', DEVC_ID='timer3' /
&OBST XB=0.7,0.8,0.6,0.7,0.6,0.7, COLOR='PINK', DEVC_ID='timer4' /
&OBST XB=0.5,1.0,0.0,1.0,0.0,0.1, COLOR='YELLOW', DEVC_ID='timer5' /
&HOLE XB=0.7,0.8,0.7,0.8,0.0,0.1, COLOR='BLACK', DEVC_ID='timer6' /
&HOLE XB=0.7,0.8,0.2,0.3,0.0,0.1, COLOR='GRAY 50', DEVC_ID='timer7' /
&DEVC XYZ=..., ID='timer1', SETPOINT=1., QUANTITY='TIME', INITIAL_STATE=F /
&DEVC XYZ=..., ID='timer2', SETPOINT=2., QUANTITY='TIME', INITIAL_STATE=T /
&DEVC XYZ=..., ID='timer3', SETPOINT=3., QUANTITY='TIME', INITIAL_STATE=F /
&DEVC XYZ=..., ID='timer4', SETPOINT=4., QUANTITY='TIME', INITIAL_STATE=T /
&DEVC XYZ=..., ID='timer5', SETPOINT=5., QUANTITY='TIME', INITIAL_STATE=F /
&DEVC XYZ=..., ID='timer6', SETPOINT=6., QUANTITY='TIME', INITIAL_STATE=T /
&DEVC XYZ=..., ID='timer7', SETPOINT=6., QUANTITY='TIME', INITIAL_STATE=F /
```

模拟开始时，紫色障碍物中嵌入一个红色块。这个红色块实际上是一个洞，其初始状态为 F，即洞已被填满。同样在模拟开始时，可以看到一个粉红色的障碍物。1 秒后，红块消失。2 秒后，紫色障碍物上的空洞被绿色块填满。这个孔最初是真实的，即是空的。蓝色障碍物在 3 秒时出现，因为它的初始状态是假的，也就是说它最初并不存在。粉色障碍物在 4 秒时消失，因为它的初始状态为真，并且在 4 秒时状态发生了变化。5 秒时，黄色障碍物出现，其中有一个空洞和一个嵌入的灰色块。6 秒时，灰色块消失，因为它是一个最初为假的洞，因此在其父障碍物（黄色）创建时被灰色块填满。同样，在 6 秒钟时，黄色障碍物中原本存在的孔被黑色块填满，因为它是一个最初为空的孔，在其 DEVC 状态改变后被填满。在对障碍物和孔洞进行复杂的创建/删除方案之前，您应该先尝试一个简单的示例。

要多次创建和移除障碍物，可以将 LATCH=F 设置为循环数学函数（见第 18.5.1 节），如下图所示，或者使用 “CUSTOM ”控制功能（见第 18.5.5 节）。下面使用TIME作为 SIN 数学函数的输入。DEVC 值的符号会切换 OBST 的状态。

```fortran
&DEVC ID='t1', XYZ=..., QUANTITY='TIME', TIME_AVERAGED=F/
&CTRL ID='s1', FUNCTION_TYPE='SIN', INPUT_ID='t1'/
&DEVC ID='timer', XYZ=..., QUANTITY='CONTROL VALUE', CTRL_ID='s1', SETPOINT=0,
LATCH=F/
&OBST XB=..., DEVC_ID='timer'/
```

### Activating and Deactivating Vents

当设备或控制功能应用于VENT时，其目的是通过 DEVC_ID 激活或停用与VENT相关联的任何时间斜坡。例如，要控制风扇，请执行以下操作：

```fortran
&SURF ID='FAN', VOLUME_FLOW=5. /
&VENT XB=..., SURF_ID='FAN', DEVC_ID='det2' /
&DEVC ID='det2', XYZ=..., QUANTITY='TIME', SETPOINT=30., INITIAL_STATE=F /
```

请注意，在 30 秒时，“FAN ”的 “状态 ”从 F 变为 T，或者更简单地说，“FAN ”开启。由于没有与 “FAN ”相关的明确时间函数，默认的 1 秒斜坡上升将从 30 秒开始，而不是从 0 秒开始。如果 INITIAL_STATE（初始状态）=T，则风扇应在 30 秒时关闭。从本质上讲，“激活 ”VENT会导致所有相关的时间函数延迟，直到达到SETPOINT。VENT的 “停用 ”会关闭所有时间功能。这通常意味着 SURF 线路上的参数全部失效，因此最好通过一个简单的示例来检查其功能。

’MIRROR“或 ”OPEN "的VENT不应被激活或关闭。不过，您可以在OPEN’ VENT前放置障碍物，然后创建或移除障碍物，以模拟门窗的关闭或打开。

在某些情况下，您可能需要创建或移除附有通风口的障碍物。如果这些障碍物重叠在一起，就可能会混淆哪个VENT与哪个 OBST 相连。如果遇到这种情况，请给 OBST 一个 ID，并将此 OBST_ID 分配到通风口线路上。

## Advanced Control Functions: The CTRL Namelist Group

很多系统的功能都无法用一个简单的 “设定点 ”设备来描述。例如，一个典型的HVAC系统。该系统由一个恒温器控制，恒温器上有一个温度设定点。当温度低于设定值一定程度时，系统开启；当温度高于设定值一定程度时，系统关闭。这种行为不能仅通过指定一个设定点来定义。您还必须定义设定点周围的范围或 “死区”，以及温度升高或降低是否会激活系统。在HVAC示例中，越过死区的下边缘会激活加热；越过上边缘则会停用加热。这些更为复杂的行为可通过 CTRL 在 FDS 中建模。以下参数决定了控制功能的行为方式：

ID 控制功能的名称，在所有控制功能中唯一。

FUNCTION_TYPE 控制功能类型。可能的类型如表 18.2 所示。

INPUT_ID 作为控制功能输入的 DEVC 或 CTRL ID 列表。最多可指定 40 个输入。如果 DEVC 或 CTRL 被用作控制功能的 INPUT_ID，那么它必须在设备和控制功能中都具有唯一的 ID。此外，控制功能本身不能用作输入。

SETPOINT 控制函数状态发生变化时的值。这只适用于返回数值的函数。

TRIP_DIRECTION 正整数表示当控制功能的值上升超过设定点时，控制功能将改变状态；负整数表示当控制功能的值下降超过设定点时，控制功能将改变状态。默认值为 +1。

LATCH 如果该逻辑值设为 T，则控制功能只改变一次状态。默认为 LATCH=T。

INITIAL_STATE 控制功能的初始状态。默认为 F。例如，如果与控制功能相关的障碍物要消失，则在 DEVC 行设置 INITIAL_STATE=T。

对于可以指定 DEVC_ID 的任何对象（如 OBST 或 VENT），可以指定 CTRL_ID 代替。

如果要设计一个涉及多次状态变化的控制和设备系统，请在相关的 DEVC 或 CTRL 行中加入属性 LATCH=F。默认情况下，设备和控制器只能改变一次状态，如自动喷水灭火器启动或烟雾探测器报警。默认情况下，设备和控制器都使用 LATCH=T。

如果希望 DEVC 根据 CTRL 的逻辑状态运行，请设置 QUANTITY='CONTROL'，并将 CTRL_ID 设为控制功能的 ID。

数值控制功能的输出值由 QUANTITY='CONTROL VALUE' 的 DEVC 行定义，CTRL_ID 设置为控制功能的 ID。然后，可以使用 SETPOINT 使 DEVC 操作控制功能的特定输出值。该输出值不能用于纯逻辑控制功能，其唯一输出是 ANY 或 DEADBAND 等逻辑状态。对于 CUSTOM，输出值将是 RAMP 函数的值，而对于 TIME_DELAY，输出值将是已评估的延迟。

控制功能的每次状态变化都会记录到日志文件中，参见第 27.5 节。

<center>Table 18.2: Control function types.</center>

![image-20241222153644726](./../FUG6.9.1翻译.assets/image-20241222153644726.png)

### Control Functions: ANY, ALL, ONLY, and AT_LEAST

假设您希望在一个房间的四个烟雾探测器中的任何一个启动后，移除一个障碍物（例如打开一扇门）。请使用以下形式的输入行

```fortran
&OBST XB=..., SURF_ID='...', CTRL_ID='SD' /
&DEVC XYZ=1,1,3, PROP_ID='Acme Smoker', ID='SD_1' /
&DEVC XYZ=1,4,3, PROP_ID='Acme Smoker', ID='SD_2' /
&DEVC XYZ=4,1,3, PROP_ID='Acme Smoker', ID='SD_3' /
&DEVC XYZ=4,4,3, PROP_ID='Acme Smoker', ID='SD_4' /
&CTRL ID='SD', FUNCTION_TYPE='ANY', INPUT_ID='SD_1','SD_2','SD_3','SD_4',
INITIAL_STATE=T /
```

控制功能 SD 的 INITIAL_STATE 为 T，表示最初存在障碍物。状态改变 "表示当任何烟雾探测器报警时，障碍物将被移除。默认情况下，控制功能 SD 的 INITIAL_STATE 为 F，即最初不存在障碍物。

假设您现在希望在房间内的四个烟雾探测器都启动后才创建障碍物（例如，门被关闭）。请使用以下形式的控制线

```fortran
&CTRL ID='SD', FUNCTION_TYPE='ALL', INPUT_ID='SD_1','SD_2','SD_3','SD_4' /
```

控制函数 AT_LEAST 和 ONLY 是 ANY 和 ALL 的概括。例如

```fortran
&CTRL ID='SD', FUNCTION_TYPE='AT_LEAST', N=3, INPUT_ID='SD_1','SD_2','SD_3','SD_4' /
```

**当至少有 3 个探测器启动时**，状态就会从 F 变为 T。请注意，在本示例和下面的示例中，参数 N 用于指定满足控制功能条件所需的激活设备数量。控制功能

```fortran
&CTRL ID='SD', FUNCTION_TYPE='ONLY', N=3, INPUT_ID='SD_1','SD_2','SD_3','SD_4' /
```

**当 3 个且仅有 3 个探测器启动时**，状态会从 F 变为 T。

### Control Function: TIME_DELAY

当 TIME_DELAY 控制函数的输入状态发生变化时，它将启动一个长度为 DELAY 的定时器。定时器到期时，TIME_DELAY 控制函数将改变状态。请注意，每次输入状态发生变化时，定时器都会启动；因此，如果在第一个定时器结束前输入状态发生第二次变化，定时器将被重置。通过该功能，FDS 可以模拟设备激活与其他动作发生之间的时间延迟，如干式管道喷淋灭火系统。

```fortran
&DEVC XYZ=2,2,3, PROP_ID='Acme Sprinkler_link', QUANTITY='LINK TEMPERATURE',
ID='Spk_29_link' /
&DEVC XYZ=2,2,3, PROP_ID='Acme Sprinkler', QUANTITY='CONTROL', ID='Spk_29',
CTRL_ID='dry pipe' /
&CTRL ID='dry pipe', FUNCTION_TYPE='TIME_DELAY', INPUT_ID='Spk_29_link', DELAY=30. /
```

自动喷水灭火系统与管道之间的这种关系意味着自动喷水灭火系统的喷水是由 “dry pipe ”控制的（在本例中是延迟的），在水从喷头流出之前，Spk_29 的激活时间（由 Spk_29_link 测得）增加了 30 秒。

### Control Function: DEADBAND

该控制功能的作用类似于HVAC恒温器。它可以在类似于加热或制冷的两种模式下运行。该函数有一个 INPUT_ID（即函数使用的 DEVC 值）、一个上限和下限 SETPOINT 以及 ON_BOUND 指定的运行模式。如果 ON_BOUND=“LOWER”，当 INPUT_ID 的值低于 SETPOINT 的下限值时，函数将从初始状态（INITIAL_STATE）开始改变状态；当 INPUT_ID 的值超过 SETPOINT 的上限值时，函数将恢复初始状态，即类似于加热系统。如果 ON_BOUND='UPPER'，则会出现相反的情况，即冷却系统。

对于HVAC系统，以下输入行将设置一个简单的恒温器：

```fortran
&SURF ID='FAN', TMP_FRONT=40., VOLUME_FLOW=-1. /
&VENT XB=-0.3,0.3,-0.3,0.3,0.0,0.0, SURF_ID='FAN', CTRL_ID='thermostat' /
&DEVC ID='TC', XYZ=2.4,5.7,3.6, QUANTITY='TEMPERATURE' /
&CTRL ID='thermostat', FUNCTION_TYPE='DEADBAND', INPUT_ID='TC',
ON_BOUND='LOWER', SETPOINT=23.,27., LATCH=F/
```

在这里，我们要控制的是模拟FAN的VENT，它将热空气吹入房间。一个名为 TC 的 DEVC 位于房间内，用于测量温度。当温度低于 23 ℃（ON_BOUND='LOWER'）时，恒温器使用 SETPOINT 打开风扇；当温度高于 27 ℃ 时，恒温器关闭风扇。

注意，死区控制器需要将 LATCH 设置为 F

### Control Function: RESTART and KILL

有时，您可能只想运行一次模拟，直到达到某个目标，或者您可能想创建某个基线条件，然后运行该基线的多种排列组合。例如，您可能想运行一系列模拟，一旦探测器报警，就测试不同的缓解策略。使用重启（RESTART）控制功能，您可以在满足所需的条件后创建一个重启文件。仿真可以继续进行，重启文件可以复制，以便拥有各种排列组合的作业识别字符串 CHID（当然，前提是遵守使用重启文件的常规限制）。一旦满足所需的条件，使用 KILL 控制功能即可停止 FDS。如果既要写入重启文件，又要停止 FDS，则需要在使用这两个函数时使用相同的 INPUT_ID。例如

```fortran
&DEVC ID='temp', QUANTITY='TEMPERATURE', SETPOINT=1000., XYZ=4.5,6.7,3.6 /
&DEVC ID='velo', QUANTITY='VELOCITY', SETPOINT=10., XYZ=4.5,6.7,3.6 /
&CTRL ID='kill', FUNCTION_TYPE='KILL', INPUT_ID='temp' /
&CTRL ID='restart', FUNCTION_TYPE='RESTART', INPUT_ID='velo' /
```

当给定点的温度上升超过 1000 ◦C 时，将终止工作；或者当给定点的速度超过 10 米/秒时，只强制输出重启文件。下列行

```fortran
&DEVC ID='temp', QUANTITY='TEMPERATURE', SETPOINT=1000., XYZ=4.5,6.7,3.6 /
&CTRL ID='kill', FUNCTION_TYPE='KILL', INPUT_ID='temp' /
&CTRL ID='restart', FUNCTION_TYPE='RESTART', INPUT_ID='temp' /
```

会在给定点的温度上升到 1000 ℃ 以上时杀死任务，并写入重启文件。

### Control Function: CUSTOM

对于大多数控制功能类型，设备和控制功能的逻辑（真/假）输出以及它们上次改变状态的时 间都被用作输入。CUSTOM 功能使用 DEVC 的数值输出和 RAMP 来确定功能的输出。当 DEVC 值的 RAMP 输出为负值时，CTRL 将具有其初始状态的值。当 DEVC 值的 RAMP 输出为正值时，CTRL 将具有与其初始状态相反的值。在下面的例子中，CUSTOM 控制功能使用定时器设备的数字输出作为输入。当 RAMP_ID 指定的斜坡参数 F 值为正值时，函数返回 true（INITIAL_STATE 的默认值为 F）；当 RAMP F 值为负值时，函数返回 false。在这种情况下，控制将从假状态开始，并在计时器计时到 60 秒时切换为真状态。然后它将保持为真状态，直到计时器计时到 120 秒，然后再变回假值。

请注意，在使用控制功能时，分配给 CTRL 和 DEVC 输入的 ID 在两组输入中必须是唯一的，也就是说，不能对控制功能和设备使用相同的 ID。通过使用基于时间的CUSTOM控制功能，您可以使风扇以固定的周期运行：

```fortran
&SURF ID='FAN', TMP_FRONT=40., VOLUME_FLOW=-1. /
&VENT XB=-0.3,0.3,-0.3,0.3,0.0,0.0, SURF_ID='FAN', CTRL_ID='cycling timer' /
&DEVC ID='TIMER', XYZ=2.4,5.7,3.6, QUANTITY='TIME' /
&CTRL ID='cycling timer', FUNCTION_TYPE='CUSTOM', INPUT_ID='TIMER', RAMP_ID='cycle' /
&RAMP ID='cycle', T= 59, F=-1 /
&RAMP ID='cycle', T= 61, F= 1 /
&RAMP ID='cycle', T=119, F= 1 /
&RAMP ID='cycle', T=121, F=-1 /
```

在上述示例中，风扇最初处于关闭状态，60 秒后打开，120 秒后关闭。
您可以使用以下几行让障碍物多次出现和消失:

```fortran
&OBST XB=..., SURF_ID='whatever', CTRL_ID='cycling timer' /
&DEVC ID='TIMER', XYZ=..., QUANTITY='TIME' /
&CTRL ID='cycling timer', FUNCTION_TYPE='CUSTOM', INPUT_ID='TIMER', RAMP_ID='cycle' /
&RAMP ID='cycle', T= 0, F=-1 /
&RAMP ID='cycle', T= 59, F=-1 /
&RAMP ID='cycle', T= 61, F= 1 /
&RAMP ID='cycle', T=119, F= 1 /
&RAMP ID='cycle', T=121, F=-1 /
```

在上述情况下，最初会移除障碍物，然后在 60 秒时添加障碍物，并在 120 秒时再次移除障碍物。
在尝试一个案例之前，先用一个简单的案例对这些组合进行试验，以确保 FDS 确实达到预期效果。

### Control Function: Math Operations

执行简单数学运算（SUM、SUBTRACT、MULTIPLY、DIVIDE、POWER 等）的控制函数可以指定一个常量值作为其输入之一。具体方法是将其中一个 INPUT_ID 指定为 “CONSTANT”，并使用输入 CONSTANT 提供数值。例如，下面的输入代表一个控制函数，当速度的平方超过 10 时，该函数的状态将发生变化（有关 TRIP_DIRECTION 的解释，请参见第 18.4 节）。

```fortran
&DEVC ID='SPEED SENSOR', XYZ=..., QUANTITY='VELOCITY' /
&CTRL ID='multiplier', FUNCTION_TYPE='POWER',
INPUT_ID='SPEED SENSOR','CONSTANT', CONSTANT=2., SETPOINT=10.,
TRIP_DIRECTION=1 /
```

### Control Function: PID Control Function

PID（比例积分微分）控制功能是一种常用的反馈控制器，用于控制电气和机械系统。该功能计算过程变量与期望设定点之间的误差。PID 功能的目标是将误差最小化。PID 控制函数的计算公式为
$$
u(t)=K_\mathrm{p}e(t)+K_\mathrm{i}\int_0^te(t)\mathrm{d}t+K_\mathrm{d}\frac{\mathrm{d}e(t)}{\mathrm{d}t}
$$
其中，$K_p$、$K_i$ 和$ K_d$ 分别是比例加权系数PROPORTIONAL_GAIN、积分加权系数INTEGRAL_GAIN和差分加权系数DIFFERENTIAL_GAIN；e(t) 是输入标识INPUT_ID减去目标值TARGET_VALUE后得到的误差；u(t) 是输出值。

**Example Case: using PID for time integration of mass loss rate**

PID 控制器可用于对热解表面的质量损失进行时间积分。首先，使用 SPATIAL_STATISTIC='SURFACE INTEGRAL' 的 DEVC 作为 PID 控制器的输入。省略 TARGET_VALUE（默认为 0），输入变为误差函数 e(t)。将 INTEGRAL_GAIN 设为 1，其他增益设为 0。然后将 PID 输出发送至 DEVC，以获得 “CONTROL VALUE”。下面是语法示例：

```fortran
&DEVC ID='MY MLR', XB=..., QUANTITY='BURNING RATE', SURF_ID='s1',
SPATIAL_STATISTIC='SURFACE INTEGRAL'/
&CTRL ID='MY PID', FUNCTION_TYPE='PID', INPUT_ID='MY MLR',
PROPORTIONAL_GAIN=0, DIFFERENTIAL_GAIN=0, INTEGRAL_GAIN=1/
&DEVC ID='PYROLYZATE', XYZ=..., QUANTITY='CONTROL VALUE', CTRL_ID='MY PID'/
```

在这里，_devc.csv 文件中 “PYROLYZATE ”列的单位是千克。

**Special Case: using PID for controlling momentum**

PID 控制器可用于调节平均动量源项，以实现与动量相关的各种输出目标。一个简单的例子就是控制通道中的体积流量。在下文中，我们将监控平均流速，并设置 CONTROL_FORCE(1)=T，为 x 动量方程添加一个源项（y 和 z 分别使用 2 和 3）。其结果类似于手动调节 FORCE_VECTOR(1)，以达到所需的流速。在下面的例子中，PID 控制器将使平均体积流量保持在 10 m/s 的 TARGET_VALUE 值附近。

```fortran
&DEVC ID='Ub', XB=..., QUANTITY='U-VELOCITY', SPATIAL_STATISTIC='MEAN'/
&CTRL ID='MY PID', FUNCTION_TYPE='PID', TARGET_VALUE=10, INPUT_ID='Ub',
PROPORTIONAL_GAIN=0.1, CONTROL_FORCE(1)=T/
&DEVC ID='FORCE X', XYZ=..., QUANTITY='CONTROL VALUE', CTRL_ID='MY PID'/
```

### Control Function: PERCENTILE

考虑累积分布函数 F(x)：
$$
F(x)=\int_{-\infty}^xf(x^{\prime})\mathrm{d}x^{\prime}\left/\int_{-\infty}^\infty f(x^{\prime})\mathrm{d}x^{\prime}\right.
$$
PERCENTILE 控制函数返回 F(x) = p 的 x 值，其中 p 是介于 0 和 1 之间的值。 在离散形式中，函数 f (x) 由 1 ≤ i ≤ N 的成对 $(x_i, f_i) $表示。第 p 个百分位数的计算公式为:
$$
x(p)=\bar{x}_{k-1}+(\bar{x}_k-\bar{x}_{k-1})\frac{pF_N-F_{k-1}}{F_k-F_{k-1}}
$$
其中，
$$
F_k=\sum_{i=1}^kf_i\delta\bar{x}_i\quad;\quad\bar{x}_i=\frac{x_{i+1}+x_i}{2}\quad;\quad\delta\bar{x}_i=\bar{x}_i-\bar{x}_{i-1}\quad;\quad k=\min_n\left(F_n>pF_N\right)
$$
假设值 xi 是离散函数的中点；也就是说，fi 是函数在区间 $(\bar{x}_{i-1},\bar{x}_{i})$ 上的平均值。
**PERCENTILE 函数可用于计算火焰高度**。请考虑以下输入行：

```fortran
&DEVC XB=0,0,0,0,0.05,4.95, QUANTITY='HRRPUL', POINTS=50, Z_ID='z', ID='qdot' /
&CTRL ID='pct', FUNCTION_TYPE='PERCENTILE', INPUT_ID='qdot', PERCENTILE=0.95 /
&DEVC ID='L_F', XYZ=0,0,0, QUANTITY='CONTROL VALUE', CTRL_ID='pct', UNITS='m' /
```

第一条 DEVC 线表示 “HRRPUL ”或单位长度热释放率（千瓦/米）的垂直剖面。这 50 个数值是对两个水平方向上的单位体积热释放率进行积分后得出的。CTRL 功能在 0.05 米到 4.95 米之间的 50 个均匀分布的高度上提取这 50 个值，并计算出火灾能量释放到 95% 的高度。请注意，对于 10 厘米网格，垂直阵列的点位于单元中心，这也是上述离散积分的原因。第二行 DEVC 只是将控制函数计算出的值打印到时间历史记录文件 CHID_devc.csv。HRRPUL "的 50 个值被时间平均化并写入文件 CHID_line.csv。请注意，写入 CHID_devc.csv 的火焰高度是打印输出之间时间间隔的时间平均值。如果将 DT_DEVC 设为很小的值（即小于时间步长），则将获得瞬时火焰高度的时间历史记录。

### Combining Control Functions: A Deluge System

对于淹没式自动喷水灭火系统，当检测事件发生时，通常干燥的自动喷水灭火管道会被淹没。在本例中，检测事件是四个烟雾探测器中的两个报警。淹没管网需要 30 秒。喷嘴是一个名为 “NOZZLE 1 ”的 DEVC，由名为 “nozzle trigger ”的 CTRL 控制。当检测和延时都发生时，喷嘴才会启动。请注意，DEVC 是以 QUANTITY='CONTROL' 指定的。

```fortran
&DEVC XYZ=1,1,3, PROP_ID='Acme Smoker', ID='SD_1' /
&DEVC XYZ=1,4,3, PROP_ID='Acme Smoker', ID='SD_2' /
&DEVC XYZ=4,1,3, PROP_ID='Acme Smoker', ID='SD_3' /
&DEVC XYZ=4,4,3, PROP_ID='Acme Smoker', ID='SD_4' /
&DEVC XYZ=2,2,3, PROP_ID='Acme Nozzle', QUANTITY='CONTROL',
ID='NOZZLE 1', CTRL_ID='nozzle trigger' /
&CTRL ID='nozzle trigger', FUNCTION_TYPE='ALL', INPUT_ID='smokey','delay' /
&CTRL ID='delay', FUNCTION_TYPE='TIME_DELAY', INPUT_ID='smokey', DELAY=30. /
&CTRL ID='smokey', FUNCTION_TYPE='AT_LEAST', N=2,
INPUT_ID='SD_1','SD_2','SD_3','SD_4' /
```

**Example Case: control_test_2**

control_test_2 示例演示了数学和 PID 控制功能的使用。定义了两个隔间，左侧隔间初始化为 20 ◦C，右侧隔间初始化为 10 ◦C。控制功能定义为

- 将两个隔间的温度相加
- 用左侧隔间温度减去右侧隔间温度
- 左手温度乘以 0.5
- 用左手温度除以右手温度
- 取右手温度的平方根
- 将时间作为目标值为 5 的 PID 函数的输入，$K_p=-0.5$，$K_i=0.001$，$K_d=1$

```fortran
&CTRL ID='Add',FUNCTION_TYPE='SUM',INPUT_ID='LHS Temp','RHS Temp'/
&CTRL ID='Subtract',FUNCTION_TYPE='SUBTRACT',INPUT_ID='RHS Temp','LHS Temp'/
&CTRL ID='Multiply',FUNCTION_TYPE='MULTIPLY',INPUT_ID='LHS
Temp','CONSTANT',CONSTANT=0.5/
&CTRL ID='Divide',FUNCTION_TYPE='DIVIDE',INPUT_ID='LHS Temp','RHS Temp'/
&CTRL ID='Power',FUNCTION_TYPE='POWER',INPUT_ID='RHS Temp','CONSTANT',CONSTANT=0.5/
&CTRL ID='PID',FUNCTION_TYPE='PID',INPUT_ID='Time',TARGET_VALUE=5.,
PROPORTIONAL_GAIN=-0.5,INTEGRAL_GAIN=0.001,DIFFERENTIAL_GAIN=1./
```

结果展示在图18.7。

![image-20241222165459576](./../FUG6.9.1翻译.assets/image-20241222165459576.png)

### Combining Control Functions: A Dry Pipe Sprinkler System

对于干管水喷淋管道系统，通常是用气体对干燥的水喷淋管道加压。当自动喷水灭火系统中的一个喷头启动时，压降会让水流入管网。在此示例中，一旦喷淋器连接装置启动，需要 30 秒钟才能使管网进水。运行所需的事件顺序是：首先必须启动ANY一个链接，从而启动 30 秒的时间延迟（TIME_DELAY）。30 秒延时结束后，每个具有激活链接的喷嘴、ALL控制功能都将开始喷水。

```fortran
&DEVC XYZ=2,2,3, PROP_ID='Acme Sprinkler Link', ID='LINK 1' /
&DEVC XYZ=2,3,3, PROP_ID='Acme Sprinkler Link', ID='LINK 2' /
&PROP ID='Acme Sprinkler Link', QUANTITY='LINK TEMPERATURE',
ACTIVATION_TEMPERATURE=74., RTI=30./
&DEVC XYZ=2,2,3, PROP_ID='Acme Nozzle', QUANTITY='CONTROL',
ID='NOZZLE 1', CTRL_ID='nozzle 1 trigger' /
&DEVC XYZ=2,3,3, PROP_ID='Acme Nozzle', QUANTITY='CONTROL',
ID='NOZZLE 2', CTRL_ID='nozzle 2 trigger' /
&CTRL ID='check links', FUNCTION_TYPE='ANY', INPUT_ID='LINK 1','LINK 2'/
&CTRL ID='delay', FUNCTION_TYPE='TIME_DELAY', INPUT_ID='check links', DELAY=30. /
&CTRL ID='nozzle 1 trigger', FUNCTION_TYPE='ALL', INPUT_ID='delay','LINK 1'/
&CTRL ID='nozzle 2 trigger', FUNCTION_TYPE='ALL', INPUT_ID='delay','LINK 2'/
```

### Example Case: activate_vents

名为 activate_vents 的简单测试用例演示了几个控制功能。图 18.8 显示了七个不同颜色的通风口，它们会根据特定的定时或控制功能在不同的时间激活。

![image-20241222165639393](./../FUG6.9.1翻译.assets/image-20241222165639393.png)

## Controlling a RAMP

### Changing the Independent Variable

对于任何用户定义的 RAMP，正常的自变量（例如 RAMP_V 的时间）都可以用 DEVC 的输出来代替。具体做法是在 RAMP 输入线之一指定输入 DEVC_ID。此时，DEVC 的当前输出将被用作 RAMP 的自变量。只要控制功能输出的是数值（即数学函数（第 18.5.6 节）或 PID 函数（第 18.5.7 节）），也可以指定 CTRL_ID。在下面的示例中，鼓风机从 20 ◦C 时的 0 % 流量升至温度超过 100 ◦C 时的 50 % 流量，再升至温度超过 200 ◦C 时的 100 % 流量。这与 CUSTOM 控制功能类似，但它允许可变响应，而不仅仅是开或关。

```fortran
&SURF ID='BLOWER', VEL=-2, RAMP_V='BLOWER RAMP' /
&DEVC XYZ=2,3,3, QUANTITY='TEMPERATURE', ID='TEMP DEVC' /
&RAMP ID='BLOWER RAMP', T= 20,F=0.0, DEVC_ID='TEMP DEVC' /
&RAMP ID='BLOWER RAMP', T=100,F=0.5 /
&RAMP ID='BLOWER RAMP', T=200,F=1.0 /
```

### Changing the Dependent Variable

如果在 RAMP 输入中指定了 DEVC_ID_DEP 或 CTRL_ID_DEP，任何 DEVC 或数学 CTRL 的输出都可以用来代替 RAMP。在任一输入中，DEVC 或 CTRL 的数值都将用作 RAMP 输出。例如，利用控制功能内置的数学函数，可以指定正弦函数：
$$
f(t)=\sin\left(\frac{2\pi(t-5)}{10}\right)
$$
通过以下行：

```fortran
&DEVC ID='t', QUANTITY='TIME', XYZ=0,0,0 /
&CTRL ID='t-t0', FUNCTION_TYPE='SUM', INPUT_ID='t','CONSTANT', CONSTANT=-5. /
&CTRL ID='2*pi*(t-t0)/10', FUNCTION_TYPE='MULTIPLY', INPUT_ID='CONSTANT','t-t0',
CONSTANT=0.62831853 /
&CTRL ID='sin(2*pi*(t-t0)/10)', FUNCTION_TYPE='SIN', INPUT_ID='2*pi*(t-t0)/10' /
&RAMP ID='ramp sin', CTRL_DEP_ID='sin(2*pi*(t-t0)/10)' /
```

该函数如图18.9所示。

![image-20241222165923332](./../FUG6.9.1翻译.assets/image-20241222165923332.png)

### Freezing the Output Value, Example Case: hrr_freeze

在某些情况下，您可能希望 RAMP 的值停止更新。例如，如果您在一个装有自动喷水灭火装置的房间内模拟火势蔓延，您可能希望在火势上方的自动喷水灭火装置启动时停止火势蔓延。要实现这种操作，可以将 RAMP 的输入更改为 DEVC（请参阅上一节），然后为 DEVC 赋予 NO_UPDATE_DEVC_ID 或 NO_UPDATE_CTRL_ID。当指定控制器的状态变为 T 时，将导致 DEVC 停止更新其值。由于 DEVC 被用作 RAMP 的自变量，因此 RAMP 的输出将保持不变。下面的示例说明了这一点。在 50 秒内，对一场火灾进行从 0 到 1000 kW/m2 的线性 RAMP。RAMP 不使用模拟时间，而是使用 DEVC 来计算时间。当另一个 DEVC 测量时间达到 200 ℃ 时，定时器被设置为冻结。图 18.10 显示了这些输入在测试用例 hrr_freeze 中的结果，可以看出一旦气体温度达到 200 ◦C，热解速率就会停止上升。

```fortran
&SURF ID='FIRE', HRRPUA=1000., RAMP_Q='FRAMP', COLOR='ORANGE'/
&RAMP ID='FRAMP', T= 0, F=0, DEVC_ID='FREEZE TIME'/
&RAMP ID='FRAMP', T=50, F=1/
&DEVC XYZ=..., QUANTITY='TEMPERATURE', SETPOINT=200., INITIAL_STATE=F,
ID='TEMP'/
&DEVC XYZ=..., QUANTITY='TIME', NO_UPDATE_DEVC_ID='TEMP', ID='FREEZE TIME'/
```

![image-20241222170143063](./../FUG6.9.1翻译.assets/image-20241222170143063.png)

需要注意的是，设备是按照输入文件中列出的顺序依次更新的，不同网格中的设备在一个时间步结束前不会共享数值。这就意味着，如果被冻结的设备位于不同的网格上，或者列在冻结设备之前，那么在下一个时间步之前它都不会被冻结。

## Visualizing FDS Devices in Smokeview

本节概述了 Smokeview 可以绘制的各种对象以及如何自定义其外观。更多技术细节请参阅 Smokeview 用户指南 [^17]。

### Devices that Indicate Activation

自动喷水灭火器和烟雾探测器等设备可以通过两种方式之一来显示已激活。当 FDS 确定某个设备已激活时，它会在 .smv 文件中放置一条信息，说明对象编号、激活时间和状态（0 表示未激活或 1 表示激活）。然后 Smokeview 绘制相应的对象。有关图像，请参见表 18.3 和表 18.4。

PROP 行中的字符串 SMOKEVIEW_ID 将 FDS 设备与 Smokeview 对象关联起来。例如，下面几行指示 Smokeview 将设备绘制成 “target ”形状：

```fortran
&PROP ID='my target', SMOKEVIEW_ID='target' /
&DEVC XYZ=0.5,0.8,0.6, QUANTITY='TEMPERATURE', PROP_ID='my target' /
```

<center>Table 18.3: Single frame static objects</center>

![image-20241222170627365](./../FUG6.9.1翻译.assets/image-20241222170627365.png)

<center>Table 18.4: Dual frame static objects</center>

![image-20241222170654430](./../FUG6.9.1翻译.assets/image-20241222170654430.png)

![image-20241222170714777](./../FUG6.9.1翻译.assets/image-20241222170714777.png)

### Devices with Variable Properties

可以使用 PROP 行中名为 SMOKEVIEW_PARAMETERS 的字符串数组指定的数据修改 Smokeview 对象的外观。例如，输入行

```fortran
&PROP ID='ballprops', SMOKEVIEW_ID='ball',
SMOKEVIEW_PARAMETERS(1:6)='R=255','G=0','B=0','DX=0.5','DY=0.25','DZ=0.1' /
&DEVC XYZ=0.5,0.8,1.5, QUANTITY='TEMPERATURE', PROP_ID='ballprops' /
```

创建一个 x、y 和 z 轴直径分别为 0.5 米、0.25 米和 0.1 米的红色椭圆体。请注意，这些参数都用单引号括起来，因为它们是传递给 Smokeview 的字符串。

表 18.5 列出了具有可变属性的对象。请注意，tsphere 对象使用纹理贴图或图像来改变其外观。纹理贴图是通过在纹理文件名前添加 t% 字符来指定的，例如 t%texturefile.jpg。

<center>Table 18.5: Dynamic Smokeview objects</center>

![image-20241222170919087](./../FUG6.9.1翻译.assets/image-20241222170919087.png)

![image-20241222170935434](./../FUG6.9.1翻译.assets/image-20241222170935434.png)

### Objects that Represent Lagrangian Particles

拉格朗日粒子（如水滴或小固体颗粒）在 Smokeview 中表示为微小的点。不过，也可以用其他方式绘制拉格朗日粒子，如表 18.6 所示。例如，以下线条定义的粒子代表 10 厘米长、直径 1.24 厘米的电缆线段：

```fortran
&PART ID='cables', QUANTITIES(1)='PARTICLE TEMPERATURE', ..., PROP_ID='cable image' /
&PROP ID='cable image', SMOKEVIEW_ID='tube', SMOKEVIEW_PARAMETERS='L=0.1','D=0.0124' /
```

默认情况下，电缆颜色为黑色，但您也可以使用 R、G 和 B 参数指定自己的默认颜色。此外，您还可以根据 PART行中列出的 QUANTITIES为粒子着色。Smokeview 中的菜单允许您在各种颜色选项之间切换。

您可以使用 “RANDXY=1 ”等参数控制 “tube ”对象的方向，使圆柱体在 x-y 平面上随机绘制。参数为 U-VEL、V-VEL 和 W-VEL 的对象会根据与移动粒子相关的速度分量进行拉伸。

<center>Table 18.6: Dynamic Smokeview objects for Lagrangian particles</center>

![image-20241222171202208](./../FUG6.9.1翻译.assets/image-20241222171202208.png)

![image-20241222171221938](./../FUG6.9.1翻译.assets/image-20241222171221938.png)

## External Control of FDS (Beta)

在模拟运行时，可以从外部控制 FDS 模拟的某些方面。任何以 RAMP_ID 或 CTRL_ID 作为输入的 FDS 输入都可以进行外部控制。通过在 RAMP 上设置 EXTERNAL_FILE，可以从外部控制 RAMP。通过设置 FUNCTION_TYPE=“EXTERNAL”，可以从外部控制 CTRL。

选择外部控制时，FDS 将根据一个 csv 文件中的值设置 RAMP 值或 CTRL 的逻辑状态，该文件的名称由 MISC 上的 EXTERNAL_FILENAME 指定。该文件将每隔 DT_EXTERNAL on TIME 秒钟检查一次，以获取新值。只有那些数值正在更改的输入才需要指定。对于未指定的输入值，或者文件不存在或无法打开（例如在文件写入过程中被操作系统锁定），将保留当前值。初始值通过 RAMP 的 INITIAL_VALUE 或 CTRL 的 INITIAL_STATE 来定义。

csv 文件格式为

```fortran
Type(1), ID(1), Value(1)
Type(2), ID(2), Value(2)
.
.
```

其中，Type 是 RAMP 或 CTRL，ID 是 FDS 输入文件中的相应 ID，Value 是 RAMP 的新输出值或 CTRL 的新逻辑状态，正值表示 CTRL 评估为 TRUE，负值表示函数评估为 FALSE。

下面是一组输入示例：

```fortran
&MISC EXTERNAL_FILENAME='external_test_input.csv'/
&TIME T_END=10,DT_EXTERNAL=5/
&OBST XB=0.0,0.1,0,1,0,1/
&VENT XB=0.1,0.1,0,1,0,1,SURF_ID='FLOW',CTRL_ID='VENT CTRL'/
&SURF ID='FLOW',VEL=-1,COLOR='BLUE',TAU_V=0/
&CTRL ID='VENT CTRL',FUNCTION_TYPE='EXTERNAL',INITIAL_STATE=T/
&VENT XB=2,2,0,1,0,1,SURF_ID='HOT'/
&SURF ID='HOT',TMP_FRONT=1000,RAMP_T='T RAMP',COLOR='RED'/
&RAMP ID='T RAMP',EXTERNAL_FILE=T,INITIAL_VALUE=0.081633/
```

在这些输入中，一个具有固定速度的通风口由一个初始为 TRUE 的 CTRL 外部控制，一个具有固定温度的通风口由一个初始斜坡值为 100 ◦C (:question:这为啥是100℃）的 RAMP 外部控制。这些通风口应用于 1 立方米箱体的两个面。5 秒钟后，读取 csv 文件的内容：

```fortran
RAMP,"T RAMP" , 1
CTRL,"VENT CTRL",-1
```

这将关闭速度通风口（负 CTRL 值表示将状态设置为 .FALSE.），并将固定温度通风口设置为 1000 ◦C（RAMP 值为 1 表示应用 TMP_FRONT 的全部值）。请注意，ID 字符串是用引号括起来的。只有在字符串中有空格或逗号时才需要这样做。运行结果如图 18.11 所示

![image-20241222171557674](./../FUG6.9.1翻译.assets/image-20241222171557674.png)

# Numerical Considerations



****

[^18-1]:请注意，将遮蔽率从 %/ft 单位转换为 %/m 单位的公式如下：$O[\%/\mathfrak{m}]=\left[1-\left(1-\frac{O[\%/\mathfrak{ft}]}{100}\right)^{3.28}\right]\times100$

# Alphabetical List of Input Parameters



# Error Codes



<center>Part III</center>

<center>FDS and Smokeview Development Tools</center>

# The FDS and Smokeview Repositories

对于有兴趣获取 FDS 和 Smokeview 源代码的用户，无论是用于开发工作还是在特定平台上进行编译，我们都强烈建议您将 FDS 和 Smokeview 源代码下载到您的计算机上。所有项目文件都使用在线工具 GitHub 维护，这是一项支持开源应用软件开发的免费服务。GitHub 使用 Git 版本控制软件。在该系统下，一个包含所有项目文件的集中式资源库位于 GitHub 服务器上。任何人都可以获取该版本库的副本或检索该版本库的特定修订版。不过，只有 FDS 和 Smokeview 开发人员可以直接向版本库提交修改。其他人必须提交 “拉取请求”。有关查看 FDS 资源库的详细说明，请访问 https://github.com/firemodels/fds。

FDS 和 Smokeview 都位于 GitHub 上一个名为 “firemodels ”的组织中。该组织的当前位置是 https://github.com/firemodels。下面列出了 FDS 和 Smokeview 项目使用的软件源以及简要说明：

- fds   FDS 源代码、验证和确认测试、维基和文档
- smv   Smokeview 源代码、集成测试和文档
- exp   用于 FDS 验证的实验数据储存库
- fig   各种手册使用的图片
- out   用于验证的 FDS 输出结果
- bot   Firebot（持续集成系统）源代码
- fds-smv   网页 html 源代码

fds 资源库中的维基页面对描述如何使用资源库资产的细节特别有用。

# Compiling FDS

如果要运行计算的机器上已经存在 FDS 的编译版本，并且没有对原始源代码进行任何修改，则不需要重新编译代码。例如，fds.exe 文件是 Windows PC 的编译程序；因此 PC 用户不需要 Fortran 编译器，也不需要编译源代码。对于尚未编译可执行文件的计算机，您必须编译代码。**需要使用符合 Fortran 2018 标准的编译器**。

## FDS Source Code

表 26.1 列出了构成 FDS 源代码的文件。后缀为“.f90 ”的文件包含符合 ANSI 和 ISO 标准（2018 年版）的自由格式 Fortran 90 指令，符合 ANSI 和 ISO 标准（2018 年版）。FDS [GitHub 代码库的 Build 目录](https://github.com/firemodels/fds/tree/master/Build)中提供了一个 makefile，其中包含特定平台的编译选项。请注意以下几点：

- 源代码完全由 Fortran 语句组成，分为 32 个文件。有些编译器有标准优化级别，还有不同程度的 “激进 ”优化。**在使用最高优化级别时要谨慎**。
- 要编译 FDS，需要使用 Fortran 编译器（2018 或更高）和 MPI 库。
- 要编译 ULMAT 和 UGLMAT 压力求解器的例程，**需要英特尔数学内核库 (MKL)**。

<center>Table 26.1: FDS source code files</center>

| File Name | Description                                                  |
| --------- | ------------------------------------------------------------ |
| ccib.f90  | Complex geometry physics routines                            |
| cons.f90  | Global arrays and constants                                  |
| ctrl.f90  | Definitions and routines for control functions               |
| data.f90  | Data for output quantities and thermophysical properties     |
| devc.f90  | Derived type definitions and constants for devices           |
| divg.f90  | Compute the flow divergence                                  |
| dump.f90  | Output data dumps into files                                 |
| fire.f90  | Combustion routines                                          |
| func.f90  | Global functions and subroutines                             |
| geom.f90  | Complex computational geometry engine                        |
| gsmv.f90  | Complex geometry visualization routines                      |
| hvac.f90  | Heating, Ventilation, and Air Conditioning                   |
| imkl.f90  | Bindings for the Intel MKL library                           |
| init.f90  | Initialize variables and Poisson solver                      |
| main.f90  | Main program                                                 |
| mass.f90  | Mass equation(s) and thermal boundary conditions             |
| mesh.f90  | Arrays and constants associated with each mesh               |
| part.f90  | Lagrangian particle transport and sprinkler activation       |
| pois.f90  | Poisson (pressure) solver                                    |
| prec.f90  | Specification of numerical precision                         |
| pres.f90  | Spatial discretization of pressure (Poisson) equation        |
| prop.f90  | Gas and liquid property data                                 |
| radi.f90  | Radiation solver                                             |
| rcal.f90  | Functions needed for radiation solver, including RadCal      |
| read.f90  | Read input parameters                                        |
| smvv.f90  | Routines for computing and outputting 3D smoke and isosurfaces |
| soot.f90  | Soot agglomeration and aerosol deposition                    |
| turb.f90  | Turbulence models and manufactured solutions                 |
| type.f90  | Derived type definitions                                     |
| vege.f90  | Experimental vegetation model                                |
| velo.f90  | Momentum equations                                           |
| wall.f90  | Wall boundary conditions                                     |

# Output File Formats

代码的输出包括文件 CHID.out，以及下文所述的各种数据文件。**这些输出文件大多由 dump.f90 中的子程序写出，很容易修改以适应各种绘图软件包**。

## Diagnostic Output (.out)

文件 CHID.out 包含诊断输出，其中包括各种重要数据，包括 CPU 使用率。通常情况下，每 100 个时间步打印出诊断信息如下：

```fortran
Time Step 137431 December 27, 2015 00:29:49
Step Size: 0.563E-01 s, Total Time: 1800.04 s
Pressure Iterations: 1
Maximum Velocity Error: 0.30E-01 on Mesh 1 at ( 0 44 3)
---------------------------------------------------------------
Max CFL number: 0.94E+00 at ( 1, 46, 1)
Max divergence: 0.13E+00 at ( 66, 12, 1)
Min divergence: -0.20E+00 at ( 66, 13, 1)
Max VN number: 0.51E+00 at ( 1, 25, 18)
No. of Lagrangian Particles: 27
Radiation Loss to Boundaries: 13.830 kW
```

时间步长表示迭代的总次数。日期和时间表示当前挂钟时间。步长（STEP SIZE）表示数值时间步长的大小。总时间（Total Time）表示计算到此时为止的总模拟时间。**压力迭代是指时间步长的校正器（后半段）压力求解器的迭代次数**。<font color=red>压力求解器迭代的目的是尽量减小实体壁或两个网格界面处速度法向分量的误差</font>。**最大速度误差（Maximum Velocity Error）表示该误差及其发生在哪个网格单元**。<u>最大/最小发散是函数$\nabla\cdot\mathbf{u}$ 的最大/最小值，并在流动不可压缩时用作诊断工具（即无加热）；Max CFL number是 CFL 数的最大值，是主要时间步长约束条件；Max VN number是 Von Neumann 数的最大值，是次要时间步长约束条件</u>。No. of Lagrangian Particles是指当前网格中的粒子数。Radiation Loss to Boundaries是指辐射到边界的能量。随着舱室升温，辐射到边界的能量会增加到Total Heat Release Rate的相当一部分。

成功运行后，每个子程序的 CPU 使用情况汇总将列在名为 CHID_cpu.csv 的文件中（第 27.6 节）。这有助于确定计算工作的主要方向。

## Heat Release Rate and Related Quantities (_hrr.csv)

火灾的热释放率以及其他与全局能量相关的数据会自动写入一个名为 CHID_hrr.csv 的文本文件中。文件格式如下

```fortran
s , kW , kW , ... , kg/s , Pa , Pa , ...
Time , HRR , Q_RADI , ... , BURN_RATE , ZONE_01 , ZONE_02 , ...
T(1) , VAL(1,1) , VAL(2,1) , ... , VAL(8,1) , VAL(9,1) , VAL(10,1) , ...
T(2) , VAL(1,2) , VAL(2,2) , ... , VAL(8,2) , VAL(9,2) , VAL(10,1) , ...
```

有关积分能量的详细信息，请参见第 22.10.1 节。BURN_RATE 是燃料的总质量损失率，ZONE_01 等是各压力区的背景压力。请注意，报告的 BURN_RATE 并未根据每种材料的燃烧热可能不同而进行调整。**它是 FDS 预测或您指定的燃料实际燃烧速率**。本底压力将在第 10.3 节中讨论。

## Device Output Data (_devc.csv)

与输入文件中命名表组 DEVC 下指定的特定设备（链路温度、烟雾遮蔽、热电偶等）相关的数据以逗号分隔格式输出，文件名为 CHID_devc.csv。文件格式如下

```fortran
s , UNITS(1) , UNITS(2) , ... , UNITS(N_DEVC)
Time , ID(1) , ID(2) , ... , ID(N_DEVC)
T(1) , VAL(1,1) , VAL(2,1) , ... , VAL(N_DEVC,1)
T(2) , VAL(1,2) , VAL(2,2) , ... , VAL(N_DEVC,2)
```

其中，N_DEVC 为设备数量，ID(I) 为用户定义的第 I 台设备的 ID，UNITS(I) 为单位，T(J) 为第 J 次转储的时间，VAL(I,J) 为第 I 台设备在第 J 次转储时的值。这些文件可以导入 Microsoft Excel 或几乎任何其他电子表格程序。如果设备列数超过 DEVC_COLUMN_LIMIT，文件将自动分割成更小的文件。

## Control Output Data

```fortran
s , status , status , ... , status
Time , ID(1) , ID(2) , ... , ID(N_CTRL)
T(1) , -001 , 001 , ... , -001
```

其中，N_CTRL 是控制器的数量，ID(I) 是用户定义的第 I 个控制函数的 ID，正负 1 表示第 I 个控制函数在特定时间的状态 -1 = F 和 +1 = T。这些文件可以导入 Microsoft Excel 或几乎任何其他电子表格程序。如果控制列数超过 CTRL_COLUMN_LIMIT，文件将自动分割成更小的文件。**输出频率由 DUMP 行上的 DT_CTRL 或 RAMP_CTRL 控制**。

## Device and Control Log File

每次设备或控制功能改变其逻辑状态时，都会以逗号分隔格式在名为 CHID_devc_ctrl_log.csv 的文件中记录一个事件。每次状态变化都会创建一行。文件格式如下：

```fortran
Time (s) , Type , ID , State , Value , Units
T(1) , Type(1) , ID(1) , State(1), Val(1), Units(1)
.
.
```

其中，第 I 个状态变化 T(I) 是状态变化的时间，Type(I) 是改变状态的项目类型（DEVC 或 CTRL），ID(I) 是项目的 ID，State(I) 是状态变化后项目的逻辑状态（T 表示 true 或 F 表示 false），Val(I) 是状态变化时的项目值，Units(I) 是与值相关的单位。逻辑控制函数（如 FUNCTION_TYPE、ALL、ANY、ONLY、AT_LEAST、X_OF_N、KILL 或 RESTART）不写值。对于 DEADBAND 和 CUSTOM 的 FUNCTION_TYPE，将写入函数的输入值。控制功能不写入单位值。如果设备或控制函数未定义 ID，则将写入设备或控制函数的编号（例如，如果项目是输入文件中的第 5 个设备，则将写入 5）。

## CPU Usage Data

名为 CHID_cpu.csv 的文件记录了每个 MPI 进程的 CPU 占用时间。

```fortran
Rank,MAIN,DIVG, ... , Total T_USED (s)
0, 2.052E+00, 1.058E+01, ... , 5.143+01
1, 2.432E+00, 1.062E+01, ... , 5.123+01
.
.
```

其中，“Rank ”是 MPI 进程的编号（从 0 开始），“MAIN”、“DIVG ”等是主要例程，“Total T_USED (s) ”是特定 MPI 进程消耗的 CPU 总时间。通常情况下，总时间是相似的。在 MAIN 中花费的时间实质上是开销--没有用于计算的时间。如果想知道工作负载是否平衡，可以看看在 MAIN 中花费的时间。所有 MPI 进程花费的时间应该差不多。如果其中一个 MPI 进程的 MAIN 值明显较小，则说明该进程正在执行核心例程，而其他进程在 MAIN 中处于闲置状态。

CHID_cpu.csv 文件将在模拟结束时打印出来。要强制在仿真期间定期打印，可在 DUMP 行设置 DT_CPU 或 RAMP_CPU。后一个参数允许您在指定时间写出文件。

## Time Step Data

名为 CHID_steps.csv 的文件记录了时间步长和 CPU 运行时间的数据。

```fortran
Time Step,Wall Time,Step Size,Simulation Time,CPU Time
1,2020-04-29T10:23:13.631-04:00, 0.100E+00, 0.10000, 0.23438
.
.
```

其中，Time Step（时间步长）为当前时间步长；Wall Time（墙上时间）为指定时间步长的日期和时间；Step Size（步长大小）为当前时间步长（以秒为单位）；Simulation Time（仿真时间）为当前仿真时间（以秒为单位）；CPU Time（CPU 时间）为启动 FDS 后的 CPU 运行时间。请注意，第一个时间步将包括读取输入文件和初始化 FDS 的时间。

## Gas Mass Data

在任何瞬间，各种气体的总质量都会在逗号分隔的文件 CHID_mass.csv 中报告。该文件由几列组成，第一列包含时间（以秒为单位），第二列包含计算域中所有气体种类的总质量（以千克为单位），接下来的行包含各个气体种类的总质量。

您必须明确要求生成该文件，因为生成该文件可能会耗费相当多的 CPU 时间。在 DUMP 行设置 MASS_FILE=T，以创建该输出文件。

## Slice Files (.sf)

命名列表组 SLCF 下定义的切分文件命名为 CHID_M_N.sf，其中 M 是网格索引，N 是数量索引。文件未格式化，从 dump.f90 中写入，行数如下：

```fortran
WRITE(LUSF) QUANTITY
WRITE(LUSF) SHORT_NAME
WRITE(LUSF) UNITS
WRITE(LUSF) I1,I2,J1,J2,K1,K2
WRITE(LUSF) TIME
WRITE(LUSF) (((QQ(I,J,K),I=I1,I2),J=J1,J2),K=K1,K2)
.
.
WRITE(LUSF) TIME
WRITE(LUSF) (((QQ(I,J,K),I=I1,I2),J=J1,J2),K=K1,K2)
```

QUANTITY、SHORT_NAME 和 UNITS 是长度为 30 的字符串。六元组（I1,I2,J1,J2,K1,K2）表示边界网格单元节点。六元组索引对应网格单元节点或边角，因此整个网格将由六元组（0,IBAR,0,JBAR,0,KBAR）表示。

我们提供了一个名为 fds2ascii.f90 的简短 Fortran 90 程序，可以将切片文件转换为文本文件，这些文件可以被各种图形软件包读取。该程序将计算域同一 “切片 ”对应的多个切片文件合并，对数据进行时间平均处理，然后将数值写入一个文件，每个节点由一行数字组成。每一行都包含节点的物理坐标以及与该节点相对应的时间平均量。图形软件包 Tecplot 可以读取该文件并绘制等高线图、流线图和/或矢量图。有关 fds2ascii 程序的详细信息，请参见第 22.11 节。

## Plot3D Data (.xyz,.q)

整个网格的数量可以以 Plot3D 图形软件包使用的格式输出。Plot3D 数据集为单精度（32 位实数）、完整且无格式化。需要注意的是，Plot3D 有空白处理，也就是说，被屏蔽的数据点不会被绘制出来。如果在 DUMP 行中包含 WRITE_XYZ=T 语句，网格数据将被写入名为 CHID_M.xyz 的文件中。

```fortran
WRITE(LU13) IBAR+1,JBAR+1,KBAR+1
WRITE(LU13) (((X(I),I=0,IBAR),J=0,JBAR),K=0,KBAR), &
(((Y(J),I=0,IBAR),J=0,JBAR),K=0,KBAR), &
(((Z(K),I=0,IBAR),J=0,JBAR),K=0,KBAR), &
(((IBLK(I,J,K),I=0,IBAR),J=0,JBAR),K=0,KBAR)
```

其中 X、Y 和 Z 是单元格角的坐标，IBLK 是单元格是否被阻塞的指标。如果点 (X,Y,Z) 完全嵌入实体区域，则 IBLK 为 0，否则 IBLK 为 1。

流量变量被写入一个名为 CHID_M_<time>.q 的文件，其中 M 是网格编号，<time> 是输出数据的秒数。文件按如下行写入：

```fortran
WRITE(LU14) IBAR+1,JBAR+1,KBAR+1
WRITE(LU14) ZERO,ZERO,ZERO,ZERO
WRITE(LU14) ((((QQ(I,J,K,N),I=0,IBAR),J=0,JBAR),K=0,KBAR),N=1,5)
```

N=1,5 的五个通道默认为温度（℃）、速度的 u、v 和 w 分量（m/s）以及单位体积的热释放率（kW/m3）。可使用 DUMP 行上的输入参数 PLOT3D_QUANTITY(1:5)指定其他变量。请注意，数据是在单元角处插值的，因此 Plot3D 数据集的尺寸比计算网格的尺寸大一个。

Smokeview 可以显示 Plot3D 数据。此外，Plot3D 数据集还可被其他一些接受该数据格式的图形程序读取。这种特殊格式非常方便，许多图形软件包都能识别。

## Boundary Files (.bf)

命名列表组 BNDF 下定义的边界文件命名为 CHID_M_N.bf，其中 M 是网格索引，N 是数量索引。文件未格式化，从 dump.f90 中写入，行数如下：

```fortran
WRITE(LUBF) QUANTITY
WRITE(LUBF) SHORT_NAME
WRITE(LUBF) UNITS
WRITE(LUBF) NPATCH
WRITE(LUBF) I1,I2,J1,J2,K1,K2,IOR,NB,NM
WRITE(LUBF) I1,I2,J1,J2,K1,K2,IOR,NB,NM
.
. WRITE(LUBF) TIME
WRITE(LUBF) (((QQ(I,J,K),I=11,I2),J=J1,J2),K=K1,K2)
WRITE(LUBF) (((QQ(I,J,K),I=11,I2),J=J1,J2),K=K1,K2)
.
. WRITE(LUBF) TIME
WRITE(LUBF) (((QQ(I,J,K),I=11,I2),J=J1,J2),K=K1,K2)
WRITE(LUBF) (((QQ(I,J,K),I=11,I2),J=J1,J2),K=K1,K2) .
.
```

QUANTITY（数量）、SHORT_NAME（短名称）和 UNITS（单位）是长度为 30 的字符串。NPATCH 是构成实体边界和外壁的平面（或 “补丁”）的数目。六元组（I1,I2,J1,J2,K1,K2）定义了每个补丁的单元节点。IOR 是一个整数，表示补丁的方向（±1,±2,±3）。您不能指定这些数值。NB 是边界编号（外墙为零），NM 是网格编号。请注意，数据是平面的，因此一对单元节点是相同的。目前，Smokeview 是唯一可用来查看边界文件的程序。

## Particle Data (.prt5)

与示踪粒子、喷洒液滴和其他拉格朗日粒子有关的坐标和指定量将写入一个名为 CHID_M.prt5（其中 M 为网格索引）的 FORTRAN 非格式化（二进制）文件。请注意，该文件的格式与以前的版本（4 及以下版本）相比有所变化。**该文件由一些标题材料和每 DT_PART 秒输出一次的粒子数据组成**。时间增量 DT_PART 在 DUMP 行中指定。默认为 T_END/NFRAMES。头文件由名为 dump.f90 的文件中的以下 FORTRAN 代码编写。

```fortran
WRITE(LUPF) ONE_INTEGER ! Integer 1 to check Endian-ness
WRITE(LUPF) NINT(VERSION*100.) ! FDS version number
WRITE(LUPF) N_PART ! Number of PARTicle classes
DO N=1,N_PART
PC => PARTICLE_CLASS(N)
WRITE(LUPF) PC%N_QUANTITIES,ZERO_INTEGER ! ZERO_INTEGER is a place holder
DO NN=1,PC%N_QUANTITIES
WRITE(LUPF) CDATA(PC%QUANTITIES_INDEX(NN)) ! 30 character output quantity
WRITE(LUPF) UDATA(PC%QUANTITIES_INDEX(NN)) ! 30 character output units
ENDDO
ENDDO
```

请注意，Smokeview 使用数字 1 的初始打印输出来确定文件的 Endian-ness。端点度与实数写入二进制文件的特定方式有关。版本号用于区分新旧文件格式。参数 N_PART 不是粒子的数量，而是与输入文件中的 PART 命名列表组相对应的粒子类别的数量。每隔 DT_PART 秒，粒子和液滴的坐标将以 4 字节实数形式输出（默认情况下）：

```fortran
WRITE(LUPF) REAL(T,FB) ! Write out the time T as a 4 byte real
DO N=1,N_PART
WRITE(LUPF) NPLIM ! Number of particles in the PART class
WRITE(LUPF) (XP(I),I=1,NPLIM),(YP(I),I=1,NPLIM),(ZP(I),I=1,NPLIM)
WRITE(LUPF) (TA(I),I=1,NPLIM) ! Integer "tag" for each particle
IF (PC%N_QUANTITIES > 0) WRITE(LUPF) ((QP(I,NN),I=1,NPLIM),NN=1,PC%N_QUANTITIES)
ENDDO
```

Smokeview 使用粒子 “标签 ”来跟踪单个粒子和液滴，以便绘制流线。它在解析文件时也很有用。数量数据 QP(I,NN) 被 Smokeview 用来为粒子和液滴着色。请注意，新格式现在可以用多个不同的量给粒子和液滴着色。

## Profile Files

在 namelist 组 PROF 下定义的配置文件命名为 CHID_prof_N.csv，并按格式写出。这些文件从 dump.f90 中写出，其中包含以下一行：

```fortran
WRITE(LU_PROF) T,NWP+1,(X_S(I),I=0,NWP),(Q(I),I=0,NWP)
```

在时间 T 之后，会给出节点的数量，然后是节点坐标。由于壁厚和局部固相网格可能会因固相反应而随时间变化，因此每个时间步长都要写出这些坐标。**数组 Q 包含输出量的值，可能是壁温、密度或组分密度**。

## 3-D Smoke Files (.s3d)

3-D 烟雾文件包含 Smokeview 用于绘制代表烟雾和火焰的半透明平面的 Alpha 值。FDS 以固定的时间间隔输出三维烟雾数据。三维烟雾文件的伪代码表示如下

```fortran
WRITE(LU_SMOKE3D) ONE,VERSION,0,NX-1,0,NY-1,0,NZ-1
.
.
WRITE(LU_SMOKE3D_SIZE,*) TIME,NCHARS_IN,NCHARS_OUT
WRITE(LU_SMOKE3D) TIME
WRITE(LU_SMOKE3D) NCHARS_IN,NCHARS_OUT
IF (NCHARS_OUT > 0) WRITE(LU_SMOKE3D)(BUFFER_OUT(I),I=1,NCHARS_OUT)
```

第一个 ONE 是一个 endian 标志。Smokeview 使用这个数字来确定创建三维烟雾文件的计算机和查看三维烟雾文件的计算机在存储浮点数时使用的字节交换（endian）约定是相同还是不同。不透明度数据从 4 字节浮点数转换为 1 字节整数，然后使用运行长度编码 (RLE) 进行压缩。压缩后的数据包含在 BUFFER_OUT 中。运行长度编码是一种压缩方案，在这种方案中，重复 “运行 ”的数据会被一个数字（重复次数）所取代，而数值则会被重复。四个或更多连续相同字符用 #nc 表示，其中 # 是表示重复序列开始的特殊字符，n 是重复次数，c 是重复的字符。n 的最大值为 254（255 用于表示特殊字符）。未重复四次或四次以上的字符按原样列出。例如，字符串 aaaaaabbbbbcc 编码为 #6a#5bcc。

## Iso-surface Triangulation Files (.iso)

等值面文件（.iso）用于存储一个或多个等值面，其中指定的数量是一个指定值。FDS 以固定的时间间隔输出等值面数据。这些曲面由顶点和三角形定义。一个顶点由一个（x,y,z）坐标组成。三角形由 3 个相连的顶点组成。这些文件从 smvv.f90 中写出，行式如下：

```fortran
! header
WRITE(LU_ISO) ONE
WRITE(LU_ISO) VERSION
WRITE(LU_ISO) NISO_LEVELS
IF (NISO_LEVELS>0) WRITE(LU_ISO) (ISO_LEVELS(I),I=1,NISO_LEVELS)
WRITE(LU_ISO) ZERO
WRITE(LU_ISO) ZERO, ZERO
! Write for each STIME
WRITE(LU_ISO) STIME, ZERO
WRITE(LU_ISO) N_VERT, N_FACE
IF (N_VERT_D>0) WRITE(LU_ISO) (Xvert(I),Yvert(I),Zvert(I),I=1,N_VERT)
IF (N_FACE_D>0) WRITE(LU_ISO) (FACE1(I),FACE2(I),FACE3(I),I=1,N_FACE)
IF (N_FACE_D>0) WRITE(LU_ISO) (ISO_LEVEL_INDICES(I),I=1,N_FACE)
```

其中：

- ONE 设置为 1 的整数。 Smokeview 使用该数字来确定创建几何图形文件的计算机和查看几何图形文件的计算机在存储浮点数时使用的字节交换（endian）约定是相同还是不同。
- VERSION 当前值为 1，表示该文件格式的版本号。
- NISO_LEVELS 文件开头定义的等值面层级（值）数。
- ISO_LEVELS 文件开头存储的 QUANTITY 等面层的浮点数值。
- STIME 是 FDS 模拟时间。
- N_VERT 和 N_FACE 是等值面的顶点数和三角形数。
- Xvert、Yvert、Zvert 是顶点坐标。
- FACE1、FACE2、FACE3 是每个三角形的顶点索引。这些索引的编号方式与之前写出顶点的方式相对应。
- LEVEL_INDICES 是每个三角形的等表面水平指数（指向 ISO_LEVELS）。
- ZERO 整数，设置为 0，留作兼容性和将来使用。

与用第二个 QUANTITY2 给等值面着色有关的数据文件在第 27.17 节中描述

## Geometry Boundary, Unstructured Slice Files (.gcf,.gsf)

浸没式几何曲面和非结构化切片使用本节所述的文件格式存储。这些曲面由顶点和三角形定义。几何三角形与 FDS 网格相交产生的表面多边形补丁（CFACE）被划分为三角形，用于绘制几何和边界数据（.gcf）。当切片与几何图形交叉时，非结构化切片（.gsf）从 &SLCF 命名列表中产生，也被分割成三角形。与这些切片相关的数据文件将在第 27.17 节中介绍。这些文件从 dump.f90 中写出，行式如下：

```fortran
WRITE(LU_GEOM) ONE
WRITE(LU_GEOM) VERSION
WRITE(LU_GEOM) ZERO, ZERO, ONE
WRITE(LU_GEOM) STIME
WRITE(LU_GEOM) N_VERT, N_FACE, ZERO
IF (N_VERT>0 .AND. N_FACE>0) THEN
WRITE(LU_GEOM) (Xvert(I),Yvert(I),Zvert(I),I=1,N_VERT)
WRITE(LU_GEOM) (FACE1(I),FACE2(I),FACE3(I),I=1,N_FACE)
WRITE(LU_GEOM) (LOCATION(I),I=1,N_FACE)
IF ( ".gcf" ) THEN
WRITE(LU_GEOM) (SURF_IND(I),I=1,N_FACE)
WRITE(LU_GEOM) (GEOM_IND(I),I=1,N_FACE)
ENDIF
ENDIF
```

其中：

- ONE 设置为 1 的整数。
- VERSION 当前值为 2，表示该文件格式的版本号。
- STIME 是 FDS 的初始模拟时间。
- N_VERT 和 N_FACE 是顶点和面的数量。
- Xvert、Yvert、Zvert 是顶点坐标。
- FACE1、FACE2、FACE3 是每个三角形的顶点索引。这些索引的编号方式与之前写出顶点的方式相对应。
- LOCATION定义哪些三角形边缘属于多边形补丁边界的整数。
- SURF_IND 是每个三角形的 SURF 指数。只写入 .gcf 文件。
- GEOM_IND 是输入文件序列中所列几何图形的每个三角形的几何图形索引。只写入 .gcf 文件。
- ZERO 整数设置为 0，条目留作将来使用。

## Isosurface, Geometry and Unstructured Slice Data Files(.viso,.be)

等值面、几何边界和非结构化切片数据文件包含 FDS 对等值面（.viso）或几何边界/非结构化切片（.be）文件产生的三角剖分计算的数据值描述。这些文件类似于边界文件。**写入非结构化数据文件的数据必须与写入相应几何文件（.iso 表示 .viso；.gcf、.gsf 表示 .be）的三角剖分相对应**。这些数据文件从 dump.f90 中写出，行式如下：

```fortran
WRITE(FUNIT_DATA) ONE
WRITE(FUNIT_DATA) FILETYPE
WRITE(FUNIT_DATA) STIME
WRITE(FUNIT_DATA) ZERO, ZERO, N_VERT_VALS, N_FACE_VALS
IF (N_VERT_VALS>0) WRITE(FUNIT_DATA) (ValVert(I), I=1,N_VERT_VALS)
IF (N_FACE_VALS>0) WRITE(FUNIT_DATA) (ValFace(I), I=1,N_FACE_VALS)
```

- ONE 设置为 1 的整数。
- FYLETYPE当前的值为1表示等值面，2表示几何体。
- STIME 是 FDS 模拟时间。
- N_VERT_VALS, N_FACE_VALS 是写出的顶点和面的数据值数量。
- ValVert、ValFace 顶点和面数据。目前，几何体和等值面文件都可以在单个文件中导出面或节点数据。
- ZERO 整数设置为 0，条目留作将来使用。

## Terrain Data Files (.ter)

对于涉及室外地形的模拟，将为每个网格 M 创建 CHID_M.ter 格式的文件，其中包含一些地形切面。写入语句为

```fortran
WRITE(LU_TERRAIN(NM)) REAL(ZS_MIN-1._EB,FB)
WRITE(LU_TERRAIN(NM)) M%IBP1,M%JBP1
WRITE(LU_TERRAIN(NM)) (M%XPLT(I),I=0,M%IBAR)
WRITE(LU_TERRAIN(NM)) (M%YPLT(J),J=0,M%JBAR)
WRITE(LU_TERRAIN(NM)) ((Z_TERRAIN(I,J),J=0,M%JBAR),I=0,M%IBAR)
```

NM 是网格编号，M 是指向网格 NM 变量的指针，ZS_MIN 是整个域的最低 Z 值，IBP1 和 JBP1 是网格中水平网格单元数加 1，XPLT 和 YPLT 是四个字节（FB）坐标，Z_TERRAIN(I,J) 是索引为 (I,J) 的点的海拔高度。所有实数都是四个字节。标高定义在单元角上。

## FDS GEOM I/O binary format (.bingeom)

如第 7.3.9 节所述，FDS 读取几何图形的二进制格式如下。:question:**FDS 发布的预编译捆绑包读取的二进制文件必须是 little endian 字节顺序**。

```fortran
WRITE(LU_BINGEOM) GEOM_TYPE
WRITE(LU_BINGEOM) N_VERTS,N_FACES,N_SURF_ID,N_VOLUS
WRITE(LU_BINGEOM) VERTS(1:3*N_VERTS)
WRITE(LU_BINGEOM) FACES(1:3*N_FACES)
WRITE(LU_BINGEOM) SURFS(1:N_FACES)
WRITE(LU_BINGEOM) VOLUS(1:4*N_VOLUS)
```

其中：

- GEOM_TYPE 对于 CAD 几何图形，整数等于 1；对于地形（仅顶面），整数等于 2。所有 FDS 分析几何图形（包括挤出的 POLY）都以一般 CAD 几何图形的二进制形式写入。
- N_VERTS,N_FACES,N_SURF_ID,N_VOLUS 几何体上顶点、三角形、曲面类型和体积的数量。
- VERTS 一维数组，包含 N_VERTS 顶点的 x、y、z 位置。
- FACES 一维数组，包含 N_FACES 三角形的 n1、n2、n3 节点连线。
- SURFS 一维数组，包含 N_FACES 三角形的 SURF_ID。
- VOLUS 一维数组，包含 N_VOLUS 四面体的 n1、n2、n3、n4 节点连接性。该阵列目前在 FDS 中未使用，今后将用于三维固体传热。

## Unstructured Geometry (.ge,.ge2)

浸没式几何对象使用下述扩展名为 .ge 的文件格式存储，以便 SMV 读取。这些对象由顶点和三角形定义。一个顶点用一个（x、y、z）坐标（三个浮点数值）表示。三角形用三个顶点（整数）指数表示。**下面的四面体体积选项不用于 FDS，而是作为未来功能的一个选项**。下一节将介绍用于存储几何对象数据的相关文件格式。这些文件从 dump.f90、geom.f90 中写出，行式如下：

```fortran
WRITE(LU_GEOM) ONE
WRITE(LU_GEOM) VERSION
WRITE(LU_GEOM) N_FLOATS, N_INTS, FIRST_FRAME_STATIC
IF (N_FLOATS>0) WRITE(LU_GEOM) (FLOAT_HEADER(I),I=1,N_FLOATS)
IF (N_INTS>0) WRITE(LU_GEOM) (INT_HEADER(I),I=1,N_INTS)
WRITE(LU_GEOM) STIME
WRITE(LU_GEOM) N_VERT, N_FACE, N_VOL
IF (N_VERT>0) WRITE(LU_GEOM)(Xvert(I),Yvert(I),Zvert(I),I=1,N_VERT)
IF (N_FACE>0) THEN
WRITE(LU_GEOM) (FACE1(I),FACE2(I),FACE3(I),I=1,N_FACE)
WRITE(LU_GEOM) (SURF_IND(I),I=1,N_FACE)
WRITE(LU_GEOM) (Xtext(I),Ytext(I),I=1,3*N_FACE)
ENDIF
IF (N_VOL>0) THEN
WRITE(LU_GEOM) (VOL1(I),VOL2(I),VOL3(I),VOL4(I),I=1,N_VOL)
WRITE(LU_GEOM) (MATL(I),I=1,N_VOL)
ENDIF
```

- ONE 设置为 1 的整数。
- VERSION当前的值为2，表示该文件格式的版本号。
- N_FLOATS、N_INTS、FIRST_FRAME_STATIC 文件开头存储的浮点和整数数据项的数量。供将来使用的 FIRST_FRAME_STATIC 目前设置为 1。
- FLOAT_HEADER, INT_HEADER 文件开头存储的浮点和整数数据。
- STIME 是 FDS 模拟时间。
- N_VERT、N_FACE 和 N_VOL 分别是顶点、面和体积的数量。
- Xvert、Yvert、Zvert 是顶点坐标。
- FACE1、FACE2、FACE3 是每个面（三角形）的顶点索引。索引范围从 1 到 N_VERT。
- SURF_IND 是每个面的 SURF 指数。
- Xtext、Ytext 是纹理坐标。
- **VOL1、VOL2、VOL3、VOL4 是每个体积（四面体）的顶点索引**。索引编号从 1 到 N_VERT。目前未使用。
- MATL 是各卷的 MATL 索引。目前 FDS 不使用。

.ge2 几何图形文件包含从 .fds 输入文件中读取的实际几何图形索引，其写法为

```fortran
IF (N_FACE>0) THEN
WRITE(LU_GEOM2) N_FACE
WRITE(LU_GEOM2) (GEOM_IDS(I), I=1,N_FACES)
ENDIF
```

通过这些信息，可以在 SMV 中获得每个几何体的完整面积和边界条件信息。

## FDS HVAC I/O binary format

命名列表组 HVAC 下的 HVAC 输出未格式化写入文件 CHID.hvac。这些文件从 dump.f90 中写出，行数如下：

```fortran
WRITE(LU_HVAC) N_NODE_OUT, N_NODE_QUANTITY, N_DUCT_OUT, N_DUCT_QUANTITY
WRITE(LU_HVAC) DUCT_CELL(1:N_DUCT_OUT)
WRITE(LU_HVAC) TIME
DO N=1,N_NODE_OUT
WRITE(LU_HVAC) OUTVAL_N(1:N_NODE_QUANTITY)
ENDDO
DO N=1,N_DUCT_OUT
IF (DUCT(N)%N_CELLS > 0) THEN
DO N=1,DUCT(N)%N_CELLS
WRITE(LU_HVAC) OUTVAL_D(1:N_DUCT_QUANTITY)
ENDDO
ELSE
WRITE(LU_HVAC) OUTVAL_D(1:N_DUCT_QUANTITY)
ENDIF
ENDDO
```

其中 DUCT_CELL 是管道的质量传输单元数（如果管道没有质量传输，则写入值 1），第二个输出块写入每个 DT_HVAC 输出区间。

## File Extension Glossary

表 27.1 提供了 FDS 和 Smokeview 使用的文件扩展名的快速参考。

<center>Table 27.1: File Extension Reference Table</center>

| File extension | Short Description                          | Reference                    |
| -------------- | ------------------------------------------ | ---------------------------- |
| .be            | Data values for .gcf,.gsf,.iso files       | Section 27.17                |
| .bf            | Boundary files                             | Section 27.11                |
| .bingeom       | Binary geometry files                      | Section 27.19                |
| .bnd           | Min/Max Bound files                        | Smokeview User’s Guide [^17] |
| .fds           | FDS input files                            | FDS User’s Guide Part II     |
| .gbf           | Geometry boundary files                    | To be deprecated             |
| .gcf           | CFACE geometry files                       | Section 27.16                |
| .ge            | Geometry vertices and faces                | Section 27.20                |
| .ge2           | Geometry face properties                   | Section 27.20                |
| .gsf           | Unstructured slice files                   | Section 27.16                |
| .ini           | Smokeview configuration files              | Smokeview User’s Guide [^17] |
| .iso           | Isosurface files                           | Section 27.15                |
| .out           | FDS output log files                       | Section 27.1                 |
| .prt5.gbnd     | Global bounds of all particle files        |                              |
| .prt5          | Particle files                             | Section 27.12                |
| .q             | Plot3D files                               | Section 27.10                |
| .restart       | FDS restart files                          | Section 5.6                  |
| .s3d           | 3D smoke files                             | Section 27.14                |
| .sf            | Slice files                                | Section 27.9                 |
| .sinfo         | Slice parameter files                      | Smokeview User’s Guide [^17] |
| .smv           | Smokeview files                            | Smokeview User’s Guide [^17] |
| .ssf           | Smokeview script files                     | Smokeview User’s Guide [^17] |
| .stop          | If present, stops a simulation gracefully  | Section 5.6                  |
| .sz            | Size files for Smokeview memory allocation |                              |
| .ter           | Terrain data files                         | Section 27.18                |
| .xyz           | Plot3D mesh files                          | Section 27.10                |
| _devc.csv      | Device files                               | Section 27.3                 |
| _git.txt       | Git revision                               |                              |
| _hrr.csv       | Heat Release Rate files                    | Section 27.2                 |



# 参考文献

文献[^3]对湍流燃烧进行了较为详细的描述。

[^1]:钠冷快堆柱状流钠火仿真研究_汤烨鑫
[^2]:钠冷快增殖堆池式钠火事故分析计算_王学容
[^3]:钠火事故钠滴燃烧仿真研究_唐绪聪
[^4]:【钠物性】Thermodynamic and transport properties of sodium liquid and vapor
[^5]:【钠表面张力】Experimental investigation of the  surface tension of liquid sodium
[^6]:Klause J, Kurge D. Solar thermal plant power and process heat[J]. Deutsches zentrum  fur luft und raumfahrt. 2003.7: 181-216.
[^7]:Luster V.P and Freudenstein K.F. Feedback from practical experience with large sodium  fire accident[C]. IWGFR/92, O-arai, Japan, 1996. 
[^8]:Mikami H, Shono A. Sodium leak at monju(I)-Cause and Consequence[J]. IWGFR/92,  O-arai, Japan, Nov.1996. 
[^9]:Funada T and Yamagishi Y. Sodium Leak at Monju(II)-Sodium leak, burning and  aerosol behavior[J]. IWGFR/92, O-arai, Japan, Nov.1996.
[^10]:Malet J C. Generation IV roadmap descripion of candidate Liquid-Mental- Cooled  reactor systems report[J]. Nuclear energy research advisory committee and the  generation IV international forum, 2002(3): 96-168.
[^11]:【物性】Numerical modeling of sodium fire—Part I Spray combustion
[^12]:A. Khawam and D. R. Flanagan. Solid-State Kinetic Models: Basics and Mathematical Fundamentals. J. Phys. Chem. B, 110:17315–17328, 2006. 177
[^13]:R.E. Lyon. Heat Release Kinetics. Fire and Materials, 24:179–186, 2000. 189
[^14]:R.E. Lyon and R.N. Walters. Pyrolysis Combustion Flow Calorimetry. Journal of Analytical and Applied Pyrolysis, 71(1):27–46, March 2004. 199
[^15]:American Society for Testing and Materials, West Conshohocken, Pennsylvania. ASTM D 7309-11, Standard Test Method for Determining Flammability Characteristics of Plastics and Other Solid Materials Using Microscale Combustion Calorimetry, 2011. 199
[^16]:Stephen B. Pope. Turbulent Flows. Cambridge University Press, 2000. 10, 25, 27, 28, 29, 43, 52, 105, 171, 172, 181
[^17]:G.P. Forney. Smokeview, A Tool for Visualizing Fire Dynamics Simulation Data, Volume I: User’s Guide. National Institute of Standards and Technology, Gaithersburg, Maryland, USA, sixth edition,May 2013. v, 3, 7, 300, 407, 416, 426, 467
[^18]:B. Ralph and R. Carvel. Coupled hybrid modelling in fire safety engineering; a literature review. Fire Safety Journal, 100:157 – 170, 2018. 126
[^19]:N. Jarrin. Synthetic Inflow Boundary Conditions for the Numerical Simulation of Turbulence. PhD thesis, The University of Manchester, Manchester M60 1QD, United Kingdom, 2008. 123, 124
[^20]:T.L. Bergman, A.S. Lavine, F.P. Incropera, and D.P. DeWitt. Fundamentals of Heat and Mass Transfer.John Wiley and Sons, New York, 7th edition, 2011. 74, 75, 478, 479
[^21]:H.S. Mickely, R.C. Ross, and A.L. Squyers. Heat, Mass, and Momentum Transfer for Flow Over a Flat Plate with Blowing or Suction. Technical Note 3208, National Advisory Committee for Aeronautics,Washington, DC, July 1954. 77
[^22]:B. Ralph and R. Carvel. Coupled hybrid modelling in fire safety engineering; a literature review. Fire Safety Journal, 100:157 – 170, 2018. 126
[^23]:K. McGrattan, S. Hostikka, R. McDermott, J. Floyd, C. Weinschenk, and K. Overholt. Fire Dynamics Simulator, Technical Reference Guide, Volume 3: Validation. National Institute of Standards and Technology, Gaithersburg, Maryland, USA, and VTT Technical Research Centre of Finland, Espoo, Finland, sixth edition, September 2013. 3, 43, 152

[^24]:K. McGrattan, S. Hostikka, R. McDermott, J. Floyd, C. Weinschenk, and K. Overholt. Fire Dynamics Simulator, Technical Reference Guide. National Institute of Standards and Technology, Gaithersburg, Maryland, USA, and VTT Technical Research Centre of Finland, Espoo, Finland, sixth edition, September 2013. Vol. 1: Mathematical Model; Vol. 2: Verification Guide; Vol. 3: Validation Guide; Vol. 4: Software Quality Assurance. v, 60, 76, 104, 157, 173, 313
[^25]:F. Bisetti, G. Blanquart, and H. Pitsch. Direct numerical simulation of soot formation in turbulent non-premixed flames. Technical report, Stanford Center for Turbulence Research, 2008. 158
[^26]:Sebastian Ferreyro Fernandez. ADVANCED SOOT AND RADIATION MODELS FOR LAMINAR AND TURBULENT FLAMES. PhD thesis, The Pennsylvania State University, 2018. 158
[^27]:W. Grosshandler. RadCal: A Narrow Band Model for Radiation Calculations in a Combustion Environment. NIST Technical Note 1402, National Institute of Standards and Technology, Gaithersburg, Maryland, 1993. 4, 159
[^28]:D. Purser and J. Purser. HCN Yields and Fate of Fuel Nitrogen for Materials under Different Combustion Conditions in the ISO 19700 Tube Furnace and Large-scale Fires. In Fire Safety Science –Proceedings of the Ninth International Symposium, pages 1117–1128. International Association of Fire Safety Science, 2008. 169
[^29]:K. McGrattan, S. Hostikka, R. McDermott, J. Floyd, C. Weinschenk, and K. Overholt. Fire Dynamics Simulator, Technical Reference Guide, Volume 1: Mathematical Model. National Institute of Standards and Technology, Gaithersburg, Maryland, USA, and VTT Technical Research Centre of Finland, Espoo, Finland, sixth edition, September 2013. 3, 75, 80, 123, 125, 171, 187, 188, 196, 202, 211, 281, 310, 312, 315, 324, 373, 384, 395, 398, 435
[^30]:C. Beyler. SFPE Handbook of Fire Protection Engineering, chapter Flammability Limits of Premixed and Diffusion Flames. Springer, New York, 5th edition, 2016. 172, 173, 174
[^31]:C.K. Westbrook and F.L. Dryer. Simplified Reaction Mechanisms for the Oxidation of Hydrocarbon Fuels in Flames. Combustion Science and Technology, 27:31–43, 1981. 184, 185
[^32]:J. Andersen, C.L. Rasmussen, T. Giselsson, and P. Glarborg. Global Combustion Mechanisms for Use in CFD Modeling Under Oxy-Fuel Conditions. Energy & Fuels, 23(3):1379–1389, 2009. 185
[^33]:W. P. Jones and R. P. Lindstedt. Global reaction schemes for hydrocarbon combustion. Combustion and Flame, 73:233–249, 1988. 186
[^34]:M.M. Khan, A. Tewarson, and M. Chaos. SFPE Handbook of Fire Protection Engineering, chapter Combustion Characteristics of Materials and Generation of Fire Products. Springer, New York, 5th edition, 2016. 177, 178, 180, 188, 193, 194
[^35]:J.R. Hartman, A.P. Beyler, S. Riahi, and C.L.Belyer. Smoke oxidation kinetics for application to prediction of clean burn patterns. Fire and Materials, 36:177–184, 2012. 189
[^36]:B. Chapman, G. Jost, and R. van der Pas. Using OpenMP – Portable Shared Memory Parallel Programming. MIT Press, Cambridge, Massachusetts, 2007. 4, 10
[^37]:W. Gropp, E. Lusk, and A. Skjellum. Using MPI – Portable Parallel Programming with the Message-Passing Interface. MIT Press, Cambridge, Massachusetts, 2nd edition, 1999. 4, 10
[^38]:K. McGrattan, S. Hostikka, R. McDermott, J. Floyd, C. Weinschenk, and K. Overholt. Fire Dynamics Simulator, Technical Reference Guide, Volume 2: Verification. National Institute of Standards and Technology, Gaithersburg, Maryland, USA, and VTT Technical Research Centre of Finland, Espoo, Finland, sixth edition, September 2013. 3, 8, 115, 333
[^39]:C.L. Beyler. SFPE Handbook of Fire Protection Engineering, chapter Fire Hazard Calculations for Large Open Hydrocarbon Fires. Springer, New York, 5th edition, 2016. 193, 194
[^40]:Y.J. Kim and A. Trouvé. Evaluation of angular resolution requirements in the finite-volume memthod solution of the radiative transfer equation. Fire Safety Journal, 141:103971, 2023. 196
[^41]:A. Gupta, K. Meredith, G. Agarwal, S. Thumuluru, Y. Xin, M. Chaos, and Y.Wang. CFD Modeling of Fire Growth in Rack-Storages of Cartoned Unexpanded Plastic (CUP) Commodity. FM Global Open Source CFD Fire Modeling Workshop, 2015. 198
[^42]:W. E. Ranz and W. R. Marshall. Evaporation from drops - Part II. Chemical Engineering Progress, 48:173–180, March 1952. 203
[^43]:S.S. Sazhin. Advanced models of fuel droplet heating and evaporation. Progress in Energy and Combustion Science, 32:162–214, 2006. 203
[^44]:C. Theobald. The Effect of Nozzle Design on the Stability and Performance of Turbulent Water Jets.Fire Safety Journal, 4:1–13, 1981. 208
[^45]:T. Bartzanas, T. Boulard, and C. Kittas. Numerical simulation of the airflow and temperature distribution in a tunnel greenhouse equipped with insect-proof screens in the openings. Computers and Electronics in Agriculture, 34:207–221, 2002. 215
[^46]:P. Andersson and P. Van Hees. Performance of Cables Subjected to Elevated Temperatures. In Fire Safety Science – Proceedings of the Eighth International Symposium, pages 1121–1132. International Association of Fire Safety Science, 2005. 215
[^47]:S.P. Nowlen, F.J. Wyant, and K.B. McGrattan. Cable Response to Live Fire (CAROLFIRE). NUREG/CR 6931, United States Nuclear Regulatory Commission, Washington, DC, April 2008. 216
[^48]:S.R. Hanna, G.A. Briggs, and R.P. Hosker. Handbook on Atmospheric Diffusion. DOE/TIC 11223, U.S. Department of Energy, 1982. Available through the National Technical Information Service, U.S. Department of Commerce, Springfield, Virginia. 230
[^49]:A.J. Dyer. A review of flux profile relationships. Boundary-Layer Meteorology, 7:363–372, 1974. 231
[^50]:R.B. Stull. Meteorology for Scientists and Engineers. Brooks/Cole, Pacific Grove, California, 2nd edition, 2000. 232, 236, 237
[^51]:J.H. Klote and J.A. Milke. Design of Smoke Management Systems. American Society of Heating Refrigeration, and Air-Conditioning Engineers and Society of Fire Protection Engineers, Atlanta, Georgia, 1992. 242
[^52]:G. Heskestad and R.G. Bill. Quantification of Thermal Responsiveness of Automatic Sprinklers Including Conduction Effects. Fire Safety Journal, 14:113–125, 1988. 275
[^53]:T. Cleary, A. Chernovsky, W. Grosshandler, and M. Anderson. Particulate Entry Lag in Spot-Type Smoke Detectors. In Fire Safety Science – Proceedings of the Sixth International Symposium, pages 779–790. International Association for Fire Safety Science, 1999. 282
[^54]:M.J. Hurley, editor. SFPE Handbook of Fire Protection Engineering. Springer, New York, 5th edition, 2016. 282

# 工业界的咨询资源【网站】

- 私立或工业机构：

1. 美国航空与航天协会 AIAA, www.aiaa.org

2. 美国消防协会 NFPA, www.nfpa.org

3. 美国消防工程师协会 SFPE, www.sfpe.org

4. 美国化学工程师协会 AiChe, http://www.aiche.org/

5. 美国暖通空调工程师协会 ASHRAE, www.ashrae.org

6. 美国测试/机械工程师协会 ASTM/ASME, www.asme.org

7. 国际火场调查员协会 IAFI, www.nafi.org

- 美国政府机构：

1. 美国标准与技术研究所 NIST, www.fire.nist.gov

2. 美国司法研究所 NIJ, www.ojp.usdoj.gov/nij/pubs.htm

3. 美国核电规范委员会 NRC, http://www.nrc.gov

4. 美国联邦航空总署 FAA, www.faa.gov

5. 美国职业安全健康总署 OSHA, www.osha.gov

6. 美国联邦应急管理总署 FEMA, www.usfa.fema.gov

- 教育机构：

1. 马里兰大学消防工程系 UMD, www.enfp.umd.edu

2. 伍斯特工学院消防工程系 WPI, http://www.wpi.edu/academics/fpe

3. 南加州大学消防工程系 CalPoly, http://www.fpe.calpoly.edu/

4. 俄克拉荷马州立大学消防与安全系 OSU, http://fpst.okstate.edu/

5. 北卡大学消防工程技术系 UNCC, http://et.uncc.edu/undergraduate-programs/fire-safetyengineering-technology

6. 东肯塔基大学 EKU, http://fireandsafety.eku.edu/

7. 纽黑文大学 UNH, http://www.newhaven.edu/5884/

8. 德州大学奥斯丁分校 UT Austin, http://studentorgs.utexas.edu/sfpe/

9. 马里兰大学火灾材料数据库：http://FireBID.umd.edu   

[MaCFP - International Association for Fire Safety Science (iafss.org)](https://iafss.org/macfp/)

FireFoam开发公司：[Fire Modeling, Simulation and Research – FM Global](https://www.fmglobal.com/research-and-resources/research-and-testing/theoretical-computational-and-experimental-research/open-source-fire-modeling)

## **核能网站**

1. [Verification And Validation Of Selected Fire Models For Nuclear Power Plant Applications (NUREG-1824) | NRC.gov](https://www.nrc.gov/reading-rm/doc-collections/nuregs/staff/sr1824/index.html)

2. **C**omputational **C**hemistry **C**omparison and **B**enchmark **D**ata**B**ase：[CCCBDB introduction navigation (nist.gov)](https://cccbdb.nist.gov/)

3. [Fast-neutron reactors, Fast nuclear reactors | IAEA](https://www.iaea.org/topics/fast-reactors)

4. [Fire dynamics & science | NIST](https://www.nist.gov/fire-dynamics-science)

5. 钠：[sodium (nist.gov)](https://webbook.nist.gov/cgi/cbook.cgi?ID=7440235#Notes)

6. 钠反应搜索：[Reaction Search Form (nist.gov)](https://webbook.nist.gov/cgi/cbook.cgi?Form=C7440235&Mask=8&Type=Reaction)


## FDS及火灾相关网站

1. [教程：Physical and Chemical Processes — Fire Simulation  Lecture Notes (firedynamics.github.io)](https://firedynamics.github.io/LectureFireSimulation/content/modelling/01_general/01_processes.html)

2. FDS火灾模拟（武警学院李胜利老师）[www.bilibili.com/video/BV14b4y1X7Zk/?spm_id_from=333.999.0.0](http://www.bilibili.com/video/BV14b4y1X7Zk/?spm_id_from=333.999.0.0)

3. FDS第三方软件[Third Party Tools · firemodels/fds Wiki (github.com)](https://github.com/firemodels/fds/wiki/Third-Party-Tools)

4. [johodges/pyfdstools: A Python Package to Assist in Developing and Post-Processing Data Produced Through the Computational Fluid Dynamics Software Fire Dynamics Simulator. (github.com)](https://github.com/johodges/pyfdstools)

5. 开源软件FIreFOAM：[Fire Modeling, Simulation and Research – FM Global](https://www.fmglobal.com/research-and-resources/research-and-testing/theoretical-computational-and-experimental-research/open-source-fire-modeling)

6.  https://pages.nist.gov/fds-smv/

7. [pyFDStools](https://github.com/johodges/pyfdstools) - Jonathan Hodges(A Python Package to Assist in Developing and Post-Processing Data Produced Through the Computational Fluid Dynamics Software Fire Dynamics Simulator. This packages has the functionality to read most of the binary data files (boundary, 2-D slice, 3-D slice, plot3d) generated by FDS.)

   [FDSReader](https://github.com/FireDynamics/fdsreader) - Jan Vogelsang(Fast and easy-to-use Python reader for FDS data.)

## 配置

1. [用Cmake来编译fortran_cmake fortran-CSDN博客](https://blog.csdn.net/baidu_29950065/article/details/72716650)

